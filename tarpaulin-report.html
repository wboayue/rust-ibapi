<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <style>html, body {
  margin: 0;
  padding: 0;
}

.app {
  margin: 10px;
  padding: 0;
}

.files-list {
  margin: 10px 0 0;
  width: 100%;
  border-collapse: collapse;
}
.files-list__head {
  border: 1px solid #999;
}
.files-list__head > tr > th {
  padding: 10px;
  border: 1px solid #999;
  text-align: left;
  font-weight: normal;
  background: #ddd;
}
.files-list__body {
}
.files-list__file {
  cursor: pointer;
}
.files-list__file:hover {
  background: #ccf;
}
.files-list__file > td {
  padding: 10px;
  border: 1px solid #999;
}
.files-list__file > td:first-child::before {
  content: '\01F4C4';
  margin-right: 1em;
}
.files-list__file_low {
  background: #fcc;
}
.files-list__file_medium {
  background: #ffc;
}
.files-list__file_high {
  background: #cfc;
}
.files-list__file_folder > td:first-child::before {
  content: '\01F4C1';
  margin-right: 1em;
}

.file-header {
  border: 1px solid #999;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.file-header__back {
  margin: 10px;
  cursor: pointer;
  flex-shrink: 0;
  flex-grow: 0;
  text-decoration: underline;
  color: #338;
}

.file-header__name {
  margin: 10px;
  flex-shrink: 2;
  flex-grow: 2;
}

.file-header__stat {
  margin: 10px;
  flex-shrink: 0;
  flex-grow: 0;
}

.file-content {
  margin: 10px 0 0;
  border: 1px solid #999;
  padding: 10px;
}

.code-line {
  margin: 0;
  padding: 0.3em;
  height: 1em;
}
.code-line_covered {
  background: #cfc;
}
.code-line_uncovered {
  background: #fcc;
}
</style>
</head>
<body>
    <div id="root"></div>
    <script>
        var data = {"files":[{"path":["/","Users","wboayue","projects","rust-ibapi","src","accounts.rs"],"content":"\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","cancel_orders.rs"],"content":"use clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::orders;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"cancel_order\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Cancels an open order\")\n        .arg(arg!(--order_id \u003cORDER_ID\u003e).value_parser(clap::value_parser!(i32)).default_value(\"-1\"))\n        .arg(arg!(--connection_string \u003cCONNECTION_STRING\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--manual_order_cancel_time \u003cCANCEL_TIME\u003e).default_value(\"\"))\n        .arg(arg!(--global).default_value(\"false\"))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").unwrap();\n    let order_id = matches.get_one::\u003ci32\u003e(\"order_id\").unwrap();\n    let manual_order_cancel_time = matches.get_one::\u003cString\u003e(\"manual_order_cancel_time\").unwrap();\n    let global = matches.get_one::\u003cbool\u003e(\"global\").unwrap();\n\n    let mut client = Client::connect(connection_string)?;\n\n    if *global {\n        println!(\"Requesting global cancel.\");\n\n        orders::global_cancel(\u0026mut client)?\n    } else {\n        println!(\"Cancelling order {order_id}\");\n\n        let results = orders::cancel_order(\u0026mut client, *order_id, manual_order_cancel_time)?;\n        for result in results {\n            println!(\"{result:?}\");\n        }\n    };\n\n    Ok(())\n}\n","traces":[{"line":6,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","contract_details.rs"],"content":"use clap::{arg, Command};\nuse log::{debug, info};\n\nuse ibapi::client::Client;\nuse ibapi::contracts::{self, Contract};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"find_contract_details\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Finds contract details\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--stock \u003cVALUE\u003e).required(true))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let stock_symbol = matches.get_one::\u003cString\u003e(\"stock\").expect(\"stock symbol is required\");\n\n    let mut client = Client::connect(connection_string)?;\n\n    info!(\"connected {client:?}\");\n\n    println!(\"server_version: {}\", client.server_version());\n    println!(\"server_time: {}\", client.server_time());\n    println!(\"managed_accounts: {}\", client.managed_accounts());\n    println!(\"next_order_id: {}\", client.next_order_id());\n\n    let mut contract = Contract::stock(stock_symbol);\n    contract.currency = \"USD\".to_string();\n    debug!(\"contract template: {contract:?}\");\n\n    let results = contracts::contract_details(\u0026mut client, \u0026contract)?;\n    for contract in \u0026results {\n        println!(\"contract: {contract:?}\");\n    }\n\n    Ok(())\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","executions.rs"],"content":"use anyhow::Ok;\nuse clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::orders::{self, ExecutionFilter};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"orders\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Find order executions for current daya\")\n        .arg(arg!(--client_id \u003cCLIENT_ID\u003e).value_parser(clap::value_parser!(i32)))\n        .arg(arg!(--account_code \u003cACCOUNT_CODE\u003e))\n        .arg(arg!(--time \u003cTIME\u003e).help(\"yyyymmdd hh:mm:ss\"))\n        .arg(arg!(--symbol \u003cSYMBOL\u003e))\n        .arg(arg!(--security_type \u003cSECURITY_TYPE\u003e))\n        .arg(arg!(--exchange \u003cEXCHANGE\u003e))\n        .arg(arg!(--side \u003cSIDE\u003e))\n        .arg(arg!(--connection_string \u003cCONNECTION_STRING\u003e).default_value(\"odin:4002\"))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").unwrap();\n\n    let mut filter = ExecutionFilter::default();\n\n    if let Some(client_id) = matches.get_one::\u003ci32\u003e(\"client_id\") {\n        filter.client_id = Some(*client_id);\n    }\n\n    if let Some(account_code) = matches.get_one::\u003cString\u003e(\"account_code\") {\n        filter.account_code = account_code.to_owned();\n    }\n\n    if let Some(time) = matches.get_one::\u003cString\u003e(\"time\") {\n        filter.time = time.to_owned();\n    }\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"symbol\") {\n        filter.symbol = symbol.to_owned();\n    }\n\n    if let Some(security_type) = matches.get_one::\u003cString\u003e(\"security_type\") {\n        filter.security_type = security_type.to_owned();\n    }\n\n    if let Some(exchange) = matches.get_one::\u003cString\u003e(\"exchange\") {\n        filter.exchange = exchange.to_owned();\n    }\n\n    if let Some(side) = matches.get_one::\u003cString\u003e(\"side\") {\n        filter.side = side.to_owned();\n    }\n\n    let mut client = Client::connect(connection_string)?;\n\n    let executions = orders::executions(\u0026mut client, filter)?;\n    for execution in executions {\n        println!(\"{execution:?}\")\n    }\n\n    // std::thread::sleep(std::time::Duration::from_secs(5));\n\n    Ok(())\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":32},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","market_rule.rs"],"content":"use clap::{arg, Command};\nuse log::info;\n\nuse ibapi::client::Client;\nuse ibapi::contracts;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"market_rule\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Finds contract descriptions matching pattern\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--market_rule_id \u003cVALUE\u003e).required(true).value_parser(clap::value_parser!(i32)))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let market_rule_id = matches.get_one::\u003ci32\u003e(\"market_rule_id\").expect(\"market rule id is required\");\n\n    let mut client = Client::connect(connection_string)?;\n\n    info!(\"connected {client:?}, using: {connection_string}\");\n\n    let results = contracts::market_rule(\u0026mut client, *market_rule_id)?;\n    println!(\"rule: {results:?}\");\n\n    std::thread::sleep(std::time::Duration::from_secs(5));\n\n    Ok(())\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":13},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","matching_symbols.rs"],"content":"use clap::{arg, Command};\nuse log::info;\n\nuse ibapi::client::Client;\nuse ibapi::contracts;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"find_contract_descriptions_matching\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Finds contract descriptions matching pattern\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--pattern \u003cVALUE\u003e).required(true))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let pattern = matches.get_one::\u003cString\u003e(\"pattern\").expect(\"pattern is required\");\n\n    let mut client = Client::connect(connection_string)?;\n\n    info!(\"connected {client:?}, using: {connection_string}\");\n\n    let results = contracts::matching_symbols(\u0026mut client, pattern)?;\n    for result in \u0026results {\n        println!(\"contract: {result:?}\");\n    }\n\n    Ok(())\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":13},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","next_order_id.rs"],"content":"use clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::orders;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"next_order_id\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Gets next valid order id\")\n        .arg(arg!(--connection_string \u003cCONNECTION_STRING\u003e).default_value(\"odin:4002\"))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").unwrap();\n\n    let mut client = Client::connect(connection_string)?;\n\n    let order_id = orders::next_valid_order_id(\u0026mut client)?;\n    println!(\"Next valid order id: {order_id}\");\n\n    Ok(())\n}\n","traces":[{"line":6,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":9},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","orders.rs"],"content":"use anyhow::Ok;\nuse clap::builder::PossibleValue;\nuse clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::orders::{self, OrderDataIterator};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let order_types = [\"completed\", \"open\", \"all_open\", \"auto_open\"];\n    let order_types: Vec\u003cPossibleValue\u003e = order_types.iter().map(PossibleValue::new).collect();\n\n    let matches = Command::new(\"orders\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Queries completed and open orders\")\n        .arg(arg!(\u003cTYPE\u003e).default_value(\"completed\").value_parser(order_types))\n        .arg(arg!(--connection_string \u003cCONNECTION_STRING\u003e).default_value(\"odin:4002\"))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").unwrap();\n    let order_type = matches.get_one::\u003cString\u003e(\"TYPE\").unwrap();\n\n    let mut client = Client::connect(connection_string)?;\n\n    match order_type.as_str() {\n        \"open\" =\u003e {\n            println!(\"Open orders:\");\n            let orders = orders::open_orders(\u0026mut client)?;\n            print_orders(orders);\n        }\n        \"all_open\" =\u003e {\n            println!(\"All open orders:\");\n            let orders = orders::all_open_orders(\u0026mut client)?;\n            print_orders(orders);\n        }\n        \"auto_open\" =\u003e {\n            println!(\"Auto open orders:\");\n            let orders = orders::auto_open_orders(\u0026mut client, false)?;\n            print_orders(orders);\n        }\n        \"completed\" =\u003e {\n            println!(\"Completed orders:\");\n            let orders = orders::completed_orders(\u0026mut client, false)?;\n            print_orders(orders);\n        }\n        kind =\u003e {\n            panic!(\"Unsupported order type: {kind}\")\n        }\n    }\n\n    Ok(())\n}\n\nfn print_orders(orders: OrderDataIterator) {\n    for order in orders {\n        println!(\"order: {order:?}\")\n    }\n}\n","traces":[{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":12,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":33},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","place_order.rs"],"content":"use clap::{arg, ArgMatches, Command};\nuse log::{debug, info};\n\nuse ibapi::client::Client;\nuse ibapi::contracts::Contract;\nuse ibapi::orders::{self, order_builder, OrderNotification};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"place_order\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Submits order to broker\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--stock \u003cSYMBOL\u003e).required(true))\n        .arg(arg!(--buy \u003cQUANTITY\u003e).value_parser(clap::value_parser!(i32)))\n        .arg(arg!(--sell \u003cQUANTITY\u003e).value_parser(clap::value_parser!(i32)))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let stock_symbol = matches.get_one::\u003cString\u003e(\"stock\").expect(\"stock symbol is required\");\n\n    if let Some((action, quantity)) = get_order(\u0026matches) {\n        println!(\"action: {action}, quantity: {quantity}\");\n    }\n\n    println!(\"connection_string: {connection_string}, stock_symbol: {stock_symbol}\");\n\n    let mut client = Client::connect(\"odin:4002\")?;\n\n    info!(\"Connected {client:?}\");\n\n    let mut contract = Contract::stock(stock_symbol);\n    contract.currency = \"USD\".to_string();\n    debug!(\"contract template {contract:?}\");\n\n    let order_id = client.next_order_id();\n    println!(\"order_id: {order_id}\");\n    let order = order_builder::market_order(orders::Action::Buy, 100.0);\n\n    println!(\"contract: {contract:?}, order: {order:?}\");\n\n    let results = orders::place_order(\u0026mut client, order_id, \u0026contract, \u0026order)?;\n\n    for status in results {\n        match status {\n            OrderNotification::OrderStatus(order_status) =\u003e {\n                println!(\"order status: {order_status:?}\")\n            }\n            OrderNotification::OpenOrder(open_order) =\u003e println!(\"open order: {open_order:?}\"),\n            OrderNotification::ExecutionData(execution) =\u003e println!(\"execution: {execution:?}\"),\n            OrderNotification::CommissionReport(report) =\u003e println!(\"commision report: {report:?}\"),\n            OrderNotification::Message(message) =\u003e println!(\"notice: {message}\"),\n        }\n    }\n\n    Ok(())\n}\n\nfn get_order(matches: \u0026ArgMatches) -\u003e Option\u003c(String, i32)\u003e {\n    if let Some(quantity) = matches.get_one::\u003ci32\u003e(\"buy\") {\n        Some((\"BUY\".to_string(), *quantity))\n    } else {\n        matches.get_one::\u003ci32\u003e(\"sell\").map(|quantity| (\"SELL\".to_string(), *quantity))\n    }\n}\n","traces":[{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":34},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","stream_bars.rs"],"content":"use std::thread;\nuse std::time::Duration;\n\nuse clap::{arg, ArgMatches, Command};\n\nuse ibapi::client::Client;\nuse ibapi::contracts::Contract;\nuse ibapi::market_data::{realtime, BarSize, WhatToShow};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"stream_bars\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil@wsbsolutions.com\")\n        .about(\"Streams realtime bars\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--stock \u003cSYMBOL\u003e))\n        .arg(arg!(--futures \u003cSYMBOL\u003e))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let contract = extract_contract(\u0026matches).expect(\"error parsing --stock or --future\");\n\n    println!(\"connection_string: {connection_string:?}\");\n    println!(\"contract: {contract:?}\");\n\n    let mut client = Client::connect(\"odin:4002\")?;\n\n    let bars = realtime::realtime_bars(\u0026mut client, \u0026contract, \u0026BarSize::Secs5, \u0026WhatToShow::Trades, false)?;\n\n    for (i, bar) in bars.enumerate() {\n        println!(\"bar: {i:?} {bar:?}\");\n\n        if i \u003e 60 {\n            break;\n        }\n    }\n\n    thread::sleep(Duration::from_secs(5));\n\n    Ok(())\n}\n\nfn extract_contract(matches: \u0026ArgMatches) -\u003e Option\u003cContract\u003e {\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"stock\") {\n        Some(Contract::stock(\u0026symbol.to_uppercase()))\n    } else {\n        matches\n            .get_one::\u003cString\u003e(\"futures\")\n            .map(|symbol| Contract::futures(\u0026symbol.to_uppercase()))\n    }\n}\n","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":22},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","tick_by_tick.rs"],"content":"use std::thread;\nuse std::time::Duration;\n\nuse clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::contracts::Contract;\nuse ibapi::market_data::realtime;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"tick_by_tick\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil@wsbsolutions.com\")\n        .about(\"Streams tick by tick data\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--last \u003cSYMBOL\u003e))\n        .arg(arg!(--all_last \u003cSYMBOL\u003e))\n        .arg(arg!(--bid_ask \u003cSYMBOL\u003e))\n        .arg(arg!(--mid_point \u003cSYMBOL\u003e))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    println!(\"connection_string: {connection_string}\");\n\n    let mut client = Client::connect(\u0026connection_string)?;\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"last\") {\n        stream_last(\u0026mut client, \u0026symbol.to_uppercase())?;\n    }\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"all_last\") {\n        stream_all_last(\u0026mut client, \u0026symbol.to_uppercase())?;\n    }\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"bid_ask\") {\n        stream_bid_ask(\u0026mut client, \u0026symbol.to_uppercase())?;\n    }\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"mid_point\") {\n        stream_mid_point(\u0026mut client, \u0026symbol.to_uppercase())?;\n    }\n\n    thread::sleep(Duration::from_secs(5));\n\n    Ok(())\n}\n\nfn stream_last(client: \u0026mut Client, symbol: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n    let contract = contract_es();\n    let ticks = realtime::tick_by_tick_last(client, \u0026contract, 0, false)?;\n\n    for (i, tick) in ticks.enumerate().take(60) {\n        println!(\"tick: {i:?} {tick:?}\");\n    }\n\n    Ok(())\n}\n\nfn contract_es() -\u003e Contract {\n    let mut contract = Contract::futures(\"ES\");\n    contract.exchange = \"CME\".to_owned();\n    contract.contract_id = 495512569;\n    contract\n}\n\nfn contract_gc() -\u003e Contract {\n    let mut contract = Contract::futures(\"GC\");\n    contract.exchange = \"COMEX\".to_owned();\n    contract.contract_id = 605552438;\n    contract\n}\n\nfn contract_zn() -\u003e Contract {\n    let mut contract = Contract::futures(\"ZN\");\n    contract.exchange = \"CBOT\".to_owned();\n    contract.contract_id = 568735904;\n    contract\n}\n\nfn stream_all_last(client: \u0026mut Client, symbol: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n    let contract = contract_es();\n    let ticks = realtime::tick_by_tick_all_last(client, \u0026contract, 0, false)?;\n\n    for (i, tick) in ticks.enumerate().take(60) {\n        println!(\"tick: {i:?} {tick:?}\");\n    }\n\n    Ok(())\n}\n\nfn stream_bid_ask(client: \u0026mut Client, symbol: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n    let contract = contract_es();\n    let ticks = realtime::tick_by_tick_bid_ask(client, \u0026contract, 0, false)?;\n\n    for (i, tick) in ticks.enumerate().take(60) {\n        println!(\"tick: {i:?} {tick:?}\");\n    }\n\n    Ok(())\n}\n\nfn stream_mid_point(client: \u0026mut Client, symbol: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n    let contract = contract_es();\n    let ticks = realtime::tick_by_tick_midpoint(client, \u0026contract, 0, false)?;\n\n    for (i, tick) in ticks.enumerate().take(60) {\n        println!(\"tick: {i:?} {tick:?}\");\n    }\n\n    Ok(())\n}\n","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":60},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","tests.rs"],"content":"use crate::contracts::{ComboLegOpenClose, SecurityType};\nuse crate::orders::{Action, OrderCondition, OrderOpenClose, Rule80A};\n\nuse super::*;\n\n#[test]\nfn request_packet_from_fields() {\n    // let mut packet = RequestPacket::default();\n    // packet.add_field(32);\n\n    let packet = || -\u003e RequestMessage {\n        let mut packet = RequestMessage::default();\n        packet.push_field(\u002632);\n        packet\n    }();\n\n    let result = 2 + 2;\n    assert_eq!(result, 4);\n}\n\n#[test]\nfn message_encodes_bool() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026false);\n    message.push_field(\u0026true);\n\n    assert_eq!(2, message.fields.len());\n    assert_eq!(\"0\\01\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_i32() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u00261);\n    message.push_field(\u0026Some(2));\n    message.push_field(\u0026Option::\u003ci32\u003e::None);\n\n    assert_eq!(3, message.fields.len());\n    assert_eq!(\"1\\02\\0\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_f64() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u00262.0);\n    message.push_field(\u0026Some(3.0));\n    message.push_field(\u0026Option::\u003cf64\u003e::None);\n\n    assert_eq!(3, message.fields.len());\n    // assert_eq!(\"2.0\\03.0\\0\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_string() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026\"interactive\");\n    message.push_field(\u0026\"brokers\");\n\n    assert_eq!(2, message.fields.len());\n    assert_eq!(\"interactive\\0brokers\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_rule_80_a() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026Some(Rule80A::Individual));\n    message.push_field(\u0026Some(Rule80A::Agency));\n    message.push_field(\u0026Some(Rule80A::AgentOtherMember));\n    message.push_field(\u0026Some(Rule80A::IndividualPTIA));\n    message.push_field(\u0026Some(Rule80A::AgencyPTIA));\n    message.push_field(\u0026Some(Rule80A::AgentOtherMemberPTIA));\n    message.push_field(\u0026Some(Rule80A::IndividualPT));\n    message.push_field(\u0026Some(Rule80A::AgencyPT));\n    message.push_field(\u0026Some(Rule80A::AgentOtherMemberPT));\n    message.push_field(\u0026Option::\u003cRule80A\u003e::None);\n\n    assert_eq!(10, message.fields.len());\n    assert_eq!(\"I\\0A\\0W\\0J\\0U\\0M\\0K\\0Y\\0N\\0\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_order_condition() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026OrderCondition::Price);\n    message.push_field(\u0026OrderCondition::Time);\n    message.push_field(\u0026OrderCondition::Margin);\n    message.push_field(\u0026OrderCondition::Execution);\n    message.push_field(\u0026OrderCondition::Volume);\n    message.push_field(\u0026OrderCondition::PercentChange);\n\n    assert_eq!(6, message.fields.len());\n    assert_eq!(\"1\\03\\04\\05\\06\\07\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_action() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026Action::Buy);\n    message.push_field(\u0026Action::Sell);\n    message.push_field(\u0026Action::SellShort);\n    message.push_field(\u0026Action::SellLong);\n\n    assert_eq!(4, message.fields.len());\n    assert_eq!(\"BUY\\0SELL\\0SSHORT\\0SLONG\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_security_type() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026SecurityType::Stock);\n    message.push_field(\u0026SecurityType::Option);\n    message.push_field(\u0026SecurityType::Future);\n    message.push_field(\u0026SecurityType::Index);\n    message.push_field(\u0026SecurityType::FuturesOption);\n    message.push_field(\u0026SecurityType::ForexPair);\n    message.push_field(\u0026SecurityType::Spread);\n    message.push_field(\u0026SecurityType::Warrant);\n    message.push_field(\u0026SecurityType::Bond);\n    message.push_field(\u0026SecurityType::Commodity);\n    message.push_field(\u0026SecurityType::News);\n    message.push_field(\u0026SecurityType::MutualFund);\n\n    assert_eq!(12, message.fields.len());\n    assert_eq!(\"STK\\0OPT\\0FUT\\0IND\\0FOP\\0CASH\\0BAG\\0WAR\\0BOND\\0CMDTY\\0NEWS\\0FUND\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_outgoing_message() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026OutgoingMessages::RequestMarketData);\n    message.push_field(\u0026OutgoingMessages::CancelMarketData);\n    message.push_field(\u0026OutgoingMessages::PlaceOrder);\n    message.push_field(\u0026OutgoingMessages::ReqUserInfo);\n\n    assert_eq!(4, message.fields.len());\n    assert_eq!(\"1\\02\\03\\0104\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_order_open_close() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026Option::\u003cOrderOpenClose\u003e::None);\n    message.push_field(\u0026OrderOpenClose::Open);\n    message.push_field(\u0026OrderOpenClose::Close);\n\n    assert_eq!(3, message.fields.len());\n    assert_eq!(\"\\0O\\0C\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_combo_leg_open_close() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026ComboLegOpenClose::Same);\n    message.push_field(\u0026ComboLegOpenClose::Open);\n    message.push_field(\u0026ComboLegOpenClose::Close);\n    message.push_field(\u0026ComboLegOpenClose::Unknown);\n\n    assert_eq!(4, message.fields.len());\n    assert_eq!(\"0\\01\\02\\03\\0\", message.encode());\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","transport","recorder","tests.rs"],"content":"use super::*;\nuse std::env;\n\n#[test]\nfn env_var_enables_recorder() {\n    let key = String::from(\"IBAPI_RECORDING_DIR\");\n    let dir = String::from(\"/tmp/records\");\n\n    env::set_var(\u0026key, \u0026dir);\n\n    let recorder = MessageRecorder::new();\n\n    assert_eq!(true, recorder.enabled);\n    assert!(\u0026recorder.recording_dir.starts_with(\u0026dir), \"{} != {}\", \u0026recorder.recording_dir, \u0026dir)\n}\n\n#[test]\nfn recorder_is_disabled() {\n    let key = String::from(\"IBAPI_RECORDING_DIR\");\n\n    env::set_var(\u0026key, \u0026\"\");\n\n    let recorder = MessageRecorder::new();\n\n    assert_eq!(false, recorder.enabled);\n    assert_eq!(\"\", \u0026recorder.recording_dir);\n}\n\n#[test]\nfn recorder_generates_output_file() {\n    let recording_dir = String::from(\"/tmp/records\");\n\n    let recorder = MessageRecorder {\n        enabled: true,\n        recording_dir: recording_dir,\n    };\n\n    assert_eq!(format!(\"{}/0001-request.msg\", recorder.recording_dir), recorder.request_file(1));\n    assert_eq!(format!(\"{}/0002-response.msg\", recorder.recording_dir), recorder.response_file(2));\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","transport","recorder.rs"],"content":"use std::env;\nuse std::fs;\nuse std::sync::atomic::{AtomicUsize, Ordering};\n\nuse time::macros::format_description;\nuse time::OffsetDateTime;\n\nuse super::{RequestMessage, ResponseMessage};\n\nstatic RECORDING_SEQ: AtomicUsize = AtomicUsize::new(0);\n\n#[derive(Clone, Debug)]\npub(crate) struct MessageRecorder {\n    enabled: bool,\n    recording_dir: String,\n}\n\nimpl MessageRecorder {\n    pub fn new() -\u003e Self {\n        match env::var(\"IBAPI_RECORDING_DIR\") {\n            Ok(dir) =\u003e {\n                if dir.is_empty() {\n                    MessageRecorder {\n                        enabled: false,\n                        recording_dir: String::from(\"\"),\n                    }\n                } else {\n                    let format = format_description!(\"[year]-[month]-[day]-[hour]-[minute]\");\n                    let now = OffsetDateTime::now_utc();\n                    let recording_dir = format!(\"{}/{}\", dir, now.format(\u0026format).unwrap());\n\n                    fs::create_dir_all(\u0026recording_dir).unwrap();\n\n                    MessageRecorder {\n                        enabled: true,\n                        recording_dir,\n                    }\n                }\n            }\n            _ =\u003e MessageRecorder {\n                enabled: false,\n                recording_dir: String::from(\"\"),\n            },\n        }\n    }\n\n    pub fn record_request(\u0026self, message: \u0026RequestMessage) {\n        if !self.enabled {\n            return;\n        }\n\n        let record_id = RECORDING_SEQ.fetch_add(1, Ordering::SeqCst);\n        fs::write(self.request_file(record_id), message.encode().replace('\\0', \"|\")).unwrap();\n    }\n\n    pub fn record_response(\u0026self, message: \u0026ResponseMessage) {\n        if !self.enabled {\n            return;\n        }\n\n        let record_id = RECORDING_SEQ.fetch_add(1, Ordering::SeqCst);\n        fs::write(self.response_file(record_id), message.encode().replace('\\0', \"|\")).unwrap();\n    }\n\n    fn request_file(\u0026self, record_id: usize) -\u003e String {\n        format!(\"{}/{:04}-request.msg\", self.recording_dir, record_id)\n    }\n\n    fn response_file(\u0026self, record_id: usize) -\u003e String {\n        format!(\"{}/{:04}-response.msg\", self.recording_dir, record_id)\n    }\n}\n","traces":[{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":24},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","transport","tests.rs"],"content":"\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","transport.rs"],"content":"use std::collections::HashMap;\nuse std::io::{prelude::*, Cursor};\nuse std::iter::Iterator;\nuse std::net::TcpStream;\nuse std::sync::{Arc, RwLock};\nuse std::thread::{self, JoinHandle};\nuse std::time::Duration;\n\nuse anyhow::Result;\nuse byteorder::{BigEndian, ReadBytesExt, WriteBytesExt};\nuse crossbeam::channel::{self, Receiver, Sender};\nuse log::{debug, error, info};\n\nuse crate::client::{RequestMessage, ResponseMessage};\nuse crate::messages::IncomingMessages;\nuse crate::server_versions;\nuse recorder::MessageRecorder;\n\nmod recorder;\n\npub trait MessageBus {\n    fn read_message(\u0026mut self) -\u003e Result\u003cResponseMessage\u003e;\n\n    fn write_message(\u0026mut self, packet: \u0026RequestMessage) -\u003e Result\u003c()\u003e;\n\n    fn send_generic_message(\u0026mut self, request_id: i32, packet: \u0026RequestMessage) -\u003e Result\u003cResponseIterator\u003e;\n    fn send_order_message(\u0026mut self, request_id: i32, packet: \u0026RequestMessage) -\u003e Result\u003cResponseIterator\u003e;\n    fn request_next_order_id(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e;\n    fn request_open_orders(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e;\n    fn request_market_rule(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e;\n\n    fn write(\u0026mut self, packet: \u0026str) -\u003e Result\u003c()\u003e;\n\n    fn process_messages(\u0026mut self, server_version: i32) -\u003e Result\u003c()\u003e;\n\n    fn request_messages(\u0026self) -\u003e Vec\u003cRequestMessage\u003e {\n        vec![]\n    }\n}\n\n#[derive(Debug)]\npub struct TcpMessageBus {\n    reader: Arc\u003cTcpStream\u003e,\n    writer: Box\u003cTcpStream\u003e,\n    handles: Vec\u003cJoinHandle\u003ci32\u003e\u003e,\n    requests: Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    orders: Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    recorder: MessageRecorder,\n    globals: Arc\u003cGlobalChannels\u003e,\n    signals_send: Sender\u003cSignal\u003e,\n    signals_recv: Receiver\u003cSignal\u003e,\n}\n\npub enum Signal {\n    Request(i32),\n    Order(i32),\n}\n\n#[derive(Debug)]\nstruct GlobalChannels {\n    order_ids_in: Arc\u003cSender\u003cResponseMessage\u003e\u003e,\n    order_ids_out: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e,\n    open_orders_in: Arc\u003cSender\u003cResponseMessage\u003e\u003e,\n    open_orders_out: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e,\n    send_market_rule: Arc\u003cSender\u003cResponseMessage\u003e\u003e,\n    recv_market_rule: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e,\n}\n\nimpl GlobalChannels {\n    pub fn new() -\u003e Self {\n        let (order_ids_in, order_ids_out) = channel::unbounded();\n        let (open_orders_in, open_orders_out) = channel::unbounded();\n        let (send_market_rule, recv_market_rule) = channel::unbounded();\n\n        GlobalChannels {\n            order_ids_in: Arc::new(order_ids_in),\n            order_ids_out: Arc::new(order_ids_out),\n            open_orders_in: Arc::new(open_orders_in),\n            open_orders_out: Arc::new(open_orders_out),\n            send_market_rule: Arc::new(send_market_rule),\n            recv_market_rule: Arc::new(recv_market_rule),\n        }\n    }\n}\n\nimpl TcpMessageBus {\n    // establishes TCP connection to server\n    pub fn connect(connection_string: \u0026str) -\u003e Result\u003cTcpMessageBus\u003e {\n        let stream = TcpStream::connect(connection_string)?;\n\n        let reader = Arc::new(stream.try_clone()?);\n        let writer = Box::new(stream);\n        let requests = Arc::new(SenderHash::new());\n        let orders = Arc::new(SenderHash::new());\n\n        let (signals_send, signals_recv) = channel::unbounded();\n\n        Ok(TcpMessageBus {\n            reader,\n            writer,\n            handles: Vec::default(),\n            requests,\n            orders,\n            recorder: MessageRecorder::new(),\n            globals: Arc::new(GlobalChannels::new()),\n            signals_send,\n            signals_recv,\n        })\n    }\n\n    fn add_request(\u0026mut self, request_id: i32, sender: Sender\u003cResponseMessage\u003e) -\u003e Result\u003c()\u003e {\n        self.requests.insert(request_id, sender);\n        Ok(())\n    }\n\n    fn add_order(\u0026mut self, order_id: i32, sender: Sender\u003cResponseMessage\u003e) -\u003e Result\u003c()\u003e {\n        self.orders.insert(order_id, sender);\n        Ok(())\n    }\n}\n\nconst UNSPECIFIED_REQUEST_ID: i32 = -1;\n\nimpl MessageBus for TcpMessageBus {\n    fn read_message(\u0026mut self) -\u003e Result\u003cResponseMessage\u003e {\n        read_packet(\u0026self.reader)\n    }\n\n    fn send_generic_message(\u0026mut self, request_id: i32, packet: \u0026RequestMessage) -\u003e Result\u003cResponseIterator\u003e {\n        let (sender, receiver) = channel::unbounded();\n\n        self.add_request(request_id, sender)?;\n        self.write_message(packet)?;\n\n        Ok(ResponseIterator::new(\n            receiver,\n            self.signals_send.clone(),\n            Some(request_id),\n            None,\n            Duration::from_secs(10),\n        ))\n    }\n\n    fn send_order_message(\u0026mut self, order_id: i32, message: \u0026RequestMessage) -\u003e Result\u003cResponseIterator\u003e {\n        let (sender, receiver) = channel::unbounded();\n\n        self.add_order(order_id, sender)?;\n        self.write_message(message)?;\n\n        Ok(ResponseIterator::new(\n            receiver,\n            self.signals_send.clone(),\n            None,\n            Some(order_id),\n            Duration::from_secs(10),\n        ))\n    }\n\n    fn request_next_order_id(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.write_message(message)?;\n        Ok(GlobalResponseIterator::new(Arc::clone(\u0026self.globals.order_ids_out)))\n    }\n\n    fn request_open_orders(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.write_message(message)?;\n        Ok(GlobalResponseIterator::new(Arc::clone(\u0026self.globals.open_orders_out)))\n    }\n\n    fn request_market_rule(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.write_message(message)?;\n        Ok(GlobalResponseIterator::new(Arc::clone(\u0026self.globals.recv_market_rule)))\n    }\n\n    fn write_message(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003c()\u003e {\n        let encoded = message.encode();\n        debug!(\"{encoded:?} -\u003e\");\n\n        let data = encoded.as_bytes();\n        let mut header = Vec::with_capacity(data.len());\n        header.write_u32::\u003cBigEndian\u003e(data.len() as u32)?;\n\n        self.writer.write_all(\u0026header)?;\n        self.writer.write_all(data)?;\n\n        self.recorder.record_request(message);\n\n        Ok(())\n    }\n\n    fn write(\u0026mut self, data: \u0026str) -\u003e Result\u003c()\u003e {\n        debug!(\"{data:?} -\u003e\");\n        self.writer.write_all(data.as_bytes())?;\n        Ok(())\n    }\n\n    fn process_messages(\u0026mut self, server_version: i32) -\u003e Result\u003c()\u003e {\n        let reader = Arc::clone(\u0026self.reader);\n        let requests = Arc::clone(\u0026self.requests);\n        let recorder = self.recorder.clone();\n        let orders = Arc::clone(\u0026self.orders);\n        let globals = Arc::clone(\u0026self.globals);\n        let executions = SenderHash::\u003cString, ResponseMessage\u003e::new();\n\n        let handle = thread::spawn(move || loop {\n            match read_packet(\u0026reader) {\n                Ok(message) =\u003e {\n                    recorder.record_response(\u0026message);\n                    dispatch_message(message, server_version, \u0026requests, \u0026orders, \u0026globals, \u0026executions);\n                }\n                Err(err) =\u003e {\n                    error!(\"error reading packet: {:?}\", err);\n                    continue;\n                }\n            };\n\n            // FIXME - does read block?\n            // thread::sleep(Duration::from_secs(1));\n        });\n\n        self.handles.push(handle);\n\n        let requests = Arc::clone(\u0026self.requests);\n        let orders = Arc::clone(\u0026self.orders);\n        let signal_recv = self.signals_recv.clone();\n\n        let handle = thread::spawn(move || loop {\n            for signal in \u0026signal_recv {\n                match signal {\n                    Signal::Request(request_id) =\u003e {\n                        requests.remove(\u0026request_id);\n                        debug!(\"released request_id {}, requests.len()={}\", request_id, requests.len());\n                    }\n                    Signal::Order(order_id) =\u003e {\n                        orders.remove(\u0026order_id);\n                        debug!(\"released order_id {}, orders.len()={}\", order_id, requests.len());\n                    }\n                }\n            }\n        });\n\n        self.handles.push(handle);\n\n        Ok(())\n    }\n}\n\nfn dispatch_message(\n    message: ResponseMessage,\n    server_version: i32,\n    requests: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    orders: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    globals: \u0026Arc\u003cGlobalChannels\u003e,\n    executions: \u0026SenderHash\u003cString, ResponseMessage\u003e,\n) {\n    match message.message_type() {\n        IncomingMessages::Error =\u003e {\n            let request_id = message.peek_int(2).unwrap_or(-1);\n\n            if request_id == UNSPECIFIED_REQUEST_ID {\n                error_event(server_version, message).unwrap();\n            } else {\n                process_response(requests, orders, message);\n            }\n        }\n        IncomingMessages::NextValidId =\u003e {\n            globals.order_ids_in.send(message).unwrap();\n        }\n        IncomingMessages::MarketRule =\u003e {\n            globals.send_market_rule.send(message).unwrap();\n        }\n        IncomingMessages::ManagedAccounts =\u003e process_managed_accounts(server_version, message),\n        IncomingMessages::OrderStatus\n        | IncomingMessages::OpenOrder\n        | IncomingMessages::OpenOrderEnd\n        | IncomingMessages::CompletedOrder\n        | IncomingMessages::CompletedOrdersEnd\n        | IncomingMessages::ExecutionData\n        | IncomingMessages::ExecutionDataEnd\n        | IncomingMessages::CommissionsReport =\u003e process_orders(message, requests, orders, executions, globals),\n        _ =\u003e process_response(requests, orders, message),\n    };\n}\n\nfn read_packet(mut reader: \u0026TcpStream) -\u003e Result\u003cResponseMessage\u003e {\n    let message_size = read_header(reader)?;\n    debug!(\"message size: {message_size}\");\n    let mut data = vec![0_u8; message_size];\n\n    reader.read_exact(\u0026mut data)?;\n\n    let packet = ResponseMessage::from(\u0026String::from_utf8(data)?);\n    debug!(\"raw string: {:?}\", packet);\n\n    Ok(packet)\n}\n\nfn read_header(mut reader: \u0026TcpStream) -\u003e Result\u003cusize\u003e {\n    let buffer = \u0026mut [0_u8; 4];\n    reader.read_exact(buffer)?;\n\n    let mut reader = Cursor::new(buffer);\n    let count = reader.read_u32::\u003cBigEndian\u003e()?;\n\n    Ok(count as usize)\n}\n\nfn error_event(server_version: i32, mut packet: ResponseMessage) -\u003e Result\u003c()\u003e {\n    packet.skip(); // message_id\n\n    let version = packet.next_int()?;\n\n    if version \u003c 2 {\n        let message = packet.next_string()?;\n        error!(\"version 2 erorr: {}\", message);\n        Ok(())\n    } else {\n        let request_id = packet.next_int()?;\n        let error_code = packet.next_int()?;\n        let error_message = packet.next_string()?;\n\n        // if 322 forward to market_rule_id\n\n        let mut advanced_order_reject_json: String = \"\".to_string();\n        if server_version \u003e= server_versions::ADVANCED_ORDER_REJECT {\n            advanced_order_reject_json = packet.next_string()?;\n        }\n        debug!(\n            \"request_id: {}, error_code: {}, error_message: {}, advanced_order_reject_json: {}\",\n            request_id, error_code, error_message, advanced_order_reject_json\n        );\n        println!(\"[{error_code}] {error_message}\");\n        Ok(())\n    }\n}\n\nfn process_managed_accounts(_server_version: i32, mut packet: ResponseMessage) {\n    packet.skip(); // message_id\n    packet.skip(); // version\n\n    let managed_accounts = packet.next_string().unwrap_or_else(|_| String::default());\n    info!(\"managed accounts: {}\", managed_accounts)\n}\n\nfn process_response(requests: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e, orders: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e, message: ResponseMessage) {\n    let request_id = message.request_id().unwrap_or(-1); // pass in request id?\n    if requests.contains(\u0026request_id) {\n        requests.send(\u0026request_id, message).unwrap();\n    } else if orders.contains(\u0026request_id) {\n        orders.send(\u0026request_id, message).unwrap();\n    }\n}\n\nfn process_orders(\n    message: ResponseMessage,\n    requests: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    orders: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    executions: \u0026SenderHash\u003cString, ResponseMessage\u003e,\n    globals: \u0026Arc\u003cGlobalChannels\u003e,\n) {\n    match message.message_type() {\n        IncomingMessages::ExecutionData =\u003e {\n            match (message.order_id(), message.request_id()) {\n                // First check matching orders channel\n                (Some(order_id), _) if orders.contains(\u0026order_id) =\u003e {\n                    if let Err(e) = orders.send(\u0026order_id, message) {\n                        error!(\"error routing message for order_id({order_id}): {e}\");\n                    }\n                }\n                (_, Some(request_id)) if requests.contains(\u0026request_id) =\u003e {\n                    if let Some(sender) = requests.copy_sender(request_id) {\n                        if let Some(execution_id) = message.execution_id() {\n                            executions.insert(execution_id, sender);\n                        }\n                    }\n\n                    if let Err(e) = requests.send(\u0026request_id, message) {\n                        error!(\"error routing message for request_id({request_id}): {e}\");\n                    }\n                }\n                _ =\u003e {\n                    error!(\"could not route message {message:?}\");\n                }\n            }\n        }\n        IncomingMessages::ExecutionDataEnd =\u003e {\n            match (message.order_id(), message.request_id()) {\n                // First check matching orders channel\n                (Some(order_id), _) if orders.contains(\u0026order_id) =\u003e {\n                    if let Err(e) = orders.send(\u0026order_id, message) {\n                        error!(\"error routing message for order_id({order_id}): {e}\");\n                    }\n                }\n                (_, Some(request_id)) if requests.contains(\u0026request_id) =\u003e {\n                    if let Err(e) = requests.send(\u0026request_id, message) {\n                        error!(\"error routing message for request_id({request_id}): {e}\");\n                    }\n                }\n                _ =\u003e {\n                    error!(\"could not route message {message:?}\");\n                }\n            }\n        }\n        IncomingMessages::OpenOrder | IncomingMessages::OrderStatus =\u003e {\n            if let Some(order_id) = message.order_id() {\n                if orders.contains(\u0026order_id) {\n                    if let Err(e) = orders.send(\u0026order_id, message) {\n                        error!(\"error routing message for order_id({order_id}): {e}\");\n                    }\n                } else {\n                    if let Err(e) = globals.open_orders_in.send(message) {\n                        error!(\"error sending IncomingMessages::OpenOrder: {e}\");\n                    }\n                }\n            }\n        }\n        IncomingMessages::CompletedOrder =\u003e {\n            if let Err(e) = globals.open_orders_in.send(message) {\n                error!(\"error sending IncomingMessages::CompletedOrder: {e}\");\n            }\n        }\n        IncomingMessages::OpenOrderEnd =\u003e {\n            if let Err(e) = globals.open_orders_in.send(message) {\n                error!(\"error sending IncomingMessages::OpenOrderEnd: {e}\");\n            }\n        }\n        IncomingMessages::CompletedOrdersEnd =\u003e {\n            if let Err(e) = globals.open_orders_in.send(message) {\n                error!(\"error sending IncomingMessages::CompletedOrdersEnd: {e}\");\n            }\n        }\n        IncomingMessages::CommissionsReport =\u003e {\n            if let Some(execution_id) = message.execution_id() {\n                if let Err(e) = executions.send(\u0026execution_id, message) {\n                    error!(\"error sending commision report for execution {}: {}\", execution_id, e);\n                }\n            }\n        }\n        _ =\u003e (),\n    }\n}\n\n#[derive(Debug)]\nstruct SenderHash\u003cK, V\u003e {\n    data: RwLock\u003cHashMap\u003cK, Sender\u003cV\u003e\u003e\u003e,\n}\n\nimpl\u003cK: std::hash::Hash + Eq + std::fmt::Debug, V: std::fmt::Debug\u003e SenderHash\u003cK, V\u003e {\n    pub fn new() -\u003e Self {\n        Self {\n            data: RwLock::new(HashMap::new()),\n        }\n    }\n\n    pub fn send(\u0026self, id: \u0026K, message: V) -\u003e Result\u003c()\u003e {\n        let senders = self.data.read().unwrap();\n        debug!(\"senders: {senders:?}\");\n        if let Some(sender) = senders.get(id) {\n            if let Err(err) = sender.send(message) {\n                error!(\"error sending: {id:?}, {err}\")\n            }\n        } else {\n            error!(\"no recipient found for: {id:?}, {message:?}\")\n        }\n        Ok(())\n    }\n\n    pub fn copy_sender(\u0026self, id: K) -\u003e Option\u003cSender\u003cV\u003e\u003e {\n        let senders = self.data.read().unwrap();\n        senders.get(\u0026id).cloned()\n    }\n\n    pub fn insert(\u0026self, id: K, message: Sender\u003cV\u003e) -\u003e Option\u003cSender\u003cV\u003e\u003e {\n        let mut senders = self.data.write().unwrap();\n        senders.insert(id, message)\n    }\n\n    pub fn remove(\u0026self, id: \u0026K) -\u003e Option\u003cSender\u003cV\u003e\u003e {\n        let mut senders = self.data.write().unwrap();\n        senders.remove(id)\n    }\n\n    pub fn contains(\u0026self, id: \u0026K) -\u003e bool {\n        let senders = self.data.read().unwrap();\n        senders.contains_key(id)\n    }\n\n    pub fn len(\u0026self) -\u003e usize {\n        let senders = self.data.read().unwrap();\n        senders.len()\n    }\n}\n\n#[derive(Debug)]\npub struct ResponseIterator {\n    messages: Receiver\u003cResponseMessage\u003e, // for client to receive incoming messages\n    signals: Sender\u003cSignal\u003e,             // for client to signal termination\n    request_id: Option\u003ci32\u003e,             // initiating request_id\n    order_id: Option\u003ci32\u003e,               // initiating order_id\n    timeout: Duration,                   // How long to wait for next message\n}\n\nimpl ResponseIterator {\n    pub fn new(\n        messages: Receiver\u003cResponseMessage\u003e,\n        signals: Sender\u003cSignal\u003e,\n        request_id: Option\u003ci32\u003e,\n        order_id: Option\u003ci32\u003e,\n        timeout: Duration,\n    ) -\u003e Self {\n        ResponseIterator {\n            messages,\n            signals,\n            request_id,\n            order_id,\n            timeout,\n        }\n    }\n}\n\nimpl Drop for ResponseIterator {\n    fn drop(\u0026mut self) {\n        if let Some(request_id) = self.request_id {\n            self.signals.send(Signal::Request(request_id)).unwrap();\n        }\n\n        if let Some(order_id) = self.order_id {\n            self.signals.send(Signal::Order(order_id)).unwrap();\n        }\n    }\n}\n\nimpl Iterator for ResponseIterator {\n    type Item = ResponseMessage;\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        match self.messages.recv_timeout(self.timeout) {\n            Err(err) =\u003e {\n                info!(\"timeout receiving packet: {err}\");\n                None\n            }\n            Ok(message) =\u003e Some(message),\n        }\n    }\n}\n\n#[derive(Debug)]\npub struct GlobalResponseIterator {\n    messages: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e,\n}\n\nimpl GlobalResponseIterator {\n    pub fn new(messages: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e) -\u003e Self {\n        Self { messages }\n    }\n}\n\nimpl Iterator for GlobalResponseIterator {\n    type Item = ResponseMessage;\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        match self.messages.recv_timeout(Duration::from_secs(5)) {\n            Err(err) =\u003e {\n                info!(\"timeout receiving packet: {err}\");\n                None\n            }\n            Ok(message) =\u003e Some(message),\n        }\n    }\n}\n\n#[cfg(test)]\nmod tests;\n","traces":[{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":190,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":193,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":206,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":207,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":208,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":210,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":211,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":212,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":220,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":224,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":227,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":228,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":229,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":230,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":233,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":235,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":255,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":262,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":265,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":266,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":268,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":269,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":271,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":279,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":280,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":284,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":287,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":291,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":297,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":301,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":302,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":304,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":307,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":312,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":315,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":317,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":325,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":336,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":338,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":341,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":344,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":345,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":347,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":348,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":349,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":353,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":360,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":362,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":365,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":366,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":369,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":370,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":371,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":372,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":376,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":381,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":388,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":389,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":390,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":393,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":404,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":405,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":406,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":407,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":411,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":417,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":418,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":422,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":423,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":427,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":428,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":432,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":433,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":438,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":454,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":455,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":457,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":458,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":459,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":462,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":464,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":467,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":469,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":472,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":473,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":474,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":477,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":478,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":479,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":482,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":487,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":489,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":522,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":523,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":526,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":527,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":534,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":535,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":536,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":537,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":538,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":540,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":551,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":558,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":559,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":560,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":561,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":562,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":564,"address":[],"length":0,"stats":{"Line":2},"fn_name":null}],"covered":10,"coverable":241},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client.rs"],"content":"use std::fmt;\nuse std::ops::Index;\nuse std::str::FromStr;\n\nuse anyhow::{anyhow, Result};\nuse log::{debug, error, info};\nuse time::OffsetDateTime;\n\nuse self::transport::{GlobalResponseIterator, MessageBus, ResponseIterator, TcpMessageBus};\nuse crate::messages::{order_id_index, request_id_index, IncomingMessages, OutgoingMessages};\nuse crate::{server_versions, ToField};\n\npub(crate) mod transport;\n\nconst MIN_SERVER_VERSION: i32 = 100;\nconst MAX_SERVER_VERSION: i32 = server_versions::HISTORICAL_SCHEDULE;\nconst INFINITY_STR: \u0026str = \"Infinity\";\nconst UNSET_DOUBLE: \u0026str = \"1.7976931348623157E308\";\nconst UNSET_INTEGER: \u0026str = \"2147483647\";\nconst UNSET_LONG: \u0026str = \"9223372036854775807\";\n\npub struct Client {\n    /// IB server version\n    pub server_version: i32,\n    /// IB Server time\n    //    pub server_time: OffsetDateTime,\n    pub server_time: String,\n    // Next valid order id\n    pub next_valid_order_id: i32,\n\n    managed_accounts: String,\n    client_id: i32, // ID of client.\n    pub(crate) message_bus: Box\u003cdyn MessageBus\u003e,\n    next_request_id: i32, // Next available request_id.\n    order_id: i32,        // Next available order_id. Starts with value returned on connection.\n}\n\nimpl Client {\n    /// Establishes connection to TWS or Gateway\n    ///\n    /// Connects to server using the given connection string\n    ///\n    /// # Arguments\n    /// * `connection_string` - connection string in the following format [host]:[port]:[client_id].\n    ///                         client id is optional and defaults to 100.\n    ///\n    /// # Examples\n    ///\n    /// ```no_run\n    /// use ibapi::client::{Client};\n    ///\n    /// fn main() -\u003e anyhow::Result\u003c()\u003e {\n    ///     let mut client = Client::connect(\"localhost:4002\")?;\n    ///\n    ///     println!(\"server_version: {}\", client.server_version());\n    ///     println!(\"server_time: {}\", client.server_time());\n    ///     println!(\"managed_accounts: {}\", client.managed_accounts());\n    ///     println!(\"next_order_id: {}\", client.next_order_id());\n    ///\n    ///     Ok(())\n    /// }\n    /// ```\n    pub fn connect(connection_string: \u0026str) -\u003e Result\u003cClient\u003e {\n        debug!(\"connecting to server with #{:?}\", connection_string);\n\n        let message_bus = Box::new(TcpMessageBus::connect(connection_string)?);\n        Client::do_connect(message_bus)\n    }\n\n    fn do_connect(message_bus: Box\u003cdyn MessageBus\u003e) -\u003e Result\u003cClient\u003e {\n        let mut client = Client {\n            server_version: 0,\n            server_time: String::from(\"\"),\n            next_valid_order_id: 0,\n            managed_accounts: String::from(\"\"),\n            message_bus,\n            client_id: 100,\n            next_request_id: 9000,\n            order_id: -1,\n        };\n\n        client.handshake()?;\n        client.start_api()?;\n        client.receive_account_info()?;\n\n        client.message_bus.process_messages(client.server_version)?;\n\n        Ok(client)\n    }\n\n    #[cfg(test)]\n    pub(crate) fn stubbed(message_bus: Box\u003cdyn MessageBus\u003e, server_version: i32) -\u003e Client {\n        Client {\n            server_version: server_version,\n            server_time: String::from(\"\"),\n            next_valid_order_id: 0,\n            managed_accounts: String::from(\"\"),\n            message_bus,\n            client_id: 100,\n            next_request_id: 9000,\n            order_id: -1,\n        }\n    }\n\n    // sends server handshake\n    fn handshake(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.message_bus.write(\"API\\x00\")?;\n\n        let prelude = \u0026mut RequestMessage::new();\n        prelude.push_field(\u0026format!(\"v{MIN_SERVER_VERSION}..{MAX_SERVER_VERSION}\"));\n\n        self.message_bus.write_message(prelude)?;\n\n        let mut status = self.message_bus.read_message()?;\n\n        self.server_version = status.next_int()?;\n        self.server_time = status.next_string()?;\n\n        Ok(())\n    }\n\n    // asks server to start processing messages\n    fn start_api(\u0026mut self) -\u003e Result\u003c()\u003e {\n        const VERSION: i32 = 2;\n\n        let prelude = \u0026mut RequestMessage::default();\n\n        prelude.push_field(\u0026OutgoingMessages::StartApi);\n        prelude.push_field(\u0026VERSION);\n        prelude.push_field(\u0026self.client_id);\n\n        if self.server_version \u003e server_versions::OPTIONAL_CAPABILITIES {\n            prelude.push_field(\u0026\"\");\n        }\n\n        self.message_bus.write_message(prelude)?;\n\n        Ok(())\n    }\n\n    // Fetches next order id and managed accounts.\n    fn receive_account_info(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let mut saw_next_order_id: bool = false;\n        let mut saw_managed_accounts: bool = false;\n\n        let mut attempts = 0;\n        const MAX_ATTEMPTS: i32 = 100;\n        loop {\n            let mut message = self.message_bus.read_message()?;\n\n            match message.message_type() {\n                IncomingMessages::NextValidId =\u003e {\n                    saw_next_order_id = true;\n\n                    message.skip(); // message type\n                    message.skip(); // message version\n\n                    self.order_id = message.next_int()?;\n                }\n                IncomingMessages::ManagedAccounts =\u003e {\n                    saw_managed_accounts = true;\n\n                    message.skip(); // message type\n                    message.skip(); // message version\n\n                    self.managed_accounts = message.next_string()?;\n                }\n                IncomingMessages::Error =\u003e {\n                    error!(\"message: {message:?}\")\n                }\n                _ =\u003e info!(\"message: {message:?}\"),\n            }\n\n            attempts += 1;\n            if (saw_next_order_id \u0026\u0026 saw_managed_accounts) || attempts \u003e MAX_ATTEMPTS {\n                break;\n            }\n        }\n\n        Ok(())\n    }\n\n    // Old Client interface\n    /// Returns the next request ID.\n    pub fn next_request_id(\u0026mut self) -\u003e i32 {\n        let request_id = self.next_request_id;\n        self.next_request_id += 1;\n        request_id\n    }\n\n    /// Returns and increments the order ID.\n    pub fn next_order_id(\u0026mut self) -\u003e i32 {\n        let order_id = self.order_id;\n        self.order_id += 1;\n        order_id\n    }\n\n    /// Sets the current value of order ID.\n    pub(crate) fn set_next_order_id(\u0026mut self, order_id: i32) -\u003e i32 {\n        self.order_id = order_id;\n        self.order_id\n    }\n\n    pub fn server_version(\u0026self) -\u003e i32 {\n        self.server_version\n    }\n\n    /// Returns the server version.\n    pub fn server_time(\u0026self) -\u003e String {\n        self.server_time.to_owned()\n    }\n\n    /// Returns the managed accounts.\n    pub fn managed_accounts(\u0026self) -\u003e String {\n        self.managed_accounts.to_owned()\n    }\n\n    pub(crate) fn send_message(\u0026mut self, packet: RequestMessage) -\u003e Result\u003c()\u003e {\n        self.message_bus.write_message(\u0026packet)\n    }\n\n    pub(crate) fn send_request(\u0026mut self, request_id: i32, message: RequestMessage) -\u003e Result\u003cResponseIterator\u003e {\n        debug!(\"send_message({:?}, {:?})\", request_id, message);\n        self.message_bus.send_generic_message(request_id, \u0026message)\n    }\n\n    pub(crate) fn send_order(\u0026mut self, order_id: i32, message: RequestMessage) -\u003e Result\u003cResponseIterator\u003e {\n        debug!(\"send_order({:?}, {:?})\", order_id, message);\n        self.message_bus.send_order_message(order_id, \u0026message)\n    }\n\n    /// Sends request for the next valid order id.\n    pub(crate) fn request_next_order_id(\u0026mut self, message: RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.message_bus.request_next_order_id(\u0026message)\n    }\n\n    /// Sends request for open orders.\n    pub(crate) fn request_order_data(\u0026mut self, message: RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.message_bus.request_open_orders(\u0026message)\n    }\n\n    /// Sends request for market rule.\n    pub(crate) fn request_market_rule(\u0026mut self, message: RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.message_bus.request_market_rule(\u0026message)\n    }\n\n    pub(crate) fn check_server_version(\u0026self, version: i32, message: \u0026str) -\u003e Result\u003c()\u003e {\n        if version \u003c= self.server_version {\n            Ok(())\n        } else {\n            Err(anyhow!(\"server version {} required, got {}: {}\", version, self.server_version, message))\n        }\n    }\n}\n\nimpl Drop for Client {\n    fn drop(\u0026mut self) {\n        info!(\"dropping basic client\")\n    }\n}\n\nimpl fmt::Debug for Client {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        f.debug_struct(\"Client\")\n            .field(\"server_version\", \u0026self.server_version)\n            .field(\"server_time\", \u0026self.server_time)\n            .field(\"client_id\", \u0026self.client_id)\n            .finish()\n    }\n}\n\n#[derive(Default, Debug, Clone)]\npub struct RequestMessage {\n    fields: Vec\u003cString\u003e,\n}\n\nimpl RequestMessage {\n    pub fn new() -\u003e Self {\n        Self::default()\n    }\n\n    pub fn from(_fields: \u0026[Box\u003cdyn ToField\u003e]) -\u003e RequestMessage {\n        RequestMessage::default()\n    }\n\n    pub fn push_field\u003cT: ToField\u003e(\u0026mut self, val: \u0026T) -\u003e \u0026RequestMessage {\n        let field = val.to_field();\n        self.fields.push(field);\n        self\n    }\n\n    pub fn encode(\u0026self) -\u003e String {\n        let mut data = self.fields.join(\"\\0\");\n        data.push('\\0');\n        data\n    }\n\n    pub(crate) fn encode_simple(\u0026self) -\u003e String {\n        let mut data = self.fields.join(\"|\");\n        data.push('|');\n        data\n    }\n}\n\nimpl Index\u003cusize\u003e for RequestMessage {\n    type Output = String;\n\n    fn index(\u0026self, i: usize) -\u003e \u0026Self::Output {\n        \u0026self.fields[i]\n    }\n}\n\n#[derive(Clone, Default, Debug)]\npub struct ResponseMessage {\n    pub i: usize,\n    pub fields: Vec\u003cString\u003e,\n}\n\nimpl ResponseMessage {\n    pub fn message_type(\u0026self) -\u003e IncomingMessages {\n        if self.fields.is_empty() {\n            IncomingMessages::NotValid\n        } else {\n            let message_id = i32::from_str(\u0026self.fields[0]).unwrap_or(-1);\n            IncomingMessages::from(message_id)\n        }\n    }\n\n    pub fn request_id(\u0026self) -\u003e Option\u003ci32\u003e {\n        if let Some(i) = request_id_index(self.message_type()) {\n            if let Ok(request_id) = self.peek_int(i) {\n                return Some(request_id);\n            }\n        }\n        None\n    }\n\n    pub fn order_id(\u0026self) -\u003e Option\u003ci32\u003e {\n        if let Some(i) = order_id_index(self.message_type()) {\n            if let Ok(order_id) = self.peek_int(i) {\n                return Some(order_id);\n            }\n        }\n        None\n    }\n\n    pub fn execution_id(\u0026self) -\u003e Option\u003cString\u003e {\n        match self.message_type() {\n            IncomingMessages::ExecutionData =\u003e Some(self.peek_string(14)),\n            IncomingMessages::CommissionsReport =\u003e Some(self.peek_string(2)),\n            _ =\u003e None,\n        }\n    }\n\n    pub fn peek_int(\u0026self, i: usize) -\u003e Result\u003ci32\u003e {\n        let field = \u0026self.fields[i];\n        match field.parse() {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", i, field, err)),\n        }\n    }\n\n    pub fn peek_string(\u0026self, i: usize) -\u003e String {\n        self.fields[i].to_owned()\n    }\n\n    pub fn next_int(\u0026mut self) -\u003e Result\u003ci32\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        match field.parse() {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_optional_int(\u0026mut self) -\u003e Result\u003cOption\u003ci32\u003e\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        if field.is_empty() || field == UNSET_INTEGER {\n            return Ok(None);\n        }\n\n        match field.parse::\u003ci32\u003e() {\n            Ok(val) =\u003e Ok(Some(val)),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_bool(\u0026mut self) -\u003e Result\u003cbool\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        Ok(field == \"1\")\n    }\n\n    pub fn next_long(\u0026mut self) -\u003e Result\u003ci64\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        match field.parse() {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_optional_long(\u0026mut self) -\u003e Result\u003cOption\u003ci64\u003e\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        if field.is_empty() || field == UNSET_LONG {\n            return Ok(None);\n        }\n\n        match field.parse::\u003ci64\u003e() {\n            Ok(val) =\u003e Ok(Some(val)),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_date_time(\u0026mut self) -\u003e Result\u003cOffsetDateTime\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        // from_unix_timestamp\n        let timestamp: i64 = field.parse()?;\n        match OffsetDateTime::from_unix_timestamp(timestamp) {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_string(\u0026mut self) -\u003e Result\u003cString\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n        Ok(String::from(field))\n    }\n\n    pub fn next_double(\u0026mut self) -\u003e Result\u003cf64\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        if field.is_empty() || field == \"0\" || field == \"0.0\" {\n            return Ok(0.0);\n        }\n\n        match field.parse() {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_optional_double(\u0026mut self) -\u003e Result\u003cOption\u003cf64\u003e\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        if field.is_empty() || field == UNSET_DOUBLE {\n            return Ok(None);\n        }\n\n        if field == INFINITY_STR {\n            return Ok(Some(f64::INFINITY));\n        }\n\n        match field.parse() {\n            Ok(val) =\u003e Ok(Some(val)),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn from(fields: \u0026str) -\u003e ResponseMessage {\n        ResponseMessage {\n            i: 0,\n            fields: fields.split('\\x00').map(|x| x.to_string()).collect(),\n        }\n    }\n\n    pub fn skip(\u0026mut self) {\n        self.i += 1;\n    }\n\n    pub fn reset(\u0026mut self) {\n        self.i = 0;\n    }\n\n    pub fn encode(\u0026self) -\u003e String {\n        let mut data = self.fields.join(\"\\0\");\n        data.push('\\0');\n        data\n    }\n}\n\n#[cfg(test)]\nmod tests;\n","traces":[{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":128,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":193,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":18},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":18},"fn_name":null},{"line":209,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":210,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":214,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":215,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":218,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":219,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":224,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":227,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":228,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":229,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":233,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":238,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":239,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":248,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":249,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":251,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":258,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":263,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":264,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":265,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":266,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":267,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":278,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":279,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":282,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":283,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":540},"fn_name":null},{"line":287,"address":[],"length":0,"stats":{"Line":540},"fn_name":null},{"line":288,"address":[],"length":0,"stats":{"Line":540},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":540},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":293,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":300,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":301,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":61},"fn_name":null},{"line":309,"address":[],"length":0,"stats":{"Line":61},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":321,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":325,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":330,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":339,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":341,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":344,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":347,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":348,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":349,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":350,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":351,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":355,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":356,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":358,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":359,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":368,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":369,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":371,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":372,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":373,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":37},"fn_name":null},{"line":378,"address":[],"length":0,"stats":{"Line":37},"fn_name":null},{"line":379,"address":[],"length":0,"stats":{"Line":37},"fn_name":null},{"line":381,"address":[],"length":0,"stats":{"Line":61},"fn_name":null},{"line":382,"address":[],"length":0,"stats":{"Line":26},"fn_name":null},{"line":385,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":387,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":391,"address":[],"length":0,"stats":{"Line":73},"fn_name":null},{"line":392,"address":[],"length":0,"stats":{"Line":73},"fn_name":null},{"line":393,"address":[],"length":0,"stats":{"Line":73},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":73},"fn_name":null},{"line":398,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":403,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":404,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":408,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":409,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":412,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":416,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":417,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":418,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":422,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":423,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":424,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":427,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":428,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":429,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":430,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":256},"fn_name":null},{"line":435,"address":[],"length":0,"stats":{"Line":256},"fn_name":null},{"line":436,"address":[],"length":0,"stats":{"Line":256},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":256},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":58},"fn_name":null},{"line":441,"address":[],"length":0,"stats":{"Line":58},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":58},"fn_name":null},{"line":444,"address":[],"length":0,"stats":{"Line":148},"fn_name":null},{"line":445,"address":[],"length":0,"stats":{"Line":25},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":33},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":33},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":454,"address":[],"length":0,"stats":{"Line":118},"fn_name":null},{"line":455,"address":[],"length":0,"stats":{"Line":118},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":118},"fn_name":null},{"line":458,"address":[],"length":0,"stats":{"Line":180},"fn_name":null},{"line":459,"address":[],"length":0,"stats":{"Line":105},"fn_name":null},{"line":462,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":463,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":466,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":467,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":472,"address":[],"length":0,"stats":{"Line":25},"fn_name":null},{"line":475,"address":[],"length":0,"stats":{"Line":807},"fn_name":null},{"line":479,"address":[],"length":0,"stats":{"Line":34},"fn_name":null},{"line":480,"address":[],"length":0,"stats":{"Line":34},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":487,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":489,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":490,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":111,"coverable":210},{"path":["/","Users","wboayue","projects","rust-ibapi","src","constants.rs"],"content":"use crate::server_versions;\n\n// 100+ messaging */\n// 100 = enhanced handshake, msg length prefixes\n\npub const CLIENT_VERSION: i32 = 66; //API v. 9.71\n\npub const MIN_CLIENT_VER: i32 = 100;\npub const MAX_CLIENT_VER: i32 = server_versions::PRICE_MGMT_ALGO;\n\n// public const int ClientVersion = 66;//API v. 9.71\n// public const byte EOL = 0;\n// public const string BagSecType = \"BAG\";\n// public const int REDIRECT_COUNT_MAX = 2;\n// public const string INFINITY_STR = \"Infinity\";\n\n// public const int FaGroups = 1;\n// public const int FaProfiles = 2;\n// public const int FaAliases = 3;\n// public const int MinVersion = 100;\n// public const int MaxVersion = MinServerVer.MIN_SERVER_VER_BOND_ISSUERID;\n// public const int MaxMsgSize = 0x00FFFFFF;\n\n//         public const int FaGroups = 1;\n//         public const int FaProfiles = 2;\n//         public const int FaAliases = 3;\n//         public const int MinVersion = 100;\n//         public const int MaxVersion = MinServerVer.MIN_SERVER_VER_BOND_ISSUERID;\n//         public const int MaxMsgSize = 0x00FFFFFF;\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts","contract_samples.rs"],"content":"use super::*;\n\n// https://github.com/InteractiveBrokers/tws-api/blob/5cb24aea5cef9d315985a7b13dea7efbcfe2b16a/samples/CSharp/Testbed/ContractSamples.cs\n\n// Future contracts also require an expiration date but are less complicated than options.\npub fn simple_future() -\u003e Contract {\n    Contract {\n        symbol: \"GBL\".to_owned(),\n        security_type: SecurityType::Future,\n        exchange: \"EUREX\".to_owned(),\n        currency: \"EUR\".to_owned(),\n        last_trade_date_or_contract_month: \"202303\".to_owned(),\n        ..Contract::default()\n    }\n}\n\n// Rather than giving expiration dates we can also provide the local symbol\n// attributes such as symbol, currency, strike, etc.\npub fn future_with_local_symbol() -\u003e Contract {\n    Contract {\n        security_type: SecurityType::Future,\n        exchange: \"EUREX\".to_owned(),\n        currency: \"EUR\".to_owned(),\n        local_symbol: \"FGBL MAR 23\".to_owned(),\n        last_trade_date_or_contract_month: \"202303\".to_owned(),\n        ..Contract::default()\n    }\n}\n\npub fn future_with_multiplier() -\u003e Contract {\n    Contract {\n        symbol: \"DAX\".to_owned(),\n        security_type: SecurityType::Future,\n        exchange: \"EUREX\".to_owned(),\n        currency: \"EUR\".to_owned(),\n        last_trade_date_or_contract_month: \"202303\".to_owned(),\n        multiplier: \"1\".to_owned(),\n        ..Contract::default()\n    }\n}\n\npub fn smart_future_combo_contract() -\u003e Contract {\n    let leg_1 = ComboLeg {\n        contract_id: 55928698, //WTI future June 2017\n        ratio: 1,\n        action: \"BUY\".to_owned(),\n        exchange: \"IPE\".to_owned(),\n        ..ComboLeg::default()\n    };\n\n    let leg_2 = ComboLeg {\n        contract_id: 55850663, //COIL future June 2017\n        ratio: 1,\n        action: \"SELL\".to_owned(),\n        exchange: \"IPE\".to_owned(),\n        ..ComboLeg::default()\n    };\n\n    Contract {\n        symbol: \"WTI\".to_owned(), // WTI,COIL spread. Symbol can be defined as first leg symbol (\"WTI\") or currency (\"USD\").\n        security_type: SecurityType::Spread,\n        currency: \"USD\".to_owned(),\n        exchange: \"SMART\".to_owned(),\n        combo_legs: vec![leg_1, leg_2],\n        ..Contract::default()\n    }\n}\n","traces":[{"line":6,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":12,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":19,"coverable":25},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts","decoders.rs"],"content":"use anyhow::Result;\nuse log::info;\n\nuse super::{Contract, ContractDescription, ContractDetails, MarketRule, PriceIncrement};\nuse crate::{client::ResponseMessage, contracts::SecurityType, orders::TagValue, server_versions};\n\npub(crate) fn contract_details(server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cContractDetails\u003e {\n    message.skip(); // message type\n\n    let mut message_version = 8;\n    if server_version \u003c server_versions::SIZE_RULES {\n        message_version = message.next_int()?;\n    }\n\n    let mut request_id = -1;\n    if message_version \u003e= 3 {\n        request_id = message.next_int()?;\n    }\n\n    info!(\n        \"request_id: {}, server_version: {}, message_version: {}\",\n        request_id, server_version, message_version\n    );\n\n    let mut contract = ContractDetails::default();\n\n    contract.contract.symbol = message.next_string()?;\n    contract.contract.security_type = SecurityType::from(\u0026message.next_string()?);\n    read_last_trade_date(\u0026mut contract, \u0026message.next_string()?, false)?;\n    contract.contract.strike = message.next_double()?;\n    contract.contract.right = message.next_string()?;\n    contract.contract.exchange = message.next_string()?;\n    contract.contract.currency = message.next_string()?;\n    contract.contract.local_symbol = message.next_string()?;\n    contract.market_name = message.next_string()?;\n    contract.contract.trading_class = message.next_string()?;\n    contract.contract.contract_id = message.next_int()?;\n    contract.min_tick = message.next_double()?;\n    if (server_versions::MD_SIZE_MULTIPLIER..server_versions::SIZE_RULES).contains(\u0026server_version) {\n        message.next_int()?; // mdSizeMultiplier no longer used\n    }\n    contract.contract.multiplier = message.next_string()?;\n    contract.order_types = message.next_string()?;\n    contract.valid_exchanges = message.next_string()?;\n    if message_version \u003e= 2 {\n        contract.price_magnifier = message.next_int()?;\n    }\n    if message_version \u003e= 4 {\n        contract.under_contract_id = message.next_int()?;\n    }\n    if message_version \u003e= 5 {\n        //        https://github.com/InteractiveBrokers/tws-api/blob/817a905d52299028ac5af08581c8ffde7644cea9/source/csharpclient/client/EDecoder.cs#L1626\n        contract.long_name = message.next_string()?;\n        contract.contract.primary_exchange = message.next_string()?;\n    }\n    if message_version \u003e= 6 {\n        contract.contract_month = message.next_string()?;\n        contract.industry = message.next_string()?;\n        contract.category = message.next_string()?;\n        contract.subcategory = message.next_string()?;\n        contract.time_zone_id = message.next_string()?;\n        contract.trading_hours = message.next_string()?;\n        contract.liquid_hours = message.next_string()?;\n    }\n    if message_version \u003e= 8 {\n        contract.ev_rule = message.next_string()?;\n        contract.ev_multiplier = message.next_double()?;\n    }\n    if message_version \u003e= 7 {\n        let sec_id_list_count = message.next_int()?;\n        for _ in 0..sec_id_list_count {\n            let tag = message.next_string()?;\n            let value = message.next_string()?;\n            contract.sec_id_list.push(TagValue { tag, value });\n        }\n    }\n    if server_version \u003e server_versions::AGG_GROUP {\n        contract.agg_group = message.next_int()?;\n    }\n    if server_version \u003e server_versions::UNDERLYING_INFO {\n        contract.under_symbol = message.next_string()?;\n        contract.under_security_type = message.next_string()?;\n    }\n    if server_version \u003e server_versions::MARKET_RULES {\n        contract.market_rule_ids = message.next_string()?;\n    }\n    if server_version \u003e server_versions::REAL_EXPIRATION_DATE {\n        contract.real_expiration_date = message.next_string()?;\n    }\n    if server_version \u003e server_versions::STOCK_TYPE {\n        contract.stock_type = message.next_string()?;\n    }\n    if (server_versions::FRACTIONAL_SIZE_SUPPORT..server_versions::SIZE_RULES).contains(\u0026server_version) {\n        message.next_double()?; // size min tick -- no longer used\n    }\n    if server_version \u003e= server_versions::SIZE_RULES {\n        contract.min_size = message.next_double()?;\n        contract.size_increment = message.next_double()?;\n        contract.suggested_size_increment = message.next_double()?;\n    }\n\n    Ok(contract)\n}\n\nfn read_last_trade_date(contract: \u0026mut ContractDetails, last_trade_date_or_contract_month: \u0026str, is_bond: bool) -\u003e Result\u003c()\u003e {\n    if last_trade_date_or_contract_month.is_empty() {\n        return Ok(());\n    }\n\n    let splitted: Vec\u003c\u0026str\u003e = if last_trade_date_or_contract_month.contains('-') {\n        last_trade_date_or_contract_month.split('-').collect()\n    } else {\n        // let re = Regex::new(r\"\\s+\").unwrap();\n        last_trade_date_or_contract_month.split(' ').collect()\n    };\n\n    if !splitted.is_empty() {\n        if is_bond {\n            contract.maturity = splitted[0].to_string();\n        } else {\n            contract.contract.last_trade_date_or_contract_month = splitted[0].to_string();\n        }\n    }\n    if splitted.len() \u003e 1 {\n        contract.last_trade_time = splitted[1].to_string();\n    }\n    if is_bond \u0026\u0026 splitted.len() \u003e 2 {\n        contract.time_zone_id = splitted[2].to_string();\n    }\n\n    Ok(())\n}\n\npub(crate) fn contract_descriptions(server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cVec\u003cContractDescription\u003e\u003e {\n    message.skip(); // message type\n\n    let _request_id = message.next_int()?;\n    let contract_descriptions_count = message.next_int()?;\n\n    if contract_descriptions_count \u003c 1 {\n        return Ok(Vec::default());\n    }\n\n    let mut contract_descriptions: Vec\u003cContractDescription\u003e = Vec::with_capacity(contract_descriptions_count as usize);\n\n    for _ in 0..contract_descriptions_count {\n        let mut contract = Contract {\n            contract_id: message.next_int()?,\n            symbol: message.next_string()?,\n            security_type: SecurityType::from(\u0026message.next_string()?),\n            primary_exchange: message.next_string()?,\n            currency: message.next_string()?,\n            ..Default::default()\n        };\n\n        let derivative_security_types_count = message.next_int()?;\n        let mut derivative_security_types: Vec\u003cString\u003e = Vec::with_capacity(derivative_security_types_count as usize);\n        for _ in 0..derivative_security_types_count {\n            derivative_security_types.push(message.next_string()?);\n        }\n\n        if server_version \u003e= server_versions::BOND_ISSUERID {\n            contract.description = message.next_string()?;\n            contract.issuer_id = message.next_string()?;\n        }\n\n        contract_descriptions.push(ContractDescription {\n            contract,\n            derivative_security_types,\n        });\n    }\n\n    Ok(contract_descriptions)\n}\n\npub(crate) fn market_rule(message: \u0026mut ResponseMessage) -\u003e Result\u003cMarketRule\u003e {\n    message.skip(); // message type\n\n    let mut market_rule = MarketRule::default();\n\n    market_rule.market_rule_id = message.next_int()?;\n\n    let price_increments_count = message.next_int()?;\n    for _ in 0..price_increments_count {\n        market_rule.price_increments.push(PriceIncrement {\n            low_edge: message.next_double()?,\n            increment: message.next_double()?,\n        });\n    }\n\n    Ok(market_rule)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn decode_market_rule() {\n        let mut message = ResponseMessage::from(\"93\\026\\01\\00\\00.01\\0\");\n\n        let results = market_rule(\u0026mut message);\n\n        if let Ok(market_rule) = results {\n            assert_eq!(market_rule.market_rule_id, 26, \"market_rule.market_rule_id\");\n\n            assert_eq!(market_rule.price_increments.len(), 1, \"market_rule.price_increments.len()\");\n            assert_eq!(market_rule.price_increments[0].low_edge, 0.0, \"market_rule.price_increments[0].low_edge\");\n            assert_eq!(\n                market_rule.price_increments[0].increment, 0.01,\n                \"market_rule.price_increments[0].increment\"\n            );\n        } else if let Err(err) = results {\n            assert!(false, \"error decoding market rule: {err}\");\n        }\n    }\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":12,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":128,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":78,"coverable":117},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts","encoders.rs"],"content":"use anyhow::Result;\n\nuse super::Contract;\nuse crate::client::RequestMessage;\nuse crate::messages::OutgoingMessages;\nuse crate::server_versions;\n\npub(crate) fn request_contract_data(server_version: i32, request_id: i32, contract: \u0026Contract) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 8;\n\n    let mut packet = RequestMessage::default();\n\n    packet.push_field(\u0026OutgoingMessages::RequestContractData);\n    packet.push_field(\u0026VERSION);\n\n    if server_version \u003e= server_versions::CONTRACT_DATA_CHAIN {\n        packet.push_field(\u0026request_id);\n    }\n\n    if server_version \u003e= server_versions::CONTRACT_CONID {\n        packet.push_field(\u0026contract.contract_id);\n    }\n\n    packet.push_field(\u0026contract.symbol);\n    packet.push_field(\u0026contract.security_type);\n    packet.push_field(\u0026contract.last_trade_date_or_contract_month);\n    packet.push_field(\u0026contract.strike);\n    packet.push_field(\u0026contract.right);\n\n    if server_version \u003e= 15 {\n        packet.push_field(\u0026contract.multiplier);\n    }\n\n    if server_version \u003e= server_versions::PRIMARYEXCH {\n        packet.push_field(\u0026contract.exchange);\n        packet.push_field(\u0026contract.primary_exchange);\n    } else if server_version \u003e= server_versions::LINKING {\n        if !contract.primary_exchange.is_empty() \u0026\u0026 (contract.exchange == \"BEST\" || contract.exchange == \"SMART\") {\n            packet.push_field(\u0026format!(\"{}:{}\", contract.exchange, contract.primary_exchange));\n        } else {\n            packet.push_field(\u0026contract.exchange);\n        }\n    }\n\n    packet.push_field(\u0026contract.currency);\n    packet.push_field(\u0026contract.local_symbol);\n\n    if server_version \u003e= server_versions::TRADING_CLASS {\n        packet.push_field(\u0026contract.trading_class);\n    }\n    if server_version \u003e= 31 {\n        packet.push_field(\u0026contract.include_expired);\n    }\n    if server_version \u003e= server_versions::SEC_ID_TYPE {\n        packet.push_field(\u0026contract.security_id_type);\n        packet.push_field(\u0026contract.security_id);\n    }\n    if server_version \u003e= server_versions::BOND_ISSUERID {\n        packet.push_field(\u0026contract.issuer_id);\n    }\n\n    Ok(packet)\n}\n\npub(crate) fn request_matching_symbols(request_id: i32, pattern: \u0026str) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestMatchingSymbols);\n    message.push_field(\u0026request_id);\n    message.push_field(\u0026pattern);\n\n    Ok(message)\n}\n\npub(crate) fn request_market_rule(market_rule_id: i32) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestMarketRule);\n    message.push_field(\u0026market_rule_id);\n\n    Ok(message)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn request_market_rule() {\n        let results = super::request_market_rule(26);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message.encode(), \"91\\026\\0\", \"message.encode()\");\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding market rule request: {err}\");\n            }\n        }\n    }\n}\n","traces":[{"line":8,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":35,"coverable":45},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts","tests.rs"],"content":"use super::*;\n\nuse crate::stubs::MessageBusStub;\n\n#[test]\nfn request_stock_contract_details() {\n    let mut message_bus = Box::new(MessageBusStub{\n        request_messages: vec![],\n        response_messages: vec![\n            \"10|9001|TSLA|STK||0||SMART|USD|TSLA|NMS|NMS|76792991|0.01||ACTIVETIM,AD,ADJUST,ALERT,ALGO,ALLOC,AON,AVGCOST,BASKET,BENCHPX,CASHQTY,COND,CONDORDER,DARKONLY,DARKPOLL,DAY,DEACT,DEACTDIS,DEACTEOD,DIS,DUR,GAT,GTC,GTD,GTT,HID,IBKRATS,ICE,IMB,IOC,LIT,LMT,LOC,MIDPX,MIT,MKT,MOC,MTL,NGCOMB,NODARK,NONALGO,OCA,OPG,OPGREROUT,PEGBENCH,PEGMID,POSTATS,POSTONLY,PREOPGRTH,PRICECHK,REL,REL2MID,RELPCTOFS,RPI,RTH,SCALE,SCALEODD,SCALERST,SIZECHK,SNAPMID,SNAPMKT,SNAPREL,STP,STPLMT,SWEEP,TRAIL,TRAILLIT,TRAILLMT,TRAILMIT,WHATIF|SMART,AMEX,NYSE,CBOE,PHLX,ISE,CHX,ARCA,ISLAND,DRCTEDGE,BEX,BATS,EDGEA,CSFBALGO,JEFFALGO,BYX,IEX,EDGX,FOXRIVER,PEARL,NYSENAT,LTSE,MEMX,PSX|1|0|TESLA INC|NASDAQ||Consumer, Cyclical|Auto Manufacturers|Auto-Cars/Light Trucks|US/Eastern|20221229:0400-20221229:2000;20221230:0400-20221230:2000;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0400-20230103:2000|20221229:0930-20221229:1600;20221230:0930-20221230:1600;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0930-20230103:1600|||1|ISIN|US88160R1014|1|||26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26||COMMON|1|1|100||\".to_string(),\n            \"10|9001|TSLA|STK||0||AMEX|USD|TSLA|NMS|NMS|76792991|0.01||ACTIVETIM,AD,ADJUST,ALERT,ALLOC,AVGCOST,BASKET,BENCHPX,CASHQTY,COND,CONDORDER,DAY,DEACT,DEACTDIS,DEACTEOD,GAT,GTC,GTD,GTT,HID,IOC,LIT,LMT,MIT,MKT,MTL,NGCOMB,NONALGO,OCA,PEGBENCH,SCALE,SCALERST,SNAPMID,SNAPMKT,SNAPREL,STP,STPLMT,TRAIL,TRAILLIT,TRAILLMT,TRAILMIT,WHATIF|SMART,AMEX,NYSE,CBOE,PHLX,ISE,CHX,ARCA,ISLAND,DRCTEDGE,BEX,BATS,EDGEA,CSFBALGO,JEFFALGO,BYX,IEX,EDGX,FOXRIVER,PEARL,NYSENAT,LTSE,MEMX,PSX|1|0|TESLA INC|NASDAQ||Consumer, Cyclical|Auto Manufacturers|Auto-Cars/Light Trucks|US/Eastern|20221229:0700-20221229:2000;20221230:0700-20221230:2000;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0700-20230103:2000|20221229:0700-20221229:2000;20221230:0700-20221230:2000;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0700-20230103:2000|||1|ISIN|US88160R1014|1|||26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26||COMMON|1|1|100||\".to_string(),\n            \"52|1|9001||\".to_string(),\n        ]\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let contract = Contract::stock(\"TSLA\");\n\n    let results = super::contract_details(\u0026mut client, \u0026contract);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode_simple(), \"9|8|9000|0|TSLA|STK||0|||SMART||USD|||0|||\");\n\n    assert!(results.is_ok(), \"failed to encode request: {:?}\", results.unwrap_err());\n\n    let contracts = results.unwrap();\n    assert_eq!(2, contracts.len());\n\n    assert_eq!(contracts[0].contract.exchange, \"SMART\");\n    assert_eq!(contracts[1].contract.exchange, \"AMEX\");\n\n    assert_eq!(contracts[0].contract.symbol, \"TSLA\");\n    assert_eq!(contracts[0].contract.security_type, SecurityType::Stock);\n    assert_eq!(contracts[0].contract.currency, \"USD\");\n    assert_eq!(contracts[0].contract.contract_id, 76792991);\n    assert_eq!(contracts[0].order_types, \"ACTIVETIM,AD,ADJUST,ALERT,ALGO,ALLOC,AON,AVGCOST,BASKET,BENCHPX,CASHQTY,COND,CONDORDER,DARKONLY,DARKPOLL,DAY,DEACT,DEACTDIS,DEACTEOD,DIS,DUR,GAT,GTC,GTD,GTT,HID,IBKRATS,ICE,IMB,IOC,LIT,LMT,LOC,MIDPX,MIT,MKT,MOC,MTL,NGCOMB,NODARK,NONALGO,OCA,OPG,OPGREROUT,PEGBENCH,PEGMID,POSTATS,POSTONLY,PREOPGRTH,PRICECHK,REL,REL2MID,RELPCTOFS,RPI,RTH,SCALE,SCALEODD,SCALERST,SIZECHK,SNAPMID,SNAPMKT,SNAPREL,STP,STPLMT,SWEEP,TRAIL,TRAILLIT,TRAILLMT,TRAILMIT,WHATIF\");\n    assert_eq!(\n        contracts[0].valid_exchanges,\n        \"SMART,AMEX,NYSE,CBOE,PHLX,ISE,CHX,ARCA,ISLAND,DRCTEDGE,BEX,BATS,EDGEA,CSFBALGO,JEFFALGO,BYX,IEX,EDGX,FOXRIVER,PEARL,NYSENAT,LTSE,MEMX,PSX\"\n    );\n    assert_eq!(contracts[0].price_magnifier, 1);\n    assert_eq!(contracts[0].under_contract_id, 0);\n    assert_eq!(contracts[0].long_name, \"TESLA INC\");\n    assert_eq!(contracts[0].contract.primary_exchange, \"NASDAQ\");\n    assert_eq!(contracts[0].contract_month, \"\");\n    assert_eq!(contracts[0].industry, \"Consumer, Cyclical\");\n    assert_eq!(contracts[0].category, \"Auto Manufacturers\");\n    assert_eq!(contracts[0].subcategory, \"Auto-Cars/Light Trucks\");\n    assert_eq!(contracts[0].time_zone_id, \"US/Eastern\");\n    assert_eq!(\n        contracts[0].trading_hours,\n        \"20221229:0400-20221229:2000;20221230:0400-20221230:2000;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0400-20230103:2000\"\n    );\n    assert_eq!(\n        contracts[0].liquid_hours,\n        \"20221229:0930-20221229:1600;20221230:0930-20221230:1600;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0930-20230103:1600\"\n    );\n    assert_eq!(contracts[0].ev_rule, \"\");\n    assert_eq!(contracts[0].ev_multiplier, 0.0);\n    assert_eq!(contracts[0].sec_id_list.len(), 1);\n    assert_eq!(contracts[0].sec_id_list[0].tag, \"ISIN\");\n    assert_eq!(contracts[0].sec_id_list[0].value, \"US88160R1014\");\n    assert_eq!(contracts[0].agg_group, 1);\n    assert_eq!(\n        contracts[0].market_rule_ids,\n        \"26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26\"\n    );\n    assert_eq!(contracts[0].stock_type, \"COMMON\");\n    assert_eq!(contracts[0].min_size, 1.0);\n    assert_eq!(contracts[0].size_increment, 1.0);\n    assert_eq!(contracts[0].suggested_size_increment, 100.0);\n}\n\n#[test]\nfn request_bond_contract_details() {}\n\n#[test]\nfn request_future_contract_details() {}\n\n#[test]\nfn test_read_last_trade_date() {\n    // let mut contract = ContractDetails::default();\n\n    // handles blank string\n    // let result = read_last_trade_date(\u0026mut contract, \"\", false);\n    // assert!(!result.is_err(), \"unexpected error {:?}\", result);\n\n    // handles non bond contracts\n\n    // handles bond contracts\n}\n\n#[test]\nfn request_matching_symbols() {}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts.rs"],"content":"use std::convert::From;\nuse std::fmt::Debug;\nuse std::string::ToString;\n\nuse anyhow::{anyhow, Result};\nuse log::{error, info};\n\nuse crate::client::{Client, RequestMessage};\nuse crate::encode_option_field;\nuse crate::messages::IncomingMessages;\nuse crate::{server_versions, ToField};\n\nmod decoders;\nmod encoders;\n\n#[cfg(test)]\npub(crate) mod contract_samples;\n#[cfg(test)]\nmod tests;\n\n// Models\n\n#[derive(Clone, Debug, PartialEq, Eq, Default)]\n/// SecurityType enumerates available security types\npub enum SecurityType {\n    /// Stock (or ETF)\n    #[default]\n    Stock,\n    /// Option\n    Option,\n    /// Future\n    Future,\n    /// Index\n    Index,\n    /// Futures option\n    FuturesOption,\n    /// Forex pair\n    ForexPair,\n    /// Combo\n    Spread,\n    ///  Warrant\n    Warrant,\n    /// Bond\n    Bond,\n    /// Commodity\n    Commodity,\n    /// News\n    News,\n    /// Mutual fund\n    MutualFund,\n}\n\nimpl ToField for SecurityType {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003cSecurityType\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl ToString for SecurityType {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            SecurityType::Stock =\u003e \"STK\".to_string(),\n            SecurityType::Option =\u003e \"OPT\".to_string(),\n            SecurityType::Future =\u003e \"FUT\".to_string(),\n            SecurityType::Index =\u003e \"IND\".to_string(),\n            SecurityType::FuturesOption =\u003e \"FOP\".to_string(),\n            SecurityType::ForexPair =\u003e \"CASH\".to_string(),\n            SecurityType::Spread =\u003e \"BAG\".to_string(),\n            SecurityType::Warrant =\u003e \"WAR\".to_string(),\n            SecurityType::Bond =\u003e \"BOND\".to_string(),\n            SecurityType::Commodity =\u003e \"CMDTY\".to_string(),\n            SecurityType::News =\u003e \"NEWS\".to_string(),\n            SecurityType::MutualFund =\u003e \"FUND\".to_string(),\n        }\n    }\n}\n\nimpl SecurityType {\n    pub fn from(name: \u0026str) -\u003e SecurityType {\n        match name {\n            \"STK\" =\u003e SecurityType::Stock,\n            \"OPT\" =\u003e SecurityType::Option,\n            \"FUT\" =\u003e SecurityType::Future,\n            \"IND\" =\u003e SecurityType::Index,\n            \"FOP\" =\u003e SecurityType::FuturesOption,\n            \"CASH\" =\u003e SecurityType::ForexPair,\n            \"BAG\" =\u003e SecurityType::Spread,\n            \"WAR\" =\u003e SecurityType::Warrant,\n            \"BOND\" =\u003e SecurityType::Bond,\n            \"CMDTY\" =\u003e SecurityType::Commodity,\n            \"NEWS\" =\u003e SecurityType::News,\n            \"FUND\" =\u003e SecurityType::MutualFund,\n            \u0026_ =\u003e todo!(),\n        }\n    }\n}\n\n#[derive(Clone, Debug, Default)]\n/// Contract describes an instrument's definition\npub struct Contract {\n    /// The unique IB contract identifier.\n    pub contract_id: i32,\n    /// The underlying's asset symbol.\n    pub symbol: String,\n    pub security_type: SecurityType,\n    /// The contract's last trading day or contract month (for Options and Futures).\n    /// Strings with format YYYYMM will be interpreted as the Contract Month whereas YYYYMMDD will be interpreted as Last Trading Day.\n    pub last_trade_date_or_contract_month: String,\n    /// The option's strike price.\n    pub strike: f64,\n    /// Either Put or Call (i.e. Options). Valid values are P, PUT, C, CALL.\n    pub right: String,\n    /// The instrument's multiplier (i.e. options, futures).\n    pub multiplier: String,\n    /// The destination exchange.\n    pub exchange: String,\n    /// The underlying's currency.\n    pub currency: String,\n    /// The contract's symbol within its primary exchange For options, this will be the OCC symbol.\n    pub local_symbol: String,\n    /// The contract's primary exchange.\n    /// For smart routed contracts, used to define contract in case of ambiguity.\n    /// Should be defined as native exchange of contract, e.g. ISLAND for MSFT For exchanges which contain a period in name, will only be part of exchange name prior to period, i.e. ENEXT for ENEXT.BE.\n    pub primary_exchange: String,\n    /// The trading class name for this contract. Available in TWS contract description window as well. For example, GBL Dec '13 future's trading class is \"FGBL\".\n    pub trading_class: String,\n    /// If set to true, contract details requests and historical data queries can be performed pertaining to expired futures contracts. Expired options or other instrument types are not available.\n    pub include_expired: bool,\n    /// Security's identifier when querying contract's details or placing orders ISIN - Example: Apple: US0378331005 CUSIP - Example: Apple: 037833100.\n    pub security_id_type: String,\n    /// Identifier of the security type.\n    pub security_id: String,\n    /// Description of the combo legs.\n    pub combo_legs_description: String,\n    pub combo_legs: Vec\u003cComboLeg\u003e,\n    /// Delta and underlying price for Delta-Neutral combo orders. Underlying (STK or FUT), delta and underlying price goes into this attribute.\n    pub delta_neutral_contract: Option\u003cDeltaNeutralContract\u003e,\n\n    pub issuer_id: String,\n    pub description: String,\n}\n\nimpl Contract {\n    /// Creates stock contract from specified symbol\n    /// currency default to USD and SMART exchange.\n    pub fn stock(symbol: \u0026str) -\u003e Contract {\n        Contract {\n            symbol: symbol.to_string(),\n            security_type: SecurityType::Stock,\n            currency: \"USD\".to_string(),\n            exchange: \"SMART\".to_string(),\n            ..Default::default()\n        }\n    }\n\n    /// Creates futures contract from specified symbol\n    pub fn futures(symbol: \u0026str) -\u003e Contract {\n        Contract {\n            symbol: symbol.to_string(),\n            security_type: SecurityType::Future,\n            currency: \"USD\".to_string(),\n            ..Default::default()\n        }\n    }\n\n    /// Is Bag request\n    pub fn is_bag(\u0026self) -\u003e bool {\n        self.security_type == SecurityType::Spread\n    }\n\n    pub fn push_fields(\u0026self, message: \u0026mut RequestMessage) {\n        message.push_field(\u0026self.contract_id);\n        message.push_field(\u0026self.symbol);\n        message.push_field(\u0026self.security_type);\n        message.push_field(\u0026self.last_trade_date_or_contract_month);\n        message.push_field(\u0026self.strike);\n        message.push_field(\u0026self.right);\n        message.push_field(\u0026self.multiplier);\n        message.push_field(\u0026self.exchange);\n        message.push_field(\u0026self.primary_exchange);\n        message.push_field(\u0026self.currency);\n        message.push_field(\u0026self.local_symbol);\n        message.push_field(\u0026self.trading_class);\n        message.push_field(\u0026self.include_expired);\n    }\n}\n\n#[derive(Clone, Debug, Default)]\n// ComboLeg represents a leg within combo orders.\npub struct ComboLeg {\n    /// The Contract's IB's unique id.\n    pub contract_id: i32,\n    /// Select the relative number of contracts for the leg you are constructing. To help determine the ratio for a specific combination order, refer to the Interactive Analytics section of the User's Guide.\n    pub ratio: i32,\n    /// The side (buy or sell) of the leg:\n    pub action: String,\n    // The destination exchange to which the order will be routed.\n    pub exchange: String,\n    /// Specifies whether an order is an open or closing order.\n    /// For instituational customers to determine if this order is to open or close a position.\n    pub open_close: ComboLegOpenClose,\n    /// For stock legs when doing short selling. Set to 1 = clearing broker, 2 = third party.\n    pub short_sale_slot: i32,\n    /// When ShortSaleSlot is 2, this field shall contain the designated location.\n    pub designated_location: String,\n    // DOC_TODO.\n    pub exempt_code: i32,\n}\n\n#[derive(Clone, Copy, Debug, Default)]\n/// OpenClose specifies whether an order is an open or closing order.\npub enum ComboLegOpenClose {\n    /// 0 - Same as the parent security. This is the only option for retail customers.\n    #[default]\n    Same = 0,\n    /// 1 - Open. This value is only valid for institutional customers.\n    Open = 1,\n    /// 2 - Close. This value is only valid for institutional customers.\n    Close = 2,\n    /// 3 - Unknown.\n    Unknown = 3,\n}\n\nimpl ToField for ComboLegOpenClose {\n    fn to_field(\u0026self) -\u003e String {\n        (*self as u8).to_string()\n    }\n}\n\nimpl From\u003ci32\u003e for ComboLegOpenClose {\n    // TODO - verify these values\n    fn from(val: i32) -\u003e Self {\n        match val {\n            0 =\u003e Self::Same,\n            1 =\u003e Self::Open,\n            2 =\u003e Self::Close,\n            3 =\u003e Self::Unknown,\n            _ =\u003e panic!(\"unsupported value: {val}\"),\n        }\n    }\n}\n\n#[derive(Clone, Debug, Default, PartialEq)]\n/// Delta and underlying price for Delta-Neutral combo orders.\n/// Underlying (STK or FUT), delta and underlying price goes into this attribute.\npub struct DeltaNeutralContract {\n    /// The unique contract identifier specifying the security. Used for Delta-Neutral Combo contracts.\n    pub contract_id: i32,\n    /// The underlying stock or future delta. Used for Delta-Neutral Combo contracts.\n    pub delta: f64,\n    /// The price of the underlying. Used for Delta-Neutral Combo contracts.\n    pub price: f64,\n}\n\n/// ContractDetails provides extended contract details.\n#[derive(Debug, Default)]\npub struct ContractDetails {\n    /// A fully-defined Contract object.\n    pub contract: Contract,\n    /// The market name for this product.\n    pub market_name: String,\n    /// The minimum allowed price variation. Note that many securities vary their minimum tick size according to their price. This value will only show the smallest of the different minimum tick sizes regardless of the product's price. Full information about the minimum increment price structure can be obtained with the reqMarketRule function or the IB Contract and Security Search site.\n    pub min_tick: f64,\n    /// Allows execution and strike prices to be reported consistently with market data, historical data and the order price, i.e. Z on LIFFE is reported in Index points and not GBP. In TWS versions prior to 972, the price magnifier is used in defining future option strike prices (e.g. in the API the strike is specified in dollars, but in TWS it is specified in cents). In TWS versions 972 and higher, the price magnifier is not used in defining futures option strike prices so they are consistent in TWS and the API.\n    pub price_magnifier: i32,\n    /// Supported order types for this product.\n    pub order_types: String,\n    /// Valid exchange fields when placing an order for this contract.\n    /// The list of exchanges will is provided in the same order as the corresponding MarketRuleIds list.\n    pub valid_exchanges: String,\n    /// For derivatives, the contract ID (conID) of the underlying instrument.\n    pub under_contract_id: i32,\n    /// Descriptive name of the product.\n    pub long_name: String,\n    /// Typically the contract month of the underlying for a Future contract.\n    pub contract_month: String,\n    /// The industry classification of the underlying/product. For example, Financial.\n    pub industry: String,\n    /// The industry category of the underlying. For example, InvestmentSvc.\n    pub category: String,\n    /// The industry subcategory of the underlying. For example, Brokerage.\n    pub subcategory: String,\n    /// The time zone for the trading hours of the product. For example, EST.\n    pub time_zone_id: String,\n    /// The trading hours of the product. This value will contain the trading hours of the current day as well as the next's. For example, 20090507:0700-1830,1830-2330;20090508:CLOSED. In TWS versions 965+ there is an option in the Global Configuration API settings to return 1 month of trading hours. In TWS version 970+, the format includes the date of the closing time to clarify potential ambiguity, ex: 20180323:0400-20180323:2000;20180326:0400-20180326:2000 The trading hours will correspond to the hours for the product on the associated exchange. The same instrument can have different hours on different exchanges.\n    pub trading_hours: String,\n    /// The liquid hours of the product. This value will contain the liquid hours (regular trading hours) of the contract on the specified exchange. Format for TWS versions until 969: 20090507:0700-1830,1830-2330;20090508:CLOSED. In TWS versions 965+ there is an option in the Global Configuration API settings to return 1 month of trading hours. In TWS v970 and above, the format includes the date of the closing time to clarify potential ambiguity, e.g. 20180323:0930-20180323:1600;20180326:0930-20180326:1600.\n    pub liquid_hours: String,\n    /// Contains the Economic Value Rule name and the respective optional argument. The two values should be separated by a colon. For example, aussieBond:YearsToExpiration=3. When the optional argument is not present, the first value will be followed by a colon.\n    pub ev_rule: String,\n    /// Tells you approximately how much the market value of a contract would change if the price were to change by 1. It cannot be used to get market value by multiplying the price by the approximate multiplier.\n    pub ev_multiplier: f64,\n    /// Aggregated group Indicates the smart-routing group to which a contract belongs. contracts which cannot be smart-routed have aggGroup = -1.\n    pub agg_group: i32,\n    /// A list of contract identifiers that the customer is allowed to view. CUSIP/ISIN/etc. For US stocks, receiving the ISIN requires the CUSIP market data subscription. For Bonds, the CUSIP or ISIN is input directly into the symbol field of the Contract class.\n    pub sec_id_list: Vec\u003cTagValue\u003e,\n    /// For derivatives, the symbol of the underlying contract.\n    pub under_symbol: String,\n    /// For derivatives, returns the underlying security type.\n    pub under_security_type: String,\n    /// The list of market rule IDs separated by comma Market rule IDs can be used to determine the minimum price increment at a given price.\n    pub market_rule_ids: String,\n    /// Real expiration date. Requires TWS 968+ and API v973.04+. Python API specifically requires API v973.06+.\n    pub real_expiration_date: String,\n    /// Last trade time.\n    pub last_trade_time: String,\n    /// Stock type.\n    pub stock_type: String,\n    /// The nine-character bond CUSIP. For Bonds only. Receiving CUSIPs requires a CUSIP market data subscription.\n    pub cusip: String,\n    /// Identifies the credit rating of the issuer. This field is not currently available from the TWS API. For Bonds only. A higher credit rating generally indicates a less risky investment. Bond ratings are from Moody's and S\u0026P respectively. Not currently implemented due to bond market data restrictions.\n    pub ratings: String,\n    /// A description string containing further descriptive information about the bond. For Bonds only.\n    pub desc_append: String,\n    /// The type of bond, such as \"CORP.\".\n    pub bond_type: String,\n    /// The type of bond coupon. This field is currently not available from the TWS API. For Bonds only.\n    pub coupon_type: String,\n    /// If true, the bond can be called by the issuer under certain conditions. This field is currently not available from the TWS API. For Bonds only.\n    pub callable: bool,\n    /// Values are True or False. If true, the bond can be sold back to the issuer under certain conditions. This field is currently not available from the TWS API. For Bonds only.\n    pub putable: bool,\n    /// The interest rate used to calculate the amount you will receive in interest payments over the course of the year. This field is currently not available from the TWS API. For Bonds only.\n    pub coupon: f64,\n    /// Values are True or False. If true, the bond can be converted to stock under certain conditions. This field is currently not available from the TWS API. For Bonds only.\n    pub convertible: bool,\n    /// The date on which the issuer must repay the face value of the bond. This field is currently not available from the TWS API. For Bonds only. Not currently implemented due to bond market data restrictions.\n    pub maturity: String,\n    /// The date the bond was issued. This field is currently not available from the TWS API. For Bonds only. Not currently implemented due to bond market data restrictions.\n    pub issue_date: String,\n    /// Only if bond has embedded options. This field is currently not available from the TWS API. Refers to callable bonds and puttable bonds. Available in TWS description window for bonds.\n    pub next_option_date: String,\n    /// Type of embedded option. This field is currently not available from the TWS API. Only if bond has embedded options.\n    pub next_option_type: String,\n    /// Only if bond has embedded options. This field is currently not available from the TWS API. For Bonds only.\n    pub next_option_partial: bool,\n    /// If populated for the bond in IB's database. For Bonds only.\n    pub notes: String,\n    /// Order's minimal size.\n    pub min_size: f64,\n    /// Order's size increment.\n    pub size_increment: f64,\n    /// Order's suggested size increment.\n    pub suggested_size_increment: f64,\n}\n\n/// TagValue is a convenience struct to define key-value pairs.\n#[derive(Clone, Debug)]\npub struct TagValue {\n    pub tag: String,\n    pub value: String,\n}\n\nimpl ToField for Vec\u003cTagValue\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        let mut values = Vec::new();\n        for tag_value in self {\n            values.push(format!(\"{}={};\", tag_value.tag, tag_value.value))\n        }\n        values.concat()\n    }\n}\n\n// API\n\n/// Requests contract information.\n///\n/// Provides all the contracts matching the contract provided. It can also be used to retrieve complete options and futures chains. Though it is now (in API version \u003e 9.72.12) advised to use reqSecDefOptParams for that purpose.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::Client;\n/// use ibapi::contracts::{self, Contract};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let contract = Contract::stock(\"TSLA\");\n///     let results = contracts::contract_details(\u0026mut client, \u0026contract)?;\n///\n///     for contract_detail in \u0026results {\n///         println!(\"contract: {:?}\", contract_detail);\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn contract_details(client: \u0026mut Client, contract: \u0026Contract) -\u003e Result\u003cVec\u003cContractDetails\u003e\u003e {\n    verify_contract(client, contract)?;\n\n    let request_id = client.next_request_id();\n    let packet = encoders::request_contract_data(client.server_version(), request_id, contract)?;\n\n    let responses = client.send_request(request_id, packet)?;\n\n    let mut contract_details: Vec\u003cContractDetails\u003e = Vec::default();\n\n    // TODO create iterator\n    for mut message in responses {\n        match message.message_type() {\n            IncomingMessages::ContractData =\u003e {\n                let decoded = decoders::contract_details(client.server_version(), \u0026mut message)?;\n                contract_details.push(decoded);\n            }\n            IncomingMessages::ContractDataEnd =\u003e {\n                break;\n            }\n            IncomingMessages::Error =\u003e {\n                error!(\"error: {:?}\", message);\n                return Err(anyhow!(\"contract_details {:?}\", message));\n            }\n            _ =\u003e {\n                error!(\"unexpected message: {:?}\", message);\n            }\n        }\n    }\n\n    Ok(contract_details)\n}\n\nfn verify_contract(client: \u0026mut Client, contract: \u0026Contract) -\u003e Result\u003c()\u003e {\n    if !contract.security_id_type.is_empty() || !contract.security_id.is_empty() {\n        client.check_server_version(\n            server_versions::SEC_ID_TYPE,\n            \"It does not support security_id_type or security_id attributes\",\n        )?\n    }\n\n    if !contract.trading_class.is_empty() {\n        client.check_server_version(\n            server_versions::TRADING_CLASS,\n            \"It does not support the trading_class parameter when requesting contract details.\",\n        )?\n    }\n\n    if !contract.primary_exchange.is_empty() {\n        client.check_server_version(\n            server_versions::LINKING,\n            \"It does not support primary_exchange parameter when requesting contract details.\",\n        )?\n    }\n\n    if !contract.issuer_id.is_empty() {\n        client.check_server_version(\n            server_versions::BOND_ISSUERID,\n            \"It does not support issuer_id parameter when requesting contract details.\",\n        )?\n    }\n\n    Ok(())\n}\n\n/// Contract data and list of derivative security types\n#[derive(Debug)]\npub struct ContractDescription {\n    pub contract: Contract,\n    pub derivative_security_types: Vec\u003cString\u003e,\n}\n\n/// Requests matching stock symbols.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `pattern` - Either start of ticker symbol or (for larger strings) company name.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::Client;\n/// use ibapi::contracts;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let contracts = contracts::matching_symbols(\u0026mut client, \"IB\")?;\n///\n///     for contract in \u0026contracts {\n///         println!(\"contract: {:?}\", contract);\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn matching_symbols(client: \u0026mut Client, pattern: \u0026str) -\u003e Result\u003cVec\u003cContractDescription\u003e\u003e {\n    client.check_server_version(server_versions::REQ_MATCHING_SYMBOLS, \"It does not support mathing symbols requests.\")?;\n\n    let request_id = client.next_request_id();\n    let request = encoders::request_matching_symbols(request_id, pattern)?;\n\n    let mut responses = client.send_request(request_id, request)?;\n\n    if let Some(mut message) = responses.next() {\n        match message.message_type() {\n            IncomingMessages::SymbolSamples =\u003e {\n                return decoders::contract_descriptions(client.server_version(), \u0026mut message);\n            }\n            IncomingMessages::Error =\u003e {\n                error!(\"unexpected error: {:?}\", message);\n                return Err(anyhow!(\"unexpected error: {:?}\", message));\n            }\n            _ =\u003e {\n                info!(\"unexpected message: {:?}\", message);\n                return Err(anyhow!(\"unexpected message: {:?}\", message));\n            }\n        }\n    }\n\n    Ok(Vec::default())\n}\n\n#[derive(Debug, Default)]\npub struct MarketRule {\n    pub market_rule_id: i32,\n    pub price_increments: Vec\u003cPriceIncrement\u003e,\n}\n\n#[derive(Debug, Default)]\npub struct PriceIncrement {\n    pub low_edge: f64,\n    pub increment: f64,\n}\n\n/// Requests details about a given market rule\n///\n/// The market rule for an instrument on a particular exchange provides details about how the minimum price increment changes with price.\n/// A list of market rule ids can be obtained by invoking [request_contract_details] on a particular contract. The returned market rule ID list will provide the market rule ID for the instrument in the correspond valid exchange list in [ContractDetails].\npub fn market_rule(client: \u0026mut Client, market_rule_id: i32) -\u003e Result\u003cMarketRule\u003e {\n    client.check_server_version(server_versions::MARKET_RULES, \"It does not support market rule requests.\")?;\n\n    let request = encoders::request_market_rule(market_rule_id)?;\n\n    let mut responses = client.request_market_rule(request)?;\n\n    match responses.next() {\n        Some(mut message) =\u003e Ok(decoders::market_rule(\u0026mut message)?),\n        None =\u003e Err(anyhow!(\"no market rule found\")),\n    }\n}\n","traces":[{"line":54,"address":[],"length":0,"stats":{"Line":23},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":23},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":23},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":23},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":190,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":232,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":238,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":239,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":240,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":242,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":361,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":362,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":366,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":403,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":405,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":407,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":411,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":412,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":414,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":417,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":420,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":424,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":429,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":432,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":433,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":435,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":441,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":447,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":454,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":455,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":461,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":496,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":498,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":499,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":504,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":506,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":509,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":510,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":513,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":514,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":519,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":539,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":541,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":543,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":545,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":546,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":547,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":63,"coverable":116},{"path":["/","Users","wboayue","projects","rust-ibapi","src","domain.rs"],"content":"pub struct DepthMktDataDescription {\n    pub exchange: String,\n    pub sec_type: String,\n    pub listing_exch: String,\n    pub service_data_type: String,\n    pub agg_group: i32,\n}\n\npub struct SmartComponent {\n    pub bit_number: i32,\n    pub exchange: String,\n    pub exchange_letter: String,\n}\n\npub struct TickAttrib {\n    pub can_auto_execute: bool,\n    pub past_limit: bool,\n    pub pre_open: bool,\n}\n\npub struct TickAttribBidAsk {\n    pub bid_past_low: bool,\n    pub ask_past_high: bool,\n}\n\npub struct TickAttribLast {\n    pub past_limit: bool,\n    pub unreported: bool,\n}\n\npub struct FamilyCode {\n    pub account_id: String,\n    pub family_code_str: String,\n}\n\n#[derive(Clone, Debug)]\npub struct NewsProvider {\n    pub code: String,\n    pub name: String,\n}\n\npub enum ComboParam {\n    NonGuaranteed,\n    PriceCondConid,\n    CondPriceMax,\n    CondPriceMin,\n    ChangeToMktTime1,\n    ChangeToMktTime2,\n    DiscretionaryPct,\n    DontLeginNext,\n    LeginPrio,\n    MaxSegSize,\n}\n\npub enum HedgeType {\n    None,\n    Delta,\n    Beta,\n    Fx,\n    Pair,\n}\n\npub enum Right {\n    None,\n    Put,\n    Call,\n}\n\npub enum VolatilityType {\n    None,\n    Daily,\n    Annual,\n}\n\npub enum ReferencePriceType {\n    None,\n    Midpoint,\n    BidOrAsk,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","lib.rs"],"content":"//! [![github]](https://github.com/wboayue/rust-ibapi)\u0026ensp;[![crates-io]](https://crates.io/crates/ibapi)\n//!\n//! [github]: https://img.shields.io/badge/github-8da0cb?style=for-the-badge\u0026labelColor=555555\u0026logo=github\n//! [crates-io]: https://img.shields.io/badge/crates.io-fc8d62?style=for-the-badge\u0026labelColor=555555\u0026logo=rust\n//!\n//! \u003cbr\u003e\n//!\n//! A wrapper around the procedural macro API of the compiler's [`proc_macro`]\n//! crate. This library serves two purposes:\n//!\n//! [`proc_macro`]: https://doc.rust-lang.org/proc_macro/\n//! Fast and easy queue abstraction.\n//!```no_run\n//!     use anyhow;\n//!     use ibapi::client::Client;     \n//!     \n//!     fn main() -\u003e anyhow::Result\u003c()\u003e {\n//!         let client = Client::connect(\"localhost:4002:100\")?;\n//!         println!(\"Client: {:?}\", client);\n//!         Ok(())\n//!     }\n//!```\n/// TSW API Client.\npub mod client;\n\n/// Describes primary data structures used by the model.\npub mod domain;\n\n/// A [Contract] object represents trading instruments such as a stocks, futures or options.\n///\n/// Every time a new request that requires a contract (i.e. market data, order placing, etc.) is sent to the API, the system will try to match the provided contract object with a single candidate. If there is more than one contract matching the same description, the API will return an error notifying you there is an ambiguity. In these cases the API needs further information to narrow down the list of contracts matching the provided description to a single element.\npub mod contracts;\n\npub mod market_data;\n\n/// News\npub mod news;\n\n/// APIs for placing orders\npub mod orders;\n\n/// APIs for requesting account information\npub mod accounts;\n\nmod constants;\nmod messages;\nmod server_versions;\n\npub(crate) mod stubs;\n\n// TODO make public to crate only\npub trait ToField {\n    fn to_field(\u0026self) -\u003e String;\n}\n\nimpl ToField for bool {\n    fn to_field(\u0026self) -\u003e String {\n        if *self {\n            String::from(\"1\")\n        } else {\n            String::from(\"0\")\n        }\n    }\n}\n\nimpl ToField for String {\n    fn to_field(\u0026self) -\u003e String {\n        self.clone()\n    }\n}\n\nimpl ToField for \u0026str {\n    fn to_field(\u0026self) -\u003e String {\n        \u003c\u0026str\u003e::clone(self).to_string()\n    }\n}\n\nimpl ToField for usize {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for i32 {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003ci32\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl ToField for f64 {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003cf64\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nfn encode_option_field\u003cT: ToField\u003e(val: \u0026Option\u003cT\u003e) -\u003e String {\n    match val {\n        Some(val) =\u003e val.to_field(),\n        None =\u003e String::from(\"\"),\n    }\n}\n","traces":[{"line":57,"address":[],"length":0,"stats":{"Line":77},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":77},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":66},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":198},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":198},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":82},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":82},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":30},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":30},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":20},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":20},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":62},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":62},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":109},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":109},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":19},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":90},"fn_name":null}],"covered":22,"coverable":22},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","historical","tests.rs"],"content":"use crate::stubs::MessageBusStub;\n\nuse super::*;\n\n#[test]\nfn test_head_timestamp() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    // client.response_packets = VecDeque::from([ResponseMessage::from(\"10\\x0000\\x00cc\")]);\n\n    let contract = Contract::stock(\"MSFT\");\n    let what_to_show = \"trades\";\n    let use_rth = true;\n\n    let result = super::head_timestamp(\u0026mut client, \u0026contract, what_to_show, use_rth);\n\n    // match result {\n    //     Err(error) =\u003e assert_eq!(error.to_string(), \"\"),\n    //     Ok(head_timestamp) =\u003e assert_eq!(head_timestamp, OffsetDateTime::now_utc()),\n    // };\n\n    // assert_eq!(client.request_packets.len(), 1);\n\n    // let packet = \u0026client.request_packets[0];\n\n    // assert_eq!(packet[0], \"hh\");\n    // assert_eq!(packet[1], \"hh\");\n}\n\n#[test]\nfn histogram_data() {\n    let result = 2 + 2;\n    assert_eq!(result, 4);\n}\n\n#[test]\nfn historical_data() {\n    let result = 2 + 2;\n    assert_eq!(result, 4);\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","historical.rs"],"content":"use std::fmt::Debug;\n\nuse anyhow::{anyhow, Result};\nuse time::OffsetDateTime;\n\nuse crate::client::{Client, RequestMessage, ResponseMessage};\nuse crate::contracts::Contract;\nuse crate::domain::TickAttribBidAsk;\nuse crate::server_versions;\n\n// https://github.com/InteractiveBrokers/tws-api/blob/master/source/csharpclient/client/EClient.cs\n// https://github.com/InteractiveBrokers/tws-api/blob/master/source/csharpclient/client/EDecoder.cs#L733\n\n/// Returns the timestamp of earliest available historical data for a contract and data type.\n/// ```no_run\n///     use anyhow::Result;\n///     use ibapi::client::Client;\n///     use ibapi::contracts::{self, Contract};\n///     use ibapi::market_data::historical;\n///\n///     fn main() -\u003e Result\u003c()\u003e {\n///         let mut client = Client::connect(\"localhost:4002\")?;\n///\n///         let contract = Contract::stock(\"MSFT\");\n///         let what_to_show = \"trades\";\n///         let use_rth = true;\n///\n///         let result =\n///             historical::head_timestamp(\u0026mut client, \u0026contract, what_to_show, use_rth);\n///\n///         print!(\"head_timestamp: {result:?}\");\n///         Ok(())\n///     }\n/// ```\npub fn head_timestamp(client: \u0026mut Client, contract: \u0026Contract, what_to_show: \u0026str, use_rth: bool) -\u003e Result\u003cOffsetDateTime\u003e {\n    client.check_server_version(server_versions::REQ_HEAD_TIMESTAMP, \"It does not support head time stamp requests.\")?;\n\n    let request_id = client.next_request_id();\n    let request = encode_head_timestamp(request_id, contract, what_to_show, use_rth)?;\n\n    let mut promise = client.send_request(request_id, request)?;\n\n    if let Some(mut response) = promise.next() {\n        decode_head_timestamp(\u0026mut response)\n    } else {\n        Err(anyhow!(\"did not receive head timestamp message\"))\n    }\n}\n\n/// Encodes the head timestamp request\npub fn encode_head_timestamp(request_id: i32, contract: \u0026Contract, what_to_show: \u0026str, use_rth: bool) -\u003e Result\u003cRequestMessage\u003e {\n    let mut packet = RequestMessage::default();\n\n    packet.push_field(\u002612);\n    packet.push_field(\u0026request_id);\n    contract.push_fields(\u0026mut packet);\n    packet.push_field(\u0026use_rth);\n    packet.push_field(\u0026what_to_show);\n    packet.push_field(\u0026\"format_date\");\n\n    // source.AddParameter(value.ConId);\n    // source.AddParameter(value.Symbol);\n    // source.AddParameter(value.SecType);\n    // source.AddParameter(value.LastTradeDateOrContractMonth);\n    // source.AddParameter(value.Strike);\n    // source.AddParameter(value.Right);\n    // source.AddParameter(value.Multiplier);\n    // source.AddParameter(value.Exchange);\n    // source.AddParameter(value.PrimaryExch);\n    // source.AddParameter(value.Currency);\n    // source.AddParameter(value.LocalSymbol);\n    // source.AddParameter(value.TradingClass);\n    // source.AddParameter(value.IncludeExpired);\n\n    Ok(packet)\n}\n\n// https://github.com/InteractiveBrokers/tws-api/blob/313c453bfc1a1f8928b0d2fba044947f4c37e380/source/csharpclient/client/IBParamsList.cs#L56\n\n// public static void AddParameter(this BinaryWriter source, Contract value)\n// {\n//     source.AddParameter(value.ConId);\n//     source.AddParameter(value.Symbol);\n//     source.AddParameter(value.SecType);\n//     source.AddParameter(value.LastTradeDateOrContractMonth);\n//     source.AddParameter(value.Strike);\n//     source.AddParameter(value.Right);\n//     source.AddParameter(value.Multiplier);\n//     source.AddParameter(value.Exchange);\n//     source.AddParameter(value.PrimaryExch);\n//     source.AddParameter(value.Currency);\n//     source.AddParameter(value.LocalSymbol);\n//     source.AddParameter(value.TradingClass);\n//     source.AddParameter(value.IncludeExpired);\n// }\n\nfn decode_head_timestamp(packet: \u0026mut ResponseMessage) -\u003e Result\u003cOffsetDateTime\u003e {\n    let _request_id = packet.next_int()?;\n    let head_timestamp = packet.next_date_time()?;\n\n    Ok(head_timestamp)\n}\n\n/// Returns data histogram of specified contract\npub fn histogram_data(client: \u0026Client, contract: \u0026Contract, use_rth: bool, period: \u0026str) -\u003e Result\u003cHistogramDataIterator\u003e {\n    // \" S (seconds) - \" D (days)\n    // \" W (weeks) - \" M (months)\n    // \" Y (years)\n    print!(\"{client:?} {contract:?} {use_rth:?} {period:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\n#[allow(clippy::too_many_arguments)]\npub fn historical_data(\n    client: \u0026Client,\n    contract: \u0026Contract,\n    end: \u0026OffsetDateTime,\n    duration: \u0026str,\n    bar_size: \u0026str,\n    what_to_show: \u0026str,\n    use_rth: bool,\n    keep_up_to_date: bool,\n) -\u003e Result\u003cBarIterator\u003e {\n    // https://interactivebrokers.github.io/tws-api/historical_bars.html#hd_duration\n    // https://interactivebrokers.github.io/tws-api/historical_bars.html#hd_barsize\n    // https://interactivebrokers.github.io/tws-api/historical_bars.html#hd_what_to_show\n    print!(\"{client:?} {contract:?} {end:?} {duration:?} {bar_size:?} {what_to_show:?} {use_rth:?} {keep_up_to_date:?}\");\n\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub fn historical_schedule(client: \u0026Client, contract: \u0026Contract, use_rth: bool, period: \u0026str) -\u003e Result\u003cHistogramDataIterator\u003e {\n    print!(\"{client:?} {contract:?} {use_rth:?} {period:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub fn historical_ticks(\n    client: \u0026Client,\n    contract: \u0026Contract,\n    start_date: Option\u003cOffsetDateTime\u003e,\n    end_date: Option\u003cOffsetDateTime\u003e,\n    number_of_ticks: i32,\n    use_rth: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cHistoricalTickIterator\u003e {\n    print!(\"{client:?} {contract:?} {start_date:?} {end_date:?} {number_of_ticks:?} {use_rth:?} {ignore_size:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub fn historical_ticks_bid_ask(\n    client: \u0026Client,\n    contract: \u0026Contract,\n    start_date: Option\u003cOffsetDateTime\u003e,\n    end_date: Option\u003cOffsetDateTime\u003e,\n    number_of_ticks: i32,\n    use_rth: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cHistoricalTickBidAskIterator\u003e {\n    print!(\"{client:?} {contract:?} {start_date:?} {end_date:?} {number_of_ticks:?} {use_rth:?} {ignore_size:?}\");\n\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub fn historical_ticks_last(\n    client: \u0026Client,\n    contract: \u0026Contract,\n    start_date: Option\u003cOffsetDateTime\u003e,\n    end_date: Option\u003cOffsetDateTime\u003e,\n    number_of_ticks: i32,\n    use_rth: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cHistoricalTickLastIterator\u003e {\n    print!(\"{client:?} {contract:?} {start_date:?} {end_date:?} {number_of_ticks:?} {use_rth:?} {ignore_size:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub struct HistoricalTick {\n    pub time: i32,\n    pub price: f64,\n    pub size: i32,\n}\n\npub struct HistoricalTickBidAsk {\n    pub time: i32,\n    pub tick_attrib_bid_ask: TickAttribBidAsk,\n    pub price_bid: f64,\n    pub price_ask: f64,\n    pub size_bid: i32,\n    pub size_ask: i32,\n}\n\npub struct HistoricalTickLast {\n    pub time: i32,\n    pub price: f64,\n    pub size: i32,\n}\n\n#[derive(Default)]\npub struct HistoricalTickIterator {}\n\nimpl HistoricalTickIterator {\n    pub fn new() -\u003e HistoricalTickIterator {\n        HistoricalTickIterator {}\n    }\n}\n\nimpl Iterator for HistoricalTickIterator {\n    // we will be counting with usize\n    type Item = HistoricalTick;\n\n    // next() is the only required method\n    fn next(\u0026mut self) -\u003e Option\u003cHistoricalTick\u003e {\n        None\n    }\n}\n\npub struct HistoricalTickBidAskIterator {}\n\npub struct HistoricalTickLastIterator {}\n\npub struct HistogramData {}\npub struct HistogramDataIterator {}\n\npub struct Bar {\n    pub time: OffsetDateTime,\n    pub open: f64,\n    pub high: f64,\n    pub low: f64,\n    pub close: f64,\n    pub volume: f64,\n    pub wap: f64,\n    pub count: i32,\n}\n\npub struct BarIterator {}\n// https://interactivebrokers.github.io/tws-api/classIBApi_1_1Bar.html\n\npub struct HistoricalSchedule {\n    //    string startDateTime, string endDateTime, string timeZone, HistoricalSession[]\n}\n\n#[cfg(test)]\nmod tests;\n","traces":[{"line":36,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":212,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":213,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":32,"coverable":60},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","realtime","decoders.rs"],"content":"use anyhow::{self, Result};\nuse time::OffsetDateTime;\n\nuse crate::{\n    client::ResponseMessage,\n    market_data::{BidAsk, BidAskAttribute, MidPoint, RealTimeBar, Trade, TradeAttribute},\n};\n\npub fn decode_realtime_bar(message: \u0026mut ResponseMessage) -\u003e Result\u003cRealTimeBar\u003e {\n    message.skip(); // message type\n    message.skip(); // message version\n    message.skip(); // message request id\n\n    let date = message.next_long()?; // long, convert to date\n    let date = OffsetDateTime::from_unix_timestamp(date).unwrap();\n\n    Ok(RealTimeBar {\n        date,\n        open: message.next_double()?,\n        high: message.next_double()?,\n        low: message.next_double()?,\n        close: message.next_double()?,\n        volume: message.next_double()?,\n        wap: message.next_double()?,\n        count: message.next_int()?,\n    })\n}\n\npub fn trade_tick(message: \u0026mut ResponseMessage) -\u003e Result\u003cTrade\u003e {\n    message.skip(); // message type\n    message.skip(); // message request id\n\n    let tick_type = message.next_int()?;\n    if !(tick_type == 1 || tick_type == 2) {\n        return Err(anyhow::anyhow!(\"Unexpected tick_type: {tick_type}\"));\n    }\n\n    let date = message.next_long()?; // long, convert to date\n    let date = OffsetDateTime::from_unix_timestamp(date).unwrap();\n    let price = message.next_double()?;\n    let size = message.next_long()?;\n    let mask = message.next_int()?;\n    let exchange = message.next_string()?;\n    let special_conditions = message.next_string()?;\n\n    Ok(Trade {\n        tick_type: tick_type.to_string(),\n        time: date,\n        price,\n        size,\n        trade_attribute: TradeAttribute {\n            past_limit: mask \u0026 0x1 != 0,\n            unreported: mask \u0026 0x2 != 0,\n        },\n        exchange,\n        special_conditions,\n    })\n}\n\npub fn bid_ask_tick(message: \u0026mut ResponseMessage) -\u003e Result\u003cBidAsk\u003e {\n    message.skip(); // message type\n    message.skip(); // message request id\n\n    let tick_type = message.next_int()?;\n    if tick_type != 3 {\n        return Err(anyhow::anyhow!(\"Unexpected tick_type: {tick_type}\"));\n    }\n\n    let date = message.next_long()?; // long, convert to date\n    let date = OffsetDateTime::from_unix_timestamp(date).unwrap();\n    let bid_price = message.next_double()?;\n    let ask_price = message.next_double()?;\n    let bid_size = message.next_long()?;\n    let ask_size = message.next_long()?;\n    let mask = message.next_int()?;\n\n    Ok(BidAsk {\n        time: date,\n        bid_price,\n        ask_price,\n        bid_size,\n        ask_size,\n        bid_ask_attribute: BidAskAttribute {\n            bid_past_low: mask \u0026 0x1 != 0,\n            ask_past_high: mask \u0026 0x2 != 0,\n        },\n    })\n}\n\npub fn mid_point_tick(message: \u0026mut ResponseMessage) -\u003e Result\u003cMidPoint\u003e {\n    message.skip(); // message type\n    message.skip(); // message request id\n\n    let tick_type = message.next_int()?;\n    if tick_type != 4 {\n        return Err(anyhow::anyhow!(\"Unexpected tick_type: {tick_type}\"));\n    }\n\n    let date = message.next_long()?; // long, convert to date\n    let date = OffsetDateTime::from_unix_timestamp(date).unwrap();\n\n    let mid_point = message.next_double()?;\n\n    Ok(MidPoint { time: date, mid_point })\n}\n\nmod tests {\n    use super::*;\n\n    #[test]\n    fn decode_trade() {\n        let mut message = ResponseMessage::from(\"99\\09000\\01\\01678740829\\03895.25\\07\\02\\0\\0\\0\");\n\n        let results = trade_tick(\u0026mut message);\n\n        if let Ok(trade) = results {\n            assert_eq!(trade.tick_type, \"1\", \"trade.tick_type\");\n            assert_eq!(trade.time, OffsetDateTime::from_unix_timestamp(1678740829).unwrap(), \"trade.time\");\n            assert_eq!(trade.price, 3895.25, \"trade.price\");\n            assert_eq!(trade.size, 7, \"trade.size\");\n            assert_eq!(trade.trade_attribute.past_limit, false, \"trade.trade_attribute.past_limit\");\n            assert_eq!(trade.trade_attribute.unreported, true, \"trade.trade_attribute.unreported\");\n            assert_eq!(trade.exchange, \"\", \"trade.exchange\");\n            assert_eq!(trade.special_conditions, \"\", \"trade.special_conditions\");\n        } else if let Err(err) = results {\n            assert!(false, \"error decoding trade tick: {err}\");\n        }\n    }\n\n    #[test]\n    fn decode_bid_ask() {\n        let mut message = ResponseMessage::from(\"99\\09000\\03\\01678745793\\03895.50\\03896.00\\09\\011\\01\\0\");\n\n        let results = bid_ask_tick(\u0026mut message);\n\n        if let Ok(bid_ask) = results {\n            assert_eq!(bid_ask.time, OffsetDateTime::from_unix_timestamp(01678745793).unwrap(), \"bid_ask.time\");\n            assert_eq!(bid_ask.bid_price, 3895.5, \"bid_ask.bid_price\");\n            assert_eq!(bid_ask.ask_price, 3896.0, \"bid_ask.ask_price\");\n            assert_eq!(bid_ask.bid_size, 9, \"bid_ask.bid_size\");\n            assert_eq!(bid_ask.ask_size, 11, \"bid_ask.ask_size\");\n            assert_eq!(bid_ask.bid_ask_attribute.bid_past_low, true, \"bid_ask.bid_ask_attribute.bid_past_low\");\n            assert_eq!(bid_ask.bid_ask_attribute.ask_past_high, false, \"bid_ask.bid_ask_attribute.ask_past_high\");\n        } else if let Err(err) = results {\n            assert!(false, \"error decoding trade tick: {err}\");\n        }\n    }\n\n    #[test]\n    fn decode_mid_point() {\n        let mut message = ResponseMessage::from(\"99\\09000\\04\\01678746113\\03896.875\\0\");\n\n        let results = mid_point_tick(\u0026mut message);\n\n        if let Ok(mid_point) = results {\n            assert_eq!(mid_point.time, OffsetDateTime::from_unix_timestamp(1678746113).unwrap(), \"mid_point.time\");\n            assert_eq!(mid_point.mid_point, 3896.875, \"mid_point.mid_point\");\n        } else if let Err(err) = results {\n            assert!(false, \"error decoding mid point tick: {err}\");\n        }\n    }\n}\n","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":12,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":67,"coverable":70},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","realtime","encoders.rs"],"content":"use anyhow::Result;\n\nuse super::{BarSize, WhatToShow};\nuse crate::client::RequestMessage;\nuse crate::contracts::Contract;\nuse crate::messages::OutgoingMessages;\nuse crate::orders::TagValue;\nuse crate::server_versions;\n\npub fn encode_request_realtime_bars(\n    server_version: i32,\n    ticker_id: i32,\n    contract: \u0026Contract,\n    bar_size: \u0026BarSize,\n    what_to_show: \u0026WhatToShow,\n    use_rth: bool,\n    options: Vec\u003cTagValue\u003e,\n) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 8;\n\n    let mut packet = RequestMessage::default();\n\n    packet.push_field(\u0026OutgoingMessages::RequestRealTimeBars);\n    packet.push_field(\u0026VERSION);\n    packet.push_field(\u0026ticker_id);\n\n    if server_version \u003e= server_versions::TRADING_CLASS {\n        packet.push_field(\u0026contract.contract_id);\n    }\n\n    packet.push_field(\u0026contract.symbol);\n    packet.push_field(\u0026contract.security_type);\n    packet.push_field(\u0026contract.last_trade_date_or_contract_month);\n    packet.push_field(\u0026contract.strike);\n    packet.push_field(\u0026contract.right);\n    packet.push_field(\u0026contract.multiplier);\n    packet.push_field(\u0026contract.exchange);\n    packet.push_field(\u0026contract.primary_exchange);\n    packet.push_field(\u0026contract.currency);\n    packet.push_field(\u0026contract.local_symbol);\n\n    if server_version \u003e= server_versions::TRADING_CLASS {\n        packet.push_field(\u0026contract.trading_class);\n    }\n\n    packet.push_field(\u00260); // bar size -- not used\n    packet.push_field(\u0026what_to_show.to_string());\n    packet.push_field(\u0026use_rth);\n\n    if server_version \u003e= server_versions::LINKING {\n        packet.push_field(\u0026options);\n    }\n\n    Ok(packet)\n}\n\npub fn cancel_realtime_bars(request_id: i32) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::CancelRealTimeBars);\n    message.push_field(\u0026VERSION);\n    message.push_field(\u0026request_id);\n\n    Ok(message)\n}\n\npub fn tick_by_tick(\n    server_version: i32,\n    request_id: i32,\n    contract: \u0026Contract,\n    tick_type: \u0026str,\n    number_of_ticks: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::ReqTickByTickData);\n    message.push_field(\u0026request_id);\n    message.push_field(\u0026contract.contract_id);\n    message.push_field(\u0026contract.symbol);\n    message.push_field(\u0026contract.security_type);\n    message.push_field(\u0026contract.last_trade_date_or_contract_month);\n    message.push_field(\u0026contract.strike);\n    message.push_field(\u0026contract.right);\n    message.push_field(\u0026contract.multiplier);\n    message.push_field(\u0026contract.exchange);\n    message.push_field(\u0026contract.primary_exchange);\n    message.push_field(\u0026contract.currency);\n    message.push_field(\u0026contract.local_symbol);\n    message.push_field(\u0026contract.trading_class);\n    message.push_field(\u0026tick_type);\n\n    if server_version \u003e= server_versions::TICK_BY_TICK_IGNORE_SIZE {\n        message.push_field(\u0026number_of_ticks);\n        message.push_field(\u0026ignore_size);\n    }\n\n    Ok(message)\n}\n\npub fn cancel_tick_by_tick(request_id: i32) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::CancelTickByTickData);\n    message.push_field(\u0026request_id);\n\n    Ok(message)\n}\n\n#[cfg(test)]\nmod tests {\n    use crate::{contracts::contract_samples, ToField};\n\n    use super::*;\n\n    #[test]\n    fn cancel_tick_by_tick() {\n        let request_id = 9000;\n\n        let results = super::cancel_tick_by_tick(request_id);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message[0], \"98\", \"message.type\");\n                assert_eq!(message[1], request_id.to_string(), \"message.request_id\");\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding cancel_tick_by_tick request: {err}\");\n            }\n        }\n    }\n\n    #[test]\n    fn cancel_realtime_bars() {\n        let request_id = 9000;\n\n        let results = super::cancel_realtime_bars(request_id);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message[0], OutgoingMessages::CancelRealTimeBars.to_field(), \"message.type\");\n                assert_eq!(message[1], \"1\", \"message.version\");\n                assert_eq!(message[2], request_id.to_string(), \"message.request_id\");\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding cancel_tick_by_tick request: {err}\");\n            }\n        }\n    }\n\n    #[test]\n    fn tick_by_tick() {\n        let request_id = 9000;\n        let server_version = server_versions::TICK_BY_TICK;\n        let contract = contract_samples::simple_future();\n        let tick_type = \"AllLast\";\n        let number_of_ticks = 1;\n        let ignore_size = true;\n\n        let results = super::tick_by_tick(server_version, request_id, \u0026contract, tick_type, number_of_ticks, ignore_size);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message[0], OutgoingMessages::ReqTickByTickData.to_field(), \"message.type\");\n                assert_eq!(message[1], request_id.to_field(), \"message.request_id\");\n                assert_eq!(message[2], contract.contract_id.to_field(), \"message.contract_id\");\n                assert_eq!(message[3], contract.symbol, \"message.symbol\");\n                assert_eq!(message[4], contract.security_type.to_field(), \"message.security_type\");\n                assert_eq!(\n                    message[5], contract.last_trade_date_or_contract_month,\n                    \"message.last_trade_date_or_contract_month\"\n                );\n                assert_eq!(message[6], contract.strike.to_field(), \"message.strike\");\n                assert_eq!(message[7], contract.right, \"message.right\");\n                assert_eq!(message[8], contract.multiplier, \"message.multiplier\");\n                assert_eq!(message[9], contract.exchange, \"message.exchange\");\n                assert_eq!(message[10], contract.primary_exchange, \"message.primary_exchange\");\n                assert_eq!(message[11], contract.currency, \"message.currency\");\n                assert_eq!(message[12], contract.local_symbol, \"message.local_symbol\");\n                assert_eq!(message[13], contract.trading_class, \"message.trading_class\");\n                assert_eq!(message[14], tick_type, \"message.tick_type\");\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding tick_by_tick request: {err}\");\n            }\n        }\n    }\n\n    #[test]\n    fn realtime_bars() {\n        let request_id = 9000;\n        let server_version = server_versions::TICK_BY_TICK;\n        let contract = contract_samples::simple_future();\n        let bar_size = BarSize::Secs5;\n        let what_to_show = WhatToShow::Trades;\n        let use_rth = true;\n        let options = vec![];\n\n        let results = super::encode_request_realtime_bars(server_version, request_id, \u0026contract, \u0026bar_size, \u0026what_to_show, use_rth, options);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message[0], OutgoingMessages::RequestRealTimeBars.to_field(), \"message.type\");\n                assert_eq!(message[1], \"8\", \"message.version\");\n                assert_eq!(message[2], request_id.to_field(), \"message.request_id\");\n                assert_eq!(message[3], contract.contract_id.to_field(), \"message.contract_id\");\n                assert_eq!(message[4], contract.symbol, \"message.symbol\");\n                assert_eq!(message[5], contract.security_type.to_field(), \"message.security_type\");\n                assert_eq!(\n                    message[6], contract.last_trade_date_or_contract_month,\n                    \"message.last_trade_date_or_contract_month\"\n                );\n                assert_eq!(message[7], contract.strike.to_field(), \"message.strike\");\n                assert_eq!(message[8], contract.right, \"message.right\");\n                assert_eq!(message[9], contract.multiplier, \"message.multiplier\");\n                assert_eq!(message[10], contract.exchange, \"message.exchange\");\n                assert_eq!(message[11], contract.primary_exchange, \"message.primary_exchange\");\n                assert_eq!(message[12], contract.currency, \"message.currency\");\n                assert_eq!(message[13], contract.local_symbol, \"message.local_symbol\");\n                assert_eq!(message[14], contract.trading_class, \"message.trading_class\");\n                assert_eq!(message[15], \"0\", \"message.bar_size\");\n                assert_eq!(message[16], what_to_show.to_field(), \"message.what_to_show\"); // implement to_field\n                assert_eq!(message[17], use_rth.to_field(), \"message.use_rth\");\n                assert_eq!(message[18], \"\", \"message.options\"); // TODO what should this be?\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding realtime_bars request: {err}\");\n            }\n        }\n    }\n}\n","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":55,"coverable":57},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","realtime","tests.rs"],"content":"use time::OffsetDateTime;\n\nuse super::*;\nuse crate::contracts::contract_samples;\nuse crate::messages::OutgoingMessages;\nuse crate::stubs::MessageBusStub;\nuse crate::ToField;\n\n#[test]\nfn realtime_bars() {\n    let message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"50|3|9001|1678323335|4028.75|4029.00|4028.25|4028.50|2|4026.75|1|\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let contract = contract_samples::future_with_local_symbol();\n    let bar_size = BarSize::Secs5;\n    let what_to_show = WhatToShow::Trades;\n    let use_rth = true;\n\n    let bars = super::realtime_bars(\u0026mut client, \u0026contract, \u0026bar_size, \u0026what_to_show, use_rth);\n    assert!(bars.is_ok(), \"failed to request realtime bars: {}\", bars.err().unwrap());\n\n    // Verify Responses\n    let mut bars = bars.unwrap();\n    if let Some(bar) = bars.next() {\n        let timestamp = OffsetDateTime::from_unix_timestamp(1678323335).unwrap();\n\n        assert_eq!(bar.date, timestamp, \"bar.date\");\n        assert_eq!(bar.open, 4028.75, \"bar.open\");\n        assert_eq!(bar.high, 4029.00, \"bar.high\");\n        assert_eq!(bar.low, 4028.25, \"bar.low\");\n        assert_eq!(bar.close, 4028.50, \"bar.close\");\n        assert_eq!(bar.volume, 2.0, \"bar.volume\");\n        assert_eq!(bar.wap, 4026.75, \"bar.wap\");\n        assert_eq!(bar.count, 1, \"bar.count\");\n    } else {\n        assert!(false, \"expected a real time bar\");\n    }\n\n    // Should trigger cancel realtime bars\n    drop(bars);\n\n    let request_messages = client.message_bus.request_messages();\n\n    // Verify Requests\n    let realtime_bars_request = \u0026request_messages[0];\n    assert_eq!(\n        realtime_bars_request[0],\n        OutgoingMessages::RequestRealTimeBars.to_field(),\n        \"message.message_type\"\n    );\n    assert_eq!(realtime_bars_request[1], \"8\", \"message.version\");\n    assert_eq!(realtime_bars_request[2], \"9000\", \"message.request_id\");\n    assert_eq!(realtime_bars_request[3], contract.contract_id.to_field(), \"message.contract_id\");\n    assert_eq!(realtime_bars_request[4], contract.symbol.to_field(), \"message.symbol\");\n    assert_eq!(realtime_bars_request[5], contract.security_type.to_field(), \"message.security_type\");\n    assert_eq!(\n        realtime_bars_request[6],\n        contract.last_trade_date_or_contract_month.to_field(),\n        \"message.last_trade_date_or_contract_month\"\n    );\n    assert_eq!(realtime_bars_request[7], contract.strike.to_field(), \"message.strike\");\n    assert_eq!(realtime_bars_request[8], contract.right.to_field(), \"message.right\");\n    assert_eq!(realtime_bars_request[9], contract.multiplier.to_field(), \"message.multiplier\");\n    assert_eq!(realtime_bars_request[10], contract.exchange.to_field(), \"message.exchange\");\n    assert_eq!(\n        realtime_bars_request[11],\n        contract.primary_exchange.to_field(),\n        \"message.primary_exchange\"\n    );\n    assert_eq!(realtime_bars_request[12], contract.currency.to_field(), \"message.currency\");\n    assert_eq!(realtime_bars_request[13], contract.local_symbol.to_field(), \"message.local_symbol\");\n    assert_eq!(realtime_bars_request[14], contract.trading_class.to_field(), \"message.trading_class\");\n    assert_eq!(realtime_bars_request[15], \"0\", \"message.bar_size\");\n    assert_eq!(realtime_bars_request[16], what_to_show.to_field(), \"message.what_to_show\");\n    assert_eq!(realtime_bars_request[17], use_rth.to_field(), \"message.use_rth\");\n    assert_eq!(realtime_bars_request[18], \"\", \"message.options\");\n\n    let cancel_request = \u0026request_messages[1];\n    assert_eq!(cancel_request[0], OutgoingMessages::CancelRealTimeBars.to_field(), \"message.message_type\");\n    assert_eq!(cancel_request[1], \"1\", \"message.version\");\n    assert_eq!(cancel_request[2], \"9000\", \"message.request_id\");\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","realtime.rs"],"content":"use anyhow::Result;\nuse log::error;\n\nuse crate::client::transport::ResponseIterator;\nuse crate::client::Client;\nuse crate::contracts::Contract;\nuse crate::messages::IncomingMessages;\nuse crate::orders::TagValue;\nuse crate::server_versions;\n\nuse super::{BarSize, BidAsk, MidPoint, RealTimeBar, Trade, WhatToShow};\n\nmod decoders;\nmod encoders;\n#[cfg(test)]\nmod tests;\n\n/// Requests realtime bars.\n///\n/// This method will provide all the contracts matching the contract provided. It can also be used to retrieve complete options and futures chains. Though it is now (in API version \u003e 9.72.12) advised to use reqSecDefOptParams for that purpose.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::Client;\n/// use ibapi::contracts::{self, Contract};\n/// use ibapi::market_data::{realtime, BarSize, WhatToShow};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let contract = Contract::stock(\"TSLA\");\n///     let bars = realtime::realtime_bars(\u0026mut client, \u0026contract, \u0026BarSize::Secs5, \u0026WhatToShow::Trades, false)?;\n///\n///     for (i, bar) in bars.enumerate() {\n///         println!(\"bar[{i}]: {bar:?}\");\n///\n///         if i \u003e 60 {\n///             break;\n///         }\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn realtime_bars\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    bar_size: \u0026BarSize,\n    what_to_show: \u0026WhatToShow,\n    use_rth: bool,\n) -\u003e Result\u003cRealTimeBarIterator\u003c'a\u003e\u003e {\n    realtime_bars_with_options(client, contract, bar_size, what_to_show, use_rth, Vec::default())\n}\n\n/// Requests realtime bars.\n///\n/// This method will provide all the contracts matching the contract provided. It can also be used to retrieve complete options and futures chains. Though it is now (in API version \u003e 9.72.12) advised to use reqSecDefOptParams for that purpose.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::Client;\n/// use ibapi::contracts::{self, Contract};\n/// use ibapi::market_data::{realtime, BarSize, WhatToShow};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let contract = Contract::stock(\"TSLA\");\n///     let bars = realtime::realtime_bars(\u0026mut client, \u0026contract, \u0026BarSize::Secs5, \u0026WhatToShow::Trades, false)?;\n///\n///     for (i, bar) in bars.enumerate() {\n///         println!(\"bar[{i}]: {bar:?}\");\n///\n///         if i \u003e 60 {\n///             break;\n///         }\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn realtime_bars_with_options\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    bar_size: \u0026BarSize,\n    what_to_show: \u0026WhatToShow,\n    use_rth: bool,\n    options: Vec\u003cTagValue\u003e,\n) -\u003e Result\u003cRealTimeBarIterator\u003c'a\u003e\u003e {\n    client.check_server_version(server_versions::REAL_TIME_BARS, \"It does not support real time bars.\")?;\n\n    if !contract.trading_class.is_empty() || contract.contract_id \u003e 0 {\n        client.check_server_version(\n            server_versions::TRADING_CLASS,\n            \"It does not support ConId nor TradingClass parameters in reqRealTimeBars.\",\n        )?;\n    }\n\n    let request_id = client.next_request_id();\n    let packet = encoders::encode_request_realtime_bars(client.server_version(), request_id, contract, bar_size, what_to_show, use_rth, options)?;\n\n    let responses = client.send_request(request_id, packet)?;\n\n    Ok(RealTimeBarIterator::new(client, request_id, responses))\n}\n\n/// Requests tick by tick AllLast ticks.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n/// * `number_of_ticks` - number of ticks.\n/// * `ignore_size` - ignore size flag.\npub fn tick_by_tick_all_last\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    number_of_ticks: i32,\n    ignore_size: bool,\n) -\u003e anyhow::Result\u003cTradeIterator\u003c'a\u003e\u003e {\n    validate_tick_by_tick_request(client, contract, number_of_ticks, ignore_size)?;\n\n    let server_version = client.server_version();\n    let request_id = client.next_request_id();\n\n    let message = encoders::tick_by_tick(server_version, request_id, contract, \"AllLast\", number_of_ticks, ignore_size)?;\n    let responses = client.send_request(request_id, message)?;\n\n    Ok(TradeIterator {\n        client,\n        request_id,\n        responses,\n    })\n}\n\n// Validates that server supports the given request.\nfn validate_tick_by_tick_request(client: \u0026Client, _contract: \u0026Contract, number_of_ticks: i32, ignore_size: bool) -\u003e anyhow::Result\u003c()\u003e {\n    client.check_server_version(server_versions::TICK_BY_TICK, \"It does not support tick-by-tick requests.\")?;\n\n    if number_of_ticks != 0 || ignore_size {\n        client.check_server_version(\n            server_versions::TICK_BY_TICK_IGNORE_SIZE,\n            \"It does not support ignoreSize and numberOfTicks parameters in tick-by-tick requests.\",\n        )?;\n    }\n\n    Ok(())\n}\n\n/// Requests tick by tick Last ticks.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n/// * `number_of_ticks` - number of ticks.\n/// * `ignore_size` - ignore size flag.\npub fn tick_by_tick_last\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    number_of_ticks: i32,\n    ignore_size: bool,\n) -\u003e anyhow::Result\u003cTradeIterator\u003c'a\u003e\u003e {\n    validate_tick_by_tick_request(client, contract, number_of_ticks, ignore_size)?;\n\n    let server_version = client.server_version();\n    let request_id = client.next_request_id();\n\n    let message = encoders::tick_by_tick(server_version, request_id, contract, \"Last\", number_of_ticks, ignore_size)?;\n    let responses = client.send_request(request_id, message)?;\n\n    Ok(TradeIterator {\n        client,\n        request_id,\n        responses,\n    })\n}\n\n/// Requests tick by tick BidAsk ticks.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n/// * `number_of_ticks` - number of ticks.\n/// * `ignore_size` - ignore size flag.\npub fn tick_by_tick_bid_ask\u003c'a\u003e(client: \u0026'a mut Client, contract: \u0026Contract, number_of_ticks: i32, ignore_size: bool) -\u003e Result\u003cBidAskIterator\u003c'a\u003e\u003e {\n    validate_tick_by_tick_request(client, contract, number_of_ticks, ignore_size)?;\n\n    let server_version = client.server_version();\n    let request_id = client.next_request_id();\n\n    let message = encoders::tick_by_tick(server_version, request_id, contract, \"BidAsk\", number_of_ticks, ignore_size)?;\n    let responses = client.send_request(request_id, message)?;\n\n    Ok(BidAskIterator {\n        client,\n        request_id,\n        responses,\n    })\n}\n\n/// Requests tick by tick MidPoint ticks.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n/// * `number_of_ticks` - number of ticks.\n/// * `ignore_size` - ignore size flag.\npub fn tick_by_tick_midpoint\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    number_of_ticks: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cMidPointIterator\u003c'a\u003e\u003e {\n    validate_tick_by_tick_request(client, contract, number_of_ticks, ignore_size)?;\n\n    let server_version = client.server_version();\n    let request_id = client.next_request_id();\n\n    let message = encoders::tick_by_tick(server_version, request_id, contract, \"MidPoint\", number_of_ticks, ignore_size)?;\n    let responses = client.send_request(request_id, message)?;\n\n    Ok(MidPointIterator {\n        client,\n        request_id,\n        responses,\n    })\n}\n\n// Iterators\n\n/// RealTimeBarIterator supports iteration over [RealTimeBar] ticks.\npub struct RealTimeBarIterator\u003c'a\u003e {\n    client: \u0026'a mut Client,\n    request_id: i32,\n    responses: ResponseIterator,\n}\n\nimpl\u003c'a\u003e RealTimeBarIterator\u003c'a\u003e {\n    fn new(client: \u0026'a mut Client, request_id: i32, responses: ResponseIterator) -\u003e RealTimeBarIterator\u003c'a\u003e {\n        RealTimeBarIterator {\n            client,\n            request_id,\n            responses,\n        }\n    }\n\n    /// Cancels request to stream realtime bars\n    fn cancel_realtime_bars(\u0026mut self) {\n        let message = encoders::cancel_realtime_bars(self.request_id).unwrap();\n\n        self.client.send_message(message).unwrap();\n\n        ()\n    }\n}\n\nimpl\u003c'a\u003e Iterator for RealTimeBarIterator\u003c'a\u003e {\n    type Item = RealTimeBar;\n\n    /// Advances the iterator and returns the next value.\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        if let Some(mut message) = self.responses.next() {\n            match message.message_type() {\n                IncomingMessages::RealTimeBars =\u003e {\n                    let decoded = decoders::decode_realtime_bar(\u0026mut message);\n\n                    if let Ok(bar) = decoded {\n                        return Some(bar);\n                    }\n\n                    error!(\"unexpected message: {:?}\", decoded.err());\n                    None\n                }\n                _ =\u003e {\n                    error!(\"unexpected message: {message:?}\");\n                    None\n                }\n            }\n        } else {\n            None\n        }\n    }\n}\n\nimpl\u003c'a\u003e Drop for RealTimeBarIterator\u003c'a\u003e {\n    fn drop(\u0026mut self) {\n        self.cancel_realtime_bars()\n    }\n}\n\n/// TradeIterator supports iteration over [Trade] ticks.\npub struct TradeIterator\u003c'a\u003e {\n    client: \u0026'a mut Client,\n    request_id: i32,\n    responses: ResponseIterator,\n}\n\nimpl\u003c'a\u003e Drop for TradeIterator\u003c'a\u003e {\n    // Ensures tick by tick request is cancelled\n    fn drop(\u0026mut self) {\n        cancel_tick_by_tick(self.client, self.request_id);\n    }\n}\n\nimpl\u003c'a\u003e Iterator for TradeIterator\u003c'a\u003e {\n    type Item = Trade;\n\n    /// Advances the iterator and returns the next value.\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            match self.responses.next() {\n                Some(mut message) =\u003e match message.message_type() {\n                    IncomingMessages::TickByTick =\u003e match decoders::trade_tick(\u0026mut message) {\n                        Ok(tick) =\u003e return Some(tick),\n                        Err(e) =\u003e error!(\"unexpected message {message:?}: {e:?}\"),\n                    },\n                    _ =\u003e error!(\"unexpected message {message:?}\"),\n                },\n                None =\u003e return None,\n            }\n        }\n    }\n}\n\n/// BidAskIterator supports iteration over [BidAsk] ticks.\npub struct BidAskIterator\u003c'a\u003e {\n    client: \u0026'a mut Client,\n    request_id: i32,\n    responses: ResponseIterator,\n}\n\n/// Cancels the tick by tick request\nfn cancel_tick_by_tick(client: \u0026mut Client, request_id: i32) {\n    if client.server_version() \u003e= server_versions::TICK_BY_TICK {\n        let message = encoders::cancel_tick_by_tick(request_id).unwrap();\n        client.send_message(message).unwrap();\n    }\n}\n\nimpl\u003c'a\u003e Drop for BidAskIterator\u003c'a\u003e {\n    // Ensures tick by tick request is cancelled\n    fn drop(\u0026mut self) {\n        cancel_tick_by_tick(self.client, self.request_id);\n    }\n}\n\nimpl\u003c'a\u003e Iterator for BidAskIterator\u003c'a\u003e {\n    type Item = BidAsk;\n\n    /// Advances the iterator and returns the next value.\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            match self.responses.next() {\n                Some(mut message) =\u003e match message.message_type() {\n                    IncomingMessages::TickByTick =\u003e match decoders::bid_ask_tick(\u0026mut message) {\n                        Ok(tick) =\u003e return Some(tick),\n                        Err(e) =\u003e error!(\"unexpected message {message:?}: {e:?}\"),\n                    },\n                    _ =\u003e error!(\"unexpected message {message:?}\"),\n                },\n                None =\u003e return None,\n            }\n        }\n    }\n}\n\n/// MidPointIterator supports iteration over [MidPoint] ticks.\npub struct MidPointIterator\u003c'a\u003e {\n    client: \u0026'a mut Client,\n    request_id: i32,\n    responses: ResponseIterator,\n}\n\nimpl\u003c'a\u003e Drop for MidPointIterator\u003c'a\u003e {\n    // Ensures tick by tick request is cancelled\n    fn drop(\u0026mut self) {\n        cancel_tick_by_tick(self.client, self.request_id);\n    }\n}\n\nimpl\u003c'a\u003e Iterator for MidPointIterator\u003c'a\u003e {\n    type Item = MidPoint;\n\n    /// Advances the iterator and returns the next value.\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            match self.responses.next() {\n                Some(mut message) =\u003e match message.message_type() {\n                    IncomingMessages::TickByTick =\u003e match decoders::mid_point_tick(\u0026mut message) {\n                        Ok(tick) =\u003e return Some(tick),\n                        Err(e) =\u003e error!(\"unexpected message {message:?}: {e:?}\"),\n                    },\n                    _ =\u003e error!(\"unexpected message {message:?}\"),\n                },\n                None =\u003e return None,\n            }\n        }\n    }\n}\n","traces":[{"line":50,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":203,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":206,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":225,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":228,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":229,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":232,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":233,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":248,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":258,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":270,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":271,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":272,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":273,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":274,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":276,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":277,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":280,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":283,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":284,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":296,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":309,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":321,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":326,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":328,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":342,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":343,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":344,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":345,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":351,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":352,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":360,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":361,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":362,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":365,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":366,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":368,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":370,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":385,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":396,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":397,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":398,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":404,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":19,"coverable":108},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","scanners.rs"],"content":"// request_scanner_sub","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data.rs"],"content":"use time::OffsetDateTime;\n\nuse crate::ToField;\n\npub mod historical;\npub mod realtime;\n\n#[derive(Clone, Debug)]\npub struct RealTimeBar {\n    pub date: OffsetDateTime,\n    pub open: f64,\n    pub high: f64,\n    pub low: f64,\n    pub close: f64,\n    pub volume: f64,\n    pub wap: f64,\n    pub count: i32,\n}\n\npub enum BarSize {\n    Secs5,\n}\n\npub enum WhatToShow {\n    Trades,\n    MidPoint,\n    Bid,\n    Ask,\n}\n\nimpl ToString for WhatToShow {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            Self::Trades =\u003e \"TRADES\".to_string(),\n            Self::MidPoint =\u003e \"MIDPOINT\".to_string(),\n            Self::Bid =\u003e \"BID\".to_string(),\n            Self::Ask =\u003e \"ASK\".to_string(),\n        }\n    }\n}\n\nimpl ToField for WhatToShow {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\n#[derive(Debug)]\npub struct BidAsk {\n    /// The spread's date and time (either as a yyyymmss hh:mm:ss formatted string or as system time according to the request). Time zone is the TWS time zone chosen on login.\n    pub time: OffsetDateTime,\n    /// tick-by-tick real-time tick bid price\n    pub bid_price: f64,\n    /// tick-by-tick real-time tick ask price\n    pub ask_price: f64,\n    /// tick-by-tick real-time tick bid size\n    pub bid_size: i64,\n    /// tick-by-tick real-time tick ask size\n    pub ask_size: i64,\n    /// tick-by-tick real-time bid/ask tick attribs (bit 0 - bid past low, bit 1 - ask past high)\n    pub bid_ask_attribute: BidAskAttribute,\n}\n\n#[derive(Debug)]\npub struct BidAskAttribute {\n    pub bid_past_low: bool,\n    pub ask_past_high: bool,\n}\n\n/// Bar describes the historical data bar.\npub struct Bar {\n    /// The bar's date and time (either as a yyyymmss hh:mm:ss formatted string or as system time according to the request). Time zone is the TWS time zone chosen on login.\n    pub time: OffsetDateTime,\n    /// The bar's open price.\n    pub open: f64,\n    /// The bar's high price.\n    pub high: f64,\n    /// The bar's low price.\n    pub low: f64,\n    /// The bar's close price.\n    pub close: f64,\n    /// The bar's traded volume if available (only available for TRADES)\n    pub volume: i64,\n    /// The bar's Weighted Average Price (only available for TRADES)\n    pub wap: f64,\n    /// The number of trades during the bar's timespan (only available for TRADES)\n    pub count: i32,\n}\n\n#[derive(Debug)]\npub struct Trade {\n    /// Tick type: \"Last\" or \"AllLast\"\n    pub tick_type: String,\n    /// The trade's date and time (either as a yyyymmss hh:mm:ss formatted string or as system time according to the request). Time zone is the TWS time zone chosen on login.\n    pub time: OffsetDateTime,\n    /// Tick last price\n    pub price: f64,\n    /// Tick last size\n    pub size: i64,\n    /// Tick attribs (bit 0 - past limit, bit 1 - unreported)\n    pub trade_attribute: TradeAttribute,\n    /// Tick exchange\n    pub exchange: String,\n    /// Tick special conditions\n    pub special_conditions: String,\n}\n\n#[derive(Debug)]\npub struct TradeAttribute {\n    pub past_limit: bool,\n    pub unreported: bool,\n}\n\n#[derive(Debug)]\npub struct HistogramData {\n    pub price: f64,\n    pub count: i32,\n}\n\n#[derive(Debug)]\npub struct MidPoint {\n    /// The trade's date and time (either as a yyyymmss hh:mm:ss formatted string or as system time according to the request). Time zone is the TWS time zone chosen on login.\n    pub time: OffsetDateTime,\n    /// mid point\n    pub mid_point: f64,\n}\n","traces":[{"line":32,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":2},"fn_name":null}],"covered":5,"coverable":8},{"path":["/","Users","wboayue","projects","rust-ibapi","src","messages.rs"],"content":"use crate::ToField;\n\n#[derive(Debug, PartialEq)]\npub enum IncomingMessages {\n    NotValid = -1,\n    TickPrice = 1,\n    TickSize = 2,\n    OrderStatus = 3,\n    Error = 4,\n    OpenOrder = 5,\n    AccountValue = 6,\n    PortfolioValue = 7,\n    AccountUpdateTime = 8,\n    NextValidId = 9,\n    ContractData = 10,\n    ExecutionData = 11,\n    MarketDepth = 12,\n    MarketDepthL2 = 13,\n    NewsBulletins = 14,\n    ManagedAccounts = 15,\n    ReceiveFA = 16,\n    HistoricalData = 17,\n    BondContractData = 18,\n    ScannerParameters = 19,\n    ScannerData = 20,\n    TickOptionComputation = 21,\n    TickGeneric = 45,\n    Tickstring = 46,\n    TickEFP = 47, //TICK EFP 47\n    CurrentTime = 49,\n    RealTimeBars = 50,\n    FundamentalData = 51,\n    ContractDataEnd = 52,\n    OpenOrderEnd = 53,\n    AccountDownloadEnd = 54,\n    ExecutionDataEnd = 55,\n    DeltaNeutralValidation = 56,\n    TickSnapshotEnd = 57,\n    MarketDataType = 58,\n    CommissionsReport = 59,\n    Position = 61,\n    PositionEnd = 62,\n    AccountSummary = 63,\n    AccountSummaryEnd = 64,\n    VerifyMessageApi = 65,\n    VerifyCompleted = 66,\n    DisplayGroupList = 67,\n    DisplayGroupUpdated = 68,\n    VerifyAndAuthMessageApi = 69,\n    VerifyAndAuthCompleted = 70,\n    PositionMulti = 71,\n    PositionMultiEnd = 72,\n    AccountUpdateMulti = 73,\n    AccountUpdateMultiEnd = 74,\n    SecurityDefinitionOptionParameter = 75,\n    SecurityDefinitionOptionParameterEnd = 76,\n    SoftDollarTier = 77,\n    FamilyCodes = 78,\n    SymbolSamples = 79,\n    MktDepthExchanges = 80,\n    TickReqParams = 81,\n    SmartComponents = 82,\n    NewsArticle = 83,\n    TickNews = 84,\n    NewsProviders = 85,\n    HistoricalNews = 86,\n    HistoricalNewsEnd = 87,\n    HeadTimestamp = 88,\n    HistogramData = 89,\n    HistoricalDataUpdate = 90,\n    RerouteMktDataReq = 91,\n    RerouteMktDepthReq = 92,\n    MarketRule = 93,\n    PnL = 94,\n    PnLSingle = 95,\n    HistoricalTick = 96,\n    HistoricalTickBidAsk = 97,\n    HistoricalTickLast = 98,\n    TickByTick = 99,\n    OrderBound = 100,\n    CompletedOrder = 101,\n    CompletedOrdersEnd = 102,\n    ReplaceFAEnd = 103,\n    WshMetaData = 104,\n    WshEventData = 105,\n    HistoricalSchedule = 106,\n    UserInfo = 107,\n}\n\nimpl From\u003ci32\u003e for IncomingMessages {\n    fn from(value: i32) -\u003e IncomingMessages {\n        match value {\n            1 =\u003e IncomingMessages::TickPrice,\n            2 =\u003e IncomingMessages::TickSize,\n            3 =\u003e IncomingMessages::OrderStatus,\n            4 =\u003e IncomingMessages::Error,\n            5 =\u003e IncomingMessages::OpenOrder,\n            6 =\u003e IncomingMessages::AccountValue,\n            7 =\u003e IncomingMessages::PortfolioValue,\n            8 =\u003e IncomingMessages::AccountUpdateTime,\n            9 =\u003e IncomingMessages::NextValidId,\n            10 =\u003e IncomingMessages::ContractData,\n            11 =\u003e IncomingMessages::ExecutionData,\n            12 =\u003e IncomingMessages::MarketDepth,\n            13 =\u003e IncomingMessages::MarketDepthL2,\n            14 =\u003e IncomingMessages::NewsBulletins,\n            15 =\u003e IncomingMessages::ManagedAccounts,\n            16 =\u003e IncomingMessages::ReceiveFA,\n            17 =\u003e IncomingMessages::HistoricalData,\n            18 =\u003e IncomingMessages::BondContractData,\n            19 =\u003e IncomingMessages::ScannerParameters,\n            20 =\u003e IncomingMessages::ScannerData,\n            21 =\u003e IncomingMessages::TickOptionComputation,\n            45 =\u003e IncomingMessages::TickGeneric,\n            46 =\u003e IncomingMessages::Tickstring,\n            47 =\u003e IncomingMessages::TickEFP, //TICK EFP 47\n            49 =\u003e IncomingMessages::CurrentTime,\n            50 =\u003e IncomingMessages::RealTimeBars,\n            51 =\u003e IncomingMessages::FundamentalData,\n            52 =\u003e IncomingMessages::ContractDataEnd,\n            53 =\u003e IncomingMessages::OpenOrderEnd,\n            54 =\u003e IncomingMessages::AccountDownloadEnd,\n            55 =\u003e IncomingMessages::ExecutionDataEnd,\n            56 =\u003e IncomingMessages::DeltaNeutralValidation,\n            57 =\u003e IncomingMessages::TickSnapshotEnd,\n            58 =\u003e IncomingMessages::MarketDataType,\n            59 =\u003e IncomingMessages::CommissionsReport,\n            61 =\u003e IncomingMessages::Position,\n            62 =\u003e IncomingMessages::PositionEnd,\n            63 =\u003e IncomingMessages::AccountSummary,\n            64 =\u003e IncomingMessages::AccountSummaryEnd,\n            65 =\u003e IncomingMessages::VerifyMessageApi,\n            66 =\u003e IncomingMessages::VerifyCompleted,\n            67 =\u003e IncomingMessages::DisplayGroupList,\n            68 =\u003e IncomingMessages::DisplayGroupUpdated,\n            69 =\u003e IncomingMessages::VerifyAndAuthMessageApi,\n            70 =\u003e IncomingMessages::VerifyAndAuthCompleted,\n            71 =\u003e IncomingMessages::PositionMulti,\n            72 =\u003e IncomingMessages::PositionMultiEnd,\n            73 =\u003e IncomingMessages::AccountUpdateMulti,\n            74 =\u003e IncomingMessages::AccountUpdateMultiEnd,\n            75 =\u003e IncomingMessages::SecurityDefinitionOptionParameter,\n            76 =\u003e IncomingMessages::SecurityDefinitionOptionParameterEnd,\n            77 =\u003e IncomingMessages::SoftDollarTier,\n            78 =\u003e IncomingMessages::FamilyCodes,\n            79 =\u003e IncomingMessages::SymbolSamples,\n            80 =\u003e IncomingMessages::MktDepthExchanges,\n            81 =\u003e IncomingMessages::TickReqParams,\n            82 =\u003e IncomingMessages::SmartComponents,\n            83 =\u003e IncomingMessages::NewsArticle,\n            84 =\u003e IncomingMessages::TickNews,\n            85 =\u003e IncomingMessages::NewsProviders,\n            86 =\u003e IncomingMessages::HistoricalNews,\n            87 =\u003e IncomingMessages::HistoricalNewsEnd,\n            88 =\u003e IncomingMessages::HeadTimestamp,\n            89 =\u003e IncomingMessages::HistogramData,\n            90 =\u003e IncomingMessages::HistoricalDataUpdate,\n            91 =\u003e IncomingMessages::RerouteMktDataReq,\n            92 =\u003e IncomingMessages::RerouteMktDepthReq,\n            93 =\u003e IncomingMessages::MarketRule,\n            94 =\u003e IncomingMessages::PnL,\n            95 =\u003e IncomingMessages::PnLSingle,\n            96 =\u003e IncomingMessages::HistoricalTick,\n            97 =\u003e IncomingMessages::HistoricalTickBidAsk,\n            98 =\u003e IncomingMessages::HistoricalTickLast,\n            99 =\u003e IncomingMessages::TickByTick,\n            100 =\u003e IncomingMessages::OrderBound,\n            101 =\u003e IncomingMessages::CompletedOrder,\n            102 =\u003e IncomingMessages::CompletedOrdersEnd,\n            103 =\u003e IncomingMessages::ReplaceFAEnd,\n            104 =\u003e IncomingMessages::WshMetaData,\n            105 =\u003e IncomingMessages::WshEventData,\n            106 =\u003e IncomingMessages::HistoricalSchedule,\n            107 =\u003e IncomingMessages::UserInfo,\n            _ =\u003e IncomingMessages::NotValid,\n        }\n    }\n}\n\npub fn order_id_index(kind: IncomingMessages) -\u003e Option\u003cusize\u003e {\n    match kind {\n        IncomingMessages::OpenOrder | IncomingMessages::OrderStatus =\u003e Some(1),\n        IncomingMessages::ExecutionData | IncomingMessages::ExecutionDataEnd =\u003e Some(2),\n        _ =\u003e None,\n    }\n}\n\npub fn request_id_index(kind: IncomingMessages) -\u003e Option\u003cusize\u003e {\n    match kind {\n        IncomingMessages::ContractData\n        | IncomingMessages::TickByTick\n        | IncomingMessages::SymbolSamples\n        | IncomingMessages::OpenOrder\n        | IncomingMessages::ExecutionData =\u003e Some(1),\n        IncomingMessages::ContractDataEnd | IncomingMessages::RealTimeBars | IncomingMessages::Error | IncomingMessages::ExecutionDataEnd =\u003e Some(2),\n        _ =\u003e None,\n    }\n}\n\n#[derive(Debug, Copy, Clone)]\npub enum OutgoingMessages {\n    RequestMarketData = 1,\n    CancelMarketData = 2,\n    PlaceOrder = 3,\n    CancelOrder = 4,\n    RequestOpenOrders = 5,\n    RequestAccountData = 6,\n    RequestExecutions = 7,\n    RequestIds = 8,\n    RequestContractData = 9,\n    RequestMarketDepth = 10,\n    CancelMarketDepth = 11,\n    RequestNewsBulletins = 12,\n    CancelNewsBulletin = 13,\n    ChangeServerLog = 14,\n    RequestAutoOpenOrders = 15,\n    RequestAllOpenOrders = 16,\n    RequestManagedAccounts = 17,\n    RequestFA = 18,\n    ReplaceFA = 19,\n    RequestHistoricalData = 20,\n    ExerciseOptions = 21,\n    RequestScannerSubscription = 22,\n    CancelScannerSubscription = 23,\n    RequestScannerParameters = 24,\n    CancelHistoricalData = 25,\n    RequestCurrentTime = 49,\n    RequestRealTimeBars = 50,\n    CancelRealTimeBars = 51,\n    RequestFundamentalData = 52,\n    CancelFundamentalData = 53,\n    ReqCalcImpliedVolat = 54,\n    ReqCalcOptionPrice = 55,\n    CancelImpliedVolatility = 56,\n    CancelOptionPrice = 57,\n    RequestGlobalCancel = 58,\n    RequestMarketDataType = 59,\n    RequestPositions = 61,\n    RequestAccountSummary = 62,\n    CancelAccountSummary = 63,\n    CancelPositions = 64,\n    VerifyRequest = 65,\n    VerifyMessage = 66,\n    QueryDisplayGroups = 67,\n    SubscribeToGroupEvents = 68,\n    UpdateDisplayGroup = 69,\n    UnsubscribeFromGroupEvents = 70,\n    StartApi = 71,\n    VerifyAndAuthRequest = 72,\n    VerifyAndAuthMessage = 73,\n    RequestPositionsMulti = 74,\n    CancelPositionsMulti = 75,\n    RequestAccountUpdatesMulti = 76,\n    CancelAccountUpdatesMulti = 77,\n    RequestSecurityDefinitionOptionalParameters = 78,\n    RequestSoftDollarTiers = 79,\n    RequestFamilyCodes = 80,\n    RequestMatchingSymbols = 81,\n    RequestMktDepthExchanges = 82,\n    RequestSmartComponents = 83,\n    RequestNewsArticle = 84,\n    RequestNewsProviders = 85,\n    RequestHistoricalNews = 86,\n    RequestHeadTimestamp = 87,\n    RequestHistogramData = 88,\n    CancelHistogramData = 89,\n    CancelHeadTimestamp = 90,\n    RequestMarketRule = 91,\n    ReqPnL = 92,\n    CancelPnL = 93,\n    ReqPnLSingle = 94,\n    CancelPnLSingle = 95,\n    ReqHistoricalTicks = 96,\n    ReqTickByTickData = 97,\n    CancelTickByTickData = 98,\n    ReqCompletedOrders = 99,\n    ReqWshMetaData = 100,\n    CancelWshMetaData = 101,\n    ReqWshEventData = 102,\n    CancelWshEventData = 103,\n    ReqUserInfo = 104,\n}\n\nimpl ToField for OutgoingMessages {\n    fn to_field(\u0026self) -\u003e String {\n        (*self as i32).to_string()\n    }\n}\n","traces":[{"line":91,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":128,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":28},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":28},"fn_name":null}],"covered":13,"coverable":97},{"path":["/","Users","wboayue","projects","rust-ibapi","src","news.rs"],"content":"use std::fmt::Debug;\n\nuse anyhow::{anyhow, Result};\n\nuse crate::{client::Client, domain::NewsProvider};\n\n// https://interactivebrokers.github.io/tws-api/news.html\n\n/// Historical News Headlines\n\n/// Requesting News Articles\n\n/// Requests news providers which the user has subscribed to.\npub fn news_providers(client: \u0026Client) -\u003e Result\u003cVec\u003cNewsProvider\u003e\u003e {\n    // request = RequestNewsProvidersRequest::new()\n    // packet = request.encode()\n    // client.send_packet(packet)\n    // packet = client.receive_packet(request_id)\n    // ReceiveNewsProvidersResponse::decode(packet)\n    print!(\"client: {client:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\n// :reqNewsArticle below.\n\n// reqHistoricalNews\n\n//reqNewsArticle s\n","traces":[{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":8},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders","decoders.rs"],"content":"use super::*;\n\nstruct OrderDecoder {\n    server_version: i32,\n    message: ResponseMessage,\n    order_id: i32,\n    contract: Contract,\n    order: Order,\n    order_state: OrderState,\n}\n\nimpl OrderDecoder {\n    fn new(server_version: i32, mut message: ResponseMessage) -\u003e Self {\n        message.skip(); // message type\n\n        if server_version \u003c server_versions::ORDER_CONTAINER {\n            message.skip(); // message version\n        }\n\n        Self {\n            server_version,\n            message,\n            order_id: -1,\n            contract: Contract::default(),\n            order: Order::default(),\n            order_state: OrderState::default(),\n        }\n    }\n\n    fn read_order_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order_id = self.message.next_int()?;\n        self.order.order_id = self.order_id;\n\n        Ok(())\n    }\n\n    fn read_contract_fields(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let message = \u0026mut self.message;\n        let contract = \u0026mut self.contract;\n\n        contract.contract_id = message.next_int()?;\n        contract.symbol = message.next_string()?;\n\n        let security_type = message.next_string()?;\n        contract.security_type = SecurityType::from(\u0026security_type);\n\n        contract.last_trade_date_or_contract_month = message.next_string()?;\n        contract.strike = message.next_double()?;\n        contract.right = message.next_string()?;\n        contract.multiplier = message.next_string()?;\n        contract.exchange = message.next_string()?;\n        contract.currency = message.next_string()?;\n        contract.local_symbol = message.next_string()?;\n        contract.trading_class = message.next_string()?;\n\n        Ok(())\n    }\n\n    fn read_action(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let action = self.message.next_string()?;\n        self.order.action = Action::from(\u0026action);\n\n        Ok(())\n    }\n\n    fn read_total_quantity(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.total_quantity = self.message.next_double()?;\n        Ok(())\n    }\n\n    fn read_order_type(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.order_type = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_limit_price(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.limit_price = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_aux_price(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.aux_price = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_tif(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.tif = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_oca_group(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.oca_group = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_account(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.account = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_open_close(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let open_close = self.message.next_string()?;\n        self.order.open_close = OrderOpenClose::from(\u0026open_close);\n        Ok(())\n    }\n\n    fn read_origin(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.origin = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_order_ref(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.order_ref = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_client_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.client_id = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_perm_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.perm_id = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_outside_rth(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.outside_rth = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_hidden(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.hidden = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_discretionary_amt(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.discretionary_amt = self.message.next_double()?;\n        Ok(())\n    }\n\n    fn read_good_after_time(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.good_after_time = self.message.next_string()?;\n        Ok(())\n    }\n\n    // skips deprecated shares_allocation field\n    fn skip_shares_allocation(\u0026mut self) {\n        self.message.skip();\n    }\n\n    fn read_fa_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.fa_group = self.message.next_string()?;\n        self.order.fa_method = self.message.next_string()?;\n        self.order.fa_percentage = self.message.next_string()?;\n        if self.server_version \u003c server_versions::FA_PROFILE_DESUPPORT {\n            self.order.fa_percentage = self.message.next_string()?;\n        }\n        Ok(())\n    }\n\n    fn read_model_code(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::MODELS_SUPPORT {\n            self.order.model_code = self.message.next_string()?;\n        }\n        Ok(())\n    }\n\n    fn read_good_till_date(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.good_till_date = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_rule_80_a(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let rule_80_a = self.message.next_string()?;\n        self.order.rule_80_a = Rule80A::from(\u0026rule_80_a);\n        Ok(())\n    }\n\n    fn read_percent_offset(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.percent_offset = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_settling_firm(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.settling_firm = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_short_sale_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.short_sale_slot = self.message.next_int()?;\n        self.order.designated_location = self.message.next_string()?;\n        self.order.exempt_code = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_auction_strategy(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.auction_strategy = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_box_order_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.starting_price = self.message.next_optional_double()?;\n        self.order.stock_ref_price = self.message.next_optional_double()?;\n        self.order.delta = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_peg_to_stock_or_vol_order_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.stock_range_lower = self.message.next_optional_double()?;\n        self.order.stock_range_upper = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_display_size(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.display_size = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_block_order(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.block_order = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_sweep_to_fill(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.sweep_to_fill = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_all_or_none(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.all_or_none = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_min_qty(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.min_qty = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_oca_type(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.oca_type = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn skip_etrade_only(\u0026mut self) {\n        self.message.skip();\n    }\n\n    fn skip_firm_quote_only(\u0026mut self) {\n        self.message.skip();\n    }\n\n    fn skip_nbbo_price_cap(\u0026mut self) {\n        self.message.skip();\n    }\n\n    fn read_parent_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.parent_id = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_trigger_method(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.trigger_method = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_volatility_order_params(\u0026mut self, read_open_order_attributes: bool) -\u003e Result\u003c()\u003e {\n        self.order.volatility = self.message.next_optional_double()?;\n        self.order.volatility_type = self.message.next_optional_int()?;\n        self.order.delta_neutral_order_type = self.message.next_string()?;\n        self.order.delta_neutral_aux_price = self.message.next_optional_double()?;\n\n        if self.order.is_delta_neutral() {\n            self.order.delta_neutral_con_id = self.message.next_int()?;\n            if read_open_order_attributes {\n                self.order.delta_neutral_settling_firm = self.message.next_string()?;\n                self.order.delta_neutral_clearing_account = self.message.next_string()?;\n                self.order.delta_neutral_clearing_intent = self.message.next_string()?;\n                self.order.delta_neutral_open_close = self.message.next_string()?;\n            }\n            self.order.delta_neutral_short_sale = self.message.next_bool()?;\n            self.order.delta_neutral_short_sale_slot = self.message.next_int()?;\n            self.order.delta_neutral_designated_location = self.message.next_string()?;\n        }\n\n        self.order.continuous_update = self.message.next_bool()?;\n        self.order.reference_price_type = self.message.next_optional_int()?;\n\n        Ok(())\n    }\n\n    fn read_trail_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.trail_stop_price = self.message.next_optional_double()?;\n        self.order.trailing_percent = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_basis_points(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.basis_points = self.message.next_optional_double()?;\n        self.order.basis_points_type = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_combo_legs(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.contract.combo_legs_description = self.message.next_string()?;\n\n        let combo_legs_count = self.message.next_int()?;\n        for _ in 0..combo_legs_count {\n            let contract_id = self.message.next_int()?;\n            let ratio = self.message.next_int()?;\n            let action = self.message.next_string()?;\n            let exchange = self.message.next_string()?;\n            let open_close = self.message.next_int()?;\n            let short_sale_slot = self.message.next_int()?;\n            let designated_location = self.message.next_string()?;\n            let exempt_code = self.message.next_int()?;\n\n            self.contract.combo_legs.push(ComboLeg {\n                contract_id,\n                ratio,\n                action,\n                exchange,\n                open_close: ComboLegOpenClose::from(open_close),\n                short_sale_slot,\n                designated_location,\n                exempt_code,\n            });\n        }\n\n        let order_combo_legs_count = self.message.next_int()?;\n        for _ in 0..order_combo_legs_count {\n            let price = self.message.next_optional_double()?;\n\n            self.order.order_combo_legs.push(OrderComboLeg { price });\n        }\n\n        Ok(())\n    }\n\n    fn read_smart_combo_routing_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        // smart combo routing params\n        let smart_combo_routing_params_count = self.message.next_int()?;\n        for _ in 0..smart_combo_routing_params_count {\n            self.order.smart_combo_routing_params.push(TagValue {\n                tag: self.message.next_string()?,\n                value: self.message.next_string()?,\n            });\n        }\n\n        Ok(())\n    }\n\n    fn read_scale_order_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.scale_init_level_size = self.message.next_optional_int()?;\n        self.order.scale_subs_level_size = self.message.next_optional_int()?;\n        self.order.scale_price_increment = self.message.next_optional_double()?;\n\n        if let Some(scale_price_increment) = self.order.scale_price_increment {\n            if scale_price_increment \u003e 0.0 {\n                self.order.scale_price_adjust_value = self.message.next_optional_double()?;\n                self.order.scale_price_adjust_interval = self.message.next_optional_int()?;\n                self.order.scale_profit_offset = self.message.next_optional_double()?;\n                self.order.scale_auto_reset = self.message.next_bool()?;\n                self.order.scale_init_position = self.message.next_optional_int()?;\n                self.order.scale_init_fill_qty = self.message.next_optional_int()?;\n                self.order.scale_random_percent = self.message.next_bool()?;\n            }\n        }\n\n        Ok(())\n    }\n\n    fn read_hedge_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.hedge_type = self.message.next_string()?;\n        if !self.order.hedge_type.is_empty() {\n            self.order.hedge_param = self.message.next_string()?;\n        }\n        Ok(())\n    }\n\n    fn read_opt_out_smart_routing(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.opt_out_smart_routing = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_clearing_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.clearing_account = self.message.next_string()?;\n        self.order.clearing_intent = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_not_held(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.not_held = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_delta_neutral(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let has_delta_neutral_contract = self.message.next_bool()?;\n        if has_delta_neutral_contract {\n            self.contract.delta_neutral_contract = Some(DeltaNeutralContract {\n                contract_id: self.message.next_int()?,\n                delta: self.message.next_double()?,\n                price: self.message.next_double()?,\n            });\n        }\n        Ok(())\n    }\n\n    fn read_algo_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.algo_strategy = self.message.next_string()?;\n        if !self.order.algo_strategy.is_empty() {\n            let algo_params_count = self.message.next_int()?;\n            for _ in 0..algo_params_count {\n                self.order.algo_params.push(TagValue {\n                    tag: self.message.next_string()?,\n                    value: self.message.next_string()?,\n                });\n            }\n        }\n\n        Ok(())\n    }\n\n    fn read_solicited(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.solicited = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_what_if_info_and_commission(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.what_if = self.message.next_bool()?;\n        self.read_order_status()?;\n\n        if self.server_version \u003e= server_versions::WHAT_IF_EXT_FIELDS {\n            self.order_state.initial_margin_before = self.message.next_optional_double()?;\n            self.order_state.maintenance_margin_before = self.message.next_optional_double()?;\n            self.order_state.equity_with_loan_before = self.message.next_optional_double()?;\n            self.order_state.initial_margin_change = self.message.next_optional_double()?;\n            self.order_state.maintenance_margin_change = self.message.next_optional_double()?;\n            self.order_state.equity_with_loan_change = self.message.next_optional_double()?;\n        }\n\n        self.order_state.initial_margin_after = self.message.next_optional_double()?;\n        self.order_state.maintenance_margin_after = self.message.next_optional_double()?;\n        self.order_state.equity_with_loan_after = self.message.next_optional_double()?;\n        self.order_state.commission = self.message.next_optional_double()?;\n        self.order_state.minimum_commission = self.message.next_optional_double()?;\n        self.order_state.maximum_commission = self.message.next_optional_double()?;\n        self.order_state.commission_currency = self.message.next_string()?;\n        self.order_state.warning_text = self.message.next_string()?;\n\n        Ok(())\n    }\n\n    fn read_vol_randomize_flags(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.randomize_size = self.message.next_bool()?;\n        self.order.randomize_price = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_peg_to_bench_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PEGGED_TO_BENCHMARK \u0026\u0026 self.order.order_type == \"PEG BENCH\" {\n            self.order.reference_contract_id = self.message.next_int()?;\n            self.order.is_pegged_change_amount_decrease = self.message.next_bool()?;\n            self.order.pegged_change_amount = self.message.next_optional_double()?;\n            self.order.reference_change_amount = self.message.next_optional_double()?;\n            self.order.reference_exchange = self.message.next_string()?;\n        }\n        Ok(())\n    }\n\n    fn read_conditions(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PEGGED_TO_BENCHMARK {\n            let conditions_count = self.message.next_int()?;\n            for _ in 0..conditions_count {\n                let order_condition = self.message.next_int()?;\n                self.order.conditions.push(OrderCondition::from(order_condition));\n            }\n            if conditions_count \u003e 0 {\n                self.order.conditions_ignore_rth = self.message.next_bool()?;\n                self.order.conditions_cancel_order = self.message.next_bool()?;\n            }\n        }\n        Ok(())\n    }\n\n    fn read_adjusted_order_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PEGGED_TO_BENCHMARK {\n            self.order.adjusted_order_type = self.message.next_string()?;\n            self.order.trigger_price = self.message.next_optional_double()?;\n            self.order.trail_stop_price = self.message.next_optional_double()?;\n            self.order.limit_price_offset = self.message.next_optional_double()?;\n            self.order.adjusted_stop_price = self.message.next_optional_double()?;\n            self.order.adjusted_stop_limit_price = self.message.next_optional_double()?;\n            self.order.adjusted_trailing_amount = self.message.next_optional_double()?;\n            self.order.adjustable_trailing_unit = self.message.next_int()?;\n        }\n        Ok(())\n    }\n\n    fn read_soft_dollar_tier(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::SOFT_DOLLAR_TIER {\n            self.order.soft_dollar_tier = SoftDollarTier {\n                name: self.message.next_string()?,\n                value: self.message.next_string()?,\n                display_name: self.message.next_string()?,\n            };\n        }\n        Ok(())\n    }\n\n    fn read_cash_qty(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::CASH_QTY {\n            self.order.cash_qty = self.message.next_optional_double()?;\n        }\n        Ok(())\n    }\n\n    fn read_dont_use_auto_price_for_hedge(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::AUTO_PRICE_FOR_HEDGE {\n            self.order.dont_use_auto_price_for_hedge = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_is_oms_container(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::ORDER_CONTAINER {\n            self.order.is_oms_container = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_discretionary_up_to_limit_price(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::D_PEG_ORDERS {\n            self.order.discretionary_up_to_limit_price = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_use_price_mgmt_algo(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PRICE_MGMT_ALGO {\n            self.order.use_price_mgmt_algo = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_duration(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::DURATION {\n            self.order.duration = self.message.next_optional_int()?;\n        }\n        Ok(())\n    }\n\n    fn read_post_to_ats(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::POST_TO_ATS {\n            self.order.post_to_ats = self.message.next_optional_int()?;\n        }\n        Ok(())\n    }\n\n    fn read_auto_cancel_parent(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::AUTO_CANCEL_PARENT {\n            self.order.auto_cancel_parent = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_peg_best_peg_mid_order_attributes(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PEGBEST_PEGMID_OFFSETS {\n            self.order.min_trade_qty = self.message.next_optional_int()?;\n            self.order.min_compete_size = self.message.next_optional_int()?;\n            self.order.compete_against_best_offset = self.message.next_optional_double()?;\n            self.order.mid_offset_at_whole = self.message.next_optional_double()?;\n            self.order.mid_offset_at_half = self.message.next_optional_double()?;\n        }\n        Ok(())\n    }\n\n    fn read_order_status(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order_state.status = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_stop_price_and_limit_price_offset(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.trail_stop_price = self.message.next_optional_double()?;\n        self.order.limit_price_offset = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_auto_cancel_date(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.auto_cancel_date = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_filled_quantity(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.filled_quantity = self.message.next_double()?;\n        Ok(())\n    }\n\n    fn read_ref_futures_contract_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.ref_futures_con_id = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_shareholder(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.shareholder = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_imbalance_only(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.imbalance_only = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_route_marketable_to_bbo(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.route_marketable_to_bbo = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_parent_perm_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.parent_perm_id = self.message.next_optional_long()?;\n        Ok(())\n    }\n\n    fn read_completed_time(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order_state.completed_time = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_completed_status(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order_state.completed_status = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn into_order_data(self) -\u003e OrderData {\n        OrderData {\n            order_id: self.order_id,\n            contract: self.contract,\n            order: self.order,\n            order_state: self.order_state,\n        }\n    }\n}\n\npub fn decode_open_order(server_version: i32, message: ResponseMessage) -\u003e Result\u003cOrderData\u003e {\n    let mut decoder = OrderDecoder::new(server_version, message);\n\n    // read order id\n    decoder.read_order_id()?;\n\n    // read contract fields\n    decoder.read_contract_fields()?;\n\n    // read order fields\n    decoder.read_action()?;\n    decoder.read_total_quantity()?;\n    decoder.read_order_type()?;\n    decoder.read_limit_price()?;\n    decoder.read_aux_price()?;\n    decoder.read_tif()?;\n    decoder.read_oca_group()?;\n    decoder.read_account()?;\n    decoder.read_open_close()?;\n    decoder.read_origin()?;\n    decoder.read_order_ref()?;\n    decoder.read_client_id()?;\n    decoder.read_perm_id()?;\n    decoder.read_outside_rth()?;\n    decoder.read_hidden()?;\n    decoder.read_discretionary_amt()?;\n    decoder.read_good_after_time()?;\n    decoder.skip_shares_allocation();\n    decoder.read_fa_params()?;\n    decoder.read_model_code()?;\n    decoder.read_good_till_date()?;\n    decoder.read_rule_80_a()?;\n    decoder.read_percent_offset()?;\n    decoder.read_settling_firm()?;\n    decoder.read_short_sale_params()?;\n    decoder.read_auction_strategy()?;\n    decoder.read_box_order_params()?;\n    decoder.read_peg_to_stock_or_vol_order_params()?;\n    decoder.read_display_size()?;\n    decoder.read_block_order()?;\n    decoder.read_sweep_to_fill()?;\n    decoder.read_all_or_none()?;\n    decoder.read_min_qty()?;\n    decoder.read_oca_type()?;\n    decoder.skip_etrade_only();\n    decoder.skip_firm_quote_only();\n    decoder.skip_nbbo_price_cap();\n    decoder.read_parent_id()?;\n    decoder.read_trigger_method()?;\n    decoder.read_volatility_order_params(true)?;\n    decoder.read_trail_params()?;\n    decoder.read_basis_points()?;\n    decoder.read_combo_legs()?;\n    decoder.read_smart_combo_routing_params()?;\n    decoder.read_scale_order_params()?;\n    decoder.read_hedge_params()?;\n    decoder.read_opt_out_smart_routing()?;\n    decoder.read_clearing_params()?;\n    decoder.read_not_held()?;\n    decoder.read_delta_neutral()?;\n    decoder.read_algo_params()?;\n    decoder.read_solicited()?;\n    decoder.read_what_if_info_and_commission()?;\n    decoder.read_vol_randomize_flags()?;\n    decoder.read_peg_to_bench_params()?;\n    decoder.read_conditions()?;\n    decoder.read_adjusted_order_params()?;\n    decoder.read_soft_dollar_tier()?;\n    decoder.read_cash_qty()?;\n    decoder.read_dont_use_auto_price_for_hedge()?;\n    decoder.read_is_oms_container()?;\n    decoder.read_discretionary_up_to_limit_price()?;\n    decoder.read_use_price_mgmt_algo()?;\n    decoder.read_duration()?;\n    decoder.read_post_to_ats()?;\n    decoder.read_auto_cancel_parent()?;\n    decoder.read_peg_best_peg_mid_order_attributes()?;\n\n    Ok(decoder.into_order_data())\n}\n\npub fn decode_order_status(server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cOrderStatus\u003e {\n    message.skip(); // message type\n\n    if server_version \u003c server_versions::MARKET_CAP_PRICE {\n        message.skip(); // message version\n    };\n\n    let mut order_status = OrderStatus::default();\n\n    order_status.order_id = message.next_int()?;\n    order_status.status = message.next_string()?;\n    order_status.filled = message.next_double()?;\n    order_status.remaining = message.next_double()?;\n    order_status.average_fill_price = message.next_double()?;\n    order_status.perm_id = message.next_int()?;\n    order_status.parent_id = message.next_int()?;\n    order_status.last_fill_price = message.next_double()?;\n    order_status.client_id = message.next_int()?;\n    order_status.why_held = message.next_string()?;\n\n    if server_version \u003e= server_versions::MARKET_CAP_PRICE {\n        order_status.market_cap_price = message.next_double()?;\n    }\n\n    Ok(order_status)\n}\n\npub fn decode_execution_data(server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cExecutionData\u003e {\n    message.skip(); // message type\n\n    if server_version \u003c server_versions::LAST_LIQUIDITY {\n        message.skip(); // message version\n    };\n\n    let mut execution_data = ExecutionData::default();\n    let contract = \u0026mut execution_data.contract;\n    let execution = \u0026mut execution_data.execution;\n\n    execution_data.request_id = message.next_int()?;\n    execution.order_id = message.next_int()?;\n    contract.contract_id = message.next_int()?;\n    contract.symbol = message.next_string()?;\n    let secutity_type = message.next_string()?;\n    contract.security_type = SecurityType::from(\u0026secutity_type);\n    contract.last_trade_date_or_contract_month = message.next_string()?;\n    contract.strike = message.next_double()?;\n    contract.right = message.next_string()?;\n    contract.multiplier = message.next_string()?;\n    contract.exchange = message.next_string()?;\n    contract.currency = message.next_string()?;\n    contract.local_symbol = message.next_string()?;\n    contract.trading_class = message.next_string()?;\n    execution.execution_id = message.next_string()?;\n    execution.time = message.next_string()?;\n    execution.account_number = message.next_string()?;\n    execution.exchange = message.next_string()?;\n    execution.side = message.next_string()?;\n    execution.shares = message.next_double()?;\n    execution.price = message.next_double()?;\n    execution.perm_id = message.next_int()?;\n    execution.client_id = message.next_int()?;\n    execution.liquidation = message.next_int()?;\n    execution.cumulative_quantity = message.next_double()?;\n    execution.average_price = message.next_double()?;\n    execution.order_reference = message.next_string()?;\n    execution.ev_rule = message.next_string()?;\n    execution.ev_multiplier = message.next_optional_double()?;\n\n    if server_version \u003e= server_versions::MODELS_SUPPORT {\n        execution.model_code = message.next_string()?;\n    }\n\n    if server_version \u003e= server_versions::LAST_LIQUIDITY {\n        execution.last_liquidity = Liquidity::from(message.next_int()?);\n    }\n\n    Ok(execution_data)\n}\n\npub fn decode_commission_report(_server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cCommissionReport\u003e {\n    message.skip(); // message type\n    message.skip(); // message version\n\n    Ok(CommissionReport {\n        execution_id: message.next_string()?,\n        commission: message.next_double()?,\n        currency: message.next_string()?,\n        realized_pnl: message.next_optional_double()?,\n        yields: message.next_optional_double()?,\n        yield_redemption_date: message.next_string()?, // TODO: use date type?\n    })\n}\n\npub fn decode_completed_order(server_version: i32, message: ResponseMessage) -\u003e Result\u003cOrderData\u003e {\n    let mut decoder = OrderDecoder::new(server_version, message);\n\n    // read contract fields\n    decoder.read_contract_fields()?;\n\n    // read order fields\n    decoder.read_action()?;\n    decoder.read_total_quantity()?;\n    decoder.read_order_type()?;\n    decoder.read_limit_price()?;\n    decoder.read_aux_price()?;\n    decoder.read_tif()?;\n    decoder.read_oca_group()?;\n    decoder.read_account()?;\n    decoder.read_open_close()?;\n    decoder.read_origin()?;\n    decoder.read_order_ref()?;\n    decoder.read_perm_id()?;\n    decoder.read_outside_rth()?;\n    decoder.read_hidden()?;\n    decoder.read_discretionary_amt()?;\n    decoder.read_good_after_time()?;\n    decoder.read_fa_params()?;\n    decoder.read_model_code()?;\n    decoder.read_good_till_date()?;\n    decoder.read_rule_80_a()?;\n    decoder.read_percent_offset()?;\n    decoder.read_settling_firm()?;\n    decoder.read_short_sale_params()?;\n    decoder.read_box_order_params()?;\n    decoder.read_peg_to_stock_or_vol_order_params()?;\n    decoder.read_display_size()?;\n    decoder.read_sweep_to_fill()?;\n    decoder.read_all_or_none()?;\n    decoder.read_min_qty()?;\n    decoder.read_oca_type()?;\n    decoder.read_trigger_method()?;\n    decoder.read_volatility_order_params(false)?;\n    decoder.read_trail_params()?;\n    decoder.read_combo_legs()?;\n    decoder.read_smart_combo_routing_params()?;\n    decoder.read_scale_order_params()?;\n    decoder.read_hedge_params()?;\n    decoder.read_clearing_params()?;\n    decoder.read_not_held()?;\n    decoder.read_delta_neutral()?;\n    decoder.read_algo_params()?;\n    decoder.read_solicited()?;\n    decoder.read_order_status()?;\n    decoder.read_vol_randomize_flags()?;\n    decoder.read_peg_to_bench_params()?;\n    decoder.read_conditions()?;\n    decoder.read_stop_price_and_limit_price_offset()?;\n    decoder.read_cash_qty()?;\n    decoder.read_dont_use_auto_price_for_hedge()?;\n    decoder.read_is_oms_container()?;\n    decoder.read_auto_cancel_date()?;\n    decoder.read_filled_quantity()?;\n    decoder.read_ref_futures_contract_id()?;\n    decoder.read_auto_cancel_parent()?;\n    decoder.read_shareholder()?;\n    decoder.read_imbalance_only()?;\n    decoder.read_route_marketable_to_bbo()?;\n    decoder.read_parent_perm_id()?;\n    decoder.read_completed_time()?;\n    decoder.read_completed_status()?;\n    decoder.read_peg_best_peg_mid_order_attributes()?;\n\n    Ok(decoder.into_order_data())\n}\n","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":128,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":190,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":193,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":199,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":202,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":203,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":206,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":209,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":210,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":211,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":212,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":215,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":216,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":217,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":220,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":221,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":225,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":227,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":230,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":232,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":235,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":236,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":237,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":240,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":242,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":245,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":246,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":249,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":250,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":253,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":254,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":258,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":262,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":263,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":264,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":267,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":268,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":269,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":270,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":271,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":273,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":274,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":275,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":276,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":277,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":278,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":279,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":282,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":283,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":287,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":293,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":300,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":301,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":305,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":307,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":309,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":312,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":315,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":316,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":321,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":325,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":326,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":330,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":334,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":342,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":343,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":345,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":350,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":353,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":354,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":355,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":356,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":358,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":359,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":360,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":361,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":362,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":365,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":366,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":370,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":374,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":375,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":376,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":378,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":381,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":382,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":383,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":387,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":388,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":389,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":392,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":393,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":397,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":398,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":401,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":403,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":406,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":411,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":412,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":415,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":416,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":424,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":425,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":426,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":429,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":430,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":431,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":433,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":435,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":436,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":438,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":439,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":443,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":444,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":445,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":446,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":447,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":451,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":454,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":455,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":457,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":460,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":461,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":462,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":463,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":464,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":465,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":466,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":471,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":472,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":473,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":474,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":475,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":476,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":478,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":479,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":480,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":486,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":487,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":489,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":490,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":491,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":492,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":493,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":494,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":495,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":497,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":500,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":504,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":505,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":508,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":511,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":512,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":513,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":515,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":518,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":519,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":520,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":522,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":525,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":526,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":527,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":529,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":532,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":533,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":534,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":536,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":539,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":540,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":541,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":543,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":546,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":547,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":548,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":550,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":553,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":554,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":555,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":557,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":560,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":561,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":562,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":564,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":567,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":568,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":569,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":570,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":571,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":572,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":573,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":575,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":579,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":580,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":583,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":584,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":585,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":586,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":590,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":591,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":594,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":595,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":596,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":599,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":600,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":601,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":605,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":606,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":609,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":610,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":611,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":614,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":615,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":616,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":619,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":620,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":621,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":625,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":626,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":630,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":631,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":634,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":636,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":637,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":638,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":639,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":644,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":645,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":647,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":648,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":651,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":654,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":655,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":656,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":657,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":658,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":659,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":660,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":661,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":662,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":663,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":664,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":665,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":666,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":667,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":668,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":669,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":670,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":671,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":672,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":673,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":674,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":675,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":676,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":677,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":678,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":679,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":680,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":681,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":682,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":683,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":684,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":685,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":686,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":687,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":688,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":689,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":690,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":691,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":692,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":693,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":694,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":695,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":696,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":697,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":698,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":699,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":700,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":701,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":702,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":703,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":704,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":705,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":706,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":707,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":708,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":709,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":710,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":711,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":712,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":713,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":714,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":715,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":716,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":717,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":718,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":719,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":720,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":722,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":725,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":726,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":728,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":729,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":732,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":734,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":735,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":736,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":737,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":738,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":739,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":740,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":741,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":742,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":743,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":745,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":746,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":749,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":752,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":753,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":755,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":756,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":759,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":760,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":761,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":763,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":764,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":765,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":766,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":767,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":768,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":769,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":770,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":771,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":772,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":773,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":774,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":775,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":776,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":777,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":778,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":779,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":780,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":781,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":782,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":783,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":784,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":785,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":786,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":787,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":788,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":789,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":790,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":791,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":793,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":794,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":797,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":798,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":801,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":804,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":805,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":806,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":808,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":809,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":810,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":811,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":812,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":813,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":814,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":818,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":819,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":821,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":822,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":825,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":826,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":827,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":828,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":829,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":830,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":831,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":832,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":833,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":834,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":835,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":836,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":837,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":838,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":839,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":840,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":841,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":842,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":843,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":844,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":845,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":846,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":847,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":848,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":849,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":850,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":851,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":852,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":853,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":854,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":855,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":856,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":857,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":858,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":859,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":860,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":861,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":862,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":863,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":864,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":865,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":866,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":867,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":868,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":869,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":870,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":871,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":872,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":873,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":874,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":875,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":876,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":877,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":878,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":879,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":880,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":881,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":882,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":883,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":884,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":885,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":887,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":532,"coverable":586},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders","encoders.rs"],"content":"use super::*;\n\npub fn encode_place_order(server_version: i32, order_id: i32, contract: \u0026Contract, order: \u0026Order) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n    let message_version = message_version_for(server_version);\n\n    message.push_field(\u0026OutgoingMessages::PlaceOrder);\n\n    if server_version \u003c server_versions::ORDER_CONTAINER {\n        message.push_field(\u0026message_version);\n    }\n\n    message.push_field(\u0026order_id);\n\n    if server_version \u003e= server_versions::PLACE_ORDER_CONID {\n        message.push_field(\u0026contract.contract_id);\n    }\n    message.push_field(\u0026contract.symbol);\n    message.push_field(\u0026contract.security_type);\n    message.push_field(\u0026contract.last_trade_date_or_contract_month);\n    message.push_field(\u0026contract.strike);\n    message.push_field(\u0026contract.right);\n    message.push_field(\u0026contract.multiplier);\n    message.push_field(\u0026contract.exchange);\n    message.push_field(\u0026contract.primary_exchange);\n    message.push_field(\u0026contract.currency);\n    message.push_field(\u0026contract.local_symbol);\n    if server_version \u003e= server_versions::TRADING_CLASS {\n        message.push_field(\u0026contract.trading_class);\n    }\n    if server_version \u003e= server_versions::SEC_ID_TYPE {\n        message.push_field(\u0026contract.security_id_type);\n        message.push_field(\u0026contract.security_id);\n    }\n\n    message.push_field(\u0026order.action);\n\n    if server_version \u003e= server_versions::FRACTIONAL_POSITIONS {\n        message.push_field(\u0026order.total_quantity);\n    } else {\n        message.push_field(\u0026(order.total_quantity as i32));\n    }\n\n    message.push_field(\u0026order.order_type);\n    if server_version \u003c server_versions::ORDER_COMBO_LEGS_PRICE {\n        message.push_field(\u0026f64_max_to_zero(order.limit_price));\n    } else {\n        message.push_field(\u0026order.limit_price);\n    }\n    if server_version \u003c server_versions::TRAILING_PERCENT {\n        message.push_field(\u0026f64_max_to_zero(order.aux_price));\n    } else {\n        message.push_field(\u0026order.aux_price);\n    }\n\n    // extended order fields\n    message.push_field(\u0026order.tif);\n    message.push_field(\u0026order.oca_group);\n    message.push_field(\u0026order.account);\n    message.push_field(\u0026order.open_close);\n    message.push_field(\u0026order.origin);\n    message.push_field(\u0026order.order_ref);\n    message.push_field(\u0026order.transmit);\n    message.push_field(\u0026order.parent_id);\n\n    message.push_field(\u0026order.block_order);\n    message.push_field(\u0026order.sweep_to_fill);\n    message.push_field(\u0026order.display_size);\n    message.push_field(\u0026order.trigger_method);\n    message.push_field(\u0026order.outside_rth);\n\n    message.push_field(\u0026order.hidden);\n\n    // Contract combo legs for BAG requests\n    if contract.is_bag() {\n        message.push_field(\u0026contract.combo_legs.len());\n\n        for combo_leg in \u0026contract.combo_legs {\n            message.push_field(\u0026combo_leg.contract_id);\n            message.push_field(\u0026combo_leg.ratio);\n            message.push_field(\u0026combo_leg.action);\n            message.push_field(\u0026combo_leg.exchange);\n            message.push_field(\u0026combo_leg.open_close);\n\n            if server_version \u003e= server_versions::SSHORT_COMBO_LEGS {\n                message.push_field(\u0026combo_leg.short_sale_slot);\n                message.push_field(\u0026combo_leg.designated_location);\n            }\n            if server_version \u003e= server_versions::SSHORTX_OLD {\n                message.push_field(\u0026combo_leg.exempt_code);\n            }\n        }\n    }\n\n    // Order combo legs for BAG requests\n    if server_version \u003e= server_versions::ORDER_COMBO_LEGS_PRICE \u0026\u0026 contract.is_bag() {\n        message.push_field(\u0026order.order_combo_legs.len());\n\n        for combo_leg in \u0026order.order_combo_legs {\n            message.push_field(\u0026combo_leg.price);\n        }\n    }\n\n    if server_version \u003e= server_versions::SMART_COMBO_ROUTING_PARAMS \u0026\u0026 contract.is_bag() {\n        message.push_field(\u0026order.smart_combo_routing_params.len());\n\n        for tag_value in \u0026order.smart_combo_routing_params {\n            message.push_field(\u0026tag_value.tag);\n            message.push_field(\u0026tag_value.value);\n        }\n    }\n\n    message.push_field(\u0026\"\"); // deprecated sharesAllocation field\n\n    message.push_field(\u0026order.discretionary_amt);\n    message.push_field(\u0026order.good_after_time);\n    message.push_field(\u0026order.good_till_date);\n\n    message.push_field(\u0026order.fa_group);\n    message.push_field(\u0026order.fa_method);\n    message.push_field(\u0026order.fa_percentage);\n    if server_version \u003c server_versions::FA_PROFILE_DESUPPORT {\n        message.push_field(\u0026order.fa_profile);\n    }\n\n    if server_version \u003e= server_versions::MODELS_SUPPORT {\n        message.push_field(\u0026order.model_code);\n    }\n\n    message.push_field(\u0026order.short_sale_slot);\n    message.push_field(\u0026order.designated_location);\n\n    if server_version \u003e= server_versions::SSHORTX_OLD {\n        message.push_field(\u0026order.exempt_code);\n    }\n\n    message.push_field(\u0026order.oca_type);\n    message.push_field(\u0026order.rule_80_a);\n    message.push_field(\u0026order.settling_firm);\n    message.push_field(\u0026order.all_or_none);\n    message.push_field(\u0026order.min_qty);\n    message.push_field(\u0026order.percent_offset);\n    message.push_field(\u0026false);\n    message.push_field(\u0026false);\n    message.push_field(\u0026Option::\u003cf64\u003e::None);\n    message.push_field(\u0026order.auction_strategy);\n    message.push_field(\u0026order.starting_price);\n    message.push_field(\u0026order.stock_ref_price);\n    message.push_field(\u0026order.delta);\n    message.push_field(\u0026order.stock_range_lower);\n    message.push_field(\u0026order.stock_range_upper);\n\n    message.push_field(\u0026order.override_percentage_constraints);\n\n    // Volitility orders\n    message.push_field(\u0026order.volatility);\n    message.push_field(\u0026order.volatility_type);\n    message.push_field(\u0026order.delta_neutral_order_type);\n    message.push_field(\u0026order.delta_neutral_aux_price);\n\n    if server_version \u003e= server_versions::DELTA_NEUTRAL_CONID \u0026\u0026 order.is_delta_neutral() {\n        message.push_field(\u0026order.delta_neutral_con_id);\n        message.push_field(\u0026order.delta_neutral_settling_firm);\n        message.push_field(\u0026order.delta_neutral_clearing_account);\n        message.push_field(\u0026order.delta_neutral_clearing_intent);\n    }\n\n    if server_version \u003e= server_versions::DELTA_NEUTRAL_OPEN_CLOSE \u0026\u0026 order.is_delta_neutral() {\n        message.push_field(\u0026order.delta_neutral_open_close);\n        message.push_field(\u0026order.delta_neutral_short_sale);\n        message.push_field(\u0026order.delta_neutral_short_sale_slot);\n        message.push_field(\u0026order.delta_neutral_designated_location);\n    }\n\n    message.push_field(\u0026order.continuous_update);\n    message.push_field(\u0026order.reference_price_type);\n\n    message.push_field(\u0026order.trail_stop_price);\n    if server_version \u003e= server_versions::TRAILING_PERCENT {\n        message.push_field(\u0026order.trailing_percent);\n    }\n\n    if server_version \u003e= server_versions::SCALE_ORDERS {\n        if server_version \u003e= server_versions::SCALE_ORDERS2 {\n            message.push_field(\u0026order.scale_init_level_size);\n            message.push_field(\u0026order.scale_subs_level_size);\n        } else {\n            message.push_field(\u0026\"\");\n            message.push_field(\u0026order.scale_init_level_size);\n        }\n        message.push_field(\u0026order.scale_price_increment);\n    }\n\n    if server_version \u003e= server_versions::SCALE_ORDERS3 \u0026\u0026 order.is_scale_order() {\n        message.push_field(\u0026order.scale_price_adjust_value);\n        message.push_field(\u0026order.scale_price_adjust_interval);\n        message.push_field(\u0026order.scale_profit_offset);\n        message.push_field(\u0026order.scale_auto_reset);\n        message.push_field(\u0026order.scale_init_position);\n        message.push_field(\u0026order.scale_init_fill_qty);\n        message.push_field(\u0026order.scale_random_percent);\n    }\n\n    if server_version \u003e= server_versions::SCALE_TABLE {\n        message.push_field(\u0026order.scale_table);\n        message.push_field(\u0026order.active_start_time);\n        message.push_field(\u0026order.active_stop_time);\n    }\n\n    if server_version \u003e= server_versions::HEDGE_ORDERS {\n        message.push_field(\u0026order.hedge_type);\n        if !order.hedge_type.is_empty() {\n            message.push_field(\u0026order.hedge_param);\n        }\n    }\n\n    if server_version \u003e= server_versions::OPT_OUT_SMART_ROUTING {\n        message.push_field(\u0026order.opt_out_smart_routing);\n    }\n\n    if server_version \u003e= server_versions::PTA_ORDERS {\n        message.push_field(\u0026order.clearing_account);\n        message.push_field(\u0026order.clearing_intent);\n    }\n\n    if server_version \u003e= server_versions::NOT_HELD {\n        message.push_field(\u0026order.not_held);\n    }\n\n    if server_version \u003e= server_versions::DELTA_NEUTRAL {\n        if let Some(delta_neutral_contract) = \u0026contract.delta_neutral_contract {\n            message.push_field(\u0026true);\n            message.push_field(\u0026delta_neutral_contract.contract_id);\n            message.push_field(\u0026delta_neutral_contract.delta);\n            message.push_field(\u0026delta_neutral_contract.price);\n        } else {\n            message.push_field(\u0026false);\n        }\n    }\n\n    if server_version \u003e= server_versions::ALGO_ORDERS {\n        message.push_field(\u0026order.algo_strategy);\n        if !order.algo_strategy.is_empty() {\n            message.push_field(\u0026order.algo_params.len());\n            for tag_value in \u0026order.algo_params {\n                message.push_field(\u0026tag_value.tag);\n                message.push_field(\u0026tag_value.value);\n            }\n        }\n    }\n\n    if server_version \u003e= server_versions::ALGO_ID {\n        message.push_field(\u0026order.algo_id);\n    }\n\n    if server_version \u003e= server_versions::WHAT_IF_ORDERS {\n        message.push_field(\u0026order.what_if);\n    }\n\n    if server_version \u003e= server_versions::LINKING {\n        message.push_field(\u0026order.order_misc_options);\n    }\n\n    if server_version \u003e= server_versions::ORDER_SOLICITED {\n        message.push_field(\u0026order.solicited);\n    }\n\n    if server_version \u003e= server_versions::RANDOMIZE_SIZE_AND_PRICE {\n        message.push_field(\u0026order.randomize_size);\n        message.push_field(\u0026order.randomize_price);\n    }\n\n    if server_version \u003e= server_versions::PEGGED_TO_BENCHMARK {\n        if order.order_type == \"PEG BENCH\" {\n            message.push_field(\u0026order.reference_contract_id);\n            message.push_field(\u0026order.is_pegged_change_amount_decrease);\n            message.push_field(\u0026order.pegged_change_amount);\n            message.push_field(\u0026order.reference_change_amount);\n            message.push_field(\u0026order.reference_exchange);\n        }\n\n        message.push_field(\u0026order.conditions.len());\n\n        if !order.conditions.is_empty() {\n            for condition in \u0026order.conditions {\n                // verify\n                // https://github.com/InteractiveBrokers/tws-api/blob/817a905d52299028ac5af08581c8ffde7644cea9/source/csharpclient/client/EClient.cs#L1187\n                message.push_field(condition);\n            }\n\n            message.push_field(\u0026order.conditions_ignore_rth);\n            message.push_field(\u0026order.conditions_cancel_order);\n        }\n\n        message.push_field(\u0026order.adjusted_order_type);\n        message.push_field(\u0026order.trigger_price);\n        message.push_field(\u0026order.limit_price_offset);\n        message.push_field(\u0026order.adjusted_stop_price);\n        message.push_field(\u0026order.adjusted_stop_limit_price);\n        message.push_field(\u0026order.adjusted_trailing_amount);\n        message.push_field(\u0026order.adjustable_trailing_unit);\n    }\n\n    if server_version \u003e= server_versions::EXT_OPERATOR {\n        message.push_field(\u0026order.ext_operator);\n    }\n\n    if server_version \u003e= server_versions::SOFT_DOLLAR_TIER {\n        message.push_field(\u0026order.soft_dollar_tier.name);\n        message.push_field(\u0026order.soft_dollar_tier.value);\n    }\n\n    if server_version \u003e= server_versions::CASH_QTY {\n        message.push_field(\u0026order.cash_qty);\n    }\n\n    if server_version \u003e= server_versions::DECISION_MAKER {\n        message.push_field(\u0026order.mifid2_decision_maker);\n        message.push_field(\u0026order.mifid2_decision_algo);\n    }\n\n    if server_version \u003e= server_versions::MIFID_EXECUTION {\n        message.push_field(\u0026order.mifid2_execution_trader);\n        message.push_field(\u0026order.mifid2_execution_algo);\n    }\n\n    if server_version \u003e= server_versions::AUTO_PRICE_FOR_HEDGE {\n        message.push_field(\u0026order.dont_use_auto_price_for_hedge);\n    }\n\n    if server_version \u003e= server_versions::ORDER_CONTAINER {\n        message.push_field(\u0026order.is_oms_container);\n    }\n\n    if server_version \u003e= server_versions::D_PEG_ORDERS {\n        message.push_field(\u0026order.discretionary_up_to_limit_price);\n    }\n\n    if server_version \u003e= server_versions::PRICE_MGMT_ALGO {\n        message.push_field(\u0026order.use_price_mgmt_algo);\n    }\n\n    if server_version \u003e= server_versions::DURATION {\n        message.push_field(\u0026order.duration);\n    }\n\n    if server_version \u003e= server_versions::POST_TO_ATS {\n        message.push_field(\u0026order.post_to_ats);\n    }\n\n    if server_version \u003e= server_versions::AUTO_CANCEL_PARENT {\n        message.push_field(\u0026order.auto_cancel_parent);\n    }\n\n    if server_version \u003e= server_versions::ADVANCED_ORDER_REJECT {\n        message.push_field(\u0026order.advanced_error_override);\n    }\n\n    if server_version \u003e= server_versions::MANUAL_ORDER_TIME {\n        message.push_field(\u0026order.manual_order_time);\n    }\n\n    if server_version \u003e= server_versions::PEGBEST_PEGMID_OFFSETS {\n        if contract.exchange == \"IBKRATS\" {\n            message.push_field(\u0026order.min_trade_qty);\n        }\n        let mut send_mid_offsets = false;\n        if order.order_type == \"PEG BEST\" {\n            message.push_field(\u0026order.min_compete_size);\n            message.push_field(\u0026order.compete_against_best_offset);\n            if order.compete_against_best_offset == COMPETE_AGAINST_BEST_OFFSET_UP_TO_MID {\n                send_mid_offsets = true;\n            }\n        } else if order.order_type == \"PEG MID\" {\n            send_mid_offsets = true;\n        }\n        if send_mid_offsets {\n            message.push_field(\u0026order.mid_offset_at_whole);\n            message.push_field(\u0026order.mid_offset_at_half);\n        }\n    }\n\n    Ok(message)\n}\n\npub fn encode_cancel_order(server_version: i32, order_id: i32, manual_order_cancel_time: \u0026str) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::CancelOrder);\n    message.push_field(\u0026VERSION);\n    message.push_field(\u0026order_id);\n\n    if server_version \u003e= server_versions::MANUAL_ORDER_TIME {\n        message.push_field(\u0026manual_order_cancel_time);\n    }\n\n    Ok(message)\n}\n\npub fn encode_global_cancel() -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestGlobalCancel);\n    message.push_field(\u0026VERSION);\n\n    Ok(message)\n}\n\npub fn encode_next_valid_order_id() -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestIds);\n    message.push_field(\u0026VERSION);\n    message.push_field(\u00260);\n\n    Ok(message)\n}\n\npub fn encode_completed_orders(api_only: bool) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::ReqCompletedOrders);\n    message.push_field(\u0026api_only);\n\n    Ok(message)\n}\n\npub fn encode_open_orders() -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestOpenOrders);\n    message.push_field(\u0026VERSION);\n\n    Ok(message)\n}\n\npub fn encode_all_open_orders() -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestAllOpenOrders);\n    message.push_field(\u0026VERSION);\n\n    Ok(message)\n}\n\npub fn encode_auto_open_orders(auto_bind: bool) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestAutoOpenOrders);\n    message.push_field(\u0026VERSION);\n    message.push_field(\u0026auto_bind);\n\n    Ok(message)\n}\n\npub fn encode_executions(server_version: i32, request_id: i32, filter: \u0026ExecutionFilter) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 3;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestExecutions);\n    message.push_field(\u0026VERSION);\n\n    if server_version \u003e= server_versions::EXECUTION_DATA_CHAIN {\n        message.push_field(\u0026request_id);\n    }\n\n    message.push_field(\u0026filter.client_id);\n    message.push_field(\u0026filter.account_code);\n    message.push_field(\u0026filter.time); // \"yyyyMMdd-HH:mm:ss\" (UTC) or \"yyyyMMdd HH:mm:ss timezone\"\n    message.push_field(\u0026filter.symbol);\n    message.push_field(\u0026filter.security_type);\n    message.push_field(\u0026filter.exchange);\n    message.push_field(\u0026filter.side);\n\n    Ok(message)\n}\n\nfn f64_max_to_zero(num: Option\u003cf64\u003e) -\u003e Option\u003cf64\u003e {\n    if num == Some(f64::MAX) {\n        Some(0.0)\n    } else {\n        num\n    }\n}\n\nfn message_version_for(server_version: i32) -\u003e i32 {\n    if server_version \u003c server_versions::NOT_HELD {\n        27\n    } else {\n        45\n    }\n}\n","traces":[{"line":3,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":4,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":5,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":7,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":115,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":131,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":206,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":207,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":210,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":211,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":212,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":213,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":217,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":218,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":221,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":227,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":230,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":232,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":233,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":235,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":237,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":242,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":252,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":253,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":256,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":261,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":264,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":265,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":268,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":269,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":270,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":273,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":274,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":275,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":276,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":277,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":278,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":279,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":282,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":284,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":287,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":288,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":291,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":296,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":297,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":300,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":301,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":304,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":305,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":309,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":317,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":327,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":328,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":335,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":336,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":339,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":343,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":344,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":347,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":348,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":351,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":352,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":355,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":356,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":359,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":360,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":365,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":367,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":368,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":369,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":370,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":371,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":372,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":374,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":375,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":378,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":379,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":383,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":389,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":391,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":392,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":393,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":396,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":405,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":407,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":408,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":416,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":418,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":419,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":420,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":422,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":425,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":426,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":428,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":429,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":431,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":439,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":445,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":451,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":453,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":459,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":461,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":462,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":463,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":465,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":471,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":473,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":474,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":476,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":477,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":480,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":481,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":482,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":485,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":486,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":491,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":492,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":493,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":495,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":499,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":500,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":3},"fn_name":null}],"covered":245,"coverable":308},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders","order_builder.rs"],"content":"use super::{Action, Order, OrderComboLeg, TagValue};\n\n/// An auction order is entered into the electronic trading system during the pre-market opening period for execution at the\n/// Calculated Opening Price (COP). If your order is not filled on the open, the order is re-submitted as a limit order with\n/// the limit price set to the COP or the best bid/ask after the market opens.\n/// Products: FUT, STK\npub fn at_auction(action: Action, quantity: f64, price: f64) -\u003e Order {\n    Order {\n        action,\n        tif: \"AUC\".to_owned(),\n        order_type: \"MTL\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        ..Order::default()\n    }\n}\n\n/// A Discretionary order is a limit order submitted with a hidden, specified 'discretionary' amount off the limit price which\n/// may be used to increase the price range over which the limit order is eligible to execute. The market sees only the limit price.\n/// Products: STK\npub fn discretionary(action: Action, quantity: f64, price: f64, discretionary_amount: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        discretionary_amt: discretionary_amount,\n        ..Order::default()\n    }\n}\n\n/// A Market order is an order to buy or sell at the market bid or offer price. A market order may increase the likelihood of a fill\n/// and the speed of execution, but unlike the Limit order a Market order provides no price protection and may fill at a price far\n/// lower/higher than the current displayed bid/ask.\n/// Products: BOND, CFD, EFP, CASH, FUND, FUT, FOP, OPT, STK, WAR\npub fn market_order(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MKT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// A Market if Touched (MIT) is an order to buy (or sell) a contract below (or above) the market. Its purpose is to take advantage\n/// of sudden or unexpected changes in share or other prices and provides investors with a trigger price to set an order in motion.\n/// Investors may be waiting for excessive strength (or weakness) to cease, which might be represented by a specific price point.\n/// MIT orders can be used to determine whether or not to enter the market once a specific price level has been achieved. This order\n/// is held in the system until the trigger price is touched, and is then submitted as a market order. An MIT order is similar to a\n/// stop order, except that an MIT sell order is placed above the current market price, and a stop sell order is placed below\n/// Products: BOND, CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn market_if_touched(action: Action, quantity: f64, price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MIT\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(price),\n        ..Order::default()\n    }\n}\n\n/// A Market-on-Close (MOC) order is a market order that is submitted to execute as close to the closing price as possible.\n/// Products: CFD, FUT, STK, WAR\npub fn market_on_close(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MOC\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// A Market-on-Open (MOO) order combines a market order with the OPG time in force to create an order that is automatically\n/// submitted at the market's open and fills at the market price.\n/// Products: CFD, STK, OPT, WAR\npub fn market_on_open(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MKT\".to_owned(),\n        total_quantity: quantity,\n        tif: \"OPG\".to_owned(),\n        ..Order::default()\n    }\n}\n\n/// ISE Midpoint Match (MPM) orders always execute at the midpoint of the NBBO. You can submit market and limit orders direct-routed\n/// to ISE for MPM execution. Market orders execute at the midpoint whenever an eligible contra-order is available. Limit orders\n/// execute only when the midpoint price is better than the limit price. Standard MPM orders are completely anonymous.\n/// Products: STK\npub fn midpoint_match(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MKT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n// A Midprice order is designed to split the difference between the bid and ask prices, and fill at the current midpoint of\n// the NBBO or better. Set an optional price cap to define the highest price (for a buy order) or the lowest price (for a sell\n// order) you are willing to accept. Requires TWS 975+. Smart-routing to US stocks only.\npub fn midprice(action: Action, quantity: f64, price_cap: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MIDPRICE\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price_cap),\n        ..Order::default()\n    }\n}\n\n/// A pegged-to-market order is designed to maintain a purchase price relative to the national best offer (NBO) or a sale price\n/// relative to the national best bid (NBB). Depending on the width of the quote, this order may be passive or aggressive.\n/// The trader creates the order by entering a limit price which defines the worst limit price that they are willing to accept.\n/// Next, the trader enters an offset amount which computes the active limit price as follows:\n///     Sell order price = Bid price + offset amount\n///     Buy order price = Ask price - offset amount\n/// Products: STK\npub fn pegged_to_market(action: Action, quantity: f64, market_offset: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG MKT\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(market_offset),\n        ..Order::default()\n    }\n}\n\n/// A Pegged to Stock order continually adjusts the option order price by the product of a signed user-define delta and the change of\n/// the option's underlying stock price. The delta is entered as an absolute and assumed to be positive for calls and negative for puts.\n/// A buy or sell call order price is determined by adding the delta times a change in an underlying stock price to a specified starting\n/// price for the call. To determine the change in price, the stock reference price is subtracted from the current NBBO midpoint.\n/// The Stock Reference Price can be defined by the user, or defaults to the NBBO midpoint at the time of the order if no reference price\n/// is entered. You may also enter a high/low stock price range which cancels the order when reached. The delta times the change in stock\n/// price will be rounded to the nearest penny in favor of the order.\n/// Products: OPT\npub fn pegged_to_stock(action: Action, quantity: f64, delta: f64, stock_reference_price: f64, starting_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG STK\".to_owned(),\n        total_quantity: quantity,\n        delta: Some(delta),\n        stock_ref_price: Some(stock_reference_price),\n        starting_price: Some(starting_price),\n        ..Order::default()\n    }\n}\n\n/// Relative (a.k.a. Pegged-to-Primary) orders provide a means for traders to seek a more aggressive price than the National Best Bid\n/// and Offer (NBBO). By acting as liquidity providers, and placing more aggressive bids and offers than the current best bids and offers,\n/// traders increase their odds of filling their order. Quotes are automatically adjusted as the markets move, to remain aggressive.\n/// For a buy order, your bid is pegged to the NBB by a more aggressive offset, and if the NBB moves up, your bid will also move up.\n/// If the NBB moves down, there will be no adjustment because your bid will become even more aggressive and execute. For sales, your\n/// offer is pegged to the NBO by a more aggressive offset, and if the NBO moves down, your offer will also move down. If the NBO moves up,\n/// there will be no adjustment because your offer will become more aggressive and execute. In addition to the offset, you can define an\n/// absolute cap, which works like a limit price, and will prevent your order from being executed above or below a specified level.\n/// Stocks, Options and Futures - not available on paper trading\n/// Products: CFD, STK, OPT, FUT\npub fn relative_pegged_to_primary(action: Action, quantity: f64, price_cap: f64, offset_amount: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"REL\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price_cap),\n        aux_price: Some(offset_amount),\n        ..Order::default()\n    }\n}\n\n/// Sweep-to-fill orders are useful when a trader values speed of execution over price. A sweep-to-fill order identifies the best price\n/// and the exact quantity offered/available at that price, and transmits the corresponding portion of your order for immediate execution.\n/// Simultaneously it identifies the next best price and quantity offered/available, and submits the matching quantity of your order for\n/// immediate execution.\n/// Products: CFD, STK, WAR\npub fn sweep_to_fill(action: Action, quantity: f64, price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        sweep_to_fill: true,\n        ..Order::default()\n    }\n}\n\n/// For option orders routed to the Boston Options Exchange (BOX) you may elect to participate in the BOX's price improvement auction in\n/// pennies. All BOX-directed price improvement orders are immediately sent from Interactive Brokers to the BOX order book, and when the\n/// terms allow, IB will evaluate it for inclusion in a price improvement auction based on price and volume priority. In the auction, your\n/// order will have priority over broker-dealer price improvement orders at the same price.\n/// An Auction Limit order at a specified price. Use of a limit order ensures that you will not receive an execution at a price less favorable\n/// than the limit price. Enter limit orders in penny increments with your auction improvement amount computed as the difference between your\n/// limit order price and the nearest listed increment.\n/// Products: OPT\n/// Supported Exchanges: BOX\npub fn auction_limit(action: Action, quantity: f64, price: f64, auction_strategy: i32) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        auction_strategy: Some(auction_strategy),\n        ..Order::default()\n    }\n}\n\n/// For option orders routed to the Boston Options Exchange (BOX) you may elect to participate in the BOX's price improvement auction in pennies.\n/// All BOX-directed price improvement orders are immediately sent from Interactive Brokers to the BOX order book, and when the terms allow,\n/// IB will evaluate it for inclusion in a price improvement auction based on price and volume priority. In the auction, your order will have\n/// priority over broker-dealer price improvement orders at the same price.\n/// An Auction Pegged to Stock order adjusts the order price by the product of a signed delta (which is entered as an absolute and assumed to be\n/// positive for calls, negative for puts) and the change of the option's underlying stock price. A buy or sell call order price is determined\n/// by adding the delta times a change in an underlying stock price change to a specified starting price for the call. To determine the change\n/// in price, a stock reference price (NBBO midpoint at the time of the order is assumed if no reference price is entered) is subtracted from\n/// the current NBBO midpoint. A stock range may also be entered that cancels an order when reached. The delta times the change in stock price\n/// will be rounded to the nearest penny in favor of the order and will be used as your auction improvement amount.\n/// Products: OPT\n/// Supported Exchanges: BOX\npub fn auction_pegged_to_stock(action: Action, quantity: f64, starting_price: f64, delta: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG STK\".to_owned(),\n        total_quantity: quantity,\n        delta: Some(delta),\n        starting_price: Some(starting_price),\n        ..Order::default()\n    }\n}\n\n/// For option orders routed to the Boston Options Exchange (BOX) you may elect to participate in the BOX's price improvement auction in pennies.\n/// All BOX-directed price improvement orders are immediately sent from Interactive Brokers to the BOX order book, and when the terms allow,\n/// IB will evaluate it for inclusion in a price improvement auction based on price and volume priority. In the auction, your order will have\n/// priority over broker-dealer price improvement orders at the same price.\n/// An Auction Relative order that adjusts the order price by the product of a signed delta (which is entered as an absolute and assumed to be\n/// positive for calls, negative for puts) and the change of the option's underlying stock price. A buy or sell call order price is determined\n/// by adding the delta times a change in an underlying stock price change to a specified starting price for the call. To determine the change\n/// in price, a stock reference price (NBBO midpoint at the time of the order is assumed if no reference price is entered) is subtracted from\n/// the current NBBO midpoint. A stock range may also be entered that cancels an order when reached. The delta times the change in stock price\n/// will be rounded to the nearest penny in favor of the order and will be used as your auction improvement amount.\n/// Products: OPT\n/// Supported Exchanges: BOX\npub fn auction_relative(action: Action, quantity: f64, offset: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"REL\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(offset),\n        ..Order::default()\n    }\n}\n\n/// The Block attribute is used for large volume option orders on ISE that consist of at least 50 contracts. To execute large-volume\n/// orders over time without moving the market, use the Accumulate/Distribute algorithm.\n/// Products: OPT\npub fn block(action: Action, quantity: f64, price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        block_order: true,\n        ..Order::default()\n    }\n}\n\n/// A Box Top order executes as a market order at the current best price. If the order is only partially filled, the remainder is submitted as\n/// a limit order with the limit price equal to the price at which the filled portion of the order executed.\n/// Products: OPT\n/// Supported Exchanges: BOX\npub fn box_top(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"BOX TOP\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// A Limit order is an order to buy or sell at a specified price or better. The Limit order ensures that if the order fills,\n/// it will not fill at a price less favorable than your limit price, but it does not guarantee a fill.\n/// Products: BOND, CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn limit_order(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        ..Order::default()\n    }\n}\n\n/// Forex orders can be placed in demonination of second currency in pair using cash_qty field\n/// Requires TWS or IBG 963+\n/// https://www.interactivebrokers.com/en/index.php?f=23876#963-02\npub fn limit_order_with_cash_qty(action: Action, limit_price: f64, cash_qty: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        limit_price: Some(limit_price),\n        cash_qty: Some(cash_qty),\n        ..Order::default()\n    }\n}\n\n/// A Limit if Touched is an order to buy (or sell) a contract at a specified price or better, below (or above) the market. This order is\n/// held in the system until the trigger price is touched. An LIT order is similar to a stop limit order, except that an LIT sell order is\n/// placed above the current market price, and a stop limit sell order is placed below.\n/// Products: BOND, CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn limit_if_touched(action: Action, quantity: f64, limit_price: f64, trigger_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LIT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        aux_price: Some(trigger_price),\n        ..Order::default()\n    }\n}\n\n/// A Limit-on-close (LOC) order will be submitted at the close and will execute if the closing price is at or better than the submitted\n/// limit price.\n/// Products: CFD, FUT, STK, WAR\npub fn limit_on_close(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LOC\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        ..Order::default()\n    }\n}\n\n/// A Limit-on-Open (LOO) order combines a limit order with the OPG time in force to create an order that is submitted at the market's open,\n/// and that will only execute at the specified limit price or better. Orders are filled in accordance with specific exchange rules.\n/// Products: CFD, STK, OPT, WAR\npub fn limit_on_open(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        tif: \"OPG\".to_owned(),\n        ..Order::default()\n    }\n}\n\n/// Passive Relative orders provide a means for traders to seek a less aggressive price than the National Best Bid and Offer (NBBO) while\n/// keeping the order pegged to the best bid (for a buy) or ask (for a sell). The order price is automatically adjusted as the markets move\n/// to keep the order less aggressive. For a buy order, your order price is pegged to the NBB by a less aggressive offset, and if the NBB\n/// moves up, your bid will also move up. If the NBB moves down, there will be no adjustment because your bid will become aggressive and execute.\n/// For a sell order, your price is pegged to the NBO by a less aggressive offset, and if the NBO moves down, your offer will also move down.\n/// If the NBO moves up, there will be no adjustment because your offer will become aggressive and execute. In addition to the offset, you can\n/// define an absolute cap, which works like a limit price, and will prevent your order from being executed above or below a specified level.\n/// The Passive Relative order is similar to the Relative/Pegged-to-Primary order, except that the Passive relative subtracts the offset from\n/// the bid and the Relative adds the offset to the bid.\n/// Products: STK, WAR\npub fn passive_relative(action: Action, quantity: f64, offset: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PASSV REL\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(offset),\n        ..Order::default()\n    }\n}\n\n/// A pegged-to-midpoint order provides a means for traders to seek a price at the midpoint of the National Best Bid and Offer (NBBO).\n/// The price automatically adjusts to peg the midpoint as the markets move, to remain aggressive. For a buy order, your bid is pegged to\n/// the NBBO midpoint and the order price adjusts automatically to continue to peg the midpoint if the market moves. The price only adjusts\n/// to be more aggressive. If the market moves in the opposite direction, the order will execute.\n/// Products: STK\npub fn pegged_to_midpoint(action: Action, quantity: f64, offset: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG MID\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(offset),\n        limit_price: Some(limit_price),\n        ..Order::default()\n    }\n}\n\n/// Bracket orders are designed to help limit your loss and lock in a profit by \"bracketing\" an order with two opposite-side orders.\n/// A BUY order is bracketed by a high-side sell limit order and a low-side sell stop order. A SELL order is bracketed by a high-side buy\n/// stop order and a low side buy limit order.\n/// Products: CFD, BAG, FOP, CASH, FUT, OPT, STK, WAR\npub fn bracket_order(\n    parent_order_id: i32,\n    action: Action,\n    quantity: f64,\n    limit_price: f64,\n    take_profit_limit_price: f64,\n    stop_loss_price: f64,\n) -\u003e Vec\u003cOrder\u003e {\n    //This will be our main or \"parent\" order\n    let parent = Order {\n        order_id: parent_order_id,\n        action: action.clone(),\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        transmit: false,\n        ..Order::default()\n    };\n\n    let take_profit = Order {\n        order_id: parent.order_id + 1,\n        action: action.reverse(),\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(take_profit_limit_price),\n        parent_id: parent_order_id,\n        transmit: false,\n        ..Order::default()\n    };\n\n    let stop_loss = Order {\n        order_id: parent.order_id + 2,\n        action: action.reverse(),\n        order_type: \"STP\".to_owned(),\n        //Stop trigger price\n        aux_price: Some(stop_loss_price),\n        total_quantity: quantity,\n        parent_id: parent_order_id,\n        //In this case, the low side order will be the last child being sent. Therefore, it needs to set this attribute to true\n        //to activate all its predecessors\n        transmit: true,\n        ..Order::default()\n    };\n\n    vec![parent, take_profit, stop_loss]\n}\n\n/// Products:CFD, FUT, FOP, OPT, STK, WAR\n/// A Market-to-Limit (MTL) order is submitted as a market order to execute at the current best market price. If the order is only\n/// partially filled, the remainder of the order is canceled and re-submitted as a limit order with the limit price equal to the price\n/// at which the filled portion of the order executed.\npub fn market_to_limit(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MTL\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// This order type is useful for futures traders using Globex. A Market with Protection order is a market order that will be cancelled and\n/// resubmitted as a limit order if the entire order does not immediately execute at the market price. The limit price is set by Globex to be\n/// close to the current market price, slightly higher for a sell order and lower for a buy order.\n/// Products: FUT, FOP\npub fn market_with_protection(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MKT PRT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// A Stop order is an instruction to submit a buy or sell market order if and when the user-specified stop trigger price is attained or\n/// penetrated. A Stop order is not guaranteed a specific execution price and may execute significantly away from its stop price. A Sell\n/// Stop order is always placed below the current market price and is typically used to limit a loss or protect a profit on a long stock\n/// position. A Buy Stop order is always placed above the current market price. It is typically used to limit a loss or help protect a\n/// profit on a short sale.\n/// Products: CFD, BAG, CASH, FUT, FOP, OPT, STK, WAR\npub fn stop(action: Action, quantity: f64, stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"STP\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(stop_price),\n        ..Order::default()\n    }\n}\n\n/// A Stop-Limit order is an instruction to submit a buy or sell limit order when the user-specified stop trigger price is attained or\n/// penetrated. The order has two basic components: the stop price and the limit price. When a trade has occurred at or through the stop\n/// price, the order becomes executable and enters the market as a limit order, which is an order to buy or sell at a specified price or better.\n/// Products: CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn stop_limit(action: Action, quantity: f64, limit_price: f64, stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"STP LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        aux_price: Some(stop_price),\n        ..Order::default()\n    }\n}\n\n/// A Stop with Protection order combines the functionality of a stop limit order with a market with protection order. The order is set\n/// to trigger at a specified stop price. When the stop price is penetrated, the order is triggered as a market with protection order,\n/// which means that it will fill within a specified protected price range equal to the trigger price +/- the exchange-defined protection\n/// point range. Any portion of the order that does not fill within this protected range is submitted as a limit order at the exchange-defined\n/// trigger price +/- the protection points.\n/// Products: FUT\npub fn stop_with_protection(action: Action, quantity: f64, stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"STP PRT\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(stop_price),\n        ..Order::default()\n    }\n}\n\n/// A sell trailing stop order sets the stop price at a fixed amount below the market price with an attached \"trailing\" amount. As the\n/// market price rises, the stop price rises by the trail amount, but if the stock price falls, the stop loss price doesn't change,\n/// and a market order is submitted when the stop price is hit. This technique is designed to allow an investor to specify a limit on the\n/// maximum possible loss, without setting a limit on the maximum possible gain. \"Buy\" trailing stop orders are the mirror image of sell\n/// trailing stop orders, and are most appropriate for use in falling markets.\n/// Products: CFD, CASH, FOP, FUT, OPT, STK, WAR\npub fn trailing_stop(action: Action, quantity: f64, trailing_percent: f64, trail_stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"TRAIL\".to_owned(),\n        total_quantity: quantity,\n        trailing_percent: Some(trailing_percent),\n        trail_stop_price: Some(trail_stop_price),\n        ..Order::default()\n    }\n}\n\n/// A trailing stop limit order is designed to allow an investor to specify a limit on the maximum possible loss, without setting a limit\n/// on the maximum possible gain. A SELL trailing stop limit moves with the market price, and continually recalculates the stop trigger\n/// price at a fixed amount below the market price, based on the user-defined \"trailing\" amount. The limit order price is also continually\n/// recalculated based on the limit offset. As the market price rises, both the stop price and the limit price rise by the trail amount and\n/// limit offset respectively, but if the stock price falls, the stop price remains unchanged, and when the stop price is hit a limit order\n/// is submitted at the last calculated limit price. A \"Buy\" trailing stop limit order is the mirror image of a sell trailing stop limit,\n/// and is generally used in falling markets.\n/// Products: BOND, CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn trailing_stop_limit(action: Action, quantity: f64, lmt_price_offset: f64, trailing_amount: f64, trail_stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"TRAIL LIMIT\".to_owned(),\n        total_quantity: quantity,\n        trail_stop_price: Some(trail_stop_price),\n        limit_price_offset: Some(lmt_price_offset),\n        aux_price: Some(trailing_amount),\n        ..Order::default()\n    }\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn combo_limit_order(action: Action, quantity: f64, limit_price: f64, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        ..Order::default()\n    };\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\nfn tag_order_non_guaranteed(mut order: Order) -\u003e Order {\n    order.smart_combo_routing_params = vec![];\n    order.smart_combo_routing_params.push(TagValue {\n        tag: \"NonGuaranteed\".to_owned(),\n        value: \"1\".to_owned(),\n    });\n    order\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn combo_market_order(action: Action, quantity: f64, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"MKT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    };\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn limit_order_for_combo_with_leg_prices(action: Action, quantity: f64, leg_prices: Vec\u003cf64\u003e, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        order_combo_legs: vec![],\n        ..Order::default()\n    };\n\n    for price in leg_prices {\n        order.order_combo_legs.push(OrderComboLeg { price: Some(price) });\n    }\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn relative_limit_combo(action: Action, quantity: f64, limit_price: f64, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"REL + LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        ..Order::default()\n    };\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn relative_market_combo(action: Action, quantity: f64, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"REL + MKT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    };\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\n/// One-Cancels All (OCA) order type allows an investor to place multiple and possibly unrelated orders assigned to a group. The aim is\n/// to complete just one of the orders, which in turn will cause TWS to cancel the remaining orders. The investor may submit several\n/// orders aimed at taking advantage of the most desirable price within the group. Completion of one piece of the group order causes\n/// cancellation of the remaining group orders while partial completion causes the group to rebalance. An investor might desire to sell\n/// 1000 shares of only ONE of three positions held above prevailing market prices. The OCA order group allows the investor to enter prices\n/// at specified target levels and if one is completed, the other two will automatically cancel. Alternatively, an investor may wish to take\n/// a LONG position in eMini S\u0026P stock index futures in a falling market or else SELL US treasury futures at a more favorable price.\n/// Grouping the two orders using an OCA order type offers the investor two chance to enter a similar position, while only running the risk\n/// of taking on a single position.\n/// Products: BOND, CASH, FUT, FOP, STK, OPT, WAR\npub fn one_cancels_all(oca_group: \u0026str, mut oca_orders: Vec\u003cOrder\u003e, oca_type: i32) -\u003e Vec\u003cOrder\u003e {\n    for order in \u0026mut oca_orders {\n        order.oca_group = oca_group.to_owned();\n        order.oca_type = oca_type;\n    }\n\n    oca_orders\n}\n\n/// Specific to US options, investors are able to create and enter Volatility-type orders for options and combinations rather than price orders.\n/// Option traders may wish to trade and position for movements in the price of the option determined by its implied volatility. Because\n/// implied volatility is a key determinant of the premium on an option, traders position in specific contract months in an effort to take\n/// advantage of perceived changes in implied volatility arising before, during or after earnings or when company specific or broad market\n/// volatility is predicted to change. In order to create a Volatility order, clients must first create a Volatility Trader page from the\n/// Trading Tools menu and as they enter option contracts, premiums will display in percentage terms rather than premium. The buy/sell process\n/// is the same as for regular orders priced in premium terms except that the client can limit the volatility level they are willing to pay or\n/// receive.\n/// Products: FOP, OPT\npub fn volatility(action: Action, quantity: f64, volatility_percent: f64, volatility_type: i32) -\u003e Order {\n    Order {\n        action,\n        order_type: \"VOL\".to_owned(),\n        total_quantity: quantity,\n        volatility: Some(volatility_percent),   //Expressed in percentage (40%)\n        volatility_type: Some(volatility_type), // 1=daily, 2=annual\n        ..Order::default()\n    }\n}\n\npub fn market_f_hedge(parent_order_id: i32, action: Action) -\u003e Order {\n    //FX Hedge orders can only have a quantity of 0\n    let mut order = market_order(action, 0.0);\n    order.parent_id = parent_order_id;\n    order.hedge_type = \"F\".to_owned();\n\n    order\n}\n\npub fn pegged_to_benchmark(\n    action: Action,\n    quantity: f64,\n    starting_price: f64,\n    pegged_change_amount_decrease: bool,\n    pegged_change_amount: f64,\n    reference_change_amount: f64,\n    reference_contract_id: i32,\n    reference_exchange: \u0026str,\n    stock_reference_price: f64,\n    reference_contract_lower_range: f64,\n    reference_contract_upper_range: f64,\n) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG BENCH\".to_owned(),\n        total_quantity: quantity,\n        starting_price: Some(starting_price),\n        is_pegged_change_amount_decrease: pegged_change_amount_decrease,\n        pegged_change_amount: Some(pegged_change_amount), // by ... (and likewise for price moving in opposite direction)\n        reference_change_amount: Some(reference_change_amount), // whenever there is a price change of ...\n        reference_contract_id,                            // in the reference contract ...\n        reference_exchange: reference_exchange.to_owned(), // being traded at ...\n        stock_ref_price: Some(stock_reference_price),     // starting reference price is ...\n        //Keep order active as long as reference contract trades between ...\n        stock_range_lower: Some(reference_contract_lower_range),\n        stock_range_upper: Some(reference_contract_upper_range),\n        ..Order::default()\n    }\n}\n\n/// An attached order that turns the parent order (a conventional STP order) into a STP order\n/// in the opposite direction when the trigger is hit.\npub fn attach_adjustable_to_stop(parent: \u0026Order, attached_order_stop_price: f64, trigger_price: f64, adjusted_stop_price: f64) -\u003e Order {\n    // Attached order is a conventional STP order\n    let mut order = stop(parent.action.reverse(), parent.total_quantity, attached_order_stop_price);\n\n    order.parent_id = parent.order_id;\n    order.trigger_price = Some(trigger_price); // When trigger price is penetrated\n    order.adjusted_order_type = \"STP\".to_owned(); // The parent order will be turned into a STP order\n    order.adjusted_stop_price = Some(adjusted_stop_price); // With the given STP price\n\n    order\n}\n\n/// An attached order that turns the parent order (a conventional STP order) into a STP LMT order\n/// in the opposite direction when the trigger is hit.\npub fn attach_adjustable_to_stop_limit(\n    parent: \u0026Order,\n    attached_order_stop_price: f64,\n    trigger_price: f64,\n    adjusted_stop_price: f64,\n    adjusted_stop_limit_price: f64,\n) -\u003e Order {\n    // Attached order is a conventional STP order\n    let mut order = stop(parent.action.reverse(), parent.total_quantity, attached_order_stop_price);\n\n    order.parent_id = parent.order_id;\n    order.trigger_price = Some(trigger_price); // When trigger price is penetrated\n    order.adjusted_order_type = \"STP LMT\".to_owned(); // The parent order will be turned into a STP LMT order\n    order.adjusted_stop_price = Some(adjusted_stop_price); // With the given STP price\n    order.adjusted_stop_limit_price = Some(adjusted_stop_limit_price); // And the given limit price\n\n    order\n}\n\n/// An attached order that turns the parent order (a conventional STP order) into a\n/// TRAIL order in the opposite direction when the trigger is hit.\npub fn attach_adjustable_to_trail(\n    parent: \u0026Order,\n    attached_order_stop_price: f64,\n    trigger_price: f64,\n    adjusted_stop_price: f64,\n    adjusted_trail_amount: f64,\n    trail_unit: i32,\n) -\u003e Order {\n    // Attached order is a conventional STP order\n    let mut order = stop(parent.action.reverse(), parent.total_quantity, attached_order_stop_price);\n\n    order.parent_id = parent.order_id;\n    order.trigger_price = Some(trigger_price); // When trigger price is penetrated\n    order.adjusted_order_type = \"TRAIL\".to_owned(); // The parent order will be turned into a TRAIL order\n    order.adjusted_stop_price = Some(adjusted_stop_price); // With a stop price of ...\n    order.adjustable_trailing_unit = trail_unit; // trailing by and amount (0) or a percent (100) ...\n    order.adjusted_trailing_amount = Some(adjusted_trail_amount); // of ...\n\n    order\n}\n\npub fn what_if_limit_order(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    let mut order = limit_order(action, quantity, limit_price);\n    order.what_if = true;\n\n    order\n}\n\n// https://github.com/InteractiveBrokers/tws-api/blob/07e54ceecda2c9cbd6ffb5f524894f0c837a9ecb/source/csharpclient/client/ContractCondition.cs\n// pub fn price_condition(contract_id: i32, exchange: \u0026str, price: f64, is_more: bool, is_conjunction: bool) -\u003e PriceCondition\n// {\n//     //! [price_condition]\n//     //Conditions have to be created via the OrderCondition.Create\n//     PriceCondition priceCondition = (PriceCondition)OrderCondition.Create(OrderConditionType.Price);\n//     //When this contract...\n//     priceCondition.ConId = conId;\n//     //traded on this exchange\n//     priceCondition.Exchange = exchange;\n//     //has a price above/below\n//     priceCondition.IsMore = isMore;\n//     //this quantity\n//     priceCondition.Price = price;\n//     //AND | OR next condition (will be ignored if no more conditions are added)\n//     priceCondition.IsConjunctionConnection = isConjunction;\n//     //! [price_condition]\n//     return priceCondition;\n// }\n\n//     public static ExecutionCondition ExecutionCondition(string symbol, string secType, string exchange, bool isConjunction)\n//     {\n//         //! [execution_condition]\n//         ExecutionCondition execCondition = (ExecutionCondition)OrderCondition.Create(OrderConditionType.Execution);\n//         //When an execution on symbol\n//         execCondition.Symbol = symbol;\n//         //at exchange\n//         execCondition.Exchange = exchange;\n//         //for this secType\n//         execCondition.SecType = secType;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         execCondition.IsConjunctionConnection = isConjunction;\n//         //! [execution_condition]\n//         return execCondition;\n//     }\n\n//     public static MarginCondition MarginCondition(int percent, bool isMore, bool isConjunction)\n//     {\n//         //! [margin_condition]\n//         MarginCondition marginCondition = (MarginCondition)OrderCondition.Create(OrderConditionType.Margin);\n//         //If margin is above/below\n//         marginCondition.IsMore = isMore;\n//         //given percent\n//         marginCondition.Percent = percent;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         marginCondition.IsConjunctionConnection = isConjunction;\n//         //! [margin_condition]\n//         return marginCondition;\n//     }\n\n//     public static PercentChangeCondition PercentageChangeCondition(double pctChange, int conId, string exchange, bool isMore, bool isConjunction)\n//     {\n//         //! [percentage_condition]\n//         PercentChangeCondition pctChangeCondition = (PercentChangeCondition)OrderCondition.Create(OrderConditionType.PercentCange);\n//         //If there is a price percent change measured against last close price above or below...\n//         pctChangeCondition.IsMore = isMore;\n//         //this amount...\n//         pctChangeCondition.ChangePercent = pctChange;\n//         //on this contract\n//         pctChangeCondition.ConId = conId;\n//         //when traded on this exchange...\n//         pctChangeCondition.Exchange = exchange;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         pctChangeCondition.IsConjunctionConnection = isConjunction;\n//         //! [percentage_condition]\n//         return pctChangeCondition;\n//     }\n\n//     public static TimeCondition TimeCondition(string time, bool isMore, bool isConjunction)\n//     {\n//         //! [time_condition]\n//         TimeCondition timeCondition = (TimeCondition)OrderCondition.Create(OrderConditionType.Time);\n//         //Before or after...\n//         timeCondition.IsMore = isMore;\n//         //this time..\n//         timeCondition.Time = time;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         timeCondition.IsConjunctionConnection = isConjunction;\n//         //! [time_condition]\n//         return timeCondition;\n//     }\n\n//     public static VolumeCondition VolumeCondition(int conId, string exchange, bool isMore, int volume, bool isConjunction)\n//     {\n//         //! [volume_condition]\n//         VolumeCondition volCond = (VolumeCondition)OrderCondition.Create(OrderConditionType.Volume);\n//         //Whenever contract...\n//         volCond.ConId = conId;\n//         //When traded at\n//         volCond.Exchange = exchange;\n//         //reaches a volume higher/lower\n//         volCond.IsMore = isMore;\n//         //than this...\n//         volCond.Volume = volume;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         volCond.IsConjunctionConnection = isConjunction;\n//         //! [volume_condition]\n//         return volCond;\n\n//     }\n\npub fn limit_ibkrats(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        not_held: true,\n        ..Order::default()\n    }\n}\n\npub fn limit_order_with_manual_order_time(action: Action, quantity: f64, limit_price: f64, manual_order_time: \u0026str) -\u003e Order {\n    let mut order = limit_order(action, quantity, limit_price);\n    order.manual_order_time = manual_order_time.to_owned();\n\n    order\n}\n\npub fn peg_best_up_to_mid_order(\n    action: Action,\n    quantity: f64,\n    limit_price: f64,\n    min_trade_qty: i32,\n    min_compete_size: i32,\n    mid_offset_at_whole: f64,\n    mid_offset_at_half: f64,\n) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG BEST\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        not_held: true,\n        min_trade_qty: Some(min_trade_qty),\n        min_compete_size: Some(min_compete_size),\n        compete_against_best_offset: super::COMPETE_AGAINST_BEST_OFFSET_UP_TO_MID,\n        mid_offset_at_whole: Some(mid_offset_at_whole),\n        mid_offset_at_half: Some(mid_offset_at_half),\n        ..Order::default()\n    }\n}\n\npub fn peg_best_order(\n    action: Action,\n    quantity: f64,\n    limit_price: f64,\n    min_trade_qty: i32,\n    min_compete_size: i32,\n    compete_against_best_offset: f64,\n) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG BEST\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        not_held: true,\n        min_trade_qty: Some(min_trade_qty),\n        min_compete_size: Some(min_compete_size),\n        compete_against_best_offset: Some(compete_against_best_offset),\n        ..Order::default()\n    }\n}\n\npub fn peg_mid_order(\n    action: Action,\n    quantity: f64,\n    limit_price: f64,\n    min_trade_qty: i32,\n    mid_offset_at_whole: f64,\n    mid_offset_at_half: f64,\n) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG MID\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        not_held: true,\n        min_trade_qty: Some(min_trade_qty),\n        mid_offset_at_whole: Some(mid_offset_at_whole),\n        mid_offset_at_half: Some(mid_offset_at_half),\n        ..Order::default()\n    }\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":218,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":221,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":224,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":254,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":269,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":272,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":284,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":297,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":325,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":338,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":341,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":356,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":359,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":361,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":371,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":374,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":376,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":397,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":398,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":406,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":407,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":408,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":417,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":418,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":419,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":430,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":453,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":465,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":470,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":479,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":482,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":485,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":496,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":499,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":512,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":515,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":517,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":518,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":531,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":534,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":536,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":537,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":538,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":548,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":551,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":553,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":557,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":558,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":561,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":564,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":565,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":566,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":567,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":568,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":570,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":578,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":581,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":586,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":587,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":590,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":598,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":601,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":603,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":607,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":608,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":611,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":612,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":615,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":623,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":626,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":628,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":632,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":633,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":636,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":644,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":647,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":652,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":653,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":656,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":669,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":670,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":671,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":672,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":675,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":687,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":690,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":692,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":693,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":698,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":699,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":700,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":701,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":702,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":704,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":707,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":722,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":724,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":726,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":727,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":729,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":730,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":732,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":733,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":740,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":741,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":742,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":744,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":745,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":746,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":747,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":749,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":754,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":761,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":762,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":764,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":765,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":766,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":767,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":768,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":770,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":775,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":783,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":784,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":786,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":787,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":788,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":789,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":790,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":791,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":793,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":796,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":797,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":798,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":800,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":904,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":907,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":909,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":915,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":916,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":917,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":919,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":922,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":933,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":935,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":937,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":938,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":940,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":941,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":946,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":956,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":958,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":960,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":961,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":962,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":967,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":977,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":979,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":981,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":982,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":983,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":16,"coverable":232},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders","tests.rs"],"content":"use super::*;\n\nuse crate::contracts::{contract_samples, Contract, SecurityType};\nuse crate::stubs::MessageBusStub;\n\n#[test]\nfn place_order() {\n    let mut message_bus = Box::new(MessageBusStub{\n        request_messages: vec![],\n        response_messages: vec![\n            \"5|13|76792991|TSLA|STK||0|?||SMART|USD|TSLA|NMS|BUY|100|MKT|0.0|0.0|DAY||DU1236109||0||100|1376327563|0|0|0||1376327563.0/DU1236109/100||||||||||0||-1|0||||||2147483647|0|0|0||3|0|0||0|0||0|None||0||||?|0|0||0|0||||||0|0|0|2147483647|2147483647|||0||IB|0|0||0|0|PreSubmitted|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308||||||0|0|0|None|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|0||||0|1|0|0|0|||0||\".to_owned(),\n            \"3|13|PreSubmitted|0|100|0|1376327563|0|0|100||0||\".to_owned(),\n            \"11|-1|13|76792991|TSLA|STK||0.0|||ISLAND|USD|TSLA|NMS|00025b46.63f8f39c.01.01|20230224  12:04:56|DU1236109|ISLAND|BOT|100|196.52|1376327563|100|0|100|196.52|||||2||\".to_owned(),\n            \"5|13|76792991|TSLA|STK||0|?||SMART|USD|TSLA|NMS|BUY|100|MKT|0.0|0.0|DAY||DU1236109||0||100|1376327563|0|0|0||1376327563.0/DU1236109/100||||||||||0||-1|0||||||2147483647|0|0|0||3|0|0||0|0||0|None||0||||?|0|0||0|0||||||0|0|0|2147483647|2147483647|||0||IB|0|0||0|0|Filled|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308||||||0|0|0|None|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|0||||0|1|0|0|0|||0||\".to_owned(),\n            \"3|13|Filled|100|0|196.52|1376327563|0|196.52|100||0||\".to_owned(),\n            \"5|13|76792991|TSLA|STK||0|?||SMART|USD|TSLA|NMS|BUY|100|MKT|0.0|0.0|DAY||DU1236109||0||100|1376327563|0|0|0||1376327563.0/DU1236109/100||||||||||0||-1|0||||||2147483647|0|0|0||3|0|0||0|0||0|None||0||||?|0|0||0|0||||||0|0|0|2147483647|2147483647|||0||IB|0|0||0|0|Filled|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.0|||USD||0|0|0|None|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|0||||0|1|0|0|0|||0||\".to_owned(),\n            \"59|1|00025b46.63f8f39c.01.01|1.0|USD|1.7976931348623157E308|1.7976931348623157E308|||\".to_owned(),\n        ]\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let contract = Contract {\n        symbol: \"TSLA\".to_owned(),\n        security_type: SecurityType::Stock,\n        exchange: \"SMART\".to_owned(),\n        currency: \"USD\".to_owned(),\n        ..Contract::default()\n    };\n\n    let order_id = 13;\n    let order = order_builder::market_order(super::Action::Buy, 100.0);\n\n    let result = super::place_order(\u0026mut client, order_id, \u0026contract, \u0026order);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(\n        request_messages[0].encode().replace('\\0', \"|\"),\n        \"3|13|0|TSLA|STK||0|||SMART||USD|||||BUY|100|MKT|||||||0||1|0|0|0|0|0|0|0||0||||||||0||-1|0|||0|||0|0||0||||||0|||||0|||||||||||0|||0|0|||0||0|0|0|0|||||||0|||||||||0|0|0|0|||0|\"\n    );\n\n    assert!(result.is_ok(), \"failed to place order: {}\", result.err().unwrap());\n\n    let mut notifications = result.unwrap();\n\n    if let Some(OrderNotification::OpenOrder(open_order)) = notifications.next() {\n        assert_eq!(open_order.order_id, 13, \"open_order.order_id\");\n\n        let contract = \u0026open_order.contract;\n        let order = \u0026open_order.order;\n        let order_state = \u0026open_order.order_state;\n\n        assert_eq!(contract.contract_id, 76792991, \"contract.contract_id\");\n        assert_eq!(contract.symbol, \"TSLA\", \"contract.symbol\");\n        assert_eq!(contract.security_type, SecurityType::Stock, \"contract.security_type\");\n        assert_eq!(\n            contract.last_trade_date_or_contract_month, \"\",\n            \"contract.last_trade_date_or_contract_month\"\n        );\n        assert_eq!(contract.strike, 0.0, \"contract.strike\");\n        assert_eq!(contract.right, \"?\", \"contract.right\");\n        assert_eq!(contract.multiplier, \"\", \"contract.multiplier\");\n        assert_eq!(contract.exchange, \"SMART\", \"contract.exchange\");\n        assert_eq!(contract.currency, \"USD\", \"contract.currency\");\n        assert_eq!(contract.local_symbol, \"TSLA\", \"contract.local_symbol\");\n        assert_eq!(contract.trading_class, \"NMS\", \"contract.trading_class\");\n\n        assert_eq!(order.order_id, 13, \"order.order_id\");\n        assert_eq!(order.action, Action::Buy, \"order.action\");\n        assert_eq!(order.total_quantity, 100.0, \"order.total_quantity\");\n        assert_eq!(order.order_type, \"MKT\", \"order.order_type\");\n        assert_eq!(order.limit_price, Some(0.0), \"order.limit_price\");\n        assert_eq!(order.aux_price, Some(0.0), \"order.aux_price\");\n        assert_eq!(order.tif, \"DAY\", \"order.tif\");\n        assert_eq!(order.oca_group, \"\", \"order.oca_group\");\n        assert_eq!(order.account, \"DU1236109\", \"order.account\");\n        assert_eq!(order.open_close, None, \"order.open_close\");\n        assert_eq!(order.origin, 0, \"order.origin\");\n        assert_eq!(order.order_ref, \"\", \"order.order_ref\");\n        assert_eq!(order.client_id, 100, \"order.client_id\");\n        assert_eq!(order.perm_id, 1376327563, \"order.perm_id\");\n        assert_eq!(order.outside_rth, false, \"order.outside_rth\");\n        assert_eq!(order.hidden, false, \"order.hidden\");\n        assert_eq!(order.discretionary_amt, 0.0, \"order.discretionary_amt\");\n        assert_eq!(order.good_after_time, \"\", \"order.good_after_time\");\n        assert_eq!(order.fa_group, \"\", \"order.fa_group\");\n        assert_eq!(order.fa_method, \"\", \"order.fa_method\");\n        assert_eq!(order.fa_percentage, \"\", \"order.fa_percentage\");\n        assert_eq!(order.fa_profile, \"\", \"order.fa_profile\");\n        assert_eq!(order.model_code, \"\", \"order.model_code\");\n        assert_eq!(order.good_till_date, \"\", \"order.good_till_date\");\n        assert_eq!(order.rule_80_a, None, \"order.rule_80_a\");\n        assert_eq!(order.percent_offset, None, \"order.percent_offset\");\n        assert_eq!(order.settling_firm, \"\", \"order.settling_firm\");\n        assert_eq!(order.short_sale_slot, 0, \"order.short_sale_slot\");\n        assert_eq!(order.designated_location, \"\", \"order.designated_location\");\n        assert_eq!(order.exempt_code, -1, \"order.exempt_code\");\n        assert_eq!(order.auction_strategy, Some(0), \"order.auction_strategy\");\n        assert_eq!(order.starting_price, None, \"order.starting_price\");\n        assert_eq!(order.stock_ref_price, None, \"order.stock_ref_price\");\n        assert_eq!(order.delta, None, \"order.delta\");\n        assert_eq!(order.stock_range_lower, None, \"order.stock_range_lower\");\n        assert_eq!(order.stock_range_upper, None, \"order.stock_range_upper\");\n        assert_eq!(order.display_size, None, \"order.display_size\");\n        assert_eq!(order.block_order, false, \"order.block_order\");\n        assert_eq!(order.sweep_to_fill, false, \"order.sweep_to_fill\");\n        assert_eq!(order.all_or_none, false, \"order.all_or_none\");\n        assert_eq!(order.min_qty, None, \"order.min_qty\");\n        assert_eq!(order.oca_type, 3, \"order.oca_type\");\n        assert_eq!(order.parent_id, 0, \"order.parent_id\");\n        assert_eq!(order.trigger_method, 0, \"order.trigger_method\");\n        assert_eq!(order.volatility, None, \"order.volatility\");\n        assert_eq!(order.volatility_type, Some(0), \"order.volatility_type\");\n        assert_eq!(order.delta_neutral_order_type, \"None\", \"order.delta_neutral_order_type\");\n        assert_eq!(order.delta_neutral_aux_price, None, \"order.delta_neutral_aux_price\");\n        assert_eq!(order.delta_neutral_con_id, 0, \"order.delta_neutral_con_id\");\n        assert_eq!(order.delta_neutral_settling_firm, \"\", \"order.delta_neutral_settling_firm\");\n        assert_eq!(order.delta_neutral_clearing_account, \"\", \"order.delta_neutral_clearing_account\");\n        assert_eq!(order.delta_neutral_clearing_intent, \"\", \"order.delta_neutral_clearing_intent\");\n        assert_eq!(order.delta_neutral_open_close, \"?\", \"order.delta_neutral_open_close\");\n        assert_eq!(order.delta_neutral_short_sale, false, \"order.delta_neutral_short_sale\");\n        assert_eq!(order.delta_neutral_short_sale_slot, 0, \"order.delta_neutral_short_sale_slot\");\n        assert_eq!(order.delta_neutral_designated_location, \"\", \"order.delta_neutral_designated_location\");\n        assert_eq!(order.continuous_update, false, \"order.continuous_update\");\n        assert_eq!(order.reference_price_type, Some(0), \"order.reference_price_type\");\n        assert_eq!(order.trail_stop_price, None, \"order.trail_stop_price\");\n        assert_eq!(order.trailing_percent, None, \"order.trailing_percent\");\n        assert_eq!(order.basis_points, None, \"order.basis_points\");\n        assert_eq!(order.basis_points_type, None, \"order.basis_points_type\");\n        assert_eq!(contract.combo_legs_description, \"\", \"contract.combo_legs_description\");\n        assert_eq!(contract.combo_legs.len(), 0, \"contract.combo_legs.len()\");\n        assert_eq!(order.order_combo_legs.len(), 0, \"order.order_combo_legs.len()\");\n        assert_eq!(order.smart_combo_routing_params.len(), 0, \"order.smart_combo_routing_params.len()\");\n        assert_eq!(order.scale_init_level_size, None, \"order.scale_init_level_size\");\n        assert_eq!(order.scale_subs_level_size, None, \"order.scale_subs_level_size\");\n        assert_eq!(order.scale_price_increment, None, \"order.scale_price_increment\");\n        assert_eq!(order.hedge_type, \"\", \"order.hedge_type\");\n        assert_eq!(order.opt_out_smart_routing, false, \"order.opt_out_smart_routing\");\n        assert_eq!(order.clearing_account, \"\", \"order.clearing_account\");\n        assert_eq!(order.clearing_intent, \"IB\", \"order.clearing_intent\");\n        assert_eq!(order.not_held, false, \"order.not_held\");\n        assert_eq!(order.algo_strategy, \"\", \"order.algo_strategy\");\n        assert_eq!(order.algo_params.len(), 0, \"order.algo_params.len()\");\n        assert_eq!(order.solicited, false, \"order.solicited\");\n        assert_eq!(order.what_if, false, \"order.what_if\");\n        assert_eq!(order_state.status, \"PreSubmitted\", \"order_state.status\");\n        assert_eq!(order_state.initial_margin_before, None, \"order_state.initial_margin_before\");\n        assert_eq!(order_state.maintenance_margin_before, None, \"order_state.maintenance_margin_before\");\n        assert_eq!(order_state.equity_with_loan_before, None, \"order_state.equity_with_loan_before\");\n        assert_eq!(order_state.initial_margin_change, None, \"order_state.initial_margin_change\");\n        assert_eq!(order_state.maintenance_margin_change, None, \"order_state.maintenance_margin_change\");\n        assert_eq!(order_state.equity_with_loan_change, None, \"order_state.equity_with_loan_change\");\n        assert_eq!(order_state.initial_margin_after, None, \"order_state.initial_margin_after\");\n        assert_eq!(order_state.maintenance_margin_after, None, \"order_state.maintenance_margin_after\");\n        assert_eq!(order_state.equity_with_loan_after, None, \"order_state.equity_with_loan_after\");\n        assert_eq!(order_state.commission, None, \"order_state.commission\");\n        assert_eq!(order_state.minimum_commission, None, \"order_state.minimum_commission\");\n        assert_eq!(order_state.maximum_commission, None, \"order_state.maximum_commission\");\n        assert_eq!(order_state.commission_currency, \"\", \"order_state.commission_currency\");\n        assert_eq!(order_state.warning_text, \"\", \"order_state.warning_text\");\n        assert_eq!(order.randomize_size, false, \"order.randomize_size\");\n        assert_eq!(order.randomize_price, false, \"order.randomize_price\");\n        assert_eq!(order.conditions.len(), 0, \"order.conditions.len()\");\n        assert_eq!(order.adjusted_order_type, \"None\", \"order.adjusted_order_type\");\n        assert_eq!(order.trigger_price, None, \"order.trigger_price\");\n        assert_eq!(order.trail_stop_price, None, \"order.trail_stop_price\");\n        assert_eq!(order.limit_price_offset, None, \"order.lmt_price_offset\");\n        assert_eq!(order.adjusted_stop_price, None, \"order.adjusted_stop_price\");\n        assert_eq!(order.adjusted_stop_limit_price, None, \"order.adjusted_stop_limit_price\");\n        assert_eq!(order.adjusted_trailing_amount, None, \"order.adjusted_trailing_amount\");\n        assert_eq!(order.adjustable_trailing_unit, 0, \"order.adjustable_trailing_unit\");\n        assert_eq!(order.soft_dollar_tier.name, \"\", \"order.soft_dollar_tier.name\");\n        assert_eq!(order.soft_dollar_tier.value, \"\", \"order.soft_dollar_tier.value\");\n        assert_eq!(order.soft_dollar_tier.display_name, \"\", \"order.soft_dollar_tier.display_name\");\n        assert_eq!(order.cash_qty, Some(0.0), \"order.cash_qty\");\n        assert_eq!(order.dont_use_auto_price_for_hedge, true, \"order.dont_use_auto_price_for_hedge\");\n        assert_eq!(order.is_oms_container, false, \"order.is_oms_container\");\n        assert_eq!(order.discretionary_up_to_limit_price, false, \"order.discretionary_up_to_limit_price\");\n        assert_eq!(order.use_price_mgmt_algo, false, \"order.use_price_mgmt_algo\");\n        assert_eq!(order.duration, None, \"order.duration\");\n        assert_eq!(order.post_to_ats, None, \"order.post_to_ats\");\n        assert_eq!(order.auto_cancel_parent, false, \"order.auto_cancel_parent\");\n        assert_eq!(order.min_trade_qty, None, \"order.min_trade_qty\");\n        assert_eq!(order.min_compete_size, None, \"order.min_compete_size\");\n        assert_eq!(order.compete_against_best_offset, None, \"order.compete_against_best_offset\");\n        assert_eq!(order.mid_offset_at_whole, None, \"order.mid_offset_at_whole\");\n        assert_eq!(order.mid_offset_at_half, None, \"order.mid_offset_at_half\");\n    } else {\n        assert!(false, \"message[0] expected an open order notification\");\n    }\n\n    if let Some(OrderNotification::OrderStatus(order_status)) = notifications.next() {\n        assert_eq!(order_status.order_id, 13, \"order_status.order_id\");\n        assert_eq!(order_status.status, \"PreSubmitted\", \"order_status.status\");\n        assert_eq!(order_status.filled, 0.0, \"order_status.filled\");\n        assert_eq!(order_status.remaining, 100.0, \"order_status.remaining\");\n        assert_eq!(order_status.average_fill_price, 0.0, \"order_status.average_fill_price\");\n        assert_eq!(order_status.perm_id, 1376327563, \"order_status.perm_id\");\n        assert_eq!(order_status.parent_id, 0, \"order_status.parent_id\");\n        assert_eq!(order_status.last_fill_price, 0.0, \"order_status.last_fill_price\");\n        assert_eq!(order_status.client_id, 100, \"order_status.client_id\");\n        assert_eq!(order_status.why_held, \"\", \"order_status.why_held\");\n        assert_eq!(order_status.market_cap_price, 0.0, \"order_status.market_cap_price\");\n    } else {\n        assert!(false, \"message[1] expected order status notification\");\n    }\n\n    if let Some(OrderNotification::ExecutionData(execution_data)) = notifications.next() {\n        let contract = execution_data.contract;\n        let execution = execution_data.execution;\n\n        assert_eq!(execution_data.request_id, -1, \"execution_data.request_id\");\n        assert_eq!(execution.order_id, 13, \"execution.order_id\");\n        assert_eq!(contract.contract_id, 76792991, \"contract.contract_id\");\n        assert_eq!(contract.symbol, \"TSLA\", \"contract.symbol\");\n        assert_eq!(contract.security_type, SecurityType::Stock, \"contract.security_type\");\n        assert_eq!(\n            contract.last_trade_date_or_contract_month, \"\",\n            \"contract.last_trade_date_or_contract_month\"\n        );\n        assert_eq!(contract.strike, 0.0, \"contract.strike\");\n        assert_eq!(contract.right, \"\", \"contract.right\");\n        assert_eq!(contract.multiplier, \"\", \"contract.multiplier\");\n        assert_eq!(contract.exchange, \"ISLAND\", \"contract.exchange\");\n        assert_eq!(contract.currency, \"USD\", \"contract.currency\");\n        assert_eq!(contract.local_symbol, \"TSLA\", \"contract.local_symbol\");\n        assert_eq!(contract.trading_class, \"NMS\", \"contract.trading_class\");\n        assert_eq!(execution.execution_id, \"00025b46.63f8f39c.01.01\", \"execution.execution_id\");\n        assert_eq!(execution.time, \"20230224  12:04:56\", \"execution.time\");\n        assert_eq!(execution.account_number, \"DU1236109\", \"execution.account_number\");\n        assert_eq!(execution.exchange, \"ISLAND\", \"execution.exchange\");\n        assert_eq!(execution.side, \"BOT\", \"execution.side\");\n        assert_eq!(execution.shares, 100.0, \"execution.shares\");\n        assert_eq!(execution.price, 196.52, \"execution.price\");\n        assert_eq!(execution.perm_id, 1376327563, \"execution.perm_id\");\n        assert_eq!(execution.client_id, 100, \"execution.client_id\");\n        assert_eq!(execution.liquidation, 0, \"execution.liquidation\");\n        assert_eq!(execution.cumulative_quantity, 100.0, \"execution.cumulative_quantity\");\n        assert_eq!(execution.average_price, 196.52, \"execution.average_price\");\n        assert_eq!(execution.order_reference, \"\", \"execution.order_reference\");\n        assert_eq!(execution.ev_rule, \"\", \"execution.ev_rule\");\n        assert_eq!(execution.ev_multiplier, None, \"execution.ev_multiplier\");\n        assert_eq!(execution.model_code, \"\", \"execution.model_code\");\n        assert_eq!(execution.last_liquidity, Liquidity::RemovedLiquidity, \"execution.last_liquidity\");\n    } else {\n        assert!(false, \"message[2] expected execution notification\");\n    }\n\n    if let Some(OrderNotification::OpenOrder(open_order)) = notifications.next() {\n        let order_state = \u0026open_order.order_state;\n\n        assert_eq!(open_order.order_id, 13, \"open_order.order_id\");\n        assert_eq!(order_state.status, \"Filled\", \"order_state.status\");\n    } else {\n        assert!(false, \"message[3] expected an open order notification\");\n    }\n\n    if let Some(OrderNotification::OrderStatus(order_status)) = notifications.next() {\n        assert_eq!(order_status.order_id, 13, \"order_status.order_id\");\n        assert_eq!(order_status.status, \"Filled\", \"order_status.status\");\n        assert_eq!(order_status.filled, 100.0, \"order_status.filled\");\n        assert_eq!(order_status.remaining, 0.0, \"order_status.remaining\");\n        assert_eq!(order_status.average_fill_price, 196.52, \"order_status.average_fill_price\");\n        assert_eq!(order_status.last_fill_price, 196.52, \"order_status.last_fill_price\");\n    } else {\n        assert!(false, \"message[4] expected order status notification\");\n    }\n\n    if let Some(OrderNotification::OpenOrder(open_order)) = notifications.next() {\n        let order_state = \u0026open_order.order_state;\n\n        assert_eq!(open_order.order_id, 13, \"open_order.order_id\");\n        assert_eq!(order_state.status, \"Filled\", \"order_state.status\");\n        assert_eq!(order_state.commission, Some(1.0), \"order_state.commission\");\n        assert_eq!(order_state.minimum_commission, None, \"order_state.minimum_commission\");\n        assert_eq!(order_state.maximum_commission, None, \"order_state.maximum_commission\");\n        assert_eq!(order_state.commission_currency, \"USD\", \"order_state.commission_currency\");\n    } else {\n        assert!(false, \"message[5] expected an open order notification\");\n    }\n\n    if let Some(OrderNotification::CommissionReport(report)) = notifications.next() {\n        assert_eq!(report.execution_id, \"00025b46.63f8f39c.01.01\", \"report.execution_id\");\n        assert_eq!(report.commission, 1.0, \"report.commission\");\n        assert_eq!(report.currency, \"USD\", \"report.currency\");\n        assert_eq!(report.realized_pnl, None, \"report.realized_pnl\");\n        assert_eq!(report.yields, None, \"report.yielded\");\n        assert_eq!(report.yield_redemption_date, \"\", \"report.yield_redemption_date\");\n    } else {\n        assert!(false, \"message[6] expected a commission report notification\");\n    }\n}\n\n#[test]\nfn cancel_order() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\n            \"3|41|Cancelled|0|100|0|71270927|0|0|100||0||\".to_owned(),\n            \"4|2|41|202|Order Canceled - reason:||\".to_owned(),\n        ],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let order_id = 41;\n    let results = super::cancel_order(\u0026mut client, order_id, \"\");\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode(), \"4\\01\\041\\0\");\n\n    assert!(results.is_ok(), \"failed to cancel order: {}\", results.err().unwrap());\n\n    let mut results = results.unwrap();\n\n    if let Some(CancelOrderResult::OrderStatus(order_status)) = results.next() {\n        assert_eq!(order_status.order_id, 41, \"order_status.order_id\");\n        assert_eq!(order_status.status, \"Cancelled\", \"order_status.status\");\n        assert_eq!(order_status.filled, 0.0, \"order_status.filled\");\n        assert_eq!(order_status.remaining, 100.0, \"order_status.remaining\");\n        assert_eq!(order_status.average_fill_price, 0.0, \"order_status.average_fill_price\");\n        assert_eq!(order_status.perm_id, 71270927, \"order_status.perm_id\");\n        assert_eq!(order_status.parent_id, 0, \"order_status.parent_id\");\n        assert_eq!(order_status.last_fill_price, 0.0, \"order_status.last_fill_price\");\n        assert_eq!(order_status.client_id, 100, \"order_status.client_id\");\n        assert_eq!(order_status.why_held, \"\", \"order_status.why_held\");\n        assert_eq!(order_status.market_cap_price, 0.0, \"order_status.market_cap_price\");\n    }\n\n    if let Some(CancelOrderResult::Notice(Notice(message))) = results.next() {\n        assert_eq!(message, \"Order Canceled - reason:\", \"order status notice\");\n    }\n}\n\n#[test]\nfn global_cancel() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let results = super::global_cancel(\u0026mut client);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode(), \"58\\01\\0\");\n    assert!(results.is_ok(), \"failed to cancel order: {}\", results.err().unwrap());\n}\n\n#[test]\nfn next_valid_order_id() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let results = super::next_valid_order_id(\u0026mut client);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode(), \"8\\01\\00\\0\");\n\n    assert!(results.is_ok(), \"failed to request next order id: {}\", results.err().unwrap());\n    assert_eq!(43, results.unwrap(), \"next order id\");\n}\n\n#[test]\nfn completed_orders() {\n    let mut message_bus = Box::new(MessageBusStub{\n        request_messages: vec![],\n        response_messages: vec![\n            \"101|265598|AAPL|STK||0|?||SMART|USD|AAPL|NMS|BUY|0|MKT|0.0|0.0|DAY||DU1236109||0||1824933227|0|0|0|||||||||||0||-1||||||2147483647|0|0||3|0||0|None||0|0|0||0|0||||0|0|0|2147483647|2147483647||||IB|0|0||0|Filled|0|0|0|1.7976931348623157E308|1.7976931348623157E308|0|1|0||100|2147483647|0|Not an insider or substantial shareholder|0|0|9223372036854775807|20230306 12:28:30 America/Los_Angeles|Filled Size: 100|\".to_owned(),\n            \"102|\".to_owned(),\n        ],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let api_only = true;\n    let results = super::completed_orders(\u0026mut client, api_only);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode(), \"99\\01\\0\");\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n\n    let mut results = results.unwrap();\n    if let Some(OrderDataResult::OrderData(order_data)) = results.next() {\n        assert_eq!(order_data.order_id, -1, \"open_order.order_id\");\n\n        let contract = \u0026order_data.contract;\n        let order = \u0026order_data.order;\n        let order_state = \u0026order_data.order_state;\n\n        assert_eq!(contract.contract_id, 265598, \"contract.contract_id\");\n        assert_eq!(contract.symbol, \"AAPL\", \"contract.symbol\");\n        assert_eq!(contract.security_type, SecurityType::Stock, \"contract.security_type\");\n        assert_eq!(\n            contract.last_trade_date_or_contract_month, \"\",\n            \"contract.last_trade_date_or_contract_month\"\n        );\n        assert_eq!(contract.strike, 0.0, \"contract.strike\");\n        assert_eq!(contract.right, \"?\", \"contract.right\");\n        assert_eq!(contract.multiplier, \"\", \"contract.multiplier\");\n        assert_eq!(contract.exchange, \"SMART\", \"contract.exchange\");\n        assert_eq!(contract.currency, \"USD\", \"contract.currency\");\n        assert_eq!(contract.local_symbol, \"AAPL\", \"contract.local_symbol\");\n        assert_eq!(contract.trading_class, \"NMS\", \"contract.trading_class\");\n        assert_eq!(order.action, Action::Buy, \"order.action\");\n        assert_eq!(order.total_quantity, 0.0, \"order.total_quantity\");\n        assert_eq!(order.order_type, \"MKT\", \"order.order_type\");\n        assert_eq!(order.limit_price, Some(0.0), \"order.limit_price\");\n        assert_eq!(order.aux_price, Some(0.0), \"order.aux_price\");\n        assert_eq!(order.tif, \"DAY\", \"order.tif\");\n        assert_eq!(order.oca_group, \"\", \"order.oca_group\");\n        assert_eq!(order.account, \"DU1236109\", \"order.account\");\n        assert_eq!(order.open_close, None, \"order.open_close\");\n        assert_eq!(order.origin, 0, \"order.origin\");\n        assert_eq!(order.order_ref, \"\", \"order.order_ref\");\n        assert_eq!(order.perm_id, 1824933227, \"order.perm_id\");\n        assert_eq!(order.outside_rth, false, \"order.outside_rth\");\n        assert_eq!(order.hidden, false, \"order.hidden\");\n        assert_eq!(order.discretionary_amt, 0.0, \"order.discretionary_amt\");\n        assert_eq!(order.good_after_time, \"\", \"order.good_after_time\");\n        assert_eq!(order.fa_group, \"\", \"order.fa_group\");\n        assert_eq!(order.fa_method, \"\", \"order.fa_method\");\n        assert_eq!(order.fa_percentage, \"\", \"order.fa_percentage\");\n        assert_eq!(order.fa_profile, \"\", \"order.fa_profile\");\n        assert_eq!(order.model_code, \"\", \"order.model_code\");\n        assert_eq!(order.good_till_date, \"\", \"order.good_till_date\");\n        assert_eq!(order.rule_80_a, None, \"order.rule_80_a\");\n        assert_eq!(order.percent_offset, None, \"order.percent_offset\");\n        assert_eq!(order.settling_firm, \"\", \"order.settling_firm\");\n        assert_eq!(order.short_sale_slot, 0, \"order.short_sale_slot\");\n        assert_eq!(order.designated_location, \"\", \"order.designated_location\");\n        assert_eq!(order.exempt_code, -1, \"order.exempt_code\");\n        assert_eq!(order.starting_price, None, \"order.starting_price\");\n        assert_eq!(order.stock_ref_price, None, \"order.stock_ref_price\");\n        assert_eq!(order.delta, None, \"order.delta\");\n        assert_eq!(order.stock_range_lower, None, \"order.stock_range_lower\");\n        assert_eq!(order.stock_range_upper, None, \"order.stock_range_upper\");\n        assert_eq!(order.display_size, None, \"order.display_size\");\n        assert_eq!(order.sweep_to_fill, false, \"order.sweep_to_fill\");\n        assert_eq!(order.all_or_none, false, \"order.all_or_none\");\n        assert_eq!(order.min_qty, None, \"order.min_qty\");\n        assert_eq!(order.oca_type, 3, \"order.oca_type\");\n        assert_eq!(order.trigger_method, 0, \"order.trigger_method\");\n        assert_eq!(order.volatility, None, \"order.volatility\");\n        assert_eq!(order.volatility_type, Some(0), \"order.volatility_type\");\n        assert_eq!(order.delta_neutral_order_type, \"None\", \"order.delta_neutral_order_type\");\n        assert_eq!(order.delta_neutral_aux_price, None, \"order.delta_neutral_aux_price\");\n        assert_eq!(order.delta_neutral_con_id, 0, \"order.delta_neutral_con_id\");\n        assert_eq!(order.delta_neutral_short_sale, false, \"order.delta_neutral_short_sale\");\n        assert_eq!(order.delta_neutral_short_sale_slot, 0, \"order.delta_neutral_short_sale_slot\");\n        assert_eq!(order.delta_neutral_designated_location, \"\", \"order.delta_neutral_designated_location\");\n        assert_eq!(order.continuous_update, false, \"order.continuous_update\");\n        assert_eq!(order.reference_price_type, Some(0), \"order.reference_price_type\");\n        assert_eq!(order.trail_stop_price, None, \"order.trail_stop_price\");\n        assert_eq!(order.trailing_percent, None, \"order.trailing_percent\");\n        assert_eq!(contract.combo_legs_description, \"\", \"contract.combo_legs_description\");\n        assert_eq!(contract.combo_legs.len(), 0, \"contract.combo_legs.len()\");\n        assert_eq!(order.order_combo_legs.len(), 0, \"order.order_combo_legs.len()\");\n        assert_eq!(order.smart_combo_routing_params.len(), 0, \"order.smart_combo_routing_params.len()\");\n        assert_eq!(order.scale_init_level_size, None, \"order.scale_init_level_size\");\n        assert_eq!(order.scale_subs_level_size, None, \"order.scale_subs_level_size\");\n        assert_eq!(order.scale_price_increment, None, \"order.scale_price_increment\");\n        assert_eq!(order.hedge_type, \"\", \"order.hedge_type\");\n        assert_eq!(order.clearing_account, \"\", \"order.clearing_account\");\n        assert_eq!(order.clearing_intent, \"IB\", \"order.clearing_intent\");\n        assert_eq!(order.not_held, false, \"order.not_held\");\n        assert_eq!(contract.delta_neutral_contract, None, \"contract.delta_neutral_contract\");\n        assert_eq!(order.algo_strategy, \"\", \"order.algo_strategy\");\n        assert_eq!(order.algo_params.len(), 0, \"order.algo_params.len()\");\n        assert_eq!(order.solicited, false, \"order.solicited\");\n        assert_eq!(order_state.status, \"Filled\", \"order_state.status\");\n        assert_eq!(order.randomize_size, false, \"order.randomize_size\");\n        assert_eq!(order.randomize_price, false, \"order.randomize_price\");\n        assert_eq!(order.conditions.len(), 0, \"order.conditions.len()\");\n        assert_eq!(order.trail_stop_price, None, \"order.trail_stop_price\");\n        assert_eq!(order.limit_price_offset, None, \"order.limit_price_offset\");\n        assert_eq!(order.cash_qty, Some(0.0), \"order.cash_qty\");\n        assert_eq!(order.dont_use_auto_price_for_hedge, true, \"order.dont_use_auto_price_for_hedge\");\n        assert_eq!(order.is_oms_container, false, \"order.is_oms_container\");\n        assert_eq!(order.auto_cancel_date, \"\", \"order.auto_cancel_date\");\n        assert_eq!(order.filled_quantity, 100.0, \"order.filled_quantity\");\n        assert_eq!(order.ref_futures_con_id, None, \"order.ref_futures_con_id\");\n        assert_eq!(order.auto_cancel_parent, false, \"order.auto_cancel_parent\");\n        assert_eq!(order.shareholder, \"Not an insider or substantial shareholder\", \"order.shareholder\");\n        assert_eq!(order.imbalance_only, false, \"order.imbalance_only\");\n        assert_eq!(order.route_marketable_to_bbo, false, \"order.route_marketable_to_bbo\");\n        assert_eq!(order.parent_perm_id, None, \"order.parent_perm_id\");\n        assert_eq!(\n            order_state.completed_time, \"20230306 12:28:30 America/Los_Angeles\",\n            \"order_state.completed_time\"\n        );\n        assert_eq!(order_state.completed_status, \"Filled Size: 100\", \"order_state.completed_status\");\n    } else {\n        assert!(false, \"expected order data\");\n    }\n}\n\n#[test]\nfn open_orders() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let results = super::open_orders(\u0026mut client);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode_simple(), \"5|1|\");\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n}\n\n#[test]\nfn all_open_orders() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let results = super::all_open_orders(\u0026mut client);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode_simple(), \"16|1|\");\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n}\n\n#[test]\nfn auto_open_orders() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let api_only = true;\n    let results = super::auto_open_orders(\u0026mut client, api_only);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode_simple(), \"15|1|1|\");\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n}\n\n#[test]\nfn executions() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let filter = ExecutionFilter {\n        client_id: Some(100),\n        account_code: \"xyz\".to_owned(),\n        time: \"yyyymmdd hh:mm:ss EST\".to_owned(),\n        symbol: \"TSLA\".to_owned(),\n        security_type: \"STK\".to_owned(),\n        exchange: \"ISLAND\".to_owned(),\n        side: \"BUY\".to_owned(),\n    };\n    let results = super::executions(\u0026mut client, filter);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(\n        request_messages[0].encode_simple(),\n        \"7|3|9000|100|xyz|yyyymmdd hh:mm:ss EST|TSLA|STK|ISLAND|BUY|\"\n    );\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n    // assert_eq!(43, results.unwrap(), \"next order id\");\n}\n\n#[test]\nfn encode_limit_order() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let order_id = 12;\n    let contract = contract_samples::future_with_local_symbol();\n    let order = order_builder::limit_order(super::Action::Buy, 10.0, 500.00);\n\n    let results = super::place_order(\u0026mut client, order_id, \u0026contract, \u0026order);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(\n        request_messages[0].encode_simple(),\n        \"3|12|0||FUT|202303|0|||EUREX||EUR|FGBL MAR 23||||BUY|10|LMT|500||||||0||1|0|0|0|0|0|0|0||0||||||||0||-1|0|||0|||0|0||0||||||0|||||0|||||||||||0|||0|0|||0||0|0|0|0|||||||0|||||||||0|0|0|0|||0|\"\n    );\n\n    assert!(results.is_ok(), \"failed to place order: {}\", results.err().unwrap());\n}\n\n#[test]\nfn encode_combo_market_order() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let order_id = 12; // get next order id\n    let contract = contract_samples::smart_future_combo_contract();\n    let order = order_builder::combo_market_order(Action::Sell, 150.0, true);\n\n    let results = super::place_order(\u0026mut client, order_id, \u0026contract, \u0026order);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(\n        request_messages[0].encode_simple(),\n        \"3|12|0|WTI|BAG||0|||SMART||USD|||||SELL|150|MKT|||||||0||1|0|0|0|0|0|0|0|2|55928698|1|BUY|IPE|0|0||0|55850663|1|SELL|IPE|0|0||0|0|1|NonGuaranteed|1||0||||||||0||-1|0|||0|||0|0||0||||||0|||||0|||||||||||0|||0|0|||0||0|0|0|0|||||||0|||||||||0|0|0|0|||0|\"\n    );\n\n    assert!(results.is_ok(), \"failed to place order: {}\", results.err().unwrap());\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders.rs"],"content":"use std::convert::From;\nuse std::fmt::{self, Debug};\n\nuse anyhow::{anyhow, Result};\nuse log::{error, info};\n\nuse crate::client::transport::{GlobalResponseIterator, ResponseIterator};\nuse crate::client::{Client, RequestMessage, ResponseMessage};\nuse crate::contracts::{ComboLeg, ComboLegOpenClose, Contract, DeltaNeutralContract, SecurityType};\nuse crate::messages::{IncomingMessages, OutgoingMessages};\nuse crate::server_versions;\nuse crate::{encode_option_field, ToField};\n\nmod decoders;\nmod encoders;\n\n/// Make sure to test using only your paper trading account when applicable. A good way of finding out if an order type/exchange combination\n/// is possible is by trying to place such order manually using the TWS.\n/// Before contacting our API support team please refer to the available documentation.\npub mod order_builder;\n\n/// New description\npub use crate::contracts::TagValue;\n\nconst COMPETE_AGAINST_BEST_OFFSET_UP_TO_MID: Option\u003cf64\u003e = Some(f64::INFINITY);\n\n#[derive(Clone, Debug)]\n/// Order describes the order.\npub struct Order {\n    /// The API client's order id.\n    pub order_id: i32,\n    /// The Solicited field should be used for orders initiated or recommended by the broker or adviser that were approved by the client (by phone, email, chat, verbally, etc.) prior to entry. Please note that orders that the adviser or broker placed without specifically discussing with the client are discretionary orders, not solicited.\n    pub solicited: bool,\n    /// The API client id which placed the order.\n    pub client_id: i32,\n    /// The Host order identifier.\n    pub perm_id: i32,\n    /// Identifies the side.\n    /// Generally available values are BUY and SELL.\n    /// Additionally, SSHORT and SLONG are available in some institutional-accounts only.\n    /// For general account types, a SELL order will be able to enter a short position automatically if the order quantity is larger than your current long position.\n    /// SSHORT is only supported for institutional account configured with Long/Short account segments or clearing with a separate account.\n    /// SLONG is available in specially-configured institutional accounts to indicate that long position not yet delivered is being sold.\n    pub action: Action,\n    /// The number of positions being bought/sold.\n    pub total_quantity: f64,\n    /// The order's type.\n    pub order_type: String,\n    /// The LIMIT price.\n    /// Used for limit, stop-limit and relative orders. In all other cases specify zero. For relative orders with no limit price, also specify zero.\n    pub limit_price: Option\u003cf64\u003e,\n    /// Generic field to contain the stop price for STP LMT orders, trailing amount, etc.\n    pub aux_price: Option\u003cf64\u003e,\n    /// The time in force.\n    /// Valid values are:\n    /// DAY - Valid for the day only.\n    /// GTC - Good until canceled. The order will continue to work within the system and in the marketplace until it executes or is canceled. GTC orders will be automatically be cancelled under the following conditions:\n    /// If a corporate action on a security results in a stock split (forward or reverse), exchange for shares, or distribution of shares. If you do not log into your IB account for 90 days.\n    /// At the end of the calendar quarter following the current quarter. For example, an order placed during the third quarter of 2011 will be canceled at the end of the first quarter of 2012. If the last day is a non-trading day, the cancellation will occur at the close of the final trading day of that quarter. For example, if the last day of the quarter is Sunday, the orders will be cancelled on the preceding Friday.\n    /// Orders that are modified will be assigned a new Auto Expire date consistent with the end of the calendar quarter following the current quarter.\n    /// Orders submitted to IB that remain in force for more than one day will not be reduced for dividends. To allow adjustment to your order price on ex-dividend date, consider using a Good-Til-Date/Time (GTD) or Good-after-Time/Date (GAT) order type, or a combination of the two.\n    /// IOC - Immediate or Cancel. Any portion that is not filled as soon as it becomes available in the market is canceled.\n    /// GTD - Good until Date. It will remain working within the system and in the marketplace until it executes or until the close of the market on the date specified\n    /// OPG - Use OPG to send a market-on-open (MOO) or limit-on-open (LOO) order.\n    /// FOK - If the entire Fill-or-Kill order does not execute as soon as it becomes available, the entire order is canceled.\n    /// DTC - Day until Canceled.\n    pub tif: String, // FIXME create enum\n    /// One-Cancels-All group identifier.\n    pub oca_group: String,\n    /// Tells how to handle remaining orders in an OCA group when one order or part of an order executes.\n    /// Valid values are:\n    /// 1 - Cancel all remaining orders with block.\n    /// 2 - Remaining orders are proportionately reduced in size with block.\n    /// 3 - Remaining orders are proportionately reduced in size with no block.\n    /// If you use a value \"with block\" it gives the order overfill protection. This means that only one order in the group will be routed at a time to remove the possibility of an overfill.\n    pub oca_type: i32,\n    /// The order reference.\n    /// Intended for institutional customers only, although all customers may use it to identify the API client that sent the order when multiple API clients are running.\n    pub order_ref: String,\n    /// Specifies whether the order will be transmitted by TWS. If set to false, the order will be created at TWS but will not be sent.\n    pub transmit: bool,\n    /// The order ID of the parent order, used for bracket and auto trailing stop orders.\n    pub parent_id: i32,\n    /// If set to true, specifies that the order is an ISE Block order.\n    pub block_order: bool,\n    /// If set to true, specifies that the order is a Sweep-to-Fill order.\n    pub sweep_to_fill: bool,\n    /// The publicly disclosed order size, used when placing Iceberg orders.\n    pub display_size: Option\u003ci32\u003e,\n    /// Specifies how Simulated Stop, Stop-Limit and Trailing Stop orders are triggered.\n    /// Valid values are:\n    /// 0 - The default value. The \"double bid/ask\" function will be used for orders for OTC stocks and US options. All other orders will used the \"last\" function.\n    /// 1 - use \"double bid/ask\" function, where stop orders are triggered based on two consecutive bid or ask prices.\n    /// 2 - \"last\" function, where stop orders are triggered based on the last price.\n    /// 3 - double last function.\n    /// 4 - bid/ask function.\n    /// 7 - last or bid/ask function.\n    /// 8 - mid-point function.    \n    pub trigger_method: i32,\n    /// If set to true, allows orders to also trigger or fill outside of regular trading hours.\n    pub outside_rth: bool,\n    /// If set to true, the order will not be visible when viewing the market depth. This option only applies to orders routed to the NASDAQ exchange.\n    pub hidden: bool,\n    /// Specifies the date and time after which the order will be active.\n    /// Format: yyyymmdd hh:mm:ss {optional Timezone}.\n    pub good_after_time: String,\n    /// The date and time until the order will be active.\n    /// You must enter GTD as the time in force to use this string. The trade's \"Good Till Date,\" format \"yyyyMMdd HH:mm:ss (optional time zone)\" or UTC \"yyyyMMdd-HH:mm:ss\".\n    pub good_till_date: String,\n    /// Overrides TWS constraints.\n    /// Precautionary constraints are defined on the TWS Presets page, and help ensure tha tyour price and size order values are reasonable. Orders sent from the API are also validated against these safety constraints, and may be rejected if any constraint is violated. To override validation, set this parameters value to True.\n    pub override_percentage_constraints: bool,\n    /// Individual = 'I', Agency = 'A', AgentOtherMember = 'W', IndividualPTIA = 'J', AgencyPTIA = 'U', AgentOtherMemberPTIA = 'M', IndividualPT = 'K', AgencyPT = 'Y', AgentOtherMemberPT = 'N'\n    pub rule_80_a: Option\u003cRule80A\u003e,\n    /// Indicates whether or not all the order has to be filled on a single execution.\n    pub all_or_none: bool,\n    /// Identifies a minimum quantity order type.\n    pub min_qty: Option\u003ci32\u003e,\n    /// The percent offset amount for relative orders.\n    pub percent_offset: Option\u003cf64\u003e,\n    /// Trail stop price for TRAIL LIMIT orders.\n    pub trail_stop_price: Option\u003cf64\u003e,\n    /// Specifies the trailing amount of a trailing stop order as a percentage.\n    /// Observe the following guidelines when using the trailingPercent field:\n    ///\n    /// This field is mutually exclusive with the existing trailing amount. That is, the API client can send one or the other but not both.\n    /// This field is read AFTER the stop price (barrier price) as follows: deltaNeutralAuxPrice stopPrice, trailingPercent, scale order attributes\n    /// The field will also be sent to the API in the openOrder message if the API client version is \u003e= 56. It is sent after the stopPrice field as follows: stopPrice, trailingPct, basisPoint.    \n    pub trailing_percent: Option\u003cf64\u003e,\n    /// The Financial Advisor group the trade will be allocated to. Use an empty string if not applicable.\n    pub fa_group: String,\n    /// The Financial Advisor allocation profile the trade will be allocated to. Use an empty string if not applicable.\n    pub fa_profile: String,\n    /// The Financial Advisor allocation method the trade will be allocated to. Use an empty string if not applicable.\n    pub fa_method: String,\n    /// The Financial Advisor percentage concerning the trade's allocation. Use an empty string if not applicable.\n    pub fa_percentage: String,\n    /// For institutional customers only. Valid values are O (open) and C (close).\n    /// Available for institutional clients to determine if this order is to open or close a position.\n    /// When Action = \"BUY\" and OpenClose = \"O\" this will open a new position.\n    /// When Action = \"BUY\" and OpenClose = \"C\" this will close and existing short position.    \n    pub open_close: Option\u003cOrderOpenClose\u003e,\n    /// The order's origin. Same as TWS \"Origin\" column. Identifies the type of customer from which the order originated.\n    /// Valid values are:\n    /// 0 - Customer\n    /// 1 - Firm.\n    pub origin: i32,\n    /// For institutions only.\n    /// Valid values are:\n    /// 1 - Broker holds shares\n    /// 2 - Shares come from elsewhere.    \n    pub short_sale_slot: i32,\n    /// For institutions only. Indicates the location where the shares to short come from. Used only when short sale slot is set to 2 (which means that the shares to short are held elsewhere and not with IB).\n    pub designated_location: String,\n    /// Only available with IB Execution-Only accounts with applicable securities.\n    /// Mark order as exempt from short sale uptick rule.\n    pub exempt_code: i32,\n    /// The amount off the limit price allowed for discretionary orders.\n    pub discretionary_amt: f64,\n    /// Use to opt out of default SmartRouting for orders routed directly to ASX.\n    /// This attribute defaults to false unless explicitly set to true.\n    /// When set to false, orders routed directly to ASX will NOT use SmartRouting.\n    /// When set to true, orders routed directly to ASX orders WILL use SmartRouting.\n    pub opt_out_smart_routing: bool,\n    /// For BOX orders only.\n    /// Values include:\n    /// 1 - Match\n    /// 2 - Improvement\n    /// 3 - Transparent.\n    pub auction_strategy: Option\u003ci32\u003e, // FIXME enum\n    /// The auction's starting price. For BOX orders only.\n    pub starting_price: Option\u003cf64\u003e,\n    /// The stock's reference price.\n    /// The reference price is used for VOL orders to compute the limit price sent to an exchange (whether or not Continuous Update is selected), and for price range monitoring.    \n    pub stock_ref_price: Option\u003cf64\u003e,\n    /// The stock's Delta. For orders on BOX only.\n    pub delta: Option\u003cf64\u003e,\n    /// The lower value for the acceptable underlying stock price range.\n    /// For price improvement option orders on BOX and VOL orders with dynamic management.    \n    pub stock_range_lower: Option\u003cf64\u003e,\n    /// The upper value for the acceptable underlying stock price range.\n    /// For price improvement option orders on BOX and VOL orders with dynamic management.\n    pub stock_range_upper: Option\u003cf64\u003e,\n    /// The option price in volatility, as calculated by TWS' Option Analytics.\n    /// This value is expressed as a percent and is used to calculate the limit price sent to the exchange.\n    pub volatility: Option\u003cf64\u003e,\n    /// Values include:\n    /// 1 - Daily Volatility\n    /// 2 - Annual Volatility.\n    pub volatility_type: Option\u003ci32\u003e, // FIXM enum\n    /// Specifies whether TWS will automatically update the limit price of the order as the underlying price moves. VOL orders only.\n    pub continuous_update: bool,\n    /// Specifies how you want TWS to calculate the limit price for options, and for stock range price monitoring.\n    /// VOL orders only.\n    /// Valid values include:\n    /// 1 - Average of NBBO\n    /// 2 - NBB or the NBO depending on the action and right.\n    pub reference_price_type: Option\u003ci32\u003e,\n    /// Enter an order type to instruct TWS to submit a delta neutral trade on full or partial execution of the VOL order. VOL orders only. For no hedge delta order to be sent, specify NONE.\n    pub delta_neutral_order_type: String,\n    /// Use this field to enter a value if the value in the deltaNeutralOrderType field is an order type that requires an Aux price, such as a REL order. VOL orders only.\n    pub delta_neutral_aux_price: Option\u003cf64\u003e,\n    /// The unique contract identifier specifying the security in Delta Neutral order.\n    pub delta_neutral_con_id: i32,\n    /// Indicates the firm which will settle the Delta Neutral trade. Institutions only.\n    pub delta_neutral_settling_firm: String,\n    /// Specifies the beneficiary of the Delta Neutral order.\n    pub delta_neutral_clearing_account: String,\n    /// Specifies where the clients want their shares to be cleared at. Must be specified by execution-only clients.\n    /// Valid values are:\n    /// IB, Away, and PTA (post trade allocation).\n    pub delta_neutral_clearing_intent: String,\n    /// Specifies whether the order is an Open or a Close order and is used when the hedge involves a CFD and and the order is clearing away.\n    pub delta_neutral_open_close: String,\n    /// Used when the hedge involves a stock and indicates whether or not it is sold short.\n    pub delta_neutral_short_sale: bool,\n    /// Indicates a short sale Delta Neutral order. Has a value of 1 (the clearing broker holds shares) or 2 (delivered from a third party). If you use 2, then you must specify a deltaNeutralDesignatedLocation.\n    pub delta_neutral_short_sale_slot: i32,\n    /// Identifies third party order origin. Used only when deltaNeutralShortSaleSlot = 2.\n    pub delta_neutral_designated_location: String,\n    /// Specifies Basis Points for EFP order. The values increment in 0.01% = 1 basis point. For EFP orders only.\n    pub basis_points: Option\u003cf64\u003e,\n    /// Specifies the increment of the Basis Points. For EFP orders only.\n    pub basis_points_type: Option\u003ci32\u003e,\n    /// Defines the size of the first, or initial, order component. For Scale orders only.\n    pub scale_init_level_size: Option\u003ci32\u003e,\n    /// Defines the order size of the subsequent scale order components. For Scale orders only. Used in conjunction with scaleInitLevelSize().\n    pub scale_subs_level_size: Option\u003ci32\u003e,\n    /// Defines the price increment between scale components. For Scale orders only. This value is compulsory.\n    pub scale_price_increment: Option\u003cf64\u003e,\n    /// Modifies the value of the Scale order. For extended Scale orders.\n    pub scale_price_adjust_value: Option\u003cf64\u003e,\n    /// Specifies the interval when the price is adjusted. For extended Scale orders.\n    pub scale_price_adjust_interval: Option\u003ci32\u003e,\n    /// Specifies the offset when to adjust profit. For extended scale orders.\n    pub scale_profit_offset: Option\u003cf64\u003e,\n    /// Restarts the Scale series if the order is cancelled. For extended scale orders.\n    pub scale_auto_reset: bool,\n    /// The initial position of the Scale order. For extended scale orders.\n    pub scale_init_position: Option\u003ci32\u003e,\n    /// Specifies the initial quantity to be filled. For extended scale orders.\n    pub scale_init_fill_qty: Option\u003ci32\u003e,\n    /// Defines the random percent by which to adjust the position. For extended scale orders.\n    pub scale_random_percent: bool,\n    /// For hedge orders.\n    /// Possible values include:\n    /// D - Delta\n    /// B - Beta\n    /// F - FX\n    /// P - Pair\n    pub hedge_type: String,\n    /// For hedge orders.\n    /// Beta = x for Beta hedge orders, ratio = y for Pair hedge order\n    pub hedge_param: String,\n    /// The account the trade will be allocated to.    \n    pub account: String,\n    /// Indicates the firm which will settle the trade. Institutions only.\n    pub settling_firm: String,\n    /// Specifies the true beneficiary of the order.\n    /// For IBExecution customers. This value is required for FUT/FOP orders for reporting to the exchange.\n    pub clearing_account: String,\n    /// For execution-only clients to know where do they want their shares to be cleared at.\n    /// Valid values are:\n    /// IB, Away, and PTA (post trade allocation).\n    pub clearing_intent: String,\n    /// The algorithm strategy.\n    /// As of API verion 9.6, the following algorithms are supported:\n    /// ArrivalPx - Arrival Price\n    /// DarkIce - Dark Ice\n    /// PctVol - Percentage of Volume\n    /// Twap - TWAP (Time Weighted Average Price)\n    /// Vwap - VWAP (Volume Weighted Average Price)\n    /// For more information about IB's API algorithms, refer to [https://www.interactivebrokers.com/en/software/api/apiguide/tables/ibalgo_parameters.htm](https://www.interactivebrokers.com/en/software/api/apiguide/tables/ibalgo_parameters.htm)\n    pub algo_strategy: String,\n    /// The list of parameters for the IB algorithm.\n    /// For more information about IB's API algorithms, refer to [https://www.interactivebrokers.com/en/software/api/apiguide/tables/ibalgo_parameters.htm](https://www.interactivebrokers.com/en/software/api/apiguide/tables/ibalgo_parameters.htm)\n    pub algo_params: Vec\u003cTagValue\u003e,\n    /// Allows to retrieve the commissions and margin information.\n    /// When placing an order with this attribute set to true, the order will not be placed as such. Instead it will used to request the commissions and margin information that would result from this order.\n    pub what_if: bool,\n    /// Identifies orders generated by algorithmic trading.\n    pub algo_id: String,\n    /// Orders routed to IBDARK are tagged as post only and are held in IB's order book, where incoming SmartRouted orders from other IB customers are eligible to trade against them.\n    /// For IBDARK orders only.\n    pub not_held: bool,\n    /// Advanced parameters for Smart combo routing.\n    /// These features are for both guaranteed and nonguaranteed combination orders routed to Smart, and are available based on combo type and order type. SmartComboRoutingParams is similar to AlgoParams in that it makes use of tag/value pairs to add parameters to combo orders.\n    /// Make sure that you fully understand how Advanced Combo Routing works in TWS itself first: \u003chttps://guides.interactivebrokers.com/tws/twsguide.htm#usersguidebook/specializedorderentry/advanced_combo_routing.htm\u003e\n    /// The parameters cover the following capabilities:\n    ///\n    /// * Non-Guaranteed - Determine if the combo order is Guaranteed or Non-Guaranteed.\n    ///   \u003cbr/\u003eTag = NonGuaranteed\n    ///   \u003cbr/\u003eValue = 0: The order is guaranteed\n    ///   \u003cbr/\u003eValue = 1: The order is non-guaranteed\n    ///\n    /// * Select Leg to Fill First - User can specify which leg to be executed first.\n    ///   \u003cbr/\u003eTag = LeginPrio\n    ///   \u003cbr/\u003eValue = -1: No priority is assigned to either combo leg\n    ///   \u003cbr/\u003eValue = 0: Priority is assigned to the first leg being added to the comboLeg\n    ///   \u003cbr/\u003eValue = 1: Priority is assigned to the second leg being added to the comboLeg\n    ///   \u003cbr/\u003eNote: The LeginPrio parameter can only be applied to two-legged combo.\n    ///\n    /// * Maximum Leg-In Combo Size - Specify the maximum allowed leg-in size per segment\n    ///   \u003cbr/\u003eTag = MaxSegSize\n    ///   \u003cbr/\u003eValue = Unit of combo size\n    ///\n    /// * Do Not Start Next Leg-In if Previous Leg-In Did Not Finish - Specify whether or not the system should attempt to fill the next segment before the current segment fills.\n    ///   \u003cbr/\u003eTag = DontLeginNext\n    ///   \u003cbr/\u003eValue = 0: Start next leg-in even if previous leg-in did not finish\n    ///   \u003cbr/\u003eValue = 1: Do not start next leg-in if previous leg-in did not finish\n    ///\n    /// * Price Condition - Combo order will be rejected or cancelled if the leg market price is outside of the specified price range [CondPriceMin, CondPriceMax]\n    ///   \u003cbr/\u003eTag = PriceCondConid: The ContractID of the combo leg to specify price condition on\n    ///   \u003cbr/\u003eValue = The ContractID\n    ///   \u003cbr/\u003eTag = CondPriceMin: The lower price range of the price condition\n    ///   \u003cbr/\u003eValue = The lower price\n    ///   \u003cbr/\u003eTag = CondPriceMax: The upper price range of the price condition\n    ///   \u003cbr/\u003eValue = The upper price    \n    pub smart_combo_routing_params: Vec\u003cTagValue\u003e,\n    /// List of Per-leg price following the same sequence combo legs are added. The combo price must be left unspecified when using per-leg prices.\n    pub order_combo_legs: Vec\u003cOrderComboLeg\u003e,\n    /// For internal use only. Use the default value XYZ.\n    pub order_misc_options: Vec\u003cTagValue\u003e,\n    /// Defines the start time of GTC orders.\n    pub active_start_time: String,\n    /// Defines the stop time of GTC orders.\n    pub active_stop_time: String,\n    /// The list of scale orders. Used for scale orders.\n    pub scale_table: String,\n    /// Is used to place an order to a model. For example, \"Technology\" model can be used for tech stocks first created in TWS.\n    pub model_code: String,\n    /// This is a regulartory attribute that applies to all US Commodity (Futures) Exchanges, provided to allow client to comply with CFTC Tag 50 Rules.\n    pub ext_operator: String,\n    /// The native cash quantity.\n    pub cash_qty: Option\u003cf64\u003e,\n    /// Identifies a person as the responsible party for investment decisions within the firm. Orders covered by MiFID 2 (Markets in Financial Instruments Directive 2) must include either Mifid2DecisionMaker or Mifid2DecisionAlgo field (but not both). Requires TWS 969+.\n    pub mifid2_decision_maker: String,\n    /// Identifies the algorithm responsible for investment decisions within the firm. Orders covered under MiFID 2 must include either Mifid2DecisionMaker or Mifid2DecisionAlgo, but cannot have both. Requires TWS 969+.\n    pub mifid2_decision_algo: String,\n    /// For MiFID 2 reporting; identifies a person as the responsible party for the execution of a transaction within the firm. Requires TWS 969+.\n    pub mifid2_execution_trader: String,\n    /// For MiFID 2 reporting; identifies the algorithm responsible for the execution of a transaction within the firm. Requires TWS 969+.\n    pub mifid2_execution_algo: String,\n    /// Don't use auto price for hedge.\n    pub dont_use_auto_price_for_hedge: bool,\n    /// Specifies the date to auto cancel the order.\n    pub auto_cancel_date: String, // TODO date object\n    /// Specifies the initial order quantity to be filled.\n    pub filled_quantity: f64,\n    /// Identifies the reference future conId.\n    pub ref_futures_con_id: Option\u003ci32\u003e,\n    /// Cancels the parent order if child order was cancelled.\n    pub auto_cancel_parent: bool,\n    /// Identifies the Shareholder.\n    pub shareholder: String,\n    /// Used to specify \"imbalance only open orders\" or \"imbalance only closing orders\".\n    pub imbalance_only: bool,\n    /// Routes market order to Best Bid Offer.\n    pub route_marketable_to_bbo: bool,\n    /// Parent order Id.\n    pub parent_perm_id: Option\u003ci64\u003e,\n    /// Accepts a list with parameters obtained from advancedOrderRejectJson.\n    pub advanced_error_override: String,\n    /// Used by brokers and advisors when manually entering, modifying or cancelling orders at the direction of a client. Only used when allocating orders to specific groups or accounts. Excluding \"All\" group.\n    pub manual_order_time: String,\n    /// Defines the minimum trade quantity to fill. For IBKRATS orders.\n    pub min_trade_qty: Option\u003ci32\u003e,\n    /// Defines the minimum size to compete. For IBKRATS orders.\n    pub min_compete_size: Option\u003ci32\u003e,\n    /// Specifies the offset off the midpoint that will be applied to the order. For IBKRATS orders.\n    pub compete_against_best_offset: Option\u003cf64\u003e,\n    /// his offset is applied when the spread is an even number of cents wide. This offset must be in whole-penny increments or zero. For IBKRATS orders.\n    pub mid_offset_at_whole: Option\u003cf64\u003e,\n    /// This offset is applied when the spread is an odd number of cents wide. This offset must be in half-penny increments. For IBKRATS orders.\n    pub mid_offset_at_half: Option\u003cf64\u003e,\n    /// Randomizes the order's size. Only for Volatility and Pegged to Volatility orders.\n    pub randomize_size: bool,\n    /// Randomizes the order's price. Only for Volatility and Pegged to Volatility orders.\n    pub randomize_price: bool,\n    /// Pegged-to-benchmark orders: this attribute will contain the conId of the contract against which the order will be pegged.\n    pub reference_contract_id: i32,\n    /// Pegged-to-benchmark orders: indicates whether the order's pegged price should increase or decreases.\n    pub is_pegged_change_amount_decrease: bool,\n    /// Pegged-to-benchmark orders: amount by which the order's pegged price should move.\n    pub pegged_change_amount: Option\u003cf64\u003e,\n    /// Pegged-to-benchmark orders: the amount the reference contract needs to move to adjust the pegged order.\n    pub reference_change_amount: Option\u003cf64\u003e,\n    /// Pegged-to-benchmark orders: the exchange against which we want to observe the reference contract.\n    pub reference_exchange: String,\n    /// Adjusted Stop orders: the parent order will be adjusted to the given type when the adjusted trigger price is penetrated.\n    pub adjusted_order_type: String,\n    /// Adjusted Stop orders: specifies the trigger price to execute.\n    pub trigger_price: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies the price offset for the stop to move in increments.\n    pub limit_price_offset: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies the stop price of the adjusted (STP) parent.\n    pub adjusted_stop_price: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies the stop limit price of the adjusted (STPL LMT) parent.\n    pub adjusted_stop_limit_price: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies the trailing amount of the adjusted (TRAIL) parent.\n    pub adjusted_trailing_amount: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies where the trailing unit is an amount (set to 0) or a percentage (set to 1)\n    pub adjustable_trailing_unit: i32,\n    /// Conditions determining when the order will be activated or canceled.\n    pub conditions: Vec\u003cOrderCondition\u003e,\n    /// Indicates whether or not conditions will also be valid outside Regular Trading Hours.\n    pub conditions_ignore_rth: bool,\n    /// Conditions can determine if an order should become active or canceled.\n    pub conditions_cancel_order: bool,\n    /// Define the Soft Dollar Tier used for the order. Only provided for registered professional advisors and hedge and mutual funds.\n    pub soft_dollar_tier: SoftDollarTier,\n    /// Set to true to create tickets from API orders when TWS is used as an OMS.\n    pub is_oms_container: bool,\n    /// Set to true to convert order of type 'Primary Peg' to 'D-Peg'.\n    pub discretionary_up_to_limit_price: bool,\n    /// Specifies wether to use Price Management Algo. CTCI users only.\n    pub use_price_mgmt_algo: bool,\n    /// Specifies the duration of the order. Format: yyyymmdd hh:mm:ss TZ. For GTD orders.\n    pub duration: Option\u003ci32\u003e, // TODO date object?\n    /// Value must be positive, and it is number of seconds that SMART order would be parked for at IBKRATS before being routed to exchange.\n    pub post_to_ats: Option\u003ci32\u003e,\n}\n\nimpl Default for Order {\n    fn default() -\u003e Self {\n        Self {\n            order_id: 0,\n            solicited: false,\n            client_id: 0,\n            perm_id: 0,\n            action: Action::Buy,\n            total_quantity: 0.0,\n            order_type: \"\".to_owned(),\n            limit_price: None,\n            aux_price: None,\n            tif: \"\".to_owned(),\n            oca_group: \"\".to_owned(),\n            oca_type: 0,\n            order_ref: \"\".to_owned(),\n            transmit: true,\n            parent_id: 0,\n            block_order: false,\n            sweep_to_fill: false,\n            display_size: Some(0), // TODO - default to None?\n            trigger_method: 0,\n            outside_rth: false,\n            hidden: false,\n            good_after_time: \"\".to_owned(),\n            good_till_date: \"\".to_owned(),\n            override_percentage_constraints: false,\n            rule_80_a: None,\n            all_or_none: false,\n            min_qty: None,\n            percent_offset: None,\n            trail_stop_price: None,\n            trailing_percent: None,\n            fa_group: \"\".to_owned(),\n            fa_profile: \"\".to_owned(),\n            fa_method: \"\".to_owned(),\n            fa_percentage: \"\".to_owned(),\n            open_close: None,\n            origin: 0,\n            short_sale_slot: 0,\n            designated_location: \"\".to_owned(),\n            exempt_code: -1,\n            discretionary_amt: 0.0,\n            opt_out_smart_routing: false,\n            auction_strategy: Some(0), // TODO - use enum\n            starting_price: None,\n            stock_ref_price: None,\n            delta: None,\n            stock_range_lower: None,\n            stock_range_upper: None,\n            volatility: None,\n            volatility_type: None,\n            continuous_update: false,\n            reference_price_type: None,\n            delta_neutral_order_type: \"\".to_owned(),\n            delta_neutral_aux_price: None,\n            delta_neutral_con_id: 0,\n            delta_neutral_settling_firm: \"\".to_owned(),\n            delta_neutral_clearing_account: \"\".to_owned(),\n            delta_neutral_clearing_intent: \"\".to_owned(),\n            delta_neutral_open_close: \"\".to_owned(),\n            delta_neutral_short_sale: false,\n            delta_neutral_short_sale_slot: 0,\n            delta_neutral_designated_location: \"\".to_owned(),\n            basis_points: Some(0.0),\n            basis_points_type: Some(0),\n            scale_init_level_size: None,\n            scale_subs_level_size: None,\n            scale_price_increment: None,\n            scale_price_adjust_value: None,\n            scale_price_adjust_interval: None,\n            scale_profit_offset: None,\n            scale_auto_reset: false,\n            scale_init_position: None,\n            scale_init_fill_qty: None,\n            scale_random_percent: false,\n            hedge_type: \"\".to_owned(),\n            hedge_param: \"\".to_owned(),\n            account: \"\".to_owned(),\n            settling_firm: \"\".to_owned(),\n            clearing_account: \"\".to_owned(),\n            clearing_intent: \"\".to_owned(),\n            algo_strategy: \"\".to_owned(),\n            algo_params: vec![],\n            what_if: false,\n            algo_id: \"\".to_owned(),\n            not_held: false,\n            smart_combo_routing_params: vec![],\n            order_combo_legs: vec![],\n            order_misc_options: vec![],\n            active_start_time: \"\".to_owned(),\n            active_stop_time: \"\".to_owned(),\n            scale_table: \"\".to_owned(),\n            model_code: \"\".to_owned(),\n            ext_operator: \"\".to_owned(),\n            cash_qty: None,\n            mifid2_decision_maker: \"\".to_owned(),\n            mifid2_decision_algo: \"\".to_owned(),\n            mifid2_execution_trader: \"\".to_owned(),\n            mifid2_execution_algo: \"\".to_owned(),\n            dont_use_auto_price_for_hedge: false,\n            auto_cancel_date: \"\".to_owned(),\n            filled_quantity: 0.0,\n            ref_futures_con_id: Some(0),\n            auto_cancel_parent: false,\n            shareholder: \"\".to_owned(),\n            imbalance_only: false,\n            route_marketable_to_bbo: false,\n            parent_perm_id: None,\n            advanced_error_override: \"\".to_owned(),\n            manual_order_time: \"\".to_owned(),\n            min_trade_qty: None,\n            min_compete_size: None,\n            compete_against_best_offset: None,\n            mid_offset_at_whole: None,\n            mid_offset_at_half: None,\n            randomize_size: false,\n            randomize_price: false,\n            reference_contract_id: 0,\n            is_pegged_change_amount_decrease: false,\n            pegged_change_amount: Some(0.0),\n            reference_change_amount: Some(0.0),\n            reference_exchange: \"\".to_owned(),\n            adjusted_order_type: \"\".to_owned(),\n            trigger_price: None,\n            limit_price_offset: None,\n            adjusted_stop_price: None,\n            adjusted_stop_limit_price: None,\n            adjusted_trailing_amount: None,\n            adjustable_trailing_unit: 0,\n            conditions: vec![],\n            conditions_ignore_rth: false,\n            conditions_cancel_order: false,\n            soft_dollar_tier: SoftDollarTier::default(),\n            is_oms_container: false,\n            discretionary_up_to_limit_price: false,\n            use_price_mgmt_algo: false,\n            duration: None,\n            post_to_ats: None,\n        }\n    }\n}\n\nimpl Order {\n    pub fn is_delta_neutral(\u0026self) -\u003e bool {\n        !self.delta_neutral_order_type.is_empty()\n    }\n\n    pub fn is_scale_order(\u0026self) -\u003e bool {\n        match self.scale_price_increment {\n            Some(price_increment) =\u003e price_increment \u003e 0.0,\n            _ =\u003e false,\n        }\n    }\n}\n\n/// Identifies the side.\n/// Generally available values are BUY and SELL.\n/// Additionally, SSHORT and SLONG are available in some institutional-accounts only.\n/// For general account types, a SELL order will be able to enter a short position automatically if the order quantity is larger than your current long position.\n/// SSHORT is only supported for institutional account configured with Long/Short account segments or clearing with a separate account.\n/// SLONG is available in specially-configured institutional accounts to indicate that long position not yet delivered is being sold.\n#[derive(Clone, Debug, Default, PartialEq, Eq)]\npub enum Action {\n    #[default]\n    Buy,\n    Sell,\n    /// SSHORT is only supported for institutional account configured with Long/Short account segments or clearing with a separate account.\n    SellShort,\n    /// SLONG is available in specially-configured institutional accounts to indicate that long position not yet delivered is being sold.\n    SellLong,\n}\n\nimpl ToField for Action {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToString for Action {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            Action::Buy =\u003e String::from(\"BUY\"),\n            Action::Sell =\u003e String::from(\"SELL\"),\n            Action::SellShort =\u003e String::from(\"SSHORT\"),\n            Action::SellLong =\u003e String::from(\"SLONG\"),\n        }\n    }\n}\n\nimpl Action {\n    fn reverse(\u0026self) -\u003e Action {\n        match self {\n            Action::Buy =\u003e Action::Sell,\n            Action::Sell =\u003e Action::Buy,\n            Action::SellShort =\u003e Action::SellLong,\n            Action::SellLong =\u003e Action::SellShort,\n        }\n    }\n\n    pub fn from(name: \u0026str) -\u003e Self {\n        match name {\n            \"BUY\" =\u003e Self::Buy,\n            \"SELL\" =\u003e Self::Sell,\n            \"SSHORT\" =\u003e Self::SellShort,\n            \"SLONG\" =\u003e Self::SellLong,\n            \u0026_ =\u003e todo!(),\n        }\n    }\n}\n\n#[derive(Clone, Debug, PartialEq)]\npub enum Rule80A {\n    Individual,\n    Agency,\n    AgentOtherMember,\n    IndividualPTIA,\n    AgencyPTIA,\n    AgentOtherMemberPTIA,\n    IndividualPT,\n    AgencyPT,\n    AgentOtherMemberPT,\n}\n\nimpl ToField for Rule80A {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003cRule80A\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl ToString for Rule80A {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            Rule80A::Individual =\u003e String::from('I'),\n            Rule80A::Agency =\u003e String::from('A'),\n            Rule80A::AgentOtherMember =\u003e String::from('W'),\n            Rule80A::IndividualPTIA =\u003e String::from('J'),\n            Rule80A::AgencyPTIA =\u003e String::from('U'),\n            Rule80A::AgentOtherMemberPTIA =\u003e String::from('M'),\n            Rule80A::IndividualPT =\u003e String::from('K'),\n            Rule80A::AgencyPT =\u003e String::from('Y'),\n            Rule80A::AgentOtherMemberPT =\u003e String::from('N'),\n        }\n    }\n}\n\nimpl Rule80A {\n    pub fn from(source: \u0026str) -\u003e Option\u003cSelf\u003e {\n        match source {\n            \"I\" =\u003e Some(Rule80A::Individual),\n            \"A\" =\u003e Some(Rule80A::Agency),\n            \"W\" =\u003e Some(Rule80A::AgentOtherMember),\n            \"J\" =\u003e Some(Rule80A::IndividualPTIA),\n            \"U\" =\u003e Some(Rule80A::AgencyPTIA),\n            \"M\" =\u003e Some(Rule80A::AgentOtherMemberPTIA),\n            \"K\" =\u003e Some(Rule80A::IndividualPT),\n            \"Y\" =\u003e Some(Rule80A::AgencyPT),\n            \"N\" =\u003e Some(Rule80A::AgentOtherMemberPT),\n            _ =\u003e None,\n        }\n    }\n}\n\npub enum AuctionStrategy {\n    Match,\n    Improvement,\n    Transparent,\n}\n\n#[derive(Clone, Debug, Default)]\npub struct OrderComboLeg {\n    price: Option\u003cf64\u003e,\n}\n\n#[derive(Copy, Clone, Debug)]\npub enum OrderCondition {\n    Price = 1,\n    Time = 3,\n    Margin = 4,\n    Execution = 5,\n    Volume = 6,\n    PercentChange = 7,\n}\n\nimpl ToField for OrderCondition {\n    fn to_field(\u0026self) -\u003e String {\n        (*self as u8).to_string()\n    }\n}\n\nimpl ToField for Option\u003cOrderCondition\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl From\u003ci32\u003e for OrderCondition {\n    fn from(val: i32) -\u003e Self {\n        match val {\n            1 =\u003e OrderCondition::Price,\n            3 =\u003e OrderCondition::Time,\n            4 =\u003e OrderCondition::Volume,\n            5 =\u003e OrderCondition::Execution,\n            6 =\u003e OrderCondition::Volume,\n            7 =\u003e OrderCondition::PercentChange,\n            _ =\u003e panic!(\"OrderCondition({val}) is unsupported\"),\n        }\n    }\n}\n\n/// Stores Soft Dollar Tier information.\n#[derive(Clone, Debug, Default)]\npub struct SoftDollarTier {\n    pub name: String,\n    pub value: String,\n    pub display_name: String,\n}\n\n#[derive(Clone, Debug, Default)]\npub struct OrderData {\n    /// The order's unique id\n    pub order_id: i32,\n    /// The order's Contract.\n    pub contract: Contract,\n    /// The currently active order\n    pub order: Order,\n    /// The order's OrderState\n    pub order_state: OrderState,\n}\n\n/// Provides an active order's current state.\n#[derive(Clone, Debug, Default)]\npub struct OrderState {\n    /// The order's current status\n    pub status: String,\n    /// The account's current initial margin.\n    pub initial_margin_before: Option\u003cf64\u003e,\n    /// The account's current maintenance margin\n    pub maintenance_margin_before: Option\u003cf64\u003e,\n    /// The account's current equity with loan\n    pub equity_with_loan_before: Option\u003cf64\u003e,\n    /// The change of the account's initial margin.\n    pub initial_margin_change: Option\u003cf64\u003e,\n    /// The change of the account's maintenance margin\n    pub maintenance_margin_change: Option\u003cf64\u003e,\n    /// The change of the account's equity with loan\n    pub equity_with_loan_change: Option\u003cf64\u003e,\n    /// The order's impact on the account's initial margin.\n    pub initial_margin_after: Option\u003cf64\u003e,\n    /// The order's impact on the account's maintenance margin\n    pub maintenance_margin_after: Option\u003cf64\u003e,\n    /// Shows the impact the order would have on the account's equity with loan\n    pub equity_with_loan_after: Option\u003cf64\u003e,\n    /// The order's generated commission.\n    pub commission: Option\u003cf64\u003e,\n    // The execution's minimum commission.\n    pub minimum_commission: Option\u003cf64\u003e,\n    /// The executions maximum commission.\n    pub maximum_commission: Option\u003cf64\u003e,\n    /// The generated commission currency\n    pub commission_currency: String,\n    /// If the order is warranted, a descriptive message will be provided.\n    pub warning_text: String,\n    pub completed_time: String,\n    pub completed_status: String,\n}\n\n/// For institutional customers only. Valid values are O (open) and C (close).\n/// Available for institutional clients to determine if this order is to open or close a position.\n/// When Action = \"BUY\" and OpenClose = \"O\" this will open a new position.\n/// When Action = \"BUY\" and OpenClose = \"C\" this will close and existing short position.\n#[derive(Clone, Debug, PartialEq)]\npub enum OrderOpenClose {\n    Open,\n    Close,\n}\n\nimpl ToField for OrderOpenClose {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003cOrderOpenClose\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl ToString for OrderOpenClose {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            OrderOpenClose::Open =\u003e String::from(\"O\"),\n            OrderOpenClose::Close =\u003e String::from(\"C\"),\n        }\n    }\n}\n\nimpl OrderOpenClose {\n    pub fn from(source: \u0026str) -\u003e Option\u003cSelf\u003e {\n        match source {\n            \"O\" =\u003e Some(OrderOpenClose::Open),\n            \"C\" =\u003e Some(OrderOpenClose::Close),\n            _ =\u003e None,\n        }\n    }\n}\n\n/// Represents the commission generated by an execution.\n#[derive(Clone, Debug, Default)]\npub struct CommissionReport {\n    /// the execution's id this commission belongs to.\n    pub execution_id: String,\n    /// the commissions cost.\n    pub commission: f64,\n    /// the reporting currency.\n    pub currency: String,\n    /// the realized profit and loss\n    pub realized_pnl: Option\u003cf64\u003e,\n    /// The income return.\n    pub yields: Option\u003cf64\u003e,\n    /// date expressed in yyyymmdd format.\n    pub yield_redemption_date: String,\n}\n\n#[derive(Clone, Debug, Default, PartialEq)]\npub enum Liquidity {\n    #[default]\n    None = 0,\n    AddedLiquidity = 1,\n    RemovedLiquidity = 2,\n    LiquidityRoutedOut = 3,\n}\n\nimpl From\u003ci32\u003e for Liquidity {\n    fn from(val: i32) -\u003e Self {\n        match val {\n            0 =\u003e Liquidity::None,\n            1 =\u003e Liquidity::AddedLiquidity,\n            2 =\u003e Liquidity::RemovedLiquidity,\n            3 =\u003e Liquidity::LiquidityRoutedOut,\n            _ =\u003e panic!(\"unsupported Liquidity({val})\"),\n        }\n    }\n}\n\n/// Describes an order's execution.\n#[derive(Clone, Debug, Default)]\npub struct Execution {\n    /// The API client's order Id. May not be unique to an account.\n    pub order_id: i32,\n    /// The API client identifier which placed the order which originated this execution.\n    pub client_id: i32,\n    /// The execution's identifier. Each partial fill has a separate ExecId.\n    /// A correction is indicated by an ExecId which differs from a previous ExecId in only the digits after the final period,\n    /// e.g. an ExecId ending in \".02\" would be a correction of a previous execution with an ExecId ending in \".01\"\n    pub execution_id: String,\n    /// The execution's server time.\n    pub time: String,\n    /// The account to which the order was allocated.\n    pub account_number: String,\n    /// The exchange where the execution took place.\n    pub exchange: String,\n    /// Specifies if the transaction was buy or sale\n    /// BOT for bought, SLD for sold\n    pub side: String,\n    /// The number of shares filled.\n    pub shares: f64,\n    /// The order's execution price excluding commissions.\n    pub price: f64,\n    /// The TWS order identifier. The PermId can be 0 for trades originating outside IB.\n    pub perm_id: i32,\n    /// Identifies whether an execution occurred because of an IB-initiated liquidation.\n    pub liquidation: i32,\n    /// Cumulative quantity.\n    // Used in regular trades, combo trades and legs of the combo.\n    pub cumulative_quantity: f64,\n    /// Average price.\n    /// Used in regular trades, combo trades and legs of the combo. Does not include commissions.\n    pub average_price: f64,\n    /// The OrderRef is a user-customizable string that can be set from the API or TWS and will be associated with an order for its lifetime.\n    pub order_reference: String,\n    /// The Economic Value Rule name and the respective optional argument.\n    /// The two values should be separated by a colon. For example, aussieBond:YearsToExpiration=3. When the optional argument is not present, the first value will be followed by a colon.\n    pub ev_rule: String,\n    /// Tells you approximately how much the market value of a contract would change if the price were to change by 1.\n    /// It cannot be used to get market value by multiplying the price by the approximate multiplier.\n    pub ev_multiplier: Option\u003cf64\u003e,\n    /// model code\n    pub model_code: String,\n    // The liquidity type of the execution. Requires TWS 968+ and API v973.05+. Python API specifically requires API v973.06+.\n    pub last_liquidity: Liquidity,\n}\n\n#[derive(Clone, Debug, Default)]\npub struct ExecutionData {\n    pub request_id: i32,\n    pub contract: Contract,\n    pub execution: Execution,\n}\n\n#[derive(Clone, Debug)]\npub enum OrderNotification {\n    OrderStatus(OrderStatus),\n    OpenOrder(OrderData),\n    ExecutionData(ExecutionData),\n    CommissionReport(CommissionReport),\n    Message(String),\n}\n\nimpl From\u003cOrderStatus\u003e for OrderNotification {\n    fn from(val: OrderStatus) -\u003e Self {\n        OrderNotification::OrderStatus(val)\n    }\n}\n\nimpl From\u003cOrderData\u003e for OrderNotification {\n    fn from(val: OrderData) -\u003e Self {\n        OrderNotification::OpenOrder(val)\n    }\n}\n\nimpl From\u003cExecutionData\u003e for OrderNotification {\n    fn from(val: ExecutionData) -\u003e Self {\n        OrderNotification::ExecutionData(val)\n    }\n}\n\nimpl From\u003cCommissionReport\u003e for OrderNotification {\n    fn from(val: CommissionReport) -\u003e Self {\n        OrderNotification::CommissionReport(val)\n    }\n}\n\n/// Contains all relevant information on the current status of the order execution-wise (i.e. amount filled and pending, filling price, etc.).\n#[derive(Clone, Debug, Default)]\npub struct OrderStatus {\n    /// The order's client id.\n    order_id: i32,\n    /// The current status of the order. Possible values:\n    ///     ApiPending - indicates order has not yet been sent to IB server, for instance if there is a delay in receiving the security definition. Uncommonly received.\n    ///     PendingSubmit - indicates that you have transmitted the order, but have not yet received confirmation that it has been accepted by the order destination.\n    ///     PendingCancel - indicates that you have sent a request to cancel the order but have not yet received cancel confirmation from the order destination. At this point, your order is not confirmed canceled. It is not guaranteed that the cancellation will be successful.\n    ///     PreSubmitted - indicates that a simulated order type has been accepted by the IB system and that this order has yet to be elected. The order is held in the IB system until the election criteria are met. At that time the order is transmitted to the order destination as specified .\n    ///     Submitted - indicates that your order has been accepted by the system.\n    ///     ApiCancelled - after an order has been submitted and before it has been acknowledged, an API client client can request its cancelation, producing this state.\n    ///     Cancelled - indicates that the balance of your order has been confirmed canceled by the IB system. This could occur unexpectedly when IB or the destination has rejected your order.\n    ///     Filled - indicates that the order has been completely filled. Market orders executions will not always trigger a Filled status.\n    ///     Inactive - indicates that the order was received by the system but is no longer active because it was rejected or canceled.    \n    status: String,\n    /// Number of filled positions.\n    filled: f64,\n    /// The remnant positions.\n    remaining: f64,\n    /// Average filling price.\n    average_fill_price: f64,\n    /// The order's permId used by the TWS to identify orders.\n    perm_id: i32,\n    /// Parent's id. Used for bracket and auto trailing stop orders.\n    parent_id: i32,\n    /// Price at which the last positions were filled.\n    last_fill_price: f64,\n    /// API client which submitted the order.\n    client_id: i32,\n    /// This field is used to identify an order held when TWS is trying to locate shares for a short sell. The value used to indicate this is 'locate'.\n    why_held: String,\n    /// If an order has been capped, this indicates the current capped price. Requires TWS 967+ and API v973.04+. Python API specifically requires API v973.06+.\n    market_cap_price: f64,\n}\n\n#[derive(Debug)]\npub struct Notice(String);\n\nimpl fmt::Display for Notice {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter) -\u003e fmt::Result {\n        write!(f, \"{}\", self.0)\n    }\n}\n\n/// Submits an [Order].\n///\n/// Submits an [Order] using [Client] for the given [Contract].\n/// Immediately after the order was submitted correctly, the TWS will start sending events concerning the order's activity via IBApi.EWrapper.openOrder and IBApi.EWrapper.orderStatus\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n/// * `order_id` - ID for [Order]. Get next valid ID using [Client::next_order_id].\n/// * `contract` - [Contract] to submit order for.\n/// * `order` - [Order] to sumbit.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::contracts::Contract;\n/// use ibapi::orders::{self, order_builder, OrderNotification};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let mut contract = Contract::stock(\"MSFT\");\n///     let order = order_builder::market_order(orders::Action::Buy, 100.0);\n///     let order_id = client.next_order_id();\n///\n///     let notifications = orders::place_order(\u0026mut client, order_id, \u0026contract, \u0026order)?;\n///\n///     for notification in notifications {\n///         match notification {\n///             OrderNotification::OrderStatus(order_status) =\u003e {\n///                 println!(\"order status: {order_status:?}\")\n///             }\n///             OrderNotification::OpenOrder(open_order) =\u003e println!(\"open order: {open_order:?}\"),\n///             OrderNotification::ExecutionData(execution) =\u003e println!(\"execution: {execution:?}\"),\n///             OrderNotification::CommissionReport(report) =\u003e println!(\"commision report: {report:?}\"),\n///             OrderNotification::Message(message) =\u003e println!(\"message: {message:?}\"),\n///        }\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn place_order(client: \u0026mut Client, order_id: i32, contract: \u0026Contract, order: \u0026Order) -\u003e Result\u003cOrderNotificationIterator\u003e {\n    verify_order(client, order, order_id)?;\n    verify_order_contract(client, contract, order_id)?;\n\n    let message = encoders::encode_place_order(client.server_version(), order_id, contract, order)?;\n\n    let messages = client.send_order(order_id, message)?;\n\n    Ok(OrderNotificationIterator {\n        messages,\n        server_version: client.server_version(),\n    })\n}\n\n// https://interactivebrokers.github.io/tws-api/order_submission.html\n\n/// Supports iteration over [OrderNotification]\npub struct OrderNotificationIterator {\n    server_version: i32,\n    messages: ResponseIterator,\n}\n\nimpl Iterator for OrderNotificationIterator {\n    type Item = OrderNotification;\n\n    /// Returns the next [OrderNotification]. Waits up to x seconds for next [OrderNotification].\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        fn convert\u003cT: Into\u003cOrderNotification\u003e\u003e(result: Result\u003cT\u003e) -\u003e Option\u003cOrderNotification\u003e {\n            match result {\n                Ok(val) =\u003e Some(val.into()),\n                Err(err) =\u003e {\n                    info!(\"error: {err:?}\");\n                    None\n                }\n            }\n        }\n\n        loop {\n            if let Some(mut message) = self.messages.next() {\n                match message.message_type() {\n                    IncomingMessages::OpenOrder =\u003e {\n                        let open_order = decoders::decode_open_order(self.server_version, message);\n                        return convert(open_order);\n                    }\n                    IncomingMessages::OrderStatus =\u003e {\n                        let order_status = decoders::decode_order_status(self.server_version, \u0026mut message);\n                        return convert(order_status);\n                    }\n                    IncomingMessages::ExecutionData =\u003e {\n                        let executation_data = decoders::decode_execution_data(self.server_version, \u0026mut message);\n                        return convert(executation_data);\n                    }\n                    IncomingMessages::CommissionsReport =\u003e {\n                        let commission_report = decoders::decode_commission_report(self.server_version, \u0026mut message);\n                        return convert(commission_report);\n                    }\n                    IncomingMessages::Error =\u003e {\n                        let message = message.peek_string(4);\n                        return Some(OrderNotification::Message(message));\n                    }\n                    message =\u003e {\n                        error!(\"unexpected messsage: {message:?}\");\n                    }\n                }\n            } else {\n                return None;\n            }\n        }\n    }\n}\n\n// Verifies that Order is properly formed.\nfn verify_order(client: \u0026mut Client, order: \u0026Order, _order_id: i32) -\u003e Result\u003c()\u003e {\n    let is_bag_order: bool = false; // StringsAreEqual(Constants.BagSecType, contract.SecType)\n\n    if order.scale_init_level_size.is_some() || order.scale_price_increment.is_some() {\n        client.check_server_version(server_versions::SCALE_ORDERS, \"It does not support Scale orders.\")?\n    }\n\n    if order.what_if {\n        client.check_server_version(server_versions::WHAT_IF_ORDERS, \"It does not support what-if orders.\")?\n    }\n\n    if order.scale_subs_level_size.is_some() {\n        client.check_server_version(\n            server_versions::SCALE_ORDERS2,\n            \"It does not support Subsequent Level Size for Scale orders.\",\n        )?\n    }\n\n    if !order.algo_strategy.is_empty() {\n        client.check_server_version(server_versions::ALGO_ORDERS, \"It does not support algo orders.\")?\n    }\n\n    if order.not_held {\n        client.check_server_version(server_versions::NOT_HELD, \"It does not support not_held parameter.\")?\n    }\n\n    if order.exempt_code != -1 {\n        client.check_server_version(server_versions::SSHORTX, \"It does not support exempt_code parameter.\")?\n    }\n\n    if !order.hedge_type.is_empty() {\n        client.check_server_version(server_versions::HEDGE_ORDERS, \"It does not support hedge orders.\")?\n    }\n\n    if order.opt_out_smart_routing {\n        client.check_server_version(\n            server_versions::OPT_OUT_SMART_ROUTING,\n            \"It does not support opt_out_smart_routing parameter.\",\n        )?\n    }\n\n    if order.delta_neutral_con_id \u003e 0\n        || !order.delta_neutral_settling_firm.is_empty()\n        || !order.delta_neutral_clearing_account.is_empty()\n        || !order.delta_neutral_clearing_intent.is_empty()\n    {\n        client.check_server_version(\n            server_versions::DELTA_NEUTRAL_CONID,\n            \"It does not support delta_neutral parameters: con_id, settling_firm, clearing_account, clearing_intent.\",\n        )?\n    }\n\n    if !order.delta_neutral_open_close.is_empty()\n        || order.delta_neutral_short_sale\n        || order.delta_neutral_short_sale_slot \u003e 0\n        || !order.delta_neutral_designated_location.is_empty()\n    {\n        client.check_server_version(\n            server_versions::DELTA_NEUTRAL_OPEN_CLOSE,\n            \"It does not support delta_neutral parameters: open_close, short_sale, short_saleSlot, designated_location\",\n        )?\n    }\n\n    if (order.scale_price_increment \u003e Some(0.0))\n        \u0026\u0026 (order.scale_price_adjust_value.is_some()\n            || order.scale_price_adjust_interval.is_some()\n            || order.scale_profit_offset.is_some()\n            || order.scale_auto_reset\n            || order.scale_init_position.is_some()\n            || order.scale_init_fill_qty.is_some()\n            || order.scale_random_percent)\n    {\n        client.check_server_version(\n                server_versions::SCALE_ORDERS3,\n                \"It does not support Scale order parameters: PriceAdjustValue, PriceAdjustInterval, ProfitOffset, AutoReset, InitPosition, InitFillQty and RandomPercent\",\n            )?\n    }\n\n    if is_bag_order \u0026\u0026 order.order_combo_legs.iter().any(|combo_leg| combo_leg.price.is_some()) {\n        client.check_server_version(\n            server_versions::ORDER_COMBO_LEGS_PRICE,\n            \"It does not support per-leg prices for order combo legs.\",\n        )?\n    }\n\n    if order.trailing_percent.is_some() {\n        client.check_server_version(server_versions::TRAILING_PERCENT, \"It does not support trailing percent parameter.\")?\n    }\n\n    if !order.algo_id.is_empty() {\n        client.check_server_version(server_versions::ALGO_ID, \"It does not support algo_id parameter\")?\n    }\n\n    if !order.scale_table.is_empty() || !order.active_start_time.is_empty() || !order.active_stop_time.is_empty() {\n        client.check_server_version(\n            server_versions::SCALE_TABLE,\n            \"It does not support scale_table, active_start_time nor active_stop_time parameters.\",\n        )?\n    }\n\n    if !order.ext_operator.is_empty() {\n        client.check_server_version(server_versions::EXT_OPERATOR, \"It does not support ext_operator parameter\")?\n    }\n\n    if order.cash_qty.is_some() {\n        client.check_server_version(server_versions::CASH_QTY, \"It does not support cash_qty parameter\")?\n    }\n\n    if !order.mifid2_execution_trader.is_empty() || !order.mifid2_execution_algo.is_empty() {\n        client.check_server_version(server_versions::DECISION_MAKER, \"It does not support MIFID II execution parameters\")?\n    }\n\n    if order.dont_use_auto_price_for_hedge {\n        client.check_server_version(\n            server_versions::AUTO_PRICE_FOR_HEDGE,\n            \"It does not support don't use auto price for hedge parameter\",\n        )?\n    }\n\n    if order.is_oms_container {\n        client.check_server_version(server_versions::ORDER_CONTAINER, \"It does not support oms container parameter\")?\n    }\n\n    if order.discretionary_up_to_limit_price {\n        client.check_server_version(server_versions::D_PEG_ORDERS, \"It does not support D-Peg orders\")?\n    }\n\n    if order.use_price_mgmt_algo {\n        client.check_server_version(server_versions::PRICE_MGMT_ALGO, \"It does not support Use Price Management Algo requests\")?\n    }\n\n    if order.duration.is_some() {\n        client.check_server_version(server_versions::DURATION, \"It does not support duration attribute\")?\n    }\n\n    if order.post_to_ats.is_some() {\n        client.check_server_version(server_versions::POST_TO_ATS, \"It does not support post_to_ats attribute\")?\n    }\n\n    if order.auto_cancel_parent {\n        client.check_server_version(server_versions::AUTO_CANCEL_PARENT, \"It does not support auto_cancel_parent attribute\")?\n    }\n\n    if !order.advanced_error_override.is_empty() {\n        client.check_server_version(\n            server_versions::ADVANCED_ORDER_REJECT,\n            \"It does not support advanced error override attribute\",\n        )?\n    }\n\n    if !order.manual_order_time.is_empty() {\n        client.check_server_version(server_versions::MANUAL_ORDER_TIME, \"It does not support manual order time attribute\")?\n    }\n\n    if order.min_trade_qty.is_some()\n        || order.min_compete_size.is_some()\n        || order.compete_against_best_offset.is_some()\n        || order.mid_offset_at_whole.is_some()\n        || order.mid_offset_at_half.is_some()\n    {\n        client.check_server_version(\n            server_versions::PEGBEST_PEGMID_OFFSETS,\n            \"It does not support PEG BEST / PEG MID order parameters: minTradeQty, minCompeteSize, competeAgainstBestOffset, midOffsetAtWhole and midOffsetAtHalf\",\n        )?\n    }\n\n    Ok(())\n}\n\n// Verifies that Contract is properly formed.\nfn verify_order_contract(client: \u0026mut Client, contract: \u0026Contract, _order_id: i32) -\u003e Result\u003c()\u003e {\n    if contract\n        .combo_legs\n        .iter()\n        .any(|combo_leg| combo_leg.short_sale_slot != 0 || !combo_leg.designated_location.is_empty())\n    {\n        client.check_server_version(server_versions::SSHORT_COMBO_LEGS, \"It does not support SSHORT flag for combo legs\")?\n    }\n\n    if contract.delta_neutral_contract.is_some() {\n        client.check_server_version(server_versions::DELTA_NEUTRAL, \"It does not support delta-neutral orders\")?\n    }\n\n    if contract.contract_id \u003e 0 {\n        client.check_server_version(server_versions::PLACE_ORDER_CONID, \"It does not support contract_id parameter\")?\n    }\n\n    if !contract.security_id_type.is_empty() || !contract.security_id.is_empty() {\n        client.check_server_version(server_versions::SEC_ID_TYPE, \"It does not support sec_id_type and sec_id parameters\")?\n    }\n\n    if contract.combo_legs.iter().any(|combo_leg| combo_leg.exempt_code != -1) {\n        client.check_server_version(server_versions::SSHORTX, \"It does not support exempt_code parameter\")?\n    }\n\n    if !contract.trading_class.is_empty() {\n        client.check_server_version(\n            server_versions::TRADING_CLASS,\n            \"It does not support trading_class parameters in place_order\",\n        )?\n    }\n\n    Ok(())\n}\n\n/// Cancels an open [Order].\n///\n/// Requests the cancelation of an open [Order].\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n/// * `order_id` - ID of [Order] to cancel.\n/// * `manual_order_cancel_time` - can't find documentation. leave blank.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let order_id = 15;\n///     let results = orders::cancel_order(\u0026mut client, order_id, \"\")?;\n///     for result in results {\n///        println!(\"{result:?}\");\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn cancel_order(client: \u0026mut Client, order_id: i32, manual_order_cancel_time: \u0026str) -\u003e Result\u003cCancelOrderResultIterator\u003e {\n    if !manual_order_cancel_time.is_empty() {\n        client.check_server_version(\n            server_versions::MANUAL_ORDER_TIME,\n            \"It does not support manual order cancel time attribute\",\n        )?\n    }\n\n    let message = encoders::encode_cancel_order(client.server_version(), order_id, manual_order_cancel_time)?;\n\n    let messages = client.send_order(order_id, message)?;\n\n    Ok(CancelOrderResultIterator {\n        messages,\n        server_version: client.server_version(),\n    })\n}\n\n/// Enumerates possible results from cancelling an order.\n#[derive(Debug)]\npub enum CancelOrderResult {\n    OrderStatus(OrderStatus),\n    Notice(Notice),\n}\n\n/// Supports iteration over [CancelOrderResult]\npub struct CancelOrderResultIterator {\n    server_version: i32,\n    messages: ResponseIterator,\n}\n\nimpl Iterator for CancelOrderResultIterator {\n    type Item = CancelOrderResult;\n\n    /// Returns the next [CancelOrderResult]. Waits up to x seconds for next [CancelOrderResult].\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            if let Some(mut message) = self.messages.next() {\n                match message.message_type() {\n                    IncomingMessages::OrderStatus =\u003e match decoders::decode_order_status(self.server_version, \u0026mut message) {\n                        Ok(val) =\u003e return Some(CancelOrderResult::OrderStatus(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding order status: {err}\");\n                        }\n                    },\n                    IncomingMessages::Error =\u003e {\n                        let message = message.peek_string(4);\n                        return Some(CancelOrderResult::Notice(Notice(message)));\n                    }\n                    message =\u003e {\n                        error!(\"unexpected messsage: {message:?}\");\n                    }\n                }\n            } else {\n                return None;\n            }\n        }\n    }\n}\n\n/// Cancels all open [Order]s.\n///\n/// Requests the cancelation of all open [Order]s.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     orders::global_cancel(\u0026mut client)?;\n///\n///     Ok(())\n/// }\n/// ```\npub fn global_cancel(client: \u0026mut Client) -\u003e Result\u003c()\u003e {\n    client.check_server_version(server_versions::REQ_GLOBAL_CANCEL, \"It does not support global cancel requests.\")?;\n\n    let message = encoders::encode_global_cancel()?;\n\n    let request_id = client.next_request_id();\n    client.send_order(request_id, message)?;\n\n    Ok(())\n}\n\n/// Cancels all open [Order]s.\n///\n/// Requests the cancelation of all open [Order]s.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let next_valid_order_id = orders::next_valid_order_id(\u0026mut client)?;\n///     println!(\"next_valid_order_id: {next_valid_order_id}\");\n///\n///     Ok(())\n/// }\n/// ```\npub fn next_valid_order_id(client: \u0026mut Client) -\u003e Result\u003ci32\u003e {\n    let message = encoders::encode_next_valid_order_id()?;\n\n    let mut messages = client.request_next_order_id(message)?;\n\n    if let Some(message) = messages.next() {\n        let order_id_index = 2;\n        let next_order_id = message.peek_int(order_id_index)?;\n\n        client.set_next_order_id(next_order_id);\n\n        Ok(next_order_id)\n    } else {\n        Err(anyhow!(\"no response from server\"))\n    }\n}\n\n/// Requests completed [Order]s.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n/// * `api_only` - request only orders placed by the API.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let results = orders::completed_orders(\u0026mut client, false)?;\n///     for order_data in results {\n///        println!(\"{order_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn completed_orders(client: \u0026mut Client, api_only: bool) -\u003e Result\u003cOrderDataIterator\u003e {\n    client.check_server_version(server_versions::COMPLETED_ORDERS, \"It does not support completed orders requests.\")?;\n\n    let message = encoders::encode_completed_orders(api_only)?;\n\n    let messages = client.request_order_data(message)?;\n\n    Ok(OrderDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n/// Enumerates possible results from querying an [Order].\n#[derive(Debug)]\npub enum OrderDataResult {\n    OrderData(OrderData),\n    OrderStatus(OrderStatus),\n}\n\n/// Supports iteration over [OrderDataResult].\npub struct OrderDataIterator {\n    server_version: i32,\n    messages: GlobalResponseIterator,\n}\n\nimpl Iterator for OrderDataIterator {\n    type Item = OrderDataResult;\n\n    /// Returns the next [OrderDataResult]. Waits up to x seconds for next [OrderDataResult].\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            if let Some(mut message) = self.messages.next() {\n                match message.message_type() {\n                    IncomingMessages::CompletedOrder =\u003e match decoders::decode_completed_order(self.server_version, message) {\n                        Ok(val) =\u003e return Some(OrderDataResult::OrderData(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding completed order: {err}\");\n                        }\n                    },\n                    IncomingMessages::OpenOrder =\u003e match decoders::decode_open_order(self.server_version, message) {\n                        Ok(val) =\u003e return Some(OrderDataResult::OrderData(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding open order: {err}\");\n                        }\n                    },\n                    IncomingMessages::OrderStatus =\u003e match decoders::decode_order_status(self.server_version, \u0026mut message) {\n                        Ok(val) =\u003e return Some(OrderDataResult::OrderStatus(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding order status: {err}\");\n                        }\n                    },\n                    IncomingMessages::OpenOrderEnd | IncomingMessages::CompletedOrdersEnd =\u003e {\n                        return None;\n                    }\n                    message =\u003e {\n                        error!(\"order data iterator unexpected messsage: {message:?}\");\n                    }\n                }\n            } else {\n                return None;\n            }\n        }\n    }\n}\n\n/// Requests all open orders places by this specific API client (identified by the API client id).\n/// For client ID 0, this will bind previous manual TWS orders.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let results = orders::open_orders(\u0026mut client)?;\n///     for order_data in results {\n///        println!(\"{order_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn open_orders(client: \u0026mut Client) -\u003e Result\u003cOrderDataIterator\u003e {\n    let message = encoders::encode_open_orders()?;\n\n    let messages = client.request_order_data(message)?;\n\n    Ok(OrderDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n/// Requests all *current* open orders in associated accounts at the current moment.\n/// Open orders are returned once; this function does not initiate a subscription.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let results = orders::all_open_orders(\u0026mut client)?;\n///     for order_data in results {\n///        println!(\"{order_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn all_open_orders(client: \u0026mut Client) -\u003e Result\u003cOrderDataIterator\u003e {\n    let message = encoders::encode_all_open_orders()?;\n\n    let messages = client.request_order_data(message)?;\n\n    Ok(OrderDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n/// Requests status updates about future orders placed from TWS. Can only be used with client ID 0.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n/// * `auto_bind` - if set to true, the newly created orders will be assigned an API order ID and implicitly associated with this client. If set to false, future orders will not be.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let results = orders::auto_open_orders(\u0026mut client, false)?;\n///     for order_data in results {\n///        println!(\"{order_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn auto_open_orders(client: \u0026mut Client, auto_bind: bool) -\u003e Result\u003cOrderDataIterator\u003e {\n    let message = encoders::encode_auto_open_orders(auto_bind)?;\n\n    // TODO this should probably not timeout.\n    let messages = client.request_order_data(message)?;\n\n    Ok(OrderDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n#[derive(Debug, Default)]\n/// Filter criteria used to determine which execution reports are returned.\npub struct ExecutionFilter {\n    /// The API client which placed the order.\n    pub client_id: Option\u003ci32\u003e,\n    /// The account to which the order was allocated to\n    pub account_code: String,\n    /// Time from which the executions will be returned yyyymmdd hh:mm:ss\n    /// Only those executions reported after the specified time will be returned.\n    pub time: String,\n    /// The instrument's symbol\n    pub symbol: String,\n    /// The Contract's security's type (i.e. STK, OPT...)\n    pub security_type: String,\n    /// The exchange at which the execution was produced\n    pub exchange: String,\n    /// The Contract's side (BUY or SELL)\n    pub side: String,\n}\n\n/// Requests current day's (since midnight) executions matching the filter.\n///\n/// Only the current day's executions can be retrieved.\n/// Along with the [ExecutionData], the [CommissionReport] will also be returned.\n/// When requesting executions, a filter can be specified to receive only a subset of them\n///\n/// # Arguments\n/// * `filter` - filter criteria used to determine which execution reports are returned\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders::{self, ExecutionFilter};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///     \n///     let filter = ExecutionFilter{\n///        side: \"BUY\".to_owned(),\n///        ..ExecutionFilter::default()\n///     };\n///\n///     let results = orders::executions(\u0026mut client, filter)?;\n///     for execution_data in results {\n///        println!(\"{execution_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn executions(client: \u0026mut Client, filter: ExecutionFilter) -\u003e Result\u003cExecutionDataIterator\u003e {\n    let request_id = client.next_request_id();\n    let message = encoders::encode_executions(client.server_version(), request_id, \u0026filter)?;\n\n    let messages = client.send_request(request_id, message)?;\n\n    Ok(ExecutionDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n/// Enumerates possible results from querying an [Execution].\n#[derive(Debug)]\npub enum ExecutionDataResult {\n    ExecutionData(ExecutionData),\n    CommissionReport(CommissionReport),\n}\n\n/// Supports iteration over [ExecutionDataResult].\npub struct ExecutionDataIterator {\n    server_version: i32,\n    messages: ResponseIterator,\n}\n\nimpl Iterator for ExecutionDataIterator {\n    type Item = ExecutionDataResult;\n\n    /// Returns the next [OrderDataResult]. Waits up to x seconds for next [OrderDataResult].\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            if let Some(mut message) = self.messages.next() {\n                match message.message_type() {\n                    IncomingMessages::ExecutionData =\u003e match decoders::decode_execution_data(self.server_version, \u0026mut message) {\n                        Ok(val) =\u003e return Some(ExecutionDataResult::ExecutionData(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding execution data: {err}\");\n                        }\n                    },\n                    IncomingMessages::CommissionsReport =\u003e match decoders::decode_commission_report(self.server_version, \u0026mut message) {\n                        Ok(val) =\u003e return Some(ExecutionDataResult::CommissionReport(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding commission report: {err}\");\n                        }\n                    },\n                    IncomingMessages::ExecutionDataEnd =\u003e {\n                        return None;\n                    }\n                    message =\u003e {\n                        error!(\"order data iterator unexpected messsage: {message:?}\");\n                    }\n                }\n            } else {\n                return None;\n            }\n        }\n    }\n}\n\n#[cfg(test)]\nmod tests;\n","traces":[{"line":425,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":433,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":436,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":439,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":444,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":457,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":458,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":459,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":460,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":464,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":465,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":478,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":481,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":482,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":487,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":489,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":500,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":502,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":504,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":505,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":506,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":507,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":509,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":511,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":512,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":513,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":514,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":515,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":516,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":517,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":518,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":520,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":521,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":522,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":523,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":525,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":527,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":529,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":533,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":534,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":544,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":545,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":546,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":547,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":554,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":557,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":568,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":569,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":572,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":573,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":574,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":575,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":598,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":599,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":604,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":605,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":606,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":607,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":608,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":609,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":615,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":616,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":617,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":618,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":619,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":620,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":624,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":625,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":626,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":627,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":628,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":629,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":649,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":650,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":655,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":656,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":661,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":662,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":663,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":664,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":665,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":666,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":667,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":668,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":669,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":670,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":671,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":677,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":678,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":679,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":680,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":681,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":682,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":683,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":684,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":685,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":686,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":687,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":688,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":715,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":716,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":721,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":722,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":727,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":728,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":729,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":730,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":731,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":732,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":733,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":734,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":735,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":808,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":809,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":814,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":815,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":820,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":821,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":822,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":823,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":829,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":830,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":831,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":832,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":833,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":865,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":866,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":867,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":868,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":869,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":870,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":871,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":941,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":942,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":947,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":948,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":953,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":954,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":959,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":960,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1004,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1005,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1052,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1053,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1055,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1057,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1059,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1060,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1061,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1077,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1078,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1079,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1080,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1081,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1082,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1083,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1089,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":1090,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1092,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1093,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1096,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1097,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1100,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1101,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1104,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1105,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1123,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1124,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1126,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1127,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1130,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1131,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1134,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1141,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1142,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1145,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1149,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1153,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1154,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1157,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1164,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1165,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1166,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1167,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1175,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1176,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1177,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1178,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1181,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1186,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1187,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1190,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1191,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1193,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1201,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1202,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1203,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1208,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1209,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1212,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1213,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1216,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":1217,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1218,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1223,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1224,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1227,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1228,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1231,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1232,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1235,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1236,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1237,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1242,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1243,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1246,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1247,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1250,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1251,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1254,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1255,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1258,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1262,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1263,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1266,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1267,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1268,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1273,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1274,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1277,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1278,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1279,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1280,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1281,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1283,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1284,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1289,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1293,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1294,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1295,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1297,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":1299,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1302,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1303,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1306,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1307,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1310,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1311,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1314,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1315,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1318,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1320,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1325,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1355,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1356,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1357,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1358,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1363,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1365,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1367,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1368,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1369,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1390,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1392,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1393,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1394,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1395,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1396,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1397,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1401,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1402,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1404,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1405,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1409,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1437,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1439,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1441,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1442,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1444,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1469,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1470,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1472,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1474,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1475,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1476,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1478,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1480,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1482,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1510,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1512,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1514,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1516,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1517,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1518,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1539,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1541,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1542,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1543,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1544,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1545,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1546,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1549,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1550,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1551,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1552,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1555,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1556,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1557,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1558,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1562,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1564,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1565,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1569,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1598,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1599,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1601,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1603,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1604,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1605,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1632,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1633,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1635,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1637,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1638,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1639,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1666,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1667,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1670,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1672,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1673,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1674,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1729,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1730,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1731,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1733,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1735,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1736,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1737,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1758,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1760,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1761,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1762,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1763,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1764,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1765,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1768,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1769,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1770,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1771,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1775,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1777,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1778,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1782,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":260,"coverable":383},{"path":["/","Users","wboayue","projects","rust-ibapi","src","server_versions.rs"],"content":"//! The known server versions.\n\n//shouldn't these all be deprecated?\n//  public const int HISTORICAL_DATA = 24;\n//  public const int CURRENT_TIME = 33;\npub const REAL_TIME_BARS: i32 = 34;\npub const SCALE_ORDERS: i32 = 35;\n//  public const int SNAPSHOT_MKT_DATA = 35;\npub const SSHORT_COMBO_LEGS: i32 = 35;\npub const WHAT_IF_ORDERS: i32 = 36;\npub const CONTRACT_CONID: i32 = 37;\n\npub const PTA_ORDERS: i32 = 39;\npub const FUNDAMENTAL_DATA: i32 = 40;\npub const DELTA_NEUTRAL: i32 = 40;\npub const CONTRACT_DATA_CHAIN: i32 = 40;\npub const SCALE_ORDERS2: i32 = 40;\npub const ALGO_ORDERS: i32 = 41;\npub const EXECUTION_DATA_CHAIN: i32 = 42;\npub const NOT_HELD: i32 = 44;\npub const SEC_ID_TYPE: i32 = 45;\npub const PLACE_ORDER_CONID: i32 = 46;\npub const REQ_MKT_DATA_CONID: i32 = 47;\npub const REQ_CALC_IMPLIED_VOLAT: i32 = 49;\npub const REQ_CALC_OPTION_PRICE: i32 = 50;\npub const SSHORTX_OLD: i32 = 51;\npub const SSHORTX: i32 = 52;\npub const REQ_GLOBAL_CANCEL: i32 = 53;\npub const HEDGE_ORDERS: i32 = 54;\npub const REQ_MARKET_DATA_TYPE: i32 = 55;\npub const OPT_OUT_SMART_ROUTING: i32 = 56;\npub const SMART_COMBO_ROUTING_PARAMS: i32 = 57;\npub const DELTA_NEUTRAL_CONID: i32 = 58;\npub const SCALE_ORDERS3: i32 = 60;\npub const ORDER_COMBO_LEGS_PRICE: i32 = 61;\npub const TRAILING_PERCENT: i32 = 62;\npub const DELTA_NEUTRAL_OPEN_CLOSE: i32 = 66;\npub const POSITIONS: i32 = 67;\npub const ACCOUNT_SUMMARY: i32 = 67;\npub const TRADING_CLASS: i32 = 68;\npub const SCALE_TABLE: i32 = 69;\npub const LINKING: i32 = 70;\npub const ALGO_ID: i32 = 71;\npub const OPTIONAL_CAPABILITIES: i32 = 72;\npub const ORDER_SOLICITED: i32 = 73;\npub const LINKING_AUTH: i32 = 74;\npub const PRIMARYEXCH: i32 = 75;\npub const RANDOMIZE_SIZE_AND_PRICE: i32 = 76;\npub const FRACTIONAL_POSITIONS: i32 = 101;\npub const PEGGED_TO_BENCHMARK: i32 = 102;\npub const MODELS_SUPPORT: i32 = 103;\npub const SEC_DEF_OPT_PARAMS_REQ: i32 = 104;\npub const EXT_OPERATOR: i32 = 105;\npub const SOFT_DOLLAR_TIER: i32 = 106;\npub const REQ_FAMILY_CODES: i32 = 107;\npub const REQ_MATCHING_SYMBOLS: i32 = 108;\npub const PAST_LIMIT: i32 = 109;\npub const MD_SIZE_MULTIPLIER: i32 = 110;\npub const CASH_QTY: i32 = 111;\npub const REQ_MKT_DEPTH_EXCHANGES: i32 = 112;\npub const TICK_NEWS: i32 = 113;\npub const REQ_SMART_COMPONENTS: i32 = 114;\npub const REQ_NEWS_PROVIDERS: i32 = 115;\npub const REQ_NEWS_ARTICLE: i32 = 116;\npub const REQ_HISTORICAL_NEWS: i32 = 117;\npub const REQ_HEAD_TIMESTAMP: i32 = 118;\npub const REQ_HISTOGRAM: i32 = 119;\npub const SERVICE_DATA_TYPE: i32 = 120;\npub const AGG_GROUP: i32 = 121;\npub const UNDERLYING_INFO: i32 = 122;\npub const CANCEL_HEADTIMESTAMP: i32 = 123;\npub const SYNT_REALTIME_BARS: i32 = 124;\npub const CFD_REROUTE: i32 = 125;\npub const MARKET_RULES: i32 = 126;\npub const PNL: i32 = 127;\npub const NEWS_QUERY_ORIGINS: i32 = 128;\npub const UNREALIZED_PNL: i32 = 129;\npub const HISTORICAL_TICKS: i32 = 130;\npub const MARKET_CAP_PRICE: i32 = 131;\npub const PRE_OPEN_BID_ASK: i32 = 132;\npub const REAL_EXPIRATION_DATE: i32 = 134;\npub const REALIZED_PNL: i32 = 135;\npub const LAST_LIQUIDITY: i32 = 136;\npub const TICK_BY_TICK: i32 = 137;\npub const DECISION_MAKER: i32 = 138;\npub const MIFID_EXECUTION: i32 = 139;\npub const TICK_BY_TICK_IGNORE_SIZE: i32 = 140;\npub const AUTO_PRICE_FOR_HEDGE: i32 = 141;\npub const WHAT_IF_EXT_FIELDS: i32 = 142;\npub const SCANNER_GENERIC_OPTS: i32 = 143;\npub const API_BIND_ORDER: i32 = 144;\npub const ORDER_CONTAINER: i32 = 145;\npub const SMART_DEPTH: i32 = 146;\npub const REMOVE_NULL_ALL_CASTING: i32 = 147;\npub const D_PEG_ORDERS: i32 = 148;\npub const MKT_DEPTH_PRIM_EXCHANGE: i32 = 149;\npub const COMPLETED_ORDERS: i32 = 150;\npub const PRICE_MGMT_ALGO: i32 = 151;\npub const STOCK_TYPE: i32 = 152;\npub const ENCODE_MSG_ASCII7: i32 = 153;\npub const SEND_ALL_FAMILY_CODES: i32 = 154;\npub const NO_DEFAULT_OPEN_CLOSE: i32 = 155;\npub const PRICE_BASED_VOLATILITY: i32 = 156;\npub const REPLACE_FA_END: i32 = 157;\npub const DURATION: i32 = 158;\npub const MARKET_DATA_IN_SHARES: i32 = 159;\npub const POST_TO_ATS: i32 = 160;\npub const WSHE_CALENDAR: i32 = 161;\npub const AUTO_CANCEL_PARENT: i32 = 162;\npub const FRACTIONAL_SIZE_SUPPORT: i32 = 163;\npub const SIZE_RULES: i32 = 164;\npub const HISTORICAL_SCHEDULE: i32 = 165;\npub const ADVANCED_ORDER_REJECT: i32 = 166;\npub const USER_INFO: i32 = 167;\npub const CRYPTO_AGGREGATED_TRADES: i32 = 168;\npub const MANUAL_ORDER_TIME: i32 = 169;\npub const PEGBEST_PEGMID_OFFSETS: i32 = 170;\npub const WSH_EVENT_DATA_FILTERS: i32 = 171;\npub const IPO_PRICES: i32 = 172;\npub const WSH_EVENT_DATA_FILTERS_DATE: i32 = 173;\npub const INSTRUMENT_TIMEZONE: i32 = 174;\npub const HMDS_MARKET_DATA_IN_SHARES: i32 = 175;\npub const BOND_ISSUERID: i32 = 176;\npub const FA_PROFILE_DESUPPORT: i32 = 177;\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","stubs.rs"],"content":"use std::sync::Arc;\nuse std::time::Duration;\n\nuse crossbeam::channel;\n\nuse crate::client::transport::{GlobalResponseIterator, MessageBus, ResponseIterator};\nuse crate::client::{RequestMessage, ResponseMessage};\n\npub struct MessageBusStub {\n    pub request_messages: Vec\u003cRequestMessage\u003e,\n    pub response_messages: Vec\u003cString\u003e,\n    // pub next_request_id: i32,\n    // pub server_version: i32,\n    // pub order_id: i32,\n}\n\nimpl MessageBus for MessageBusStub {\n    fn request_messages(\u0026self) -\u003e Vec\u003cRequestMessage\u003e {\n        self.request_messages.clone()\n    }\n\n    fn read_message(\u0026mut self) -\u003e anyhow::Result\u003cResponseMessage\u003e {\n        Ok(ResponseMessage::default())\n    }\n\n    fn write_message(\u0026mut self, message: \u0026RequestMessage) -\u003e anyhow::Result\u003c()\u003e {\n        self.request_messages.push(message.clone());\n        Ok(())\n    }\n\n    fn send_generic_message(\u0026mut self, request_id: i32, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n        let (s1, r1) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(ResponseIterator::new(receiver, s1, None, None, Duration::from_secs(5)))\n    }\n\n    fn send_order_message(\u0026mut self, request_id: i32, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n        let (s1, r1) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(ResponseIterator::new(receiver, s1, None, None, Duration::from_secs(5)))\n    }\n\n    fn request_next_order_id(\u0026mut self, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cGlobalResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(GlobalResponseIterator::new(Arc::new(receiver)))\n    }\n\n    fn request_open_orders(\u0026mut self, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cGlobalResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(GlobalResponseIterator::new(Arc::new(receiver)))\n    }\n\n    fn request_market_rule(\u0026mut self, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cGlobalResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(GlobalResponseIterator::new(Arc::new(receiver)))\n    }\n\n    fn write(\u0026mut self, packet: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n        Ok(())\n    }\n\n    fn process_messages(\u0026mut self, server_version: i32) -\u003e anyhow::Result\u003c()\u003e {\n        Ok(())\n    }\n}\n\nfn encode_message(message: \u0026RequestMessage) -\u003e String {\n    message.encode().replace(\"\\0\", \"|\")\n}\n","traces":[{"line":18,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":22},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":32},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":19},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":31,"coverable":45}]};
        var previousData = {"files":[{"path":["/","Users","wboayue","projects","rust-ibapi","src","accounts.rs"],"content":"\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","cancel_orders.rs"],"content":"use clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::orders;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"cancel_order\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Cancels an open order\")\n        .arg(arg!(--order_id \u003cORDER_ID\u003e).value_parser(clap::value_parser!(i32)).default_value(\"-1\"))\n        .arg(arg!(--connection_string \u003cCONNECTION_STRING\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--manual_order_cancel_time \u003cCANCEL_TIME\u003e).default_value(\"\"))\n        .arg(arg!(--global).default_value(\"false\"))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").unwrap();\n    let order_id = matches.get_one::\u003ci32\u003e(\"order_id\").unwrap();\n    let manual_order_cancel_time = matches.get_one::\u003cString\u003e(\"manual_order_cancel_time\").unwrap();\n    let global = matches.get_one::\u003cbool\u003e(\"global\").unwrap();\n\n    let mut client = Client::connect(connection_string)?;\n\n    if *global {\n        println!(\"Requesting global cancel.\");\n\n        orders::global_cancel(\u0026mut client)?\n    } else {\n        println!(\"Cancelling order {order_id}\");\n\n        let results = orders::cancel_order(\u0026mut client, *order_id, manual_order_cancel_time)?;\n        for result in results {\n            println!(\"{result:?}\");\n        }\n    };\n\n    Ok(())\n}\n","traces":[{"line":6,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","contract_details.rs"],"content":"use clap::{arg, Command};\nuse log::{debug, info};\n\nuse ibapi::client::Client;\nuse ibapi::contracts::{self, Contract};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"find_contract_details\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Finds contract details\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--stock \u003cVALUE\u003e).required(true))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let stock_symbol = matches.get_one::\u003cString\u003e(\"stock\").expect(\"stock symbol is required\");\n\n    let mut client = Client::connect(connection_string)?;\n\n    info!(\"connected {client:?}\");\n\n    println!(\"server_version: {}\", client.server_version());\n    println!(\"server_time: {}\", client.server_time());\n    println!(\"managed_accounts: {}\", client.managed_accounts());\n    println!(\"next_order_id: {}\", client.next_order_id());\n\n    let mut contract = Contract::stock(stock_symbol);\n    contract.currency = \"USD\".to_string();\n    debug!(\"contract template: {contract:?}\");\n\n    let results = contracts::contract_details(\u0026mut client, \u0026contract)?;\n    for contract in \u0026results {\n        println!(\"contract: {contract:?}\");\n    }\n\n    Ok(())\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","executions.rs"],"content":"use anyhow::Ok;\nuse clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::orders::{self, ExecutionFilter};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"orders\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Find order executions for current daya\")\n        .arg(arg!(--client_id \u003cCLIENT_ID\u003e).value_parser(clap::value_parser!(i32)))\n        .arg(arg!(--account_code \u003cACCOUNT_CODE\u003e))\n        .arg(arg!(--time \u003cTIME\u003e).help(\"yyyymmdd hh:mm:ss\"))\n        .arg(arg!(--symbol \u003cSYMBOL\u003e))\n        .arg(arg!(--security_type \u003cSECURITY_TYPE\u003e))\n        .arg(arg!(--exchange \u003cEXCHANGE\u003e))\n        .arg(arg!(--side \u003cSIDE\u003e))\n        .arg(arg!(--connection_string \u003cCONNECTION_STRING\u003e).default_value(\"odin:4002\"))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").unwrap();\n\n    let mut filter = ExecutionFilter::default();\n\n    if let Some(client_id) = matches.get_one::\u003ci32\u003e(\"client_id\") {\n        filter.client_id = Some(*client_id);\n    }\n\n    if let Some(account_code) = matches.get_one::\u003cString\u003e(\"account_code\") {\n        filter.account_code = account_code.to_owned();\n    }\n\n    if let Some(time) = matches.get_one::\u003cString\u003e(\"time\") {\n        filter.time = time.to_owned();\n    }\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"symbol\") {\n        filter.symbol = symbol.to_owned();\n    }\n\n    if let Some(security_type) = matches.get_one::\u003cString\u003e(\"security_type\") {\n        filter.security_type = security_type.to_owned();\n    }\n\n    if let Some(exchange) = matches.get_one::\u003cString\u003e(\"exchange\") {\n        filter.exchange = exchange.to_owned();\n    }\n\n    if let Some(side) = matches.get_one::\u003cString\u003e(\"side\") {\n        filter.side = side.to_owned();\n    }\n\n    let mut client = Client::connect(connection_string)?;\n\n    let executions = orders::executions(\u0026mut client, filter)?;\n    for execution in executions {\n        println!(\"{execution:?}\")\n    }\n\n    // std::thread::sleep(std::time::Duration::from_secs(5));\n\n    Ok(())\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":32},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","market_rule.rs"],"content":"use clap::{arg, Command};\nuse log::info;\n\nuse ibapi::client::Client;\nuse ibapi::contracts;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"market_rule\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Finds contract descriptions matching pattern\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--market_rule_id \u003cVALUE\u003e).required(true).value_parser(clap::value_parser!(i32)))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let market_rule_id = matches.get_one::\u003ci32\u003e(\"market_rule_id\").expect(\"market rule id is required\");\n\n    let mut client = Client::connect(connection_string)?;\n\n    info!(\"connected {client:?}, using: {connection_string}\");\n\n    let results = contracts::market_rule(\u0026mut client, *market_rule_id)?;\n    println!(\"rule: {results:?}\");\n\n    std::thread::sleep(std::time::Duration::from_secs(5));\n\n    Ok(())\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":13},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","matching_symbols.rs"],"content":"use clap::{arg, Command};\nuse log::info;\n\nuse ibapi::client::Client;\nuse ibapi::contracts;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"find_contract_descriptions_matching\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Finds contract descriptions matching pattern\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--pattern \u003cVALUE\u003e).required(true))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let pattern = matches.get_one::\u003cString\u003e(\"pattern\").expect(\"pattern is required\");\n\n    let mut client = Client::connect(connection_string)?;\n\n    info!(\"connected {client:?}, using: {connection_string}\");\n\n    let results = contracts::matching_symbols(\u0026mut client, pattern)?;\n    for result in \u0026results {\n        println!(\"contract: {result:?}\");\n    }\n\n    Ok(())\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":13},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","next_order_id.rs"],"content":"use clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::orders;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"next_order_id\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Gets next valid order id\")\n        .arg(arg!(--connection_string \u003cCONNECTION_STRING\u003e).default_value(\"odin:4002\"))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").unwrap();\n\n    let mut client = Client::connect(connection_string)?;\n\n    let order_id = orders::next_valid_order_id(\u0026mut client)?;\n    println!(\"Next valid order id: {order_id}\");\n\n    Ok(())\n}\n","traces":[{"line":6,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":9},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","orders.rs"],"content":"use anyhow::Ok;\nuse clap::builder::PossibleValue;\nuse clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::orders::{self, OrderDataIterator};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let order_types = [\"completed\", \"open\", \"all_open\", \"auto_open\"];\n    let order_types: Vec\u003cPossibleValue\u003e = order_types.iter().map(PossibleValue::new).collect();\n\n    let matches = Command::new(\"orders\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Queries completed and open orders\")\n        .arg(arg!(\u003cTYPE\u003e).default_value(\"completed\").value_parser(order_types))\n        .arg(arg!(--connection_string \u003cCONNECTION_STRING\u003e).default_value(\"odin:4002\"))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").unwrap();\n    let order_type = matches.get_one::\u003cString\u003e(\"TYPE\").unwrap();\n\n    let mut client = Client::connect(connection_string)?;\n\n    match order_type.as_str() {\n        \"open\" =\u003e {\n            println!(\"Open orders:\");\n            let orders = orders::open_orders(\u0026mut client)?;\n            print_orders(orders);\n        }\n        \"all_open\" =\u003e {\n            println!(\"All open orders:\");\n            let orders = orders::all_open_orders(\u0026mut client)?;\n            print_orders(orders);\n        }\n        \"auto_open\" =\u003e {\n            println!(\"Auto open orders:\");\n            let orders = orders::auto_open_orders(\u0026mut client, false)?;\n            print_orders(orders);\n        }\n        \"completed\" =\u003e {\n            println!(\"Completed orders:\");\n            let orders = orders::completed_orders(\u0026mut client, false)?;\n            print_orders(orders);\n        }\n        kind =\u003e {\n            panic!(\"Unsupported order type: {kind}\")\n        }\n    }\n\n    Ok(())\n}\n\nfn print_orders(orders: OrderDataIterator) {\n    for order in orders {\n        println!(\"order: {order:?}\")\n    }\n}\n","traces":[{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":12,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":33},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","place_order.rs"],"content":"use clap::{arg, ArgMatches, Command};\nuse log::{debug, info};\n\nuse ibapi::client::Client;\nuse ibapi::contracts::Contract;\nuse ibapi::orders::{self, order_builder, OrderNotification};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"place_order\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil.boayue@gmail.com\u003e\")\n        .about(\"Submits order to broker\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--stock \u003cSYMBOL\u003e).required(true))\n        .arg(arg!(--buy \u003cQUANTITY\u003e).value_parser(clap::value_parser!(i32)))\n        .arg(arg!(--sell \u003cQUANTITY\u003e).value_parser(clap::value_parser!(i32)))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let stock_symbol = matches.get_one::\u003cString\u003e(\"stock\").expect(\"stock symbol is required\");\n\n    if let Some((action, quantity)) = get_order(\u0026matches) {\n        println!(\"action: {action}, quantity: {quantity}\");\n    }\n\n    println!(\"connection_string: {connection_string}, stock_symbol: {stock_symbol}\");\n\n    let mut client = Client::connect(\"odin:4002\")?;\n\n    info!(\"Connected {client:?}\");\n\n    let mut contract = Contract::stock(stock_symbol);\n    contract.currency = \"USD\".to_string();\n    debug!(\"contract template {contract:?}\");\n\n    let order_id = client.next_order_id();\n    println!(\"order_id: {order_id}\");\n    let order = order_builder::market_order(orders::Action::Buy, 100.0);\n\n    println!(\"contract: {contract:?}, order: {order:?}\");\n\n    let results = orders::place_order(\u0026mut client, order_id, \u0026contract, \u0026order)?;\n\n    for status in results {\n        match status {\n            OrderNotification::OrderStatus(order_status) =\u003e {\n                println!(\"order status: {order_status:?}\")\n            }\n            OrderNotification::OpenOrder(open_order) =\u003e println!(\"open order: {open_order:?}\"),\n            OrderNotification::ExecutionData(execution) =\u003e println!(\"execution: {execution:?}\"),\n            OrderNotification::CommissionReport(report) =\u003e println!(\"commision report: {report:?}\"),\n            OrderNotification::Message(message) =\u003e println!(\"notice: {message}\"),\n        }\n    }\n\n    Ok(())\n}\n\nfn get_order(matches: \u0026ArgMatches) -\u003e Option\u003c(String, i32)\u003e {\n    if let Some(quantity) = matches.get_one::\u003ci32\u003e(\"buy\") {\n        Some((\"BUY\".to_string(), *quantity))\n    } else {\n        matches.get_one::\u003ci32\u003e(\"sell\").map(|quantity| (\"SELL\".to_string(), *quantity))\n    }\n}\n","traces":[{"line":8,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":34},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","stream_bars.rs"],"content":"use std::thread;\nuse std::time::Duration;\n\nuse clap::{arg, ArgMatches, Command};\n\nuse ibapi::client::Client;\nuse ibapi::contracts::Contract;\nuse ibapi::market_data::{realtime, BarSize, WhatToShow};\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"stream_bars\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil@wsbsolutions.com\")\n        .about(\"Streams realtime bars\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--stock \u003cSYMBOL\u003e))\n        .arg(arg!(--futures \u003cSYMBOL\u003e))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    let contract = extract_contract(\u0026matches).expect(\"error parsing --stock or --future\");\n\n    println!(\"connection_string: {connection_string:?}\");\n    println!(\"contract: {contract:?}\");\n\n    let mut client = Client::connect(\"odin:4002\")?;\n\n    let bars = realtime::realtime_bars(\u0026mut client, \u0026contract, \u0026BarSize::Secs5, \u0026WhatToShow::Trades, false)?;\n\n    for (i, bar) in bars.enumerate() {\n        println!(\"bar: {i:?} {bar:?}\");\n\n        if i \u003e 60 {\n            break;\n        }\n    }\n\n    thread::sleep(Duration::from_secs(5));\n\n    Ok(())\n}\n\nfn extract_contract(matches: \u0026ArgMatches) -\u003e Option\u003cContract\u003e {\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"stock\") {\n        Some(Contract::stock(\u0026symbol.to_uppercase()))\n    } else {\n        matches\n            .get_one::\u003cString\u003e(\"futures\")\n            .map(|symbol| Contract::futures(\u0026symbol.to_uppercase()))\n    }\n}\n","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":22},{"path":["/","Users","wboayue","projects","rust-ibapi","src","bin","tick_by_tick.rs"],"content":"use std::thread;\nuse std::time::Duration;\n\nuse clap::{arg, Command};\n\nuse ibapi::client::Client;\nuse ibapi::contracts::Contract;\nuse ibapi::market_data::realtime;\n\nfn main() -\u003e anyhow::Result\u003c()\u003e {\n    env_logger::init();\n\n    let matches = Command::new(\"tick_by_tick\")\n        .version(\"1.0\")\n        .author(\"Wil Boayue \u003cwil@wsbsolutions.com\")\n        .about(\"Streams tick by tick data\")\n        .arg(arg!(--connection_string \u003cVALUE\u003e).default_value(\"odin:4002\"))\n        .arg(arg!(--last \u003cSYMBOL\u003e))\n        .arg(arg!(--all_last \u003cSYMBOL\u003e))\n        .arg(arg!(--bid_ask \u003cSYMBOL\u003e))\n        .arg(arg!(--mid_point \u003cSYMBOL\u003e))\n        .get_matches();\n\n    let connection_string = matches.get_one::\u003cString\u003e(\"connection_string\").expect(\"connection_string is required\");\n    println!(\"connection_string: {connection_string}\");\n\n    let mut client = Client::connect(\u0026connection_string)?;\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"last\") {\n        stream_last(\u0026mut client, \u0026symbol.to_uppercase())?;\n    }\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"all_last\") {\n        stream_all_last(\u0026mut client, \u0026symbol.to_uppercase())?;\n    }\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"bid_ask\") {\n        stream_bid_ask(\u0026mut client, \u0026symbol.to_uppercase())?;\n    }\n\n    if let Some(symbol) = matches.get_one::\u003cString\u003e(\"mid_point\") {\n        stream_mid_point(\u0026mut client, \u0026symbol.to_uppercase())?;\n    }\n\n    thread::sleep(Duration::from_secs(5));\n\n    Ok(())\n}\n\nfn stream_last(client: \u0026mut Client, symbol: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n    let contract = contract_es();\n    let ticks = realtime::tick_by_tick_last(client, \u0026contract, 0, false)?;\n\n    for (i, tick) in ticks.enumerate().take(60) {\n        println!(\"tick: {i:?} {tick:?}\");\n    }\n\n    Ok(())\n}\n\nfn contract_es() -\u003e Contract {\n    let mut contract = Contract::futures(\"ES\");\n    contract.exchange = \"CME\".to_owned();\n    contract.contract_id = 495512569;\n    contract\n}\n\nfn contract_gc() -\u003e Contract {\n    let mut contract = Contract::futures(\"GC\");\n    contract.exchange = \"COMEX\".to_owned();\n    contract.contract_id = 605552438;\n    contract\n}\n\nfn contract_zn() -\u003e Contract {\n    let mut contract = Contract::futures(\"ZN\");\n    contract.exchange = \"CBOT\".to_owned();\n    contract.contract_id = 568735904;\n    contract\n}\n\nfn stream_all_last(client: \u0026mut Client, symbol: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n    let contract = contract_es();\n    let ticks = realtime::tick_by_tick_all_last(client, \u0026contract, 0, false)?;\n\n    for (i, tick) in ticks.enumerate().take(60) {\n        println!(\"tick: {i:?} {tick:?}\");\n    }\n\n    Ok(())\n}\n\nfn stream_bid_ask(client: \u0026mut Client, symbol: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n    let contract = contract_es();\n    let ticks = realtime::tick_by_tick_bid_ask(client, \u0026contract, 0, false)?;\n\n    for (i, tick) in ticks.enumerate().take(60) {\n        println!(\"tick: {i:?} {tick:?}\");\n    }\n\n    Ok(())\n}\n\nfn stream_mid_point(client: \u0026mut Client, symbol: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n    let contract = contract_es();\n    let ticks = realtime::tick_by_tick_midpoint(client, \u0026contract, 0, false)?;\n\n    for (i, tick) in ticks.enumerate().take(60) {\n        println!(\"tick: {i:?} {tick:?}\");\n    }\n\n    Ok(())\n}\n","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":60},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","tests.rs"],"content":"use crate::contracts::{ComboLegOpenClose, SecurityType};\nuse crate::orders::{Action, OrderCondition, OrderOpenClose, Rule80A};\n\nuse super::*;\n\n#[test]\nfn request_packet_from_fields() {\n    // let mut packet = RequestPacket::default();\n    // packet.add_field(32);\n\n    let packet = || -\u003e RequestMessage {\n        let mut packet = RequestMessage::default();\n        packet.push_field(\u002632);\n        packet\n    }();\n\n    let result = 2 + 2;\n    assert_eq!(result, 4);\n}\n\n#[test]\nfn message_encodes_bool() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026false);\n    message.push_field(\u0026true);\n\n    assert_eq!(2, message.fields.len());\n    assert_eq!(\"0\\01\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_i32() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u00261);\n    message.push_field(\u0026Some(2));\n    message.push_field(\u0026Option::\u003ci32\u003e::None);\n\n    assert_eq!(3, message.fields.len());\n    assert_eq!(\"1\\02\\0\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_f64() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u00262.0);\n    message.push_field(\u0026Some(3.0));\n    message.push_field(\u0026Option::\u003cf64\u003e::None);\n\n    assert_eq!(3, message.fields.len());\n    // assert_eq!(\"2.0\\03.0\\0\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_string() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026\"interactive\");\n    message.push_field(\u0026\"brokers\");\n\n    assert_eq!(2, message.fields.len());\n    assert_eq!(\"interactive\\0brokers\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_rule_80_a() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026Some(Rule80A::Individual));\n    message.push_field(\u0026Some(Rule80A::Agency));\n    message.push_field(\u0026Some(Rule80A::AgentOtherMember));\n    message.push_field(\u0026Some(Rule80A::IndividualPTIA));\n    message.push_field(\u0026Some(Rule80A::AgencyPTIA));\n    message.push_field(\u0026Some(Rule80A::AgentOtherMemberPTIA));\n    message.push_field(\u0026Some(Rule80A::IndividualPT));\n    message.push_field(\u0026Some(Rule80A::AgencyPT));\n    message.push_field(\u0026Some(Rule80A::AgentOtherMemberPT));\n    message.push_field(\u0026Option::\u003cRule80A\u003e::None);\n\n    assert_eq!(10, message.fields.len());\n    assert_eq!(\"I\\0A\\0W\\0J\\0U\\0M\\0K\\0Y\\0N\\0\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_order_condition() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026OrderCondition::Price);\n    message.push_field(\u0026OrderCondition::Time);\n    message.push_field(\u0026OrderCondition::Margin);\n    message.push_field(\u0026OrderCondition::Execution);\n    message.push_field(\u0026OrderCondition::Volume);\n    message.push_field(\u0026OrderCondition::PercentChange);\n\n    assert_eq!(6, message.fields.len());\n    assert_eq!(\"1\\03\\04\\05\\06\\07\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_action() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026Action::Buy);\n    message.push_field(\u0026Action::Sell);\n    message.push_field(\u0026Action::SellShort);\n    message.push_field(\u0026Action::SellLong);\n\n    assert_eq!(4, message.fields.len());\n    assert_eq!(\"BUY\\0SELL\\0SSHORT\\0SLONG\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_security_type() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026SecurityType::Stock);\n    message.push_field(\u0026SecurityType::Option);\n    message.push_field(\u0026SecurityType::Future);\n    message.push_field(\u0026SecurityType::Index);\n    message.push_field(\u0026SecurityType::FuturesOption);\n    message.push_field(\u0026SecurityType::ForexPair);\n    message.push_field(\u0026SecurityType::Spread);\n    message.push_field(\u0026SecurityType::Warrant);\n    message.push_field(\u0026SecurityType::Bond);\n    message.push_field(\u0026SecurityType::Commodity);\n    message.push_field(\u0026SecurityType::News);\n    message.push_field(\u0026SecurityType::MutualFund);\n\n    assert_eq!(12, message.fields.len());\n    assert_eq!(\"STK\\0OPT\\0FUT\\0IND\\0FOP\\0CASH\\0BAG\\0WAR\\0BOND\\0CMDTY\\0NEWS\\0FUND\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_outgoing_message() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026OutgoingMessages::RequestMarketData);\n    message.push_field(\u0026OutgoingMessages::CancelMarketData);\n    message.push_field(\u0026OutgoingMessages::PlaceOrder);\n    message.push_field(\u0026OutgoingMessages::ReqUserInfo);\n\n    assert_eq!(4, message.fields.len());\n    assert_eq!(\"1\\02\\03\\0104\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_order_open_close() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026Option::\u003cOrderOpenClose\u003e::None);\n    message.push_field(\u0026OrderOpenClose::Open);\n    message.push_field(\u0026OrderOpenClose::Close);\n\n    assert_eq!(3, message.fields.len());\n    assert_eq!(\"\\0O\\0C\\0\", message.encode());\n}\n\n#[test]\nfn message_encodes_combo_leg_open_close() {\n    let mut message = RequestMessage::new();\n\n    message.push_field(\u0026ComboLegOpenClose::Same);\n    message.push_field(\u0026ComboLegOpenClose::Open);\n    message.push_field(\u0026ComboLegOpenClose::Close);\n    message.push_field(\u0026ComboLegOpenClose::Unknown);\n\n    assert_eq!(4, message.fields.len());\n    assert_eq!(\"0\\01\\02\\03\\0\", message.encode());\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","transport","recorder","tests.rs"],"content":"use super::*;\nuse std::env;\n\n#[test]\nfn env_var_enables_recorder() {\n    let key = String::from(\"IBAPI_RECORDING_DIR\");\n    let dir = String::from(\"/tmp/records\");\n\n    env::set_var(\u0026key, \u0026dir);\n\n    let recorder = MessageRecorder::new();\n\n    assert_eq!(true, recorder.enabled);\n    assert!(\u0026recorder.recording_dir.starts_with(\u0026dir), \"{} != {}\", \u0026recorder.recording_dir, \u0026dir)\n}\n\n#[test]\nfn recorder_is_disabled() {\n    let key = String::from(\"IBAPI_RECORDING_DIR\");\n\n    env::set_var(\u0026key, \u0026\"\");\n\n    let recorder = MessageRecorder::new();\n\n    assert_eq!(false, recorder.enabled);\n    assert_eq!(\"\", \u0026recorder.recording_dir);\n}\n\n#[test]\nfn recorder_generates_output_file() {\n    let recording_dir = String::from(\"/tmp/records\");\n\n    let recorder = MessageRecorder {\n        enabled: true,\n        recording_dir: recording_dir,\n    };\n\n    assert_eq!(format!(\"{}/0001-request.msg\", recorder.recording_dir), recorder.request_file(1));\n    assert_eq!(format!(\"{}/0002-response.msg\", recorder.recording_dir), recorder.response_file(2));\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","transport","recorder.rs"],"content":"use std::env;\nuse std::fs;\nuse std::sync::atomic::{AtomicUsize, Ordering};\n\nuse time::macros::format_description;\nuse time::OffsetDateTime;\n\nuse super::{RequestMessage, ResponseMessage};\n\nstatic RECORDING_SEQ: AtomicUsize = AtomicUsize::new(0);\n\n#[derive(Clone, Debug)]\npub(crate) struct MessageRecorder {\n    enabled: bool,\n    recording_dir: String,\n}\n\nimpl MessageRecorder {\n    pub fn new() -\u003e Self {\n        match env::var(\"IBAPI_RECORDING_DIR\") {\n            Ok(dir) =\u003e {\n                if dir.is_empty() {\n                    MessageRecorder {\n                        enabled: false,\n                        recording_dir: String::from(\"\"),\n                    }\n                } else {\n                    let format = format_description!(\"[year]-[month]-[day]-[hour]-[minute]\");\n                    let now = OffsetDateTime::now_utc();\n                    let recording_dir = format!(\"{}/{}\", dir, now.format(\u0026format).unwrap());\n\n                    fs::create_dir_all(\u0026recording_dir).unwrap();\n\n                    MessageRecorder {\n                        enabled: true,\n                        recording_dir,\n                    }\n                }\n            }\n            _ =\u003e MessageRecorder {\n                enabled: false,\n                recording_dir: String::from(\"\"),\n            },\n        }\n    }\n\n    pub fn record_request(\u0026self, message: \u0026RequestMessage) {\n        if !self.enabled {\n            return;\n        }\n\n        let record_id = RECORDING_SEQ.fetch_add(1, Ordering::SeqCst);\n        fs::write(self.request_file(record_id), message.encode().replace('\\0', \"|\")).unwrap();\n    }\n\n    pub fn record_response(\u0026self, message: \u0026ResponseMessage) {\n        if !self.enabled {\n            return;\n        }\n\n        let record_id = RECORDING_SEQ.fetch_add(1, Ordering::SeqCst);\n        fs::write(self.response_file(record_id), message.encode().replace('\\0', \"|\")).unwrap();\n    }\n\n    fn request_file(\u0026self, record_id: usize) -\u003e String {\n        format!(\"{}/{:04}-request.msg\", self.recording_dir, record_id)\n    }\n\n    fn response_file(\u0026self, record_id: usize) -\u003e String {\n        format!(\"{}/{:04}-response.msg\", self.recording_dir, record_id)\n    }\n}\n","traces":[{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":24},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","transport","tests.rs"],"content":"\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client","transport.rs"],"content":"use std::collections::HashMap;\nuse std::io::{prelude::*, Cursor};\nuse std::iter::Iterator;\nuse std::net::TcpStream;\nuse std::sync::{Arc, RwLock};\nuse std::thread::{self, JoinHandle};\nuse std::time::Duration;\n\nuse anyhow::Result;\nuse byteorder::{BigEndian, ReadBytesExt, WriteBytesExt};\nuse crossbeam::channel::{self, Receiver, Sender};\nuse log::{debug, error, info};\n\nuse crate::client::{RequestMessage, ResponseMessage};\nuse crate::messages::IncomingMessages;\nuse crate::server_versions;\nuse recorder::MessageRecorder;\n\nmod recorder;\n\npub trait MessageBus {\n    fn read_message(\u0026mut self) -\u003e Result\u003cResponseMessage\u003e;\n\n    fn write_message(\u0026mut self, packet: \u0026RequestMessage) -\u003e Result\u003c()\u003e;\n\n    fn send_generic_message(\u0026mut self, request_id: i32, packet: \u0026RequestMessage) -\u003e Result\u003cResponseIterator\u003e;\n    fn send_order_message(\u0026mut self, request_id: i32, packet: \u0026RequestMessage) -\u003e Result\u003cResponseIterator\u003e;\n    fn request_next_order_id(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e;\n    fn request_open_orders(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e;\n    fn request_market_rule(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e;\n\n    fn write(\u0026mut self, packet: \u0026str) -\u003e Result\u003c()\u003e;\n\n    fn process_messages(\u0026mut self, server_version: i32) -\u003e Result\u003c()\u003e;\n\n    fn request_messages(\u0026self) -\u003e Vec\u003cRequestMessage\u003e {\n        vec![]\n    }\n}\n\n#[derive(Debug)]\npub struct TcpMessageBus {\n    reader: Arc\u003cTcpStream\u003e,\n    writer: Box\u003cTcpStream\u003e,\n    handles: Vec\u003cJoinHandle\u003ci32\u003e\u003e,\n    requests: Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    orders: Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    recorder: MessageRecorder,\n    globals: Arc\u003cGlobalChannels\u003e,\n    signals_send: Sender\u003cSignal\u003e,\n    signals_recv: Receiver\u003cSignal\u003e,\n}\n\npub enum Signal {\n    Request(i32),\n    Order(i32),\n}\n\n#[derive(Debug)]\nstruct GlobalChannels {\n    order_ids_in: Arc\u003cSender\u003cResponseMessage\u003e\u003e,\n    order_ids_out: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e,\n    open_orders_in: Arc\u003cSender\u003cResponseMessage\u003e\u003e,\n    open_orders_out: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e,\n    send_market_rule: Arc\u003cSender\u003cResponseMessage\u003e\u003e,\n    recv_market_rule: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e,\n}\n\nimpl GlobalChannels {\n    pub fn new() -\u003e Self {\n        let (order_ids_in, order_ids_out) = channel::unbounded();\n        let (open_orders_in, open_orders_out) = channel::unbounded();\n        let (send_market_rule, recv_market_rule) = channel::unbounded();\n\n        GlobalChannels {\n            order_ids_in: Arc::new(order_ids_in),\n            order_ids_out: Arc::new(order_ids_out),\n            open_orders_in: Arc::new(open_orders_in),\n            open_orders_out: Arc::new(open_orders_out),\n            send_market_rule: Arc::new(send_market_rule),\n            recv_market_rule: Arc::new(recv_market_rule),\n        }\n    }\n}\n\nimpl TcpMessageBus {\n    // establishes TCP connection to server\n    pub fn connect(connection_string: \u0026str) -\u003e Result\u003cTcpMessageBus\u003e {\n        let stream = TcpStream::connect(connection_string)?;\n\n        let reader = Arc::new(stream.try_clone()?);\n        let writer = Box::new(stream);\n        let requests = Arc::new(SenderHash::new());\n        let orders = Arc::new(SenderHash::new());\n\n        let (signals_send, signals_recv) = channel::unbounded();\n\n        Ok(TcpMessageBus {\n            reader,\n            writer,\n            handles: Vec::default(),\n            requests,\n            orders,\n            recorder: MessageRecorder::new(),\n            globals: Arc::new(GlobalChannels::new()),\n            signals_send,\n            signals_recv,\n        })\n    }\n\n    fn add_request(\u0026mut self, request_id: i32, sender: Sender\u003cResponseMessage\u003e) -\u003e Result\u003c()\u003e {\n        self.requests.insert(request_id, sender);\n        Ok(())\n    }\n\n    fn add_order(\u0026mut self, order_id: i32, sender: Sender\u003cResponseMessage\u003e) -\u003e Result\u003c()\u003e {\n        self.orders.insert(order_id, sender);\n        Ok(())\n    }\n}\n\nconst UNSPECIFIED_REQUEST_ID: i32 = -1;\n\nimpl MessageBus for TcpMessageBus {\n    fn read_message(\u0026mut self) -\u003e Result\u003cResponseMessage\u003e {\n        read_packet(\u0026self.reader)\n    }\n\n    fn send_generic_message(\u0026mut self, request_id: i32, packet: \u0026RequestMessage) -\u003e Result\u003cResponseIterator\u003e {\n        let (sender, receiver) = channel::unbounded();\n\n        self.add_request(request_id, sender)?;\n        self.write_message(packet)?;\n\n        Ok(ResponseIterator::new(\n            receiver,\n            self.signals_send.clone(),\n            Some(request_id),\n            None,\n            Duration::from_secs(10),\n        ))\n    }\n\n    fn send_order_message(\u0026mut self, order_id: i32, message: \u0026RequestMessage) -\u003e Result\u003cResponseIterator\u003e {\n        let (sender, receiver) = channel::unbounded();\n\n        self.add_order(order_id, sender)?;\n        self.write_message(message)?;\n\n        Ok(ResponseIterator::new(\n            receiver,\n            self.signals_send.clone(),\n            None,\n            Some(order_id),\n            Duration::from_secs(10),\n        ))\n    }\n\n    fn request_next_order_id(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.write_message(message)?;\n        Ok(GlobalResponseIterator::new(Arc::clone(\u0026self.globals.order_ids_out)))\n    }\n\n    fn request_open_orders(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.write_message(message)?;\n        Ok(GlobalResponseIterator::new(Arc::clone(\u0026self.globals.open_orders_out)))\n    }\n\n    fn request_market_rule(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.write_message(message)?;\n        Ok(GlobalResponseIterator::new(Arc::clone(\u0026self.globals.recv_market_rule)))\n    }\n\n    fn write_message(\u0026mut self, message: \u0026RequestMessage) -\u003e Result\u003c()\u003e {\n        let encoded = message.encode();\n        debug!(\"{encoded:?} -\u003e\");\n\n        let data = encoded.as_bytes();\n        let mut header = Vec::with_capacity(data.len());\n        header.write_u32::\u003cBigEndian\u003e(data.len() as u32)?;\n\n        self.writer.write_all(\u0026header)?;\n        self.writer.write_all(data)?;\n\n        self.recorder.record_request(message);\n\n        Ok(())\n    }\n\n    fn write(\u0026mut self, data: \u0026str) -\u003e Result\u003c()\u003e {\n        debug!(\"{data:?} -\u003e\");\n        self.writer.write_all(data.as_bytes())?;\n        Ok(())\n    }\n\n    fn process_messages(\u0026mut self, server_version: i32) -\u003e Result\u003c()\u003e {\n        let reader = Arc::clone(\u0026self.reader);\n        let requests = Arc::clone(\u0026self.requests);\n        let recorder = self.recorder.clone();\n        let orders = Arc::clone(\u0026self.orders);\n        let globals = Arc::clone(\u0026self.globals);\n        let executions = SenderHash::\u003cString, ResponseMessage\u003e::new();\n\n        let handle = thread::spawn(move || loop {\n            match read_packet(\u0026reader) {\n                Ok(message) =\u003e {\n                    recorder.record_response(\u0026message);\n                    dispatch_message(message, server_version, \u0026requests, \u0026orders, \u0026globals, \u0026executions);\n                }\n                Err(err) =\u003e {\n                    error!(\"error reading packet: {:?}\", err);\n                    continue;\n                }\n            };\n\n            // FIXME - does read block?\n            // thread::sleep(Duration::from_secs(1));\n        });\n\n        self.handles.push(handle);\n\n        let requests = Arc::clone(\u0026self.requests);\n        let orders = Arc::clone(\u0026self.orders);\n        let signal_recv = self.signals_recv.clone();\n\n        let handle = thread::spawn(move || loop {\n            for signal in \u0026signal_recv {\n                match signal {\n                    Signal::Request(request_id) =\u003e {\n                        requests.remove(\u0026request_id);\n                        debug!(\"released request_id {}, requests.len()={}\", request_id, requests.len());\n                    }\n                    Signal::Order(order_id) =\u003e {\n                        orders.remove(\u0026order_id);\n                        debug!(\"released order_id {}, orders.len()={}\", order_id, requests.len());\n                    }\n                }\n            }\n        });\n\n        self.handles.push(handle);\n\n        Ok(())\n    }\n}\n\nfn dispatch_message(\n    message: ResponseMessage,\n    server_version: i32,\n    requests: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    orders: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    globals: \u0026Arc\u003cGlobalChannels\u003e,\n    executions: \u0026SenderHash\u003cString, ResponseMessage\u003e,\n) {\n    match message.message_type() {\n        IncomingMessages::Error =\u003e {\n            let request_id = message.peek_int(2).unwrap_or(-1);\n\n            if request_id == UNSPECIFIED_REQUEST_ID {\n                error_event(server_version, message).unwrap();\n            } else {\n                process_response(requests, orders, message);\n            }\n        }\n        IncomingMessages::NextValidId =\u003e {\n            globals.order_ids_in.send(message).unwrap();\n        }\n        IncomingMessages::MarketRule =\u003e {\n            globals.send_market_rule.send(message).unwrap();\n        }\n        IncomingMessages::ManagedAccounts =\u003e process_managed_accounts(server_version, message),\n        IncomingMessages::OrderStatus\n        | IncomingMessages::OpenOrder\n        | IncomingMessages::OpenOrderEnd\n        | IncomingMessages::CompletedOrder\n        | IncomingMessages::CompletedOrdersEnd\n        | IncomingMessages::ExecutionData\n        | IncomingMessages::ExecutionDataEnd\n        | IncomingMessages::CommissionsReport =\u003e process_orders(message, requests, orders, executions, globals),\n        _ =\u003e process_response(requests, orders, message),\n    };\n}\n\nfn read_packet(mut reader: \u0026TcpStream) -\u003e Result\u003cResponseMessage\u003e {\n    let message_size = read_header(reader)?;\n    debug!(\"message size: {message_size}\");\n    let mut data = vec![0_u8; message_size];\n\n    reader.read_exact(\u0026mut data)?;\n\n    let packet = ResponseMessage::from(\u0026String::from_utf8(data)?);\n    debug!(\"raw string: {:?}\", packet);\n\n    Ok(packet)\n}\n\nfn read_header(mut reader: \u0026TcpStream) -\u003e Result\u003cusize\u003e {\n    let buffer = \u0026mut [0_u8; 4];\n    reader.read_exact(buffer)?;\n\n    let mut reader = Cursor::new(buffer);\n    let count = reader.read_u32::\u003cBigEndian\u003e()?;\n\n    Ok(count as usize)\n}\n\nfn error_event(server_version: i32, mut packet: ResponseMessage) -\u003e Result\u003c()\u003e {\n    packet.skip(); // message_id\n\n    let version = packet.next_int()?;\n\n    if version \u003c 2 {\n        let message = packet.next_string()?;\n        error!(\"version 2 erorr: {}\", message);\n        Ok(())\n    } else {\n        let request_id = packet.next_int()?;\n        let error_code = packet.next_int()?;\n        let error_message = packet.next_string()?;\n\n        // if 322 forward to market_rule_id\n\n        let mut advanced_order_reject_json: String = \"\".to_string();\n        if server_version \u003e= server_versions::ADVANCED_ORDER_REJECT {\n            advanced_order_reject_json = packet.next_string()?;\n        }\n        debug!(\n            \"request_id: {}, error_code: {}, error_message: {}, advanced_order_reject_json: {}\",\n            request_id, error_code, error_message, advanced_order_reject_json\n        );\n        println!(\"[{error_code}] {error_message}\");\n        Ok(())\n    }\n}\n\nfn process_managed_accounts(_server_version: i32, mut packet: ResponseMessage) {\n    packet.skip(); // message_id\n    packet.skip(); // version\n\n    let managed_accounts = packet.next_string().unwrap_or_else(|_| String::default());\n    info!(\"managed accounts: {}\", managed_accounts)\n}\n\nfn process_response(requests: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e, orders: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e, message: ResponseMessage) {\n    let request_id = message.request_id().unwrap_or(-1); // pass in request id?\n    if requests.contains(\u0026request_id) {\n        requests.send(\u0026request_id, message).unwrap();\n    } else if orders.contains(\u0026request_id) {\n        orders.send(\u0026request_id, message).unwrap();\n    }\n}\n\nfn process_orders(\n    message: ResponseMessage,\n    requests: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    orders: \u0026Arc\u003cSenderHash\u003ci32, ResponseMessage\u003e\u003e,\n    executions: \u0026SenderHash\u003cString, ResponseMessage\u003e,\n    globals: \u0026Arc\u003cGlobalChannels\u003e,\n) {\n    match message.message_type() {\n        IncomingMessages::ExecutionData =\u003e {\n            match (message.order_id(), message.request_id()) {\n                // First check matching orders channel\n                (Some(order_id), _) if orders.contains(\u0026order_id) =\u003e {\n                    if let Err(e) = orders.send(\u0026order_id, message) {\n                        error!(\"error routing message for order_id({order_id}): {e}\");\n                    }\n                }\n                (_, Some(request_id)) if requests.contains(\u0026request_id) =\u003e {\n                    if let Some(sender) = requests.copy_sender(request_id) {\n                        if let Some(execution_id) = message.execution_id() {\n                            executions.insert(execution_id, sender);\n                        }\n                    }\n\n                    if let Err(e) = requests.send(\u0026request_id, message) {\n                        error!(\"error routing message for request_id({request_id}): {e}\");\n                    }\n                }\n                _ =\u003e {\n                    error!(\"could not route message {message:?}\");\n                }\n            }\n        }\n        IncomingMessages::ExecutionDataEnd =\u003e {\n            match (message.order_id(), message.request_id()) {\n                // First check matching orders channel\n                (Some(order_id), _) if orders.contains(\u0026order_id) =\u003e {\n                    if let Err(e) = orders.send(\u0026order_id, message) {\n                        error!(\"error routing message for order_id({order_id}): {e}\");\n                    }\n                }\n                (_, Some(request_id)) if requests.contains(\u0026request_id) =\u003e {\n                    if let Err(e) = requests.send(\u0026request_id, message) {\n                        error!(\"error routing message for request_id({request_id}): {e}\");\n                    }\n                }\n                _ =\u003e {\n                    error!(\"could not route message {message:?}\");\n                }\n            }\n        }\n        IncomingMessages::OpenOrder | IncomingMessages::OrderStatus =\u003e {\n            if let Some(order_id) = message.order_id() {\n                if orders.contains(\u0026order_id) {\n                    if let Err(e) = orders.send(\u0026order_id, message) {\n                        error!(\"error routing message for order_id({order_id}): {e}\");\n                    }\n                } else {\n                    if let Err(e) = globals.open_orders_in.send(message) {\n                        error!(\"error sending IncomingMessages::OpenOrder: {e}\");\n                    }\n                }\n            }\n        }\n        IncomingMessages::CompletedOrder =\u003e {\n            if let Err(e) = globals.open_orders_in.send(message) {\n                error!(\"error sending IncomingMessages::CompletedOrder: {e}\");\n            }\n        }\n        IncomingMessages::OpenOrderEnd =\u003e {\n            if let Err(e) = globals.open_orders_in.send(message) {\n                error!(\"error sending IncomingMessages::OpenOrderEnd: {e}\");\n            }\n        }\n        IncomingMessages::CompletedOrdersEnd =\u003e {\n            if let Err(e) = globals.open_orders_in.send(message) {\n                error!(\"error sending IncomingMessages::CompletedOrdersEnd: {e}\");\n            }\n        }\n        IncomingMessages::CommissionsReport =\u003e {\n            if let Some(execution_id) = message.execution_id() {\n                if let Err(e) = executions.send(\u0026execution_id, message) {\n                    error!(\"error sending commision report for execution {}: {}\", execution_id, e);\n                }\n            }\n        }\n        _ =\u003e (),\n    }\n}\n\n#[derive(Debug)]\nstruct SenderHash\u003cK, V\u003e {\n    data: RwLock\u003cHashMap\u003cK, Sender\u003cV\u003e\u003e\u003e,\n}\n\nimpl\u003cK: std::hash::Hash + Eq + std::fmt::Debug, V: std::fmt::Debug\u003e SenderHash\u003cK, V\u003e {\n    pub fn new() -\u003e Self {\n        Self {\n            data: RwLock::new(HashMap::new()),\n        }\n    }\n\n    pub fn send(\u0026self, id: \u0026K, message: V) -\u003e Result\u003c()\u003e {\n        let senders = self.data.read().unwrap();\n        debug!(\"senders: {senders:?}\");\n        if let Some(sender) = senders.get(id) {\n            if let Err(err) = sender.send(message) {\n                error!(\"error sending: {id:?}, {err}\")\n            }\n        } else {\n            error!(\"no recipient found for: {id:?}, {message:?}\")\n        }\n        Ok(())\n    }\n\n    pub fn copy_sender(\u0026self, id: K) -\u003e Option\u003cSender\u003cV\u003e\u003e {\n        let senders = self.data.read().unwrap();\n        senders.get(\u0026id).cloned()\n    }\n\n    pub fn insert(\u0026self, id: K, message: Sender\u003cV\u003e) -\u003e Option\u003cSender\u003cV\u003e\u003e {\n        let mut senders = self.data.write().unwrap();\n        senders.insert(id, message)\n    }\n\n    pub fn remove(\u0026self, id: \u0026K) -\u003e Option\u003cSender\u003cV\u003e\u003e {\n        let mut senders = self.data.write().unwrap();\n        senders.remove(id)\n    }\n\n    pub fn contains(\u0026self, id: \u0026K) -\u003e bool {\n        let senders = self.data.read().unwrap();\n        senders.contains_key(id)\n    }\n\n    pub fn len(\u0026self) -\u003e usize {\n        let senders = self.data.read().unwrap();\n        senders.len()\n    }\n}\n\n#[derive(Debug)]\npub struct ResponseIterator {\n    messages: Receiver\u003cResponseMessage\u003e, // for client to receive incoming messages\n    signals: Sender\u003cSignal\u003e,             // for client to signal termination\n    request_id: Option\u003ci32\u003e,             // initiating request_id\n    order_id: Option\u003ci32\u003e,               // initiating order_id\n    timeout: Duration,                   // How long to wait for next message\n}\n\nimpl ResponseIterator {\n    pub fn new(\n        messages: Receiver\u003cResponseMessage\u003e,\n        signals: Sender\u003cSignal\u003e,\n        request_id: Option\u003ci32\u003e,\n        order_id: Option\u003ci32\u003e,\n        timeout: Duration,\n    ) -\u003e Self {\n        ResponseIterator {\n            messages,\n            signals,\n            request_id,\n            order_id,\n            timeout,\n        }\n    }\n}\n\nimpl Drop for ResponseIterator {\n    fn drop(\u0026mut self) {\n        if let Some(request_id) = self.request_id {\n            self.signals.send(Signal::Request(request_id)).unwrap();\n        }\n\n        if let Some(order_id) = self.order_id {\n            self.signals.send(Signal::Order(order_id)).unwrap();\n        }\n    }\n}\n\nimpl Iterator for ResponseIterator {\n    type Item = ResponseMessage;\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        match self.messages.recv_timeout(self.timeout) {\n            Err(err) =\u003e {\n                info!(\"timeout receiving packet: {err}\");\n                None\n            }\n            Ok(message) =\u003e Some(message),\n        }\n    }\n}\n\n#[derive(Debug)]\npub struct GlobalResponseIterator {\n    messages: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e,\n}\n\nimpl GlobalResponseIterator {\n    pub fn new(messages: Arc\u003cReceiver\u003cResponseMessage\u003e\u003e) -\u003e Self {\n        Self { messages }\n    }\n}\n\nimpl Iterator for GlobalResponseIterator {\n    type Item = ResponseMessage;\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        match self.messages.recv_timeout(Duration::from_secs(5)) {\n            Err(err) =\u003e {\n                info!(\"timeout receiving packet: {err}\");\n                None\n            }\n            Ok(message) =\u003e Some(message),\n        }\n    }\n}\n\n#[cfg(test)]\nmod tests;\n","traces":[{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":190,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":193,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":206,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":207,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":208,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":210,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":211,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":212,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":220,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":224,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":227,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":228,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":229,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":230,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":233,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":235,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":255,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":262,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":265,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":266,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":268,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":269,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":271,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":279,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":280,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":284,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":287,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":291,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":297,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":301,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":302,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":304,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":307,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":312,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":315,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":317,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":325,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":336,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":338,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":341,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":344,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":345,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":347,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":348,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":349,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":353,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":360,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":362,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":365,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":366,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":369,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":370,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":371,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":372,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":376,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":381,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":388,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":389,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":390,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":393,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":404,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":405,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":406,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":407,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":411,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":417,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":418,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":422,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":423,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":427,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":428,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":432,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":433,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":438,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":454,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":455,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":457,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":458,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":459,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":462,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":464,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":467,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":469,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":472,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":473,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":474,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":477,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":478,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":479,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":482,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":487,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":489,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":522,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":523,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":526,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":527,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":534,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":535,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":536,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":537,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":538,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":540,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":551,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":558,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":559,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":560,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":561,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":562,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":564,"address":[],"length":0,"stats":{"Line":2},"fn_name":null}],"covered":10,"coverable":241},{"path":["/","Users","wboayue","projects","rust-ibapi","src","client.rs"],"content":"use std::fmt;\nuse std::ops::Index;\nuse std::str::FromStr;\n\nuse anyhow::{anyhow, Result};\nuse log::{debug, error, info};\nuse time::OffsetDateTime;\n\nuse self::transport::{GlobalResponseIterator, MessageBus, ResponseIterator, TcpMessageBus};\nuse crate::messages::{order_id_index, request_id_index, IncomingMessages, OutgoingMessages};\nuse crate::{server_versions, ToField};\n\npub(crate) mod transport;\n\nconst MIN_SERVER_VERSION: i32 = 100;\nconst MAX_SERVER_VERSION: i32 = server_versions::HISTORICAL_SCHEDULE;\nconst INFINITY_STR: \u0026str = \"Infinity\";\nconst UNSET_DOUBLE: \u0026str = \"1.7976931348623157E308\";\nconst UNSET_INTEGER: \u0026str = \"2147483647\";\nconst UNSET_LONG: \u0026str = \"9223372036854775807\";\n\npub struct Client {\n    /// IB server version\n    pub server_version: i32,\n    /// IB Server time\n    //    pub server_time: OffsetDateTime,\n    pub server_time: String,\n    // Next valid order id\n    pub next_valid_order_id: i32,\n\n    managed_accounts: String,\n    client_id: i32, // ID of client.\n    pub(crate) message_bus: Box\u003cdyn MessageBus\u003e,\n    next_request_id: i32, // Next available request_id.\n    order_id: i32,        // Next available order_id. Starts with value returned on connection.\n}\n\nimpl Client {\n    /// Establishes connection to TWS or Gateway\n    ///\n    /// Connects to server using the given connection string\n    ///\n    /// # Arguments\n    /// * `connection_string` - connection string in the following format [host]:[port]:[client_id].\n    ///                         client id is optional and defaults to 100.\n    ///\n    /// # Examples\n    ///\n    /// ```no_run\n    /// use ibapi::client::{Client};\n    ///\n    /// fn main() -\u003e anyhow::Result\u003c()\u003e {\n    ///     let mut client = Client::connect(\"localhost:4002\")?;\n    ///\n    ///     println!(\"server_version: {}\", client.server_version());\n    ///     println!(\"server_time: {}\", client.server_time());\n    ///     println!(\"managed_accounts: {}\", client.managed_accounts());\n    ///     println!(\"next_order_id: {}\", client.next_order_id());\n    ///\n    ///     Ok(())\n    /// }\n    /// ```\n    pub fn connect(connection_string: \u0026str) -\u003e Result\u003cClient\u003e {\n        debug!(\"connecting to server with #{:?}\", connection_string);\n\n        let message_bus = Box::new(TcpMessageBus::connect(connection_string)?);\n        Client::do_connect(message_bus)\n    }\n\n    fn do_connect(message_bus: Box\u003cdyn MessageBus\u003e) -\u003e Result\u003cClient\u003e {\n        let mut client = Client {\n            server_version: 0,\n            server_time: String::from(\"\"),\n            next_valid_order_id: 0,\n            managed_accounts: String::from(\"\"),\n            message_bus,\n            client_id: 100,\n            next_request_id: 9000,\n            order_id: -1,\n        };\n\n        client.handshake()?;\n        client.start_api()?;\n        client.receive_account_info()?;\n\n        client.message_bus.process_messages(client.server_version)?;\n\n        Ok(client)\n    }\n\n    #[cfg(test)]\n    pub(crate) fn stubbed(message_bus: Box\u003cdyn MessageBus\u003e, server_version: i32) -\u003e Client {\n        Client {\n            server_version: server_version,\n            server_time: String::from(\"\"),\n            next_valid_order_id: 0,\n            managed_accounts: String::from(\"\"),\n            message_bus,\n            client_id: 100,\n            next_request_id: 9000,\n            order_id: -1,\n        }\n    }\n\n    // sends server handshake\n    fn handshake(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.message_bus.write(\"API\\x00\")?;\n\n        let prelude = \u0026mut RequestMessage::new();\n        prelude.push_field(\u0026format!(\"v{MIN_SERVER_VERSION}..{MAX_SERVER_VERSION}\"));\n\n        self.message_bus.write_message(prelude)?;\n\n        let mut status = self.message_bus.read_message()?;\n\n        self.server_version = status.next_int()?;\n        self.server_time = status.next_string()?;\n\n        Ok(())\n    }\n\n    // asks server to start processing messages\n    fn start_api(\u0026mut self) -\u003e Result\u003c()\u003e {\n        const VERSION: i32 = 2;\n\n        let prelude = \u0026mut RequestMessage::default();\n\n        prelude.push_field(\u0026OutgoingMessages::StartApi);\n        prelude.push_field(\u0026VERSION);\n        prelude.push_field(\u0026self.client_id);\n\n        if self.server_version \u003e server_versions::OPTIONAL_CAPABILITIES {\n            prelude.push_field(\u0026\"\");\n        }\n\n        self.message_bus.write_message(prelude)?;\n\n        Ok(())\n    }\n\n    // Fetches next order id and managed accounts.\n    fn receive_account_info(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let mut saw_next_order_id: bool = false;\n        let mut saw_managed_accounts: bool = false;\n\n        let mut attempts = 0;\n        const MAX_ATTEMPTS: i32 = 100;\n        loop {\n            let mut message = self.message_bus.read_message()?;\n\n            match message.message_type() {\n                IncomingMessages::NextValidId =\u003e {\n                    saw_next_order_id = true;\n\n                    message.skip(); // message type\n                    message.skip(); // message version\n\n                    self.order_id = message.next_int()?;\n                }\n                IncomingMessages::ManagedAccounts =\u003e {\n                    saw_managed_accounts = true;\n\n                    message.skip(); // message type\n                    message.skip(); // message version\n\n                    self.managed_accounts = message.next_string()?;\n                }\n                IncomingMessages::Error =\u003e {\n                    error!(\"message: {message:?}\")\n                }\n                _ =\u003e info!(\"message: {message:?}\"),\n            }\n\n            attempts += 1;\n            if (saw_next_order_id \u0026\u0026 saw_managed_accounts) || attempts \u003e MAX_ATTEMPTS {\n                break;\n            }\n        }\n\n        Ok(())\n    }\n\n    // Old Client interface\n    /// Returns the next request ID.\n    pub fn next_request_id(\u0026mut self) -\u003e i32 {\n        let request_id = self.next_request_id;\n        self.next_request_id += 1;\n        request_id\n    }\n\n    /// Returns and increments the order ID.\n    pub fn next_order_id(\u0026mut self) -\u003e i32 {\n        let order_id = self.order_id;\n        self.order_id += 1;\n        order_id\n    }\n\n    /// Sets the current value of order ID.\n    pub(crate) fn set_next_order_id(\u0026mut self, order_id: i32) -\u003e i32 {\n        self.order_id = order_id;\n        self.order_id\n    }\n\n    pub fn server_version(\u0026self) -\u003e i32 {\n        self.server_version\n    }\n\n    /// Returns the server version.\n    pub fn server_time(\u0026self) -\u003e String {\n        self.server_time.to_owned()\n    }\n\n    /// Returns the managed accounts.\n    pub fn managed_accounts(\u0026self) -\u003e String {\n        self.managed_accounts.to_owned()\n    }\n\n    pub(crate) fn send_message(\u0026mut self, packet: RequestMessage) -\u003e Result\u003c()\u003e {\n        self.message_bus.write_message(\u0026packet)\n    }\n\n    pub(crate) fn send_request(\u0026mut self, request_id: i32, message: RequestMessage) -\u003e Result\u003cResponseIterator\u003e {\n        debug!(\"send_message({:?}, {:?})\", request_id, message);\n        self.message_bus.send_generic_message(request_id, \u0026message)\n    }\n\n    pub(crate) fn send_order(\u0026mut self, order_id: i32, message: RequestMessage) -\u003e Result\u003cResponseIterator\u003e {\n        debug!(\"send_order({:?}, {:?})\", order_id, message);\n        self.message_bus.send_order_message(order_id, \u0026message)\n    }\n\n    /// Sends request for the next valid order id.\n    pub(crate) fn request_next_order_id(\u0026mut self, message: RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.message_bus.request_next_order_id(\u0026message)\n    }\n\n    /// Sends request for open orders.\n    pub(crate) fn request_order_data(\u0026mut self, message: RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.message_bus.request_open_orders(\u0026message)\n    }\n\n    /// Sends request for market rule.\n    pub(crate) fn request_market_rule(\u0026mut self, message: RequestMessage) -\u003e Result\u003cGlobalResponseIterator\u003e {\n        self.message_bus.request_market_rule(\u0026message)\n    }\n\n    pub(crate) fn check_server_version(\u0026self, version: i32, message: \u0026str) -\u003e Result\u003c()\u003e {\n        if version \u003c= self.server_version {\n            Ok(())\n        } else {\n            Err(anyhow!(\"server version {} required, got {}: {}\", version, self.server_version, message))\n        }\n    }\n}\n\nimpl Drop for Client {\n    fn drop(\u0026mut self) {\n        info!(\"dropping basic client\")\n    }\n}\n\nimpl fmt::Debug for Client {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        f.debug_struct(\"Client\")\n            .field(\"server_version\", \u0026self.server_version)\n            .field(\"server_time\", \u0026self.server_time)\n            .field(\"client_id\", \u0026self.client_id)\n            .finish()\n    }\n}\n\n#[derive(Default, Debug, Clone)]\npub struct RequestMessage {\n    fields: Vec\u003cString\u003e,\n}\n\nimpl RequestMessage {\n    pub fn new() -\u003e Self {\n        Self::default()\n    }\n\n    pub fn from(_fields: \u0026[Box\u003cdyn ToField\u003e]) -\u003e RequestMessage {\n        RequestMessage::default()\n    }\n\n    pub fn push_field\u003cT: ToField\u003e(\u0026mut self, val: \u0026T) -\u003e \u0026RequestMessage {\n        let field = val.to_field();\n        self.fields.push(field);\n        self\n    }\n\n    pub fn encode(\u0026self) -\u003e String {\n        let mut data = self.fields.join(\"\\0\");\n        data.push('\\0');\n        data\n    }\n\n    pub(crate) fn encode_simple(\u0026self) -\u003e String {\n        let mut data = self.fields.join(\"|\");\n        data.push('|');\n        data\n    }\n}\n\nimpl Index\u003cusize\u003e for RequestMessage {\n    type Output = String;\n\n    fn index(\u0026self, i: usize) -\u003e \u0026Self::Output {\n        \u0026self.fields[i]\n    }\n}\n\n#[derive(Clone, Default, Debug)]\npub struct ResponseMessage {\n    pub i: usize,\n    pub fields: Vec\u003cString\u003e,\n}\n\nimpl ResponseMessage {\n    pub fn message_type(\u0026self) -\u003e IncomingMessages {\n        if self.fields.is_empty() {\n            IncomingMessages::NotValid\n        } else {\n            let message_id = i32::from_str(\u0026self.fields[0]).unwrap_or(-1);\n            IncomingMessages::from(message_id)\n        }\n    }\n\n    pub fn request_id(\u0026self) -\u003e Option\u003ci32\u003e {\n        if let Some(i) = request_id_index(self.message_type()) {\n            if let Ok(request_id) = self.peek_int(i) {\n                return Some(request_id);\n            }\n        }\n        None\n    }\n\n    pub fn order_id(\u0026self) -\u003e Option\u003ci32\u003e {\n        if let Some(i) = order_id_index(self.message_type()) {\n            if let Ok(order_id) = self.peek_int(i) {\n                return Some(order_id);\n            }\n        }\n        None\n    }\n\n    pub fn execution_id(\u0026self) -\u003e Option\u003cString\u003e {\n        match self.message_type() {\n            IncomingMessages::ExecutionData =\u003e Some(self.peek_string(14)),\n            IncomingMessages::CommissionsReport =\u003e Some(self.peek_string(2)),\n            _ =\u003e None,\n        }\n    }\n\n    pub fn peek_int(\u0026self, i: usize) -\u003e Result\u003ci32\u003e {\n        let field = \u0026self.fields[i];\n        match field.parse() {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", i, field, err)),\n        }\n    }\n\n    pub fn peek_string(\u0026self, i: usize) -\u003e String {\n        self.fields[i].to_owned()\n    }\n\n    pub fn next_int(\u0026mut self) -\u003e Result\u003ci32\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        match field.parse() {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_optional_int(\u0026mut self) -\u003e Result\u003cOption\u003ci32\u003e\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        if field.is_empty() || field == UNSET_INTEGER {\n            return Ok(None);\n        }\n\n        match field.parse::\u003ci32\u003e() {\n            Ok(val) =\u003e Ok(Some(val)),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_bool(\u0026mut self) -\u003e Result\u003cbool\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        Ok(field == \"1\")\n    }\n\n    pub fn next_long(\u0026mut self) -\u003e Result\u003ci64\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        match field.parse() {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_optional_long(\u0026mut self) -\u003e Result\u003cOption\u003ci64\u003e\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        if field.is_empty() || field == UNSET_LONG {\n            return Ok(None);\n        }\n\n        match field.parse::\u003ci64\u003e() {\n            Ok(val) =\u003e Ok(Some(val)),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_date_time(\u0026mut self) -\u003e Result\u003cOffsetDateTime\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        // from_unix_timestamp\n        let timestamp: i64 = field.parse()?;\n        match OffsetDateTime::from_unix_timestamp(timestamp) {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_string(\u0026mut self) -\u003e Result\u003cString\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n        Ok(String::from(field))\n    }\n\n    pub fn next_double(\u0026mut self) -\u003e Result\u003cf64\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        if field.is_empty() || field == \"0\" || field == \"0.0\" {\n            return Ok(0.0);\n        }\n\n        match field.parse() {\n            Ok(val) =\u003e Ok(val),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn next_optional_double(\u0026mut self) -\u003e Result\u003cOption\u003cf64\u003e\u003e {\n        let field = \u0026self.fields[self.i];\n        self.i += 1;\n\n        if field.is_empty() || field == UNSET_DOUBLE {\n            return Ok(None);\n        }\n\n        if field == INFINITY_STR {\n            return Ok(Some(f64::INFINITY));\n        }\n\n        match field.parse() {\n            Ok(val) =\u003e Ok(Some(val)),\n            Err(err) =\u003e Err(anyhow!(\"error parsing field {} {}: {}\", self.i, field, err)),\n        }\n    }\n\n    pub fn from(fields: \u0026str) -\u003e ResponseMessage {\n        ResponseMessage {\n            i: 0,\n            fields: fields.split('\\x00').map(|x| x.to_string()).collect(),\n        }\n    }\n\n    pub fn skip(\u0026mut self) {\n        self.i += 1;\n    }\n\n    pub fn reset(\u0026mut self) {\n        self.i = 0;\n    }\n\n    pub fn encode(\u0026self) -\u003e String {\n        let mut data = self.fields.join(\"\\0\");\n        data.push('\\0');\n        data\n    }\n}\n\n#[cfg(test)]\nmod tests;\n","traces":[{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":128,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":193,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":18},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":18},"fn_name":null},{"line":209,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":210,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":214,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":215,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":218,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":219,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":224,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":227,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":228,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":229,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":233,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":238,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":239,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":248,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":249,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":251,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":258,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":263,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":264,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":265,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":266,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":267,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":278,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":279,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":282,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":283,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":540},"fn_name":null},{"line":287,"address":[],"length":0,"stats":{"Line":540},"fn_name":null},{"line":288,"address":[],"length":0,"stats":{"Line":540},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":540},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":293,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":300,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":301,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":61},"fn_name":null},{"line":309,"address":[],"length":0,"stats":{"Line":61},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":321,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":325,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":330,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":339,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":341,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":344,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":347,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":348,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":349,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":350,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":351,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":355,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":356,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":358,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":359,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":368,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":369,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":371,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":372,"address":[],"length":0,"stats":{"Line":104},"fn_name":null},{"line":373,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":37},"fn_name":null},{"line":378,"address":[],"length":0,"stats":{"Line":37},"fn_name":null},{"line":379,"address":[],"length":0,"stats":{"Line":37},"fn_name":null},{"line":381,"address":[],"length":0,"stats":{"Line":61},"fn_name":null},{"line":382,"address":[],"length":0,"stats":{"Line":26},"fn_name":null},{"line":385,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":387,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":391,"address":[],"length":0,"stats":{"Line":73},"fn_name":null},{"line":392,"address":[],"length":0,"stats":{"Line":73},"fn_name":null},{"line":393,"address":[],"length":0,"stats":{"Line":73},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":73},"fn_name":null},{"line":398,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":403,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":404,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":408,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":409,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":412,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":416,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":417,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":418,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":422,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":423,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":424,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":427,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":428,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":429,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":430,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":256},"fn_name":null},{"line":435,"address":[],"length":0,"stats":{"Line":256},"fn_name":null},{"line":436,"address":[],"length":0,"stats":{"Line":256},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":256},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":58},"fn_name":null},{"line":441,"address":[],"length":0,"stats":{"Line":58},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":58},"fn_name":null},{"line":444,"address":[],"length":0,"stats":{"Line":148},"fn_name":null},{"line":445,"address":[],"length":0,"stats":{"Line":25},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":33},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":33},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":454,"address":[],"length":0,"stats":{"Line":118},"fn_name":null},{"line":455,"address":[],"length":0,"stats":{"Line":118},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":118},"fn_name":null},{"line":458,"address":[],"length":0,"stats":{"Line":180},"fn_name":null},{"line":459,"address":[],"length":0,"stats":{"Line":105},"fn_name":null},{"line":462,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":463,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":466,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":467,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":472,"address":[],"length":0,"stats":{"Line":25},"fn_name":null},{"line":475,"address":[],"length":0,"stats":{"Line":807},"fn_name":null},{"line":479,"address":[],"length":0,"stats":{"Line":34},"fn_name":null},{"line":480,"address":[],"length":0,"stats":{"Line":34},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":487,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":489,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":490,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":111,"coverable":210},{"path":["/","Users","wboayue","projects","rust-ibapi","src","constants.rs"],"content":"use crate::server_versions;\n\n// 100+ messaging */\n// 100 = enhanced handshake, msg length prefixes\n\npub const CLIENT_VERSION: i32 = 66; //API v. 9.71\n\npub const MIN_CLIENT_VER: i32 = 100;\npub const MAX_CLIENT_VER: i32 = server_versions::PRICE_MGMT_ALGO;\n\n// public const int ClientVersion = 66;//API v. 9.71\n// public const byte EOL = 0;\n// public const string BagSecType = \"BAG\";\n// public const int REDIRECT_COUNT_MAX = 2;\n// public const string INFINITY_STR = \"Infinity\";\n\n// public const int FaGroups = 1;\n// public const int FaProfiles = 2;\n// public const int FaAliases = 3;\n// public const int MinVersion = 100;\n// public const int MaxVersion = MinServerVer.MIN_SERVER_VER_BOND_ISSUERID;\n// public const int MaxMsgSize = 0x00FFFFFF;\n\n//         public const int FaGroups = 1;\n//         public const int FaProfiles = 2;\n//         public const int FaAliases = 3;\n//         public const int MinVersion = 100;\n//         public const int MaxVersion = MinServerVer.MIN_SERVER_VER_BOND_ISSUERID;\n//         public const int MaxMsgSize = 0x00FFFFFF;\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts","contract_samples.rs"],"content":"use super::*;\n\n// https://github.com/InteractiveBrokers/tws-api/blob/5cb24aea5cef9d315985a7b13dea7efbcfe2b16a/samples/CSharp/Testbed/ContractSamples.cs\n\n// Future contracts also require an expiration date but are less complicated than options.\npub fn simple_future() -\u003e Contract {\n    Contract {\n        symbol: \"GBL\".to_owned(),\n        security_type: SecurityType::Future,\n        exchange: \"EUREX\".to_owned(),\n        currency: \"EUR\".to_owned(),\n        last_trade_date_or_contract_month: \"202303\".to_owned(),\n        ..Contract::default()\n    }\n}\n\n// Rather than giving expiration dates we can also provide the local symbol\n// attributes such as symbol, currency, strike, etc.\npub fn future_with_local_symbol() -\u003e Contract {\n    Contract {\n        security_type: SecurityType::Future,\n        exchange: \"EUREX\".to_owned(),\n        currency: \"EUR\".to_owned(),\n        local_symbol: \"FGBL MAR 23\".to_owned(),\n        last_trade_date_or_contract_month: \"202303\".to_owned(),\n        ..Contract::default()\n    }\n}\n\npub fn future_with_multiplier() -\u003e Contract {\n    Contract {\n        symbol: \"DAX\".to_owned(),\n        security_type: SecurityType::Future,\n        exchange: \"EUREX\".to_owned(),\n        currency: \"EUR\".to_owned(),\n        last_trade_date_or_contract_month: \"202303\".to_owned(),\n        multiplier: \"1\".to_owned(),\n        ..Contract::default()\n    }\n}\n\npub fn smart_future_combo_contract() -\u003e Contract {\n    let leg_1 = ComboLeg {\n        contract_id: 55928698, //WTI future June 2017\n        ratio: 1,\n        action: \"BUY\".to_owned(),\n        exchange: \"IPE\".to_owned(),\n        ..ComboLeg::default()\n    };\n\n    let leg_2 = ComboLeg {\n        contract_id: 55850663, //COIL future June 2017\n        ratio: 1,\n        action: \"SELL\".to_owned(),\n        exchange: \"IPE\".to_owned(),\n        ..ComboLeg::default()\n    };\n\n    Contract {\n        symbol: \"WTI\".to_owned(), // WTI,COIL spread. Symbol can be defined as first leg symbol (\"WTI\") or currency (\"USD\").\n        security_type: SecurityType::Spread,\n        currency: \"USD\".to_owned(),\n        exchange: \"SMART\".to_owned(),\n        combo_legs: vec![leg_1, leg_2],\n        ..Contract::default()\n    }\n}\n","traces":[{"line":6,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":12,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":19,"coverable":25},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts","decoders.rs"],"content":"use anyhow::Result;\nuse log::info;\n\nuse super::{Contract, ContractDescription, ContractDetails, MarketRule, PriceIncrement};\nuse crate::{client::ResponseMessage, contracts::SecurityType, orders::TagValue, server_versions};\n\npub(crate) fn contract_details(server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cContractDetails\u003e {\n    message.skip(); // message type\n\n    let mut message_version = 8;\n    if server_version \u003c server_versions::SIZE_RULES {\n        message_version = message.next_int()?;\n    }\n\n    let mut request_id = -1;\n    if message_version \u003e= 3 {\n        request_id = message.next_int()?;\n    }\n\n    info!(\n        \"request_id: {}, server_version: {}, message_version: {}\",\n        request_id, server_version, message_version\n    );\n\n    let mut contract = ContractDetails::default();\n\n    contract.contract.symbol = message.next_string()?;\n    contract.contract.security_type = SecurityType::from(\u0026message.next_string()?);\n    read_last_trade_date(\u0026mut contract, \u0026message.next_string()?, false)?;\n    contract.contract.strike = message.next_double()?;\n    contract.contract.right = message.next_string()?;\n    contract.contract.exchange = message.next_string()?;\n    contract.contract.currency = message.next_string()?;\n    contract.contract.local_symbol = message.next_string()?;\n    contract.market_name = message.next_string()?;\n    contract.contract.trading_class = message.next_string()?;\n    contract.contract.contract_id = message.next_int()?;\n    contract.min_tick = message.next_double()?;\n    if (server_versions::MD_SIZE_MULTIPLIER..server_versions::SIZE_RULES).contains(\u0026server_version) {\n        message.next_int()?; // mdSizeMultiplier no longer used\n    }\n    contract.contract.multiplier = message.next_string()?;\n    contract.order_types = message.next_string()?;\n    contract.valid_exchanges = message.next_string()?;\n    if message_version \u003e= 2 {\n        contract.price_magnifier = message.next_int()?;\n    }\n    if message_version \u003e= 4 {\n        contract.under_contract_id = message.next_int()?;\n    }\n    if message_version \u003e= 5 {\n        //        https://github.com/InteractiveBrokers/tws-api/blob/817a905d52299028ac5af08581c8ffde7644cea9/source/csharpclient/client/EDecoder.cs#L1626\n        contract.long_name = message.next_string()?;\n        contract.contract.primary_exchange = message.next_string()?;\n    }\n    if message_version \u003e= 6 {\n        contract.contract_month = message.next_string()?;\n        contract.industry = message.next_string()?;\n        contract.category = message.next_string()?;\n        contract.subcategory = message.next_string()?;\n        contract.time_zone_id = message.next_string()?;\n        contract.trading_hours = message.next_string()?;\n        contract.liquid_hours = message.next_string()?;\n    }\n    if message_version \u003e= 8 {\n        contract.ev_rule = message.next_string()?;\n        contract.ev_multiplier = message.next_double()?;\n    }\n    if message_version \u003e= 7 {\n        let sec_id_list_count = message.next_int()?;\n        for _ in 0..sec_id_list_count {\n            let tag = message.next_string()?;\n            let value = message.next_string()?;\n            contract.sec_id_list.push(TagValue { tag, value });\n        }\n    }\n    if server_version \u003e server_versions::AGG_GROUP {\n        contract.agg_group = message.next_int()?;\n    }\n    if server_version \u003e server_versions::UNDERLYING_INFO {\n        contract.under_symbol = message.next_string()?;\n        contract.under_security_type = message.next_string()?;\n    }\n    if server_version \u003e server_versions::MARKET_RULES {\n        contract.market_rule_ids = message.next_string()?;\n    }\n    if server_version \u003e server_versions::REAL_EXPIRATION_DATE {\n        contract.real_expiration_date = message.next_string()?;\n    }\n    if server_version \u003e server_versions::STOCK_TYPE {\n        contract.stock_type = message.next_string()?;\n    }\n    if (server_versions::FRACTIONAL_SIZE_SUPPORT..server_versions::SIZE_RULES).contains(\u0026server_version) {\n        message.next_double()?; // size min tick -- no longer used\n    }\n    if server_version \u003e= server_versions::SIZE_RULES {\n        contract.min_size = message.next_double()?;\n        contract.size_increment = message.next_double()?;\n        contract.suggested_size_increment = message.next_double()?;\n    }\n\n    Ok(contract)\n}\n\nfn read_last_trade_date(contract: \u0026mut ContractDetails, last_trade_date_or_contract_month: \u0026str, is_bond: bool) -\u003e Result\u003c()\u003e {\n    if last_trade_date_or_contract_month.is_empty() {\n        return Ok(());\n    }\n\n    let splitted: Vec\u003c\u0026str\u003e = if last_trade_date_or_contract_month.contains('-') {\n        last_trade_date_or_contract_month.split('-').collect()\n    } else {\n        // let re = Regex::new(r\"\\s+\").unwrap();\n        last_trade_date_or_contract_month.split(' ').collect()\n    };\n\n    if !splitted.is_empty() {\n        if is_bond {\n            contract.maturity = splitted[0].to_string();\n        } else {\n            contract.contract.last_trade_date_or_contract_month = splitted[0].to_string();\n        }\n    }\n    if splitted.len() \u003e 1 {\n        contract.last_trade_time = splitted[1].to_string();\n    }\n    if is_bond \u0026\u0026 splitted.len() \u003e 2 {\n        contract.time_zone_id = splitted[2].to_string();\n    }\n\n    Ok(())\n}\n\npub(crate) fn contract_descriptions(server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cVec\u003cContractDescription\u003e\u003e {\n    message.skip(); // message type\n\n    let _request_id = message.next_int()?;\n    let contract_descriptions_count = message.next_int()?;\n\n    if contract_descriptions_count \u003c 1 {\n        return Ok(Vec::default());\n    }\n\n    let mut contract_descriptions: Vec\u003cContractDescription\u003e = Vec::with_capacity(contract_descriptions_count as usize);\n\n    for _ in 0..contract_descriptions_count {\n        let mut contract = Contract {\n            contract_id: message.next_int()?,\n            symbol: message.next_string()?,\n            security_type: SecurityType::from(\u0026message.next_string()?),\n            primary_exchange: message.next_string()?,\n            currency: message.next_string()?,\n            ..Default::default()\n        };\n\n        let derivative_security_types_count = message.next_int()?;\n        let mut derivative_security_types: Vec\u003cString\u003e = Vec::with_capacity(derivative_security_types_count as usize);\n        for _ in 0..derivative_security_types_count {\n            derivative_security_types.push(message.next_string()?);\n        }\n\n        if server_version \u003e= server_versions::BOND_ISSUERID {\n            contract.description = message.next_string()?;\n            contract.issuer_id = message.next_string()?;\n        }\n\n        contract_descriptions.push(ContractDescription {\n            contract,\n            derivative_security_types,\n        });\n    }\n\n    Ok(contract_descriptions)\n}\n\npub(crate) fn market_rule(message: \u0026mut ResponseMessage) -\u003e Result\u003cMarketRule\u003e {\n    message.skip(); // message type\n\n    let mut market_rule = MarketRule::default();\n\n    market_rule.market_rule_id = message.next_int()?;\n\n    let price_increments_count = message.next_int()?;\n    for _ in 0..price_increments_count {\n        market_rule.price_increments.push(PriceIncrement {\n            low_edge: message.next_double()?,\n            increment: message.next_double()?,\n        });\n    }\n\n    Ok(market_rule)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn decode_market_rule() {\n        let mut message = ResponseMessage::from(\"93\\026\\01\\00\\00.01\\0\");\n\n        let results = market_rule(\u0026mut message);\n\n        if let Ok(market_rule) = results {\n            assert_eq!(market_rule.market_rule_id, 26, \"market_rule.market_rule_id\");\n\n            assert_eq!(market_rule.price_increments.len(), 1, \"market_rule.price_increments.len()\");\n            assert_eq!(market_rule.price_increments[0].low_edge, 0.0, \"market_rule.price_increments[0].low_edge\");\n            assert_eq!(\n                market_rule.price_increments[0].increment, 0.01,\n                \"market_rule.price_increments[0].increment\"\n            );\n        } else if let Err(err) = results {\n            assert!(false, \"error decoding market rule: {err}\");\n        }\n    }\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":8,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":12,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":128,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":78,"coverable":117},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts","encoders.rs"],"content":"use anyhow::Result;\n\nuse super::Contract;\nuse crate::client::RequestMessage;\nuse crate::messages::OutgoingMessages;\nuse crate::server_versions;\n\npub(crate) fn request_contract_data(server_version: i32, request_id: i32, contract: \u0026Contract) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 8;\n\n    let mut packet = RequestMessage::default();\n\n    packet.push_field(\u0026OutgoingMessages::RequestContractData);\n    packet.push_field(\u0026VERSION);\n\n    if server_version \u003e= server_versions::CONTRACT_DATA_CHAIN {\n        packet.push_field(\u0026request_id);\n    }\n\n    if server_version \u003e= server_versions::CONTRACT_CONID {\n        packet.push_field(\u0026contract.contract_id);\n    }\n\n    packet.push_field(\u0026contract.symbol);\n    packet.push_field(\u0026contract.security_type);\n    packet.push_field(\u0026contract.last_trade_date_or_contract_month);\n    packet.push_field(\u0026contract.strike);\n    packet.push_field(\u0026contract.right);\n\n    if server_version \u003e= 15 {\n        packet.push_field(\u0026contract.multiplier);\n    }\n\n    if server_version \u003e= server_versions::PRIMARYEXCH {\n        packet.push_field(\u0026contract.exchange);\n        packet.push_field(\u0026contract.primary_exchange);\n    } else if server_version \u003e= server_versions::LINKING {\n        if !contract.primary_exchange.is_empty() \u0026\u0026 (contract.exchange == \"BEST\" || contract.exchange == \"SMART\") {\n            packet.push_field(\u0026format!(\"{}:{}\", contract.exchange, contract.primary_exchange));\n        } else {\n            packet.push_field(\u0026contract.exchange);\n        }\n    }\n\n    packet.push_field(\u0026contract.currency);\n    packet.push_field(\u0026contract.local_symbol);\n\n    if server_version \u003e= server_versions::TRADING_CLASS {\n        packet.push_field(\u0026contract.trading_class);\n    }\n    if server_version \u003e= 31 {\n        packet.push_field(\u0026contract.include_expired);\n    }\n    if server_version \u003e= server_versions::SEC_ID_TYPE {\n        packet.push_field(\u0026contract.security_id_type);\n        packet.push_field(\u0026contract.security_id);\n    }\n    if server_version \u003e= server_versions::BOND_ISSUERID {\n        packet.push_field(\u0026contract.issuer_id);\n    }\n\n    Ok(packet)\n}\n\npub(crate) fn request_matching_symbols(request_id: i32, pattern: \u0026str) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestMatchingSymbols);\n    message.push_field(\u0026request_id);\n    message.push_field(\u0026pattern);\n\n    Ok(message)\n}\n\npub(crate) fn request_market_rule(market_rule_id: i32) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestMarketRule);\n    message.push_field(\u0026market_rule_id);\n\n    Ok(message)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn request_market_rule() {\n        let results = super::request_market_rule(26);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message.encode(), \"91\\026\\0\", \"message.encode()\");\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding market rule request: {err}\");\n            }\n        }\n    }\n}\n","traces":[{"line":8,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":35,"coverable":45},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts","tests.rs"],"content":"use super::*;\n\nuse crate::stubs::MessageBusStub;\n\n#[test]\nfn request_stock_contract_details() {\n    let mut message_bus = Box::new(MessageBusStub{\n        request_messages: vec![],\n        response_messages: vec![\n            \"10|9001|TSLA|STK||0||SMART|USD|TSLA|NMS|NMS|76792991|0.01||ACTIVETIM,AD,ADJUST,ALERT,ALGO,ALLOC,AON,AVGCOST,BASKET,BENCHPX,CASHQTY,COND,CONDORDER,DARKONLY,DARKPOLL,DAY,DEACT,DEACTDIS,DEACTEOD,DIS,DUR,GAT,GTC,GTD,GTT,HID,IBKRATS,ICE,IMB,IOC,LIT,LMT,LOC,MIDPX,MIT,MKT,MOC,MTL,NGCOMB,NODARK,NONALGO,OCA,OPG,OPGREROUT,PEGBENCH,PEGMID,POSTATS,POSTONLY,PREOPGRTH,PRICECHK,REL,REL2MID,RELPCTOFS,RPI,RTH,SCALE,SCALEODD,SCALERST,SIZECHK,SNAPMID,SNAPMKT,SNAPREL,STP,STPLMT,SWEEP,TRAIL,TRAILLIT,TRAILLMT,TRAILMIT,WHATIF|SMART,AMEX,NYSE,CBOE,PHLX,ISE,CHX,ARCA,ISLAND,DRCTEDGE,BEX,BATS,EDGEA,CSFBALGO,JEFFALGO,BYX,IEX,EDGX,FOXRIVER,PEARL,NYSENAT,LTSE,MEMX,PSX|1|0|TESLA INC|NASDAQ||Consumer, Cyclical|Auto Manufacturers|Auto-Cars/Light Trucks|US/Eastern|20221229:0400-20221229:2000;20221230:0400-20221230:2000;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0400-20230103:2000|20221229:0930-20221229:1600;20221230:0930-20221230:1600;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0930-20230103:1600|||1|ISIN|US88160R1014|1|||26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26||COMMON|1|1|100||\".to_string(),\n            \"10|9001|TSLA|STK||0||AMEX|USD|TSLA|NMS|NMS|76792991|0.01||ACTIVETIM,AD,ADJUST,ALERT,ALLOC,AVGCOST,BASKET,BENCHPX,CASHQTY,COND,CONDORDER,DAY,DEACT,DEACTDIS,DEACTEOD,GAT,GTC,GTD,GTT,HID,IOC,LIT,LMT,MIT,MKT,MTL,NGCOMB,NONALGO,OCA,PEGBENCH,SCALE,SCALERST,SNAPMID,SNAPMKT,SNAPREL,STP,STPLMT,TRAIL,TRAILLIT,TRAILLMT,TRAILMIT,WHATIF|SMART,AMEX,NYSE,CBOE,PHLX,ISE,CHX,ARCA,ISLAND,DRCTEDGE,BEX,BATS,EDGEA,CSFBALGO,JEFFALGO,BYX,IEX,EDGX,FOXRIVER,PEARL,NYSENAT,LTSE,MEMX,PSX|1|0|TESLA INC|NASDAQ||Consumer, Cyclical|Auto Manufacturers|Auto-Cars/Light Trucks|US/Eastern|20221229:0700-20221229:2000;20221230:0700-20221230:2000;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0700-20230103:2000|20221229:0700-20221229:2000;20221230:0700-20221230:2000;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0700-20230103:2000|||1|ISIN|US88160R1014|1|||26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26||COMMON|1|1|100||\".to_string(),\n            \"52|1|9001||\".to_string(),\n        ]\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let contract = Contract::stock(\"TSLA\");\n\n    let results = super::contract_details(\u0026mut client, \u0026contract);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode_simple(), \"9|8|9000|0|TSLA|STK||0|||SMART||USD|||0|||\");\n\n    assert!(results.is_ok(), \"failed to encode request: {:?}\", results.unwrap_err());\n\n    let contracts = results.unwrap();\n    assert_eq!(2, contracts.len());\n\n    assert_eq!(contracts[0].contract.exchange, \"SMART\");\n    assert_eq!(contracts[1].contract.exchange, \"AMEX\");\n\n    assert_eq!(contracts[0].contract.symbol, \"TSLA\");\n    assert_eq!(contracts[0].contract.security_type, SecurityType::Stock);\n    assert_eq!(contracts[0].contract.currency, \"USD\");\n    assert_eq!(contracts[0].contract.contract_id, 76792991);\n    assert_eq!(contracts[0].order_types, \"ACTIVETIM,AD,ADJUST,ALERT,ALGO,ALLOC,AON,AVGCOST,BASKET,BENCHPX,CASHQTY,COND,CONDORDER,DARKONLY,DARKPOLL,DAY,DEACT,DEACTDIS,DEACTEOD,DIS,DUR,GAT,GTC,GTD,GTT,HID,IBKRATS,ICE,IMB,IOC,LIT,LMT,LOC,MIDPX,MIT,MKT,MOC,MTL,NGCOMB,NODARK,NONALGO,OCA,OPG,OPGREROUT,PEGBENCH,PEGMID,POSTATS,POSTONLY,PREOPGRTH,PRICECHK,REL,REL2MID,RELPCTOFS,RPI,RTH,SCALE,SCALEODD,SCALERST,SIZECHK,SNAPMID,SNAPMKT,SNAPREL,STP,STPLMT,SWEEP,TRAIL,TRAILLIT,TRAILLMT,TRAILMIT,WHATIF\");\n    assert_eq!(\n        contracts[0].valid_exchanges,\n        \"SMART,AMEX,NYSE,CBOE,PHLX,ISE,CHX,ARCA,ISLAND,DRCTEDGE,BEX,BATS,EDGEA,CSFBALGO,JEFFALGO,BYX,IEX,EDGX,FOXRIVER,PEARL,NYSENAT,LTSE,MEMX,PSX\"\n    );\n    assert_eq!(contracts[0].price_magnifier, 1);\n    assert_eq!(contracts[0].under_contract_id, 0);\n    assert_eq!(contracts[0].long_name, \"TESLA INC\");\n    assert_eq!(contracts[0].contract.primary_exchange, \"NASDAQ\");\n    assert_eq!(contracts[0].contract_month, \"\");\n    assert_eq!(contracts[0].industry, \"Consumer, Cyclical\");\n    assert_eq!(contracts[0].category, \"Auto Manufacturers\");\n    assert_eq!(contracts[0].subcategory, \"Auto-Cars/Light Trucks\");\n    assert_eq!(contracts[0].time_zone_id, \"US/Eastern\");\n    assert_eq!(\n        contracts[0].trading_hours,\n        \"20221229:0400-20221229:2000;20221230:0400-20221230:2000;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0400-20230103:2000\"\n    );\n    assert_eq!(\n        contracts[0].liquid_hours,\n        \"20221229:0930-20221229:1600;20221230:0930-20221230:1600;20221231:CLOSED;20230101:CLOSED;20230102:CLOSED;20230103:0930-20230103:1600\"\n    );\n    assert_eq!(contracts[0].ev_rule, \"\");\n    assert_eq!(contracts[0].ev_multiplier, 0.0);\n    assert_eq!(contracts[0].sec_id_list.len(), 1);\n    assert_eq!(contracts[0].sec_id_list[0].tag, \"ISIN\");\n    assert_eq!(contracts[0].sec_id_list[0].value, \"US88160R1014\");\n    assert_eq!(contracts[0].agg_group, 1);\n    assert_eq!(\n        contracts[0].market_rule_ids,\n        \"26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26\"\n    );\n    assert_eq!(contracts[0].stock_type, \"COMMON\");\n    assert_eq!(contracts[0].min_size, 1.0);\n    assert_eq!(contracts[0].size_increment, 1.0);\n    assert_eq!(contracts[0].suggested_size_increment, 100.0);\n}\n\n#[test]\nfn request_bond_contract_details() {}\n\n#[test]\nfn request_future_contract_details() {}\n\n#[test]\nfn test_read_last_trade_date() {\n    // let mut contract = ContractDetails::default();\n\n    // handles blank string\n    // let result = read_last_trade_date(\u0026mut contract, \"\", false);\n    // assert!(!result.is_err(), \"unexpected error {:?}\", result);\n\n    // handles non bond contracts\n\n    // handles bond contracts\n}\n\n#[test]\nfn request_matching_symbols() {}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","contracts.rs"],"content":"use std::convert::From;\nuse std::fmt::Debug;\nuse std::string::ToString;\n\nuse anyhow::{anyhow, Result};\nuse log::{error, info};\n\nuse crate::client::{Client, RequestMessage};\nuse crate::encode_option_field;\nuse crate::messages::IncomingMessages;\nuse crate::{server_versions, ToField};\n\nmod decoders;\nmod encoders;\n\n#[cfg(test)]\npub(crate) mod contract_samples;\n#[cfg(test)]\nmod tests;\n\n// Models\n\n#[derive(Clone, Debug, PartialEq, Eq, Default)]\n/// SecurityType enumerates available security types\npub enum SecurityType {\n    /// Stock (or ETF)\n    #[default]\n    Stock,\n    /// Option\n    Option,\n    /// Future\n    Future,\n    /// Index\n    Index,\n    /// Futures option\n    FuturesOption,\n    /// Forex pair\n    ForexPair,\n    /// Combo\n    Spread,\n    ///  Warrant\n    Warrant,\n    /// Bond\n    Bond,\n    /// Commodity\n    Commodity,\n    /// News\n    News,\n    /// Mutual fund\n    MutualFund,\n}\n\nimpl ToField for SecurityType {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003cSecurityType\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl ToString for SecurityType {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            SecurityType::Stock =\u003e \"STK\".to_string(),\n            SecurityType::Option =\u003e \"OPT\".to_string(),\n            SecurityType::Future =\u003e \"FUT\".to_string(),\n            SecurityType::Index =\u003e \"IND\".to_string(),\n            SecurityType::FuturesOption =\u003e \"FOP\".to_string(),\n            SecurityType::ForexPair =\u003e \"CASH\".to_string(),\n            SecurityType::Spread =\u003e \"BAG\".to_string(),\n            SecurityType::Warrant =\u003e \"WAR\".to_string(),\n            SecurityType::Bond =\u003e \"BOND\".to_string(),\n            SecurityType::Commodity =\u003e \"CMDTY\".to_string(),\n            SecurityType::News =\u003e \"NEWS\".to_string(),\n            SecurityType::MutualFund =\u003e \"FUND\".to_string(),\n        }\n    }\n}\n\nimpl SecurityType {\n    pub fn from(name: \u0026str) -\u003e SecurityType {\n        match name {\n            \"STK\" =\u003e SecurityType::Stock,\n            \"OPT\" =\u003e SecurityType::Option,\n            \"FUT\" =\u003e SecurityType::Future,\n            \"IND\" =\u003e SecurityType::Index,\n            \"FOP\" =\u003e SecurityType::FuturesOption,\n            \"CASH\" =\u003e SecurityType::ForexPair,\n            \"BAG\" =\u003e SecurityType::Spread,\n            \"WAR\" =\u003e SecurityType::Warrant,\n            \"BOND\" =\u003e SecurityType::Bond,\n            \"CMDTY\" =\u003e SecurityType::Commodity,\n            \"NEWS\" =\u003e SecurityType::News,\n            \"FUND\" =\u003e SecurityType::MutualFund,\n            \u0026_ =\u003e todo!(),\n        }\n    }\n}\n\n#[derive(Clone, Debug, Default)]\n/// Contract describes an instrument's definition\npub struct Contract {\n    /// The unique IB contract identifier.\n    pub contract_id: i32,\n    /// The underlying's asset symbol.\n    pub symbol: String,\n    pub security_type: SecurityType,\n    /// The contract's last trading day or contract month (for Options and Futures).\n    /// Strings with format YYYYMM will be interpreted as the Contract Month whereas YYYYMMDD will be interpreted as Last Trading Day.\n    pub last_trade_date_or_contract_month: String,\n    /// The option's strike price.\n    pub strike: f64,\n    /// Either Put or Call (i.e. Options). Valid values are P, PUT, C, CALL.\n    pub right: String,\n    /// The instrument's multiplier (i.e. options, futures).\n    pub multiplier: String,\n    /// The destination exchange.\n    pub exchange: String,\n    /// The underlying's currency.\n    pub currency: String,\n    /// The contract's symbol within its primary exchange For options, this will be the OCC symbol.\n    pub local_symbol: String,\n    /// The contract's primary exchange.\n    /// For smart routed contracts, used to define contract in case of ambiguity.\n    /// Should be defined as native exchange of contract, e.g. ISLAND for MSFT For exchanges which contain a period in name, will only be part of exchange name prior to period, i.e. ENEXT for ENEXT.BE.\n    pub primary_exchange: String,\n    /// The trading class name for this contract. Available in TWS contract description window as well. For example, GBL Dec '13 future's trading class is \"FGBL\".\n    pub trading_class: String,\n    /// If set to true, contract details requests and historical data queries can be performed pertaining to expired futures contracts. Expired options or other instrument types are not available.\n    pub include_expired: bool,\n    /// Security's identifier when querying contract's details or placing orders ISIN - Example: Apple: US0378331005 CUSIP - Example: Apple: 037833100.\n    pub security_id_type: String,\n    /// Identifier of the security type.\n    pub security_id: String,\n    /// Description of the combo legs.\n    pub combo_legs_description: String,\n    pub combo_legs: Vec\u003cComboLeg\u003e,\n    /// Delta and underlying price for Delta-Neutral combo orders. Underlying (STK or FUT), delta and underlying price goes into this attribute.\n    pub delta_neutral_contract: Option\u003cDeltaNeutralContract\u003e,\n\n    pub issuer_id: String,\n    pub description: String,\n}\n\nimpl Contract {\n    /// Creates stock contract from specified symbol\n    /// currency default to USD and SMART exchange.\n    pub fn stock(symbol: \u0026str) -\u003e Contract {\n        Contract {\n            symbol: symbol.to_string(),\n            security_type: SecurityType::Stock,\n            currency: \"USD\".to_string(),\n            exchange: \"SMART\".to_string(),\n            ..Default::default()\n        }\n    }\n\n    /// Creates futures contract from specified symbol\n    pub fn futures(symbol: \u0026str) -\u003e Contract {\n        Contract {\n            symbol: symbol.to_string(),\n            security_type: SecurityType::Future,\n            currency: \"USD\".to_string(),\n            ..Default::default()\n        }\n    }\n\n    /// Is Bag request\n    pub fn is_bag(\u0026self) -\u003e bool {\n        self.security_type == SecurityType::Spread\n    }\n\n    pub fn push_fields(\u0026self, message: \u0026mut RequestMessage) {\n        message.push_field(\u0026self.contract_id);\n        message.push_field(\u0026self.symbol);\n        message.push_field(\u0026self.security_type);\n        message.push_field(\u0026self.last_trade_date_or_contract_month);\n        message.push_field(\u0026self.strike);\n        message.push_field(\u0026self.right);\n        message.push_field(\u0026self.multiplier);\n        message.push_field(\u0026self.exchange);\n        message.push_field(\u0026self.primary_exchange);\n        message.push_field(\u0026self.currency);\n        message.push_field(\u0026self.local_symbol);\n        message.push_field(\u0026self.trading_class);\n        message.push_field(\u0026self.include_expired);\n    }\n}\n\n#[derive(Clone, Debug, Default)]\n// ComboLeg represents a leg within combo orders.\npub struct ComboLeg {\n    /// The Contract's IB's unique id.\n    pub contract_id: i32,\n    /// Select the relative number of contracts for the leg you are constructing. To help determine the ratio for a specific combination order, refer to the Interactive Analytics section of the User's Guide.\n    pub ratio: i32,\n    /// The side (buy or sell) of the leg:\n    pub action: String,\n    // The destination exchange to which the order will be routed.\n    pub exchange: String,\n    /// Specifies whether an order is an open or closing order.\n    /// For instituational customers to determine if this order is to open or close a position.\n    pub open_close: ComboLegOpenClose,\n    /// For stock legs when doing short selling. Set to 1 = clearing broker, 2 = third party.\n    pub short_sale_slot: i32,\n    /// When ShortSaleSlot is 2, this field shall contain the designated location.\n    pub designated_location: String,\n    // DOC_TODO.\n    pub exempt_code: i32,\n}\n\n#[derive(Clone, Copy, Debug, Default)]\n/// OpenClose specifies whether an order is an open or closing order.\npub enum ComboLegOpenClose {\n    /// 0 - Same as the parent security. This is the only option for retail customers.\n    #[default]\n    Same = 0,\n    /// 1 - Open. This value is only valid for institutional customers.\n    Open = 1,\n    /// 2 - Close. This value is only valid for institutional customers.\n    Close = 2,\n    /// 3 - Unknown.\n    Unknown = 3,\n}\n\nimpl ToField for ComboLegOpenClose {\n    fn to_field(\u0026self) -\u003e String {\n        (*self as u8).to_string()\n    }\n}\n\nimpl From\u003ci32\u003e for ComboLegOpenClose {\n    // TODO - verify these values\n    fn from(val: i32) -\u003e Self {\n        match val {\n            0 =\u003e Self::Same,\n            1 =\u003e Self::Open,\n            2 =\u003e Self::Close,\n            3 =\u003e Self::Unknown,\n            _ =\u003e panic!(\"unsupported value: {val}\"),\n        }\n    }\n}\n\n#[derive(Clone, Debug, Default, PartialEq)]\n/// Delta and underlying price for Delta-Neutral combo orders.\n/// Underlying (STK or FUT), delta and underlying price goes into this attribute.\npub struct DeltaNeutralContract {\n    /// The unique contract identifier specifying the security. Used for Delta-Neutral Combo contracts.\n    pub contract_id: i32,\n    /// The underlying stock or future delta. Used for Delta-Neutral Combo contracts.\n    pub delta: f64,\n    /// The price of the underlying. Used for Delta-Neutral Combo contracts.\n    pub price: f64,\n}\n\n/// ContractDetails provides extended contract details.\n#[derive(Debug, Default)]\npub struct ContractDetails {\n    /// A fully-defined Contract object.\n    pub contract: Contract,\n    /// The market name for this product.\n    pub market_name: String,\n    /// The minimum allowed price variation. Note that many securities vary their minimum tick size according to their price. This value will only show the smallest of the different minimum tick sizes regardless of the product's price. Full information about the minimum increment price structure can be obtained with the reqMarketRule function or the IB Contract and Security Search site.\n    pub min_tick: f64,\n    /// Allows execution and strike prices to be reported consistently with market data, historical data and the order price, i.e. Z on LIFFE is reported in Index points and not GBP. In TWS versions prior to 972, the price magnifier is used in defining future option strike prices (e.g. in the API the strike is specified in dollars, but in TWS it is specified in cents). In TWS versions 972 and higher, the price magnifier is not used in defining futures option strike prices so they are consistent in TWS and the API.\n    pub price_magnifier: i32,\n    /// Supported order types for this product.\n    pub order_types: String,\n    /// Valid exchange fields when placing an order for this contract.\n    /// The list of exchanges will is provided in the same order as the corresponding MarketRuleIds list.\n    pub valid_exchanges: String,\n    /// For derivatives, the contract ID (conID) of the underlying instrument.\n    pub under_contract_id: i32,\n    /// Descriptive name of the product.\n    pub long_name: String,\n    /// Typically the contract month of the underlying for a Future contract.\n    pub contract_month: String,\n    /// The industry classification of the underlying/product. For example, Financial.\n    pub industry: String,\n    /// The industry category of the underlying. For example, InvestmentSvc.\n    pub category: String,\n    /// The industry subcategory of the underlying. For example, Brokerage.\n    pub subcategory: String,\n    /// The time zone for the trading hours of the product. For example, EST.\n    pub time_zone_id: String,\n    /// The trading hours of the product. This value will contain the trading hours of the current day as well as the next's. For example, 20090507:0700-1830,1830-2330;20090508:CLOSED. In TWS versions 965+ there is an option in the Global Configuration API settings to return 1 month of trading hours. In TWS version 970+, the format includes the date of the closing time to clarify potential ambiguity, ex: 20180323:0400-20180323:2000;20180326:0400-20180326:2000 The trading hours will correspond to the hours for the product on the associated exchange. The same instrument can have different hours on different exchanges.\n    pub trading_hours: String,\n    /// The liquid hours of the product. This value will contain the liquid hours (regular trading hours) of the contract on the specified exchange. Format for TWS versions until 969: 20090507:0700-1830,1830-2330;20090508:CLOSED. In TWS versions 965+ there is an option in the Global Configuration API settings to return 1 month of trading hours. In TWS v970 and above, the format includes the date of the closing time to clarify potential ambiguity, e.g. 20180323:0930-20180323:1600;20180326:0930-20180326:1600.\n    pub liquid_hours: String,\n    /// Contains the Economic Value Rule name and the respective optional argument. The two values should be separated by a colon. For example, aussieBond:YearsToExpiration=3. When the optional argument is not present, the first value will be followed by a colon.\n    pub ev_rule: String,\n    /// Tells you approximately how much the market value of a contract would change if the price were to change by 1. It cannot be used to get market value by multiplying the price by the approximate multiplier.\n    pub ev_multiplier: f64,\n    /// Aggregated group Indicates the smart-routing group to which a contract belongs. contracts which cannot be smart-routed have aggGroup = -1.\n    pub agg_group: i32,\n    /// A list of contract identifiers that the customer is allowed to view. CUSIP/ISIN/etc. For US stocks, receiving the ISIN requires the CUSIP market data subscription. For Bonds, the CUSIP or ISIN is input directly into the symbol field of the Contract class.\n    pub sec_id_list: Vec\u003cTagValue\u003e,\n    /// For derivatives, the symbol of the underlying contract.\n    pub under_symbol: String,\n    /// For derivatives, returns the underlying security type.\n    pub under_security_type: String,\n    /// The list of market rule IDs separated by comma Market rule IDs can be used to determine the minimum price increment at a given price.\n    pub market_rule_ids: String,\n    /// Real expiration date. Requires TWS 968+ and API v973.04+. Python API specifically requires API v973.06+.\n    pub real_expiration_date: String,\n    /// Last trade time.\n    pub last_trade_time: String,\n    /// Stock type.\n    pub stock_type: String,\n    /// The nine-character bond CUSIP. For Bonds only. Receiving CUSIPs requires a CUSIP market data subscription.\n    pub cusip: String,\n    /// Identifies the credit rating of the issuer. This field is not currently available from the TWS API. For Bonds only. A higher credit rating generally indicates a less risky investment. Bond ratings are from Moody's and S\u0026P respectively. Not currently implemented due to bond market data restrictions.\n    pub ratings: String,\n    /// A description string containing further descriptive information about the bond. For Bonds only.\n    pub desc_append: String,\n    /// The type of bond, such as \"CORP.\".\n    pub bond_type: String,\n    /// The type of bond coupon. This field is currently not available from the TWS API. For Bonds only.\n    pub coupon_type: String,\n    /// If true, the bond can be called by the issuer under certain conditions. This field is currently not available from the TWS API. For Bonds only.\n    pub callable: bool,\n    /// Values are True or False. If true, the bond can be sold back to the issuer under certain conditions. This field is currently not available from the TWS API. For Bonds only.\n    pub putable: bool,\n    /// The interest rate used to calculate the amount you will receive in interest payments over the course of the year. This field is currently not available from the TWS API. For Bonds only.\n    pub coupon: f64,\n    /// Values are True or False. If true, the bond can be converted to stock under certain conditions. This field is currently not available from the TWS API. For Bonds only.\n    pub convertible: bool,\n    /// The date on which the issuer must repay the face value of the bond. This field is currently not available from the TWS API. For Bonds only. Not currently implemented due to bond market data restrictions.\n    pub maturity: String,\n    /// The date the bond was issued. This field is currently not available from the TWS API. For Bonds only. Not currently implemented due to bond market data restrictions.\n    pub issue_date: String,\n    /// Only if bond has embedded options. This field is currently not available from the TWS API. Refers to callable bonds and puttable bonds. Available in TWS description window for bonds.\n    pub next_option_date: String,\n    /// Type of embedded option. This field is currently not available from the TWS API. Only if bond has embedded options.\n    pub next_option_type: String,\n    /// Only if bond has embedded options. This field is currently not available from the TWS API. For Bonds only.\n    pub next_option_partial: bool,\n    /// If populated for the bond in IB's database. For Bonds only.\n    pub notes: String,\n    /// Order's minimal size.\n    pub min_size: f64,\n    /// Order's size increment.\n    pub size_increment: f64,\n    /// Order's suggested size increment.\n    pub suggested_size_increment: f64,\n}\n\n/// TagValue is a convenience struct to define key-value pairs.\n#[derive(Clone, Debug)]\npub struct TagValue {\n    pub tag: String,\n    pub value: String,\n}\n\nimpl ToField for Vec\u003cTagValue\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        let mut values = Vec::new();\n        for tag_value in self {\n            values.push(format!(\"{}={};\", tag_value.tag, tag_value.value))\n        }\n        values.concat()\n    }\n}\n\n// API\n\n/// Requests contract information.\n///\n/// Provides all the contracts matching the contract provided. It can also be used to retrieve complete options and futures chains. Though it is now (in API version \u003e 9.72.12) advised to use reqSecDefOptParams for that purpose.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::Client;\n/// use ibapi::contracts::{self, Contract};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let contract = Contract::stock(\"TSLA\");\n///     let results = contracts::contract_details(\u0026mut client, \u0026contract)?;\n///\n///     for contract_detail in \u0026results {\n///         println!(\"contract: {:?}\", contract_detail);\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn contract_details(client: \u0026mut Client, contract: \u0026Contract) -\u003e Result\u003cVec\u003cContractDetails\u003e\u003e {\n    verify_contract(client, contract)?;\n\n    let request_id = client.next_request_id();\n    let packet = encoders::request_contract_data(client.server_version(), request_id, contract)?;\n\n    let responses = client.send_request(request_id, packet)?;\n\n    let mut contract_details: Vec\u003cContractDetails\u003e = Vec::default();\n\n    // TODO create iterator\n    for mut message in responses {\n        match message.message_type() {\n            IncomingMessages::ContractData =\u003e {\n                let decoded = decoders::contract_details(client.server_version(), \u0026mut message)?;\n                contract_details.push(decoded);\n            }\n            IncomingMessages::ContractDataEnd =\u003e {\n                break;\n            }\n            IncomingMessages::Error =\u003e {\n                error!(\"error: {:?}\", message);\n                return Err(anyhow!(\"contract_details {:?}\", message));\n            }\n            _ =\u003e {\n                error!(\"unexpected message: {:?}\", message);\n            }\n        }\n    }\n\n    Ok(contract_details)\n}\n\nfn verify_contract(client: \u0026mut Client, contract: \u0026Contract) -\u003e Result\u003c()\u003e {\n    if !contract.security_id_type.is_empty() || !contract.security_id.is_empty() {\n        client.check_server_version(\n            server_versions::SEC_ID_TYPE,\n            \"It does not support security_id_type or security_id attributes\",\n        )?\n    }\n\n    if !contract.trading_class.is_empty() {\n        client.check_server_version(\n            server_versions::TRADING_CLASS,\n            \"It does not support the trading_class parameter when requesting contract details.\",\n        )?\n    }\n\n    if !contract.primary_exchange.is_empty() {\n        client.check_server_version(\n            server_versions::LINKING,\n            \"It does not support primary_exchange parameter when requesting contract details.\",\n        )?\n    }\n\n    if !contract.issuer_id.is_empty() {\n        client.check_server_version(\n            server_versions::BOND_ISSUERID,\n            \"It does not support issuer_id parameter when requesting contract details.\",\n        )?\n    }\n\n    Ok(())\n}\n\n/// Contract data and list of derivative security types\n#[derive(Debug)]\npub struct ContractDescription {\n    pub contract: Contract,\n    pub derivative_security_types: Vec\u003cString\u003e,\n}\n\n/// Requests matching stock symbols.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `pattern` - Either start of ticker symbol or (for larger strings) company name.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::Client;\n/// use ibapi::contracts;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let contracts = contracts::matching_symbols(\u0026mut client, \"IB\")?;\n///\n///     for contract in \u0026contracts {\n///         println!(\"contract: {:?}\", contract);\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn matching_symbols(client: \u0026mut Client, pattern: \u0026str) -\u003e Result\u003cVec\u003cContractDescription\u003e\u003e {\n    client.check_server_version(server_versions::REQ_MATCHING_SYMBOLS, \"It does not support mathing symbols requests.\")?;\n\n    let request_id = client.next_request_id();\n    let request = encoders::request_matching_symbols(request_id, pattern)?;\n\n    let mut responses = client.send_request(request_id, request)?;\n\n    if let Some(mut message) = responses.next() {\n        match message.message_type() {\n            IncomingMessages::SymbolSamples =\u003e {\n                return decoders::contract_descriptions(client.server_version(), \u0026mut message);\n            }\n            IncomingMessages::Error =\u003e {\n                error!(\"unexpected error: {:?}\", message);\n                return Err(anyhow!(\"unexpected error: {:?}\", message));\n            }\n            _ =\u003e {\n                info!(\"unexpected message: {:?}\", message);\n                return Err(anyhow!(\"unexpected message: {:?}\", message));\n            }\n        }\n    }\n\n    Ok(Vec::default())\n}\n\n#[derive(Debug, Default)]\npub struct MarketRule {\n    pub market_rule_id: i32,\n    pub price_increments: Vec\u003cPriceIncrement\u003e,\n}\n\n#[derive(Debug, Default)]\npub struct PriceIncrement {\n    pub low_edge: f64,\n    pub increment: f64,\n}\n\n/// Requests details about a given market rule\n///\n/// The market rule for an instrument on a particular exchange provides details about how the minimum price increment changes with price.\n/// A list of market rule ids can be obtained by invoking [request_contract_details] on a particular contract. The returned market rule ID list will provide the market rule ID for the instrument in the correspond valid exchange list in [ContractDetails].\npub fn market_rule(client: \u0026mut Client, market_rule_id: i32) -\u003e Result\u003cMarketRule\u003e {\n    client.check_server_version(server_versions::MARKET_RULES, \"It does not support market rule requests.\")?;\n\n    let request = encoders::request_market_rule(market_rule_id)?;\n\n    let mut responses = client.request_market_rule(request)?;\n\n    match responses.next() {\n        Some(mut message) =\u003e Ok(decoders::market_rule(\u0026mut message)?),\n        None =\u003e Err(anyhow!(\"no market rule found\")),\n    }\n}\n","traces":[{"line":54,"address":[],"length":0,"stats":{"Line":23},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":23},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":23},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":23},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":190,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":232,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":238,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":239,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":240,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":242,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":361,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":362,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":366,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":403,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":405,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":407,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":411,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":412,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":414,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":417,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":420,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":424,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":429,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":432,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":433,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":435,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":441,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":447,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":454,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":455,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":461,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":496,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":498,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":499,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":504,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":506,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":509,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":510,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":513,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":514,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":519,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":539,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":541,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":543,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":545,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":546,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":547,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":63,"coverable":116},{"path":["/","Users","wboayue","projects","rust-ibapi","src","domain.rs"],"content":"pub struct DepthMktDataDescription {\n    pub exchange: String,\n    pub sec_type: String,\n    pub listing_exch: String,\n    pub service_data_type: String,\n    pub agg_group: i32,\n}\n\npub struct SmartComponent {\n    pub bit_number: i32,\n    pub exchange: String,\n    pub exchange_letter: String,\n}\n\npub struct TickAttrib {\n    pub can_auto_execute: bool,\n    pub past_limit: bool,\n    pub pre_open: bool,\n}\n\npub struct TickAttribBidAsk {\n    pub bid_past_low: bool,\n    pub ask_past_high: bool,\n}\n\npub struct TickAttribLast {\n    pub past_limit: bool,\n    pub unreported: bool,\n}\n\npub struct FamilyCode {\n    pub account_id: String,\n    pub family_code_str: String,\n}\n\n#[derive(Clone, Debug)]\npub struct NewsProvider {\n    pub code: String,\n    pub name: String,\n}\n\npub enum ComboParam {\n    NonGuaranteed,\n    PriceCondConid,\n    CondPriceMax,\n    CondPriceMin,\n    ChangeToMktTime1,\n    ChangeToMktTime2,\n    DiscretionaryPct,\n    DontLeginNext,\n    LeginPrio,\n    MaxSegSize,\n}\n\npub enum HedgeType {\n    None,\n    Delta,\n    Beta,\n    Fx,\n    Pair,\n}\n\npub enum Right {\n    None,\n    Put,\n    Call,\n}\n\npub enum VolatilityType {\n    None,\n    Daily,\n    Annual,\n}\n\npub enum ReferencePriceType {\n    None,\n    Midpoint,\n    BidOrAsk,\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","lib.rs"],"content":"//! [![github]](https://github.com/wboayue/rust-ibapi)\u0026ensp;[![crates-io]](https://crates.io/crates/ibapi)\n//!\n//! [github]: https://img.shields.io/badge/github-8da0cb?style=for-the-badge\u0026labelColor=555555\u0026logo=github\n//! [crates-io]: https://img.shields.io/badge/crates.io-fc8d62?style=for-the-badge\u0026labelColor=555555\u0026logo=rust\n//!\n//! \u003cbr\u003e\n//!\n//! A wrapper around the procedural macro API of the compiler's [`proc_macro`]\n//! crate. This library serves two purposes:\n//!\n//! [`proc_macro`]: https://doc.rust-lang.org/proc_macro/\n//! Fast and easy queue abstraction.\n//!```no_run\n//!     use anyhow;\n//!     use ibapi::client::Client;     \n//!     \n//!     fn main() -\u003e anyhow::Result\u003c()\u003e {\n//!         let client = Client::connect(\"localhost:4002:100\")?;\n//!         println!(\"Client: {:?}\", client);\n//!         Ok(())\n//!     }\n//!```\n/// TSW API Client.\npub mod client;\n\n/// Describes primary data structures used by the model.\npub mod domain;\n\n/// A [Contract] object represents trading instruments such as a stocks, futures or options.\n///\n/// Every time a new request that requires a contract (i.e. market data, order placing, etc.) is sent to the API, the system will try to match the provided contract object with a single candidate. If there is more than one contract matching the same description, the API will return an error notifying you there is an ambiguity. In these cases the API needs further information to narrow down the list of contracts matching the provided description to a single element.\npub mod contracts;\n\npub mod market_data;\n\n/// News\npub mod news;\n\n/// APIs for placing orders\npub mod orders;\n\n/// APIs for requesting account information\npub mod accounts;\n\nmod constants;\nmod messages;\nmod server_versions;\n\npub(crate) mod stubs;\n\n// TODO make public to crate only\npub trait ToField {\n    fn to_field(\u0026self) -\u003e String;\n}\n\nimpl ToField for bool {\n    fn to_field(\u0026self) -\u003e String {\n        if *self {\n            String::from(\"1\")\n        } else {\n            String::from(\"0\")\n        }\n    }\n}\n\nimpl ToField for String {\n    fn to_field(\u0026self) -\u003e String {\n        self.clone()\n    }\n}\n\nimpl ToField for \u0026str {\n    fn to_field(\u0026self) -\u003e String {\n        \u003c\u0026str\u003e::clone(self).to_string()\n    }\n}\n\nimpl ToField for usize {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for i32 {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003ci32\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl ToField for f64 {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003cf64\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nfn encode_option_field\u003cT: ToField\u003e(val: \u0026Option\u003cT\u003e) -\u003e String {\n    match val {\n        Some(val) =\u003e val.to_field(),\n        None =\u003e String::from(\"\"),\n    }\n}\n","traces":[{"line":57,"address":[],"length":0,"stats":{"Line":77},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":77},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":11},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":66},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":198},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":198},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":82},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":82},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":30},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":30},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":20},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":20},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":62},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":62},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":109},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":109},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":19},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":90},"fn_name":null}],"covered":22,"coverable":22},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","historical","tests.rs"],"content":"use crate::stubs::MessageBusStub;\n\nuse super::*;\n\n#[test]\nfn test_head_timestamp() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    // client.response_packets = VecDeque::from([ResponseMessage::from(\"10\\x0000\\x00cc\")]);\n\n    let contract = Contract::stock(\"MSFT\");\n    let what_to_show = \"trades\";\n    let use_rth = true;\n\n    let result = super::head_timestamp(\u0026mut client, \u0026contract, what_to_show, use_rth);\n\n    // match result {\n    //     Err(error) =\u003e assert_eq!(error.to_string(), \"\"),\n    //     Ok(head_timestamp) =\u003e assert_eq!(head_timestamp, OffsetDateTime::now_utc()),\n    // };\n\n    // assert_eq!(client.request_packets.len(), 1);\n\n    // let packet = \u0026client.request_packets[0];\n\n    // assert_eq!(packet[0], \"hh\");\n    // assert_eq!(packet[1], \"hh\");\n}\n\n#[test]\nfn histogram_data() {\n    let result = 2 + 2;\n    assert_eq!(result, 4);\n}\n\n#[test]\nfn historical_data() {\n    let result = 2 + 2;\n    assert_eq!(result, 4);\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","historical.rs"],"content":"use std::fmt::Debug;\n\nuse anyhow::{anyhow, Result};\nuse time::OffsetDateTime;\n\nuse crate::client::{Client, RequestMessage, ResponseMessage};\nuse crate::contracts::Contract;\nuse crate::domain::TickAttribBidAsk;\nuse crate::server_versions;\n\n// https://github.com/InteractiveBrokers/tws-api/blob/master/source/csharpclient/client/EClient.cs\n// https://github.com/InteractiveBrokers/tws-api/blob/master/source/csharpclient/client/EDecoder.cs#L733\n\n/// Returns the timestamp of earliest available historical data for a contract and data type.\n/// ```no_run\n///     use anyhow::Result;\n///     use ibapi::client::Client;\n///     use ibapi::contracts::{self, Contract};\n///     use ibapi::market_data::historical;\n///\n///     fn main() -\u003e Result\u003c()\u003e {\n///         let mut client = Client::connect(\"localhost:4002\")?;\n///\n///         let contract = Contract::stock(\"MSFT\");\n///         let what_to_show = \"trades\";\n///         let use_rth = true;\n///\n///         let result =\n///             historical::head_timestamp(\u0026mut client, \u0026contract, what_to_show, use_rth);\n///\n///         print!(\"head_timestamp: {result:?}\");\n///         Ok(())\n///     }\n/// ```\npub fn head_timestamp(client: \u0026mut Client, contract: \u0026Contract, what_to_show: \u0026str, use_rth: bool) -\u003e Result\u003cOffsetDateTime\u003e {\n    client.check_server_version(server_versions::REQ_HEAD_TIMESTAMP, \"It does not support head time stamp requests.\")?;\n\n    let request_id = client.next_request_id();\n    let request = encode_head_timestamp(request_id, contract, what_to_show, use_rth)?;\n\n    let mut promise = client.send_request(request_id, request)?;\n\n    if let Some(mut response) = promise.next() {\n        decode_head_timestamp(\u0026mut response)\n    } else {\n        Err(anyhow!(\"did not receive head timestamp message\"))\n    }\n}\n\n/// Encodes the head timestamp request\npub fn encode_head_timestamp(request_id: i32, contract: \u0026Contract, what_to_show: \u0026str, use_rth: bool) -\u003e Result\u003cRequestMessage\u003e {\n    let mut packet = RequestMessage::default();\n\n    packet.push_field(\u002612);\n    packet.push_field(\u0026request_id);\n    contract.push_fields(\u0026mut packet);\n    packet.push_field(\u0026use_rth);\n    packet.push_field(\u0026what_to_show);\n    packet.push_field(\u0026\"format_date\");\n\n    // source.AddParameter(value.ConId);\n    // source.AddParameter(value.Symbol);\n    // source.AddParameter(value.SecType);\n    // source.AddParameter(value.LastTradeDateOrContractMonth);\n    // source.AddParameter(value.Strike);\n    // source.AddParameter(value.Right);\n    // source.AddParameter(value.Multiplier);\n    // source.AddParameter(value.Exchange);\n    // source.AddParameter(value.PrimaryExch);\n    // source.AddParameter(value.Currency);\n    // source.AddParameter(value.LocalSymbol);\n    // source.AddParameter(value.TradingClass);\n    // source.AddParameter(value.IncludeExpired);\n\n    Ok(packet)\n}\n\n// https://github.com/InteractiveBrokers/tws-api/blob/313c453bfc1a1f8928b0d2fba044947f4c37e380/source/csharpclient/client/IBParamsList.cs#L56\n\n// public static void AddParameter(this BinaryWriter source, Contract value)\n// {\n//     source.AddParameter(value.ConId);\n//     source.AddParameter(value.Symbol);\n//     source.AddParameter(value.SecType);\n//     source.AddParameter(value.LastTradeDateOrContractMonth);\n//     source.AddParameter(value.Strike);\n//     source.AddParameter(value.Right);\n//     source.AddParameter(value.Multiplier);\n//     source.AddParameter(value.Exchange);\n//     source.AddParameter(value.PrimaryExch);\n//     source.AddParameter(value.Currency);\n//     source.AddParameter(value.LocalSymbol);\n//     source.AddParameter(value.TradingClass);\n//     source.AddParameter(value.IncludeExpired);\n// }\n\nfn decode_head_timestamp(packet: \u0026mut ResponseMessage) -\u003e Result\u003cOffsetDateTime\u003e {\n    let _request_id = packet.next_int()?;\n    let head_timestamp = packet.next_date_time()?;\n\n    Ok(head_timestamp)\n}\n\n/// Returns data histogram of specified contract\npub fn histogram_data(client: \u0026Client, contract: \u0026Contract, use_rth: bool, period: \u0026str) -\u003e Result\u003cHistogramDataIterator\u003e {\n    // \" S (seconds) - \" D (days)\n    // \" W (weeks) - \" M (months)\n    // \" Y (years)\n    print!(\"{client:?} {contract:?} {use_rth:?} {period:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\n#[allow(clippy::too_many_arguments)]\npub fn historical_data(\n    client: \u0026Client,\n    contract: \u0026Contract,\n    end: \u0026OffsetDateTime,\n    duration: \u0026str,\n    bar_size: \u0026str,\n    what_to_show: \u0026str,\n    use_rth: bool,\n    keep_up_to_date: bool,\n) -\u003e Result\u003cBarIterator\u003e {\n    // https://interactivebrokers.github.io/tws-api/historical_bars.html#hd_duration\n    // https://interactivebrokers.github.io/tws-api/historical_bars.html#hd_barsize\n    // https://interactivebrokers.github.io/tws-api/historical_bars.html#hd_what_to_show\n    print!(\"{client:?} {contract:?} {end:?} {duration:?} {bar_size:?} {what_to_show:?} {use_rth:?} {keep_up_to_date:?}\");\n\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub fn historical_schedule(client: \u0026Client, contract: \u0026Contract, use_rth: bool, period: \u0026str) -\u003e Result\u003cHistogramDataIterator\u003e {\n    print!(\"{client:?} {contract:?} {use_rth:?} {period:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub fn historical_ticks(\n    client: \u0026Client,\n    contract: \u0026Contract,\n    start_date: Option\u003cOffsetDateTime\u003e,\n    end_date: Option\u003cOffsetDateTime\u003e,\n    number_of_ticks: i32,\n    use_rth: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cHistoricalTickIterator\u003e {\n    print!(\"{client:?} {contract:?} {start_date:?} {end_date:?} {number_of_ticks:?} {use_rth:?} {ignore_size:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub fn historical_ticks_bid_ask(\n    client: \u0026Client,\n    contract: \u0026Contract,\n    start_date: Option\u003cOffsetDateTime\u003e,\n    end_date: Option\u003cOffsetDateTime\u003e,\n    number_of_ticks: i32,\n    use_rth: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cHistoricalTickBidAskIterator\u003e {\n    print!(\"{client:?} {contract:?} {start_date:?} {end_date:?} {number_of_ticks:?} {use_rth:?} {ignore_size:?}\");\n\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub fn historical_ticks_last(\n    client: \u0026Client,\n    contract: \u0026Contract,\n    start_date: Option\u003cOffsetDateTime\u003e,\n    end_date: Option\u003cOffsetDateTime\u003e,\n    number_of_ticks: i32,\n    use_rth: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cHistoricalTickLastIterator\u003e {\n    print!(\"{client:?} {contract:?} {start_date:?} {end_date:?} {number_of_ticks:?} {use_rth:?} {ignore_size:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\npub struct HistoricalTick {\n    pub time: i32,\n    pub price: f64,\n    pub size: i32,\n}\n\npub struct HistoricalTickBidAsk {\n    pub time: i32,\n    pub tick_attrib_bid_ask: TickAttribBidAsk,\n    pub price_bid: f64,\n    pub price_ask: f64,\n    pub size_bid: i32,\n    pub size_ask: i32,\n}\n\npub struct HistoricalTickLast {\n    pub time: i32,\n    pub price: f64,\n    pub size: i32,\n}\n\n#[derive(Default)]\npub struct HistoricalTickIterator {}\n\nimpl HistoricalTickIterator {\n    pub fn new() -\u003e HistoricalTickIterator {\n        HistoricalTickIterator {}\n    }\n}\n\nimpl Iterator for HistoricalTickIterator {\n    // we will be counting with usize\n    type Item = HistoricalTick;\n\n    // next() is the only required method\n    fn next(\u0026mut self) -\u003e Option\u003cHistoricalTick\u003e {\n        None\n    }\n}\n\npub struct HistoricalTickBidAskIterator {}\n\npub struct HistoricalTickLastIterator {}\n\npub struct HistogramData {}\npub struct HistogramDataIterator {}\n\npub struct Bar {\n    pub time: OffsetDateTime,\n    pub open: f64,\n    pub high: f64,\n    pub low: f64,\n    pub close: f64,\n    pub volume: f64,\n    pub wap: f64,\n    pub count: i32,\n}\n\npub struct BarIterator {}\n// https://interactivebrokers.github.io/tws-api/classIBApi_1_1Bar.html\n\npub struct HistoricalSchedule {\n    //    string startDateTime, string endDateTime, string timeZone, HistoricalSession[]\n}\n\n#[cfg(test)]\nmod tests;\n","traces":[{"line":36,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":212,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":213,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":32,"coverable":60},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","realtime","decoders.rs"],"content":"use anyhow::{self, Result};\nuse time::OffsetDateTime;\n\nuse crate::{\n    client::ResponseMessage,\n    market_data::{BidAsk, BidAskAttribute, MidPoint, RealTimeBar, Trade, TradeAttribute},\n};\n\npub fn decode_realtime_bar(message: \u0026mut ResponseMessage) -\u003e Result\u003cRealTimeBar\u003e {\n    message.skip(); // message type\n    message.skip(); // message version\n    message.skip(); // message request id\n\n    let date = message.next_long()?; // long, convert to date\n    let date = OffsetDateTime::from_unix_timestamp(date).unwrap();\n\n    Ok(RealTimeBar {\n        date,\n        open: message.next_double()?,\n        high: message.next_double()?,\n        low: message.next_double()?,\n        close: message.next_double()?,\n        volume: message.next_double()?,\n        wap: message.next_double()?,\n        count: message.next_int()?,\n    })\n}\n\npub fn trade_tick(message: \u0026mut ResponseMessage) -\u003e Result\u003cTrade\u003e {\n    message.skip(); // message type\n    message.skip(); // message request id\n\n    let tick_type = message.next_int()?;\n    if !(tick_type == 1 || tick_type == 2) {\n        return Err(anyhow::anyhow!(\"Unexpected tick_type: {tick_type}\"));\n    }\n\n    let date = message.next_long()?; // long, convert to date\n    let date = OffsetDateTime::from_unix_timestamp(date).unwrap();\n    let price = message.next_double()?;\n    let size = message.next_long()?;\n    let mask = message.next_int()?;\n    let exchange = message.next_string()?;\n    let special_conditions = message.next_string()?;\n\n    Ok(Trade {\n        tick_type: tick_type.to_string(),\n        time: date,\n        price,\n        size,\n        trade_attribute: TradeAttribute {\n            past_limit: mask \u0026 0x1 != 0,\n            unreported: mask \u0026 0x2 != 0,\n        },\n        exchange,\n        special_conditions,\n    })\n}\n\npub fn bid_ask_tick(message: \u0026mut ResponseMessage) -\u003e Result\u003cBidAsk\u003e {\n    message.skip(); // message type\n    message.skip(); // message request id\n\n    let tick_type = message.next_int()?;\n    if tick_type != 3 {\n        return Err(anyhow::anyhow!(\"Unexpected tick_type: {tick_type}\"));\n    }\n\n    let date = message.next_long()?; // long, convert to date\n    let date = OffsetDateTime::from_unix_timestamp(date).unwrap();\n    let bid_price = message.next_double()?;\n    let ask_price = message.next_double()?;\n    let bid_size = message.next_long()?;\n    let ask_size = message.next_long()?;\n    let mask = message.next_int()?;\n\n    Ok(BidAsk {\n        time: date,\n        bid_price,\n        ask_price,\n        bid_size,\n        ask_size,\n        bid_ask_attribute: BidAskAttribute {\n            bid_past_low: mask \u0026 0x1 != 0,\n            ask_past_high: mask \u0026 0x2 != 0,\n        },\n    })\n}\n\npub fn mid_point_tick(message: \u0026mut ResponseMessage) -\u003e Result\u003cMidPoint\u003e {\n    message.skip(); // message type\n    message.skip(); // message request id\n\n    let tick_type = message.next_int()?;\n    if tick_type != 4 {\n        return Err(anyhow::anyhow!(\"Unexpected tick_type: {tick_type}\"));\n    }\n\n    let date = message.next_long()?; // long, convert to date\n    let date = OffsetDateTime::from_unix_timestamp(date).unwrap();\n\n    let mid_point = message.next_double()?;\n\n    Ok(MidPoint { time: date, mid_point })\n}\n\nmod tests {\n    use super::*;\n\n    #[test]\n    fn decode_trade() {\n        let mut message = ResponseMessage::from(\"99\\09000\\01\\01678740829\\03895.25\\07\\02\\0\\0\\0\");\n\n        let results = trade_tick(\u0026mut message);\n\n        if let Ok(trade) = results {\n            assert_eq!(trade.tick_type, \"1\", \"trade.tick_type\");\n            assert_eq!(trade.time, OffsetDateTime::from_unix_timestamp(1678740829).unwrap(), \"trade.time\");\n            assert_eq!(trade.price, 3895.25, \"trade.price\");\n            assert_eq!(trade.size, 7, \"trade.size\");\n            assert_eq!(trade.trade_attribute.past_limit, false, \"trade.trade_attribute.past_limit\");\n            assert_eq!(trade.trade_attribute.unreported, true, \"trade.trade_attribute.unreported\");\n            assert_eq!(trade.exchange, \"\", \"trade.exchange\");\n            assert_eq!(trade.special_conditions, \"\", \"trade.special_conditions\");\n        } else if let Err(err) = results {\n            assert!(false, \"error decoding trade tick: {err}\");\n        }\n    }\n\n    #[test]\n    fn decode_bid_ask() {\n        let mut message = ResponseMessage::from(\"99\\09000\\03\\01678745793\\03895.50\\03896.00\\09\\011\\01\\0\");\n\n        let results = bid_ask_tick(\u0026mut message);\n\n        if let Ok(bid_ask) = results {\n            assert_eq!(bid_ask.time, OffsetDateTime::from_unix_timestamp(01678745793).unwrap(), \"bid_ask.time\");\n            assert_eq!(bid_ask.bid_price, 3895.5, \"bid_ask.bid_price\");\n            assert_eq!(bid_ask.ask_price, 3896.0, \"bid_ask.ask_price\");\n            assert_eq!(bid_ask.bid_size, 9, \"bid_ask.bid_size\");\n            assert_eq!(bid_ask.ask_size, 11, \"bid_ask.ask_size\");\n            assert_eq!(bid_ask.bid_ask_attribute.bid_past_low, true, \"bid_ask.bid_ask_attribute.bid_past_low\");\n            assert_eq!(bid_ask.bid_ask_attribute.ask_past_high, false, \"bid_ask.bid_ask_attribute.ask_past_high\");\n        } else if let Err(err) = results {\n            assert!(false, \"error decoding trade tick: {err}\");\n        }\n    }\n\n    #[test]\n    fn decode_mid_point() {\n        let mut message = ResponseMessage::from(\"99\\09000\\04\\01678746113\\03896.875\\0\");\n\n        let results = mid_point_tick(\u0026mut message);\n\n        if let Ok(mid_point) = results {\n            assert_eq!(mid_point.time, OffsetDateTime::from_unix_timestamp(1678746113).unwrap(), \"mid_point.time\");\n            assert_eq!(mid_point.mid_point, 3896.875, \"mid_point.mid_point\");\n        } else if let Err(err) = results {\n            assert!(false, \"error decoding mid point tick: {err}\");\n        }\n    }\n}\n","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":12,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":67,"coverable":70},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","realtime","encoders.rs"],"content":"use anyhow::Result;\n\nuse super::{BarSize, WhatToShow};\nuse crate::client::RequestMessage;\nuse crate::contracts::Contract;\nuse crate::messages::OutgoingMessages;\nuse crate::orders::TagValue;\nuse crate::server_versions;\n\npub fn encode_request_realtime_bars(\n    server_version: i32,\n    ticker_id: i32,\n    contract: \u0026Contract,\n    bar_size: \u0026BarSize,\n    what_to_show: \u0026WhatToShow,\n    use_rth: bool,\n    options: Vec\u003cTagValue\u003e,\n) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 8;\n\n    let mut packet = RequestMessage::default();\n\n    packet.push_field(\u0026OutgoingMessages::RequestRealTimeBars);\n    packet.push_field(\u0026VERSION);\n    packet.push_field(\u0026ticker_id);\n\n    if server_version \u003e= server_versions::TRADING_CLASS {\n        packet.push_field(\u0026contract.contract_id);\n    }\n\n    packet.push_field(\u0026contract.symbol);\n    packet.push_field(\u0026contract.security_type);\n    packet.push_field(\u0026contract.last_trade_date_or_contract_month);\n    packet.push_field(\u0026contract.strike);\n    packet.push_field(\u0026contract.right);\n    packet.push_field(\u0026contract.multiplier);\n    packet.push_field(\u0026contract.exchange);\n    packet.push_field(\u0026contract.primary_exchange);\n    packet.push_field(\u0026contract.currency);\n    packet.push_field(\u0026contract.local_symbol);\n\n    if server_version \u003e= server_versions::TRADING_CLASS {\n        packet.push_field(\u0026contract.trading_class);\n    }\n\n    packet.push_field(\u00260); // bar size -- not used\n    packet.push_field(\u0026what_to_show.to_string());\n    packet.push_field(\u0026use_rth);\n\n    if server_version \u003e= server_versions::LINKING {\n        packet.push_field(\u0026options);\n    }\n\n    Ok(packet)\n}\n\npub fn cancel_realtime_bars(request_id: i32) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::CancelRealTimeBars);\n    message.push_field(\u0026VERSION);\n    message.push_field(\u0026request_id);\n\n    Ok(message)\n}\n\npub fn tick_by_tick(\n    server_version: i32,\n    request_id: i32,\n    contract: \u0026Contract,\n    tick_type: \u0026str,\n    number_of_ticks: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::ReqTickByTickData);\n    message.push_field(\u0026request_id);\n    message.push_field(\u0026contract.contract_id);\n    message.push_field(\u0026contract.symbol);\n    message.push_field(\u0026contract.security_type);\n    message.push_field(\u0026contract.last_trade_date_or_contract_month);\n    message.push_field(\u0026contract.strike);\n    message.push_field(\u0026contract.right);\n    message.push_field(\u0026contract.multiplier);\n    message.push_field(\u0026contract.exchange);\n    message.push_field(\u0026contract.primary_exchange);\n    message.push_field(\u0026contract.currency);\n    message.push_field(\u0026contract.local_symbol);\n    message.push_field(\u0026contract.trading_class);\n    message.push_field(\u0026tick_type);\n\n    if server_version \u003e= server_versions::TICK_BY_TICK_IGNORE_SIZE {\n        message.push_field(\u0026number_of_ticks);\n        message.push_field(\u0026ignore_size);\n    }\n\n    Ok(message)\n}\n\npub fn cancel_tick_by_tick(request_id: i32) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::CancelTickByTickData);\n    message.push_field(\u0026request_id);\n\n    Ok(message)\n}\n\n#[cfg(test)]\nmod tests {\n    use crate::{contracts::contract_samples, ToField};\n\n    use super::*;\n\n    #[test]\n    fn cancel_tick_by_tick() {\n        let request_id = 9000;\n\n        let results = super::cancel_tick_by_tick(request_id);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message[0], \"98\", \"message.type\");\n                assert_eq!(message[1], request_id.to_string(), \"message.request_id\");\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding cancel_tick_by_tick request: {err}\");\n            }\n        }\n    }\n\n    #[test]\n    fn cancel_realtime_bars() {\n        let request_id = 9000;\n\n        let results = super::cancel_realtime_bars(request_id);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message[0], OutgoingMessages::CancelRealTimeBars.to_field(), \"message.type\");\n                assert_eq!(message[1], \"1\", \"message.version\");\n                assert_eq!(message[2], request_id.to_string(), \"message.request_id\");\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding cancel_tick_by_tick request: {err}\");\n            }\n        }\n    }\n\n    #[test]\n    fn tick_by_tick() {\n        let request_id = 9000;\n        let server_version = server_versions::TICK_BY_TICK;\n        let contract = contract_samples::simple_future();\n        let tick_type = \"AllLast\";\n        let number_of_ticks = 1;\n        let ignore_size = true;\n\n        let results = super::tick_by_tick(server_version, request_id, \u0026contract, tick_type, number_of_ticks, ignore_size);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message[0], OutgoingMessages::ReqTickByTickData.to_field(), \"message.type\");\n                assert_eq!(message[1], request_id.to_field(), \"message.request_id\");\n                assert_eq!(message[2], contract.contract_id.to_field(), \"message.contract_id\");\n                assert_eq!(message[3], contract.symbol, \"message.symbol\");\n                assert_eq!(message[4], contract.security_type.to_field(), \"message.security_type\");\n                assert_eq!(\n                    message[5], contract.last_trade_date_or_contract_month,\n                    \"message.last_trade_date_or_contract_month\"\n                );\n                assert_eq!(message[6], contract.strike.to_field(), \"message.strike\");\n                assert_eq!(message[7], contract.right, \"message.right\");\n                assert_eq!(message[8], contract.multiplier, \"message.multiplier\");\n                assert_eq!(message[9], contract.exchange, \"message.exchange\");\n                assert_eq!(message[10], contract.primary_exchange, \"message.primary_exchange\");\n                assert_eq!(message[11], contract.currency, \"message.currency\");\n                assert_eq!(message[12], contract.local_symbol, \"message.local_symbol\");\n                assert_eq!(message[13], contract.trading_class, \"message.trading_class\");\n                assert_eq!(message[14], tick_type, \"message.tick_type\");\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding tick_by_tick request: {err}\");\n            }\n        }\n    }\n\n    #[test]\n    fn realtime_bars() {\n        let request_id = 9000;\n        let server_version = server_versions::TICK_BY_TICK;\n        let contract = contract_samples::simple_future();\n        let bar_size = BarSize::Secs5;\n        let what_to_show = WhatToShow::Trades;\n        let use_rth = true;\n        let options = vec![];\n\n        let results = super::encode_request_realtime_bars(server_version, request_id, \u0026contract, \u0026bar_size, \u0026what_to_show, use_rth, options);\n\n        match results {\n            Ok(message) =\u003e {\n                assert_eq!(message[0], OutgoingMessages::RequestRealTimeBars.to_field(), \"message.type\");\n                assert_eq!(message[1], \"8\", \"message.version\");\n                assert_eq!(message[2], request_id.to_field(), \"message.request_id\");\n                assert_eq!(message[3], contract.contract_id.to_field(), \"message.contract_id\");\n                assert_eq!(message[4], contract.symbol, \"message.symbol\");\n                assert_eq!(message[5], contract.security_type.to_field(), \"message.security_type\");\n                assert_eq!(\n                    message[6], contract.last_trade_date_or_contract_month,\n                    \"message.last_trade_date_or_contract_month\"\n                );\n                assert_eq!(message[7], contract.strike.to_field(), \"message.strike\");\n                assert_eq!(message[8], contract.right, \"message.right\");\n                assert_eq!(message[9], contract.multiplier, \"message.multiplier\");\n                assert_eq!(message[10], contract.exchange, \"message.exchange\");\n                assert_eq!(message[11], contract.primary_exchange, \"message.primary_exchange\");\n                assert_eq!(message[12], contract.currency, \"message.currency\");\n                assert_eq!(message[13], contract.local_symbol, \"message.local_symbol\");\n                assert_eq!(message[14], contract.trading_class, \"message.trading_class\");\n                assert_eq!(message[15], \"0\", \"message.bar_size\");\n                assert_eq!(message[16], what_to_show.to_field(), \"message.what_to_show\"); // implement to_field\n                assert_eq!(message[17], use_rth.to_field(), \"message.use_rth\");\n                assert_eq!(message[18], \"\", \"message.options\"); // TODO what should this be?\n            }\n            Err(err) =\u003e {\n                assert!(false, \"error encoding realtime_bars request: {err}\");\n            }\n        }\n    }\n}\n","traces":[{"line":10,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":91,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":55,"coverable":57},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","realtime","tests.rs"],"content":"use time::OffsetDateTime;\n\nuse super::*;\nuse crate::contracts::contract_samples;\nuse crate::messages::OutgoingMessages;\nuse crate::stubs::MessageBusStub;\nuse crate::ToField;\n\n#[test]\nfn realtime_bars() {\n    let message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"50|3|9001|1678323335|4028.75|4029.00|4028.25|4028.50|2|4026.75|1|\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let contract = contract_samples::future_with_local_symbol();\n    let bar_size = BarSize::Secs5;\n    let what_to_show = WhatToShow::Trades;\n    let use_rth = true;\n\n    let bars = super::realtime_bars(\u0026mut client, \u0026contract, \u0026bar_size, \u0026what_to_show, use_rth);\n    assert!(bars.is_ok(), \"failed to request realtime bars: {}\", bars.err().unwrap());\n\n    // Verify Responses\n    let mut bars = bars.unwrap();\n    if let Some(bar) = bars.next() {\n        let timestamp = OffsetDateTime::from_unix_timestamp(1678323335).unwrap();\n\n        assert_eq!(bar.date, timestamp, \"bar.date\");\n        assert_eq!(bar.open, 4028.75, \"bar.open\");\n        assert_eq!(bar.high, 4029.00, \"bar.high\");\n        assert_eq!(bar.low, 4028.25, \"bar.low\");\n        assert_eq!(bar.close, 4028.50, \"bar.close\");\n        assert_eq!(bar.volume, 2.0, \"bar.volume\");\n        assert_eq!(bar.wap, 4026.75, \"bar.wap\");\n        assert_eq!(bar.count, 1, \"bar.count\");\n    } else {\n        assert!(false, \"expected a real time bar\");\n    }\n\n    // Should trigger cancel realtime bars\n    drop(bars);\n\n    let request_messages = client.message_bus.request_messages();\n\n    // Verify Requests\n    let realtime_bars_request = \u0026request_messages[0];\n    assert_eq!(\n        realtime_bars_request[0],\n        OutgoingMessages::RequestRealTimeBars.to_field(),\n        \"message.message_type\"\n    );\n    assert_eq!(realtime_bars_request[1], \"8\", \"message.version\");\n    assert_eq!(realtime_bars_request[2], \"9000\", \"message.request_id\");\n    assert_eq!(realtime_bars_request[3], contract.contract_id.to_field(), \"message.contract_id\");\n    assert_eq!(realtime_bars_request[4], contract.symbol.to_field(), \"message.symbol\");\n    assert_eq!(realtime_bars_request[5], contract.security_type.to_field(), \"message.security_type\");\n    assert_eq!(\n        realtime_bars_request[6],\n        contract.last_trade_date_or_contract_month.to_field(),\n        \"message.last_trade_date_or_contract_month\"\n    );\n    assert_eq!(realtime_bars_request[7], contract.strike.to_field(), \"message.strike\");\n    assert_eq!(realtime_bars_request[8], contract.right.to_field(), \"message.right\");\n    assert_eq!(realtime_bars_request[9], contract.multiplier.to_field(), \"message.multiplier\");\n    assert_eq!(realtime_bars_request[10], contract.exchange.to_field(), \"message.exchange\");\n    assert_eq!(\n        realtime_bars_request[11],\n        contract.primary_exchange.to_field(),\n        \"message.primary_exchange\"\n    );\n    assert_eq!(realtime_bars_request[12], contract.currency.to_field(), \"message.currency\");\n    assert_eq!(realtime_bars_request[13], contract.local_symbol.to_field(), \"message.local_symbol\");\n    assert_eq!(realtime_bars_request[14], contract.trading_class.to_field(), \"message.trading_class\");\n    assert_eq!(realtime_bars_request[15], \"0\", \"message.bar_size\");\n    assert_eq!(realtime_bars_request[16], what_to_show.to_field(), \"message.what_to_show\");\n    assert_eq!(realtime_bars_request[17], use_rth.to_field(), \"message.use_rth\");\n    assert_eq!(realtime_bars_request[18], \"\", \"message.options\");\n\n    let cancel_request = \u0026request_messages[1];\n    assert_eq!(cancel_request[0], OutgoingMessages::CancelRealTimeBars.to_field(), \"message.message_type\");\n    assert_eq!(cancel_request[1], \"1\", \"message.version\");\n    assert_eq!(cancel_request[2], \"9000\", \"message.request_id\");\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","realtime.rs"],"content":"use anyhow::Result;\nuse log::error;\n\nuse crate::client::transport::ResponseIterator;\nuse crate::client::Client;\nuse crate::contracts::Contract;\nuse crate::messages::IncomingMessages;\nuse crate::orders::TagValue;\nuse crate::server_versions;\n\nuse super::{BarSize, BidAsk, MidPoint, RealTimeBar, Trade, WhatToShow};\n\nmod decoders;\nmod encoders;\n#[cfg(test)]\nmod tests;\n\n/// Requests realtime bars.\n///\n/// This method will provide all the contracts matching the contract provided. It can also be used to retrieve complete options and futures chains. Though it is now (in API version \u003e 9.72.12) advised to use reqSecDefOptParams for that purpose.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::Client;\n/// use ibapi::contracts::{self, Contract};\n/// use ibapi::market_data::{realtime, BarSize, WhatToShow};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let contract = Contract::stock(\"TSLA\");\n///     let bars = realtime::realtime_bars(\u0026mut client, \u0026contract, \u0026BarSize::Secs5, \u0026WhatToShow::Trades, false)?;\n///\n///     for (i, bar) in bars.enumerate() {\n///         println!(\"bar[{i}]: {bar:?}\");\n///\n///         if i \u003e 60 {\n///             break;\n///         }\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn realtime_bars\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    bar_size: \u0026BarSize,\n    what_to_show: \u0026WhatToShow,\n    use_rth: bool,\n) -\u003e Result\u003cRealTimeBarIterator\u003c'a\u003e\u003e {\n    realtime_bars_with_options(client, contract, bar_size, what_to_show, use_rth, Vec::default())\n}\n\n/// Requests realtime bars.\n///\n/// This method will provide all the contracts matching the contract provided. It can also be used to retrieve complete options and futures chains. Though it is now (in API version \u003e 9.72.12) advised to use reqSecDefOptParams for that purpose.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::Client;\n/// use ibapi::contracts::{self, Contract};\n/// use ibapi::market_data::{realtime, BarSize, WhatToShow};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let contract = Contract::stock(\"TSLA\");\n///     let bars = realtime::realtime_bars(\u0026mut client, \u0026contract, \u0026BarSize::Secs5, \u0026WhatToShow::Trades, false)?;\n///\n///     for (i, bar) in bars.enumerate() {\n///         println!(\"bar[{i}]: {bar:?}\");\n///\n///         if i \u003e 60 {\n///             break;\n///         }\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn realtime_bars_with_options\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    bar_size: \u0026BarSize,\n    what_to_show: \u0026WhatToShow,\n    use_rth: bool,\n    options: Vec\u003cTagValue\u003e,\n) -\u003e Result\u003cRealTimeBarIterator\u003c'a\u003e\u003e {\n    client.check_server_version(server_versions::REAL_TIME_BARS, \"It does not support real time bars.\")?;\n\n    if !contract.trading_class.is_empty() || contract.contract_id \u003e 0 {\n        client.check_server_version(\n            server_versions::TRADING_CLASS,\n            \"It does not support ConId nor TradingClass parameters in reqRealTimeBars.\",\n        )?;\n    }\n\n    let request_id = client.next_request_id();\n    let packet = encoders::encode_request_realtime_bars(client.server_version(), request_id, contract, bar_size, what_to_show, use_rth, options)?;\n\n    let responses = client.send_request(request_id, packet)?;\n\n    Ok(RealTimeBarIterator::new(client, request_id, responses))\n}\n\n/// Requests tick by tick AllLast ticks.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n/// * `number_of_ticks` - number of ticks.\n/// * `ignore_size` - ignore size flag.\npub fn tick_by_tick_all_last\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    number_of_ticks: i32,\n    ignore_size: bool,\n) -\u003e anyhow::Result\u003cTradeIterator\u003c'a\u003e\u003e {\n    validate_tick_by_tick_request(client, contract, number_of_ticks, ignore_size)?;\n\n    let server_version = client.server_version();\n    let request_id = client.next_request_id();\n\n    let message = encoders::tick_by_tick(server_version, request_id, contract, \"AllLast\", number_of_ticks, ignore_size)?;\n    let responses = client.send_request(request_id, message)?;\n\n    Ok(TradeIterator {\n        client,\n        request_id,\n        responses,\n    })\n}\n\n// Validates that server supports the given request.\nfn validate_tick_by_tick_request(client: \u0026Client, _contract: \u0026Contract, number_of_ticks: i32, ignore_size: bool) -\u003e anyhow::Result\u003c()\u003e {\n    client.check_server_version(server_versions::TICK_BY_TICK, \"It does not support tick-by-tick requests.\")?;\n\n    if number_of_ticks != 0 || ignore_size {\n        client.check_server_version(\n            server_versions::TICK_BY_TICK_IGNORE_SIZE,\n            \"It does not support ignoreSize and numberOfTicks parameters in tick-by-tick requests.\",\n        )?;\n    }\n\n    Ok(())\n}\n\n/// Requests tick by tick Last ticks.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n/// * `number_of_ticks` - number of ticks.\n/// * `ignore_size` - ignore size flag.\npub fn tick_by_tick_last\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    number_of_ticks: i32,\n    ignore_size: bool,\n) -\u003e anyhow::Result\u003cTradeIterator\u003c'a\u003e\u003e {\n    validate_tick_by_tick_request(client, contract, number_of_ticks, ignore_size)?;\n\n    let server_version = client.server_version();\n    let request_id = client.next_request_id();\n\n    let message = encoders::tick_by_tick(server_version, request_id, contract, \"Last\", number_of_ticks, ignore_size)?;\n    let responses = client.send_request(request_id, message)?;\n\n    Ok(TradeIterator {\n        client,\n        request_id,\n        responses,\n    })\n}\n\n/// Requests tick by tick BidAsk ticks.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n/// * `number_of_ticks` - number of ticks.\n/// * `ignore_size` - ignore size flag.\npub fn tick_by_tick_bid_ask\u003c'a\u003e(client: \u0026'a mut Client, contract: \u0026Contract, number_of_ticks: i32, ignore_size: bool) -\u003e Result\u003cBidAskIterator\u003c'a\u003e\u003e {\n    validate_tick_by_tick_request(client, contract, number_of_ticks, ignore_size)?;\n\n    let server_version = client.server_version();\n    let request_id = client.next_request_id();\n\n    let message = encoders::tick_by_tick(server_version, request_id, contract, \"BidAsk\", number_of_ticks, ignore_size)?;\n    let responses = client.send_request(request_id, message)?;\n\n    Ok(BidAskIterator {\n        client,\n        request_id,\n        responses,\n    })\n}\n\n/// Requests tick by tick MidPoint ticks.\n///\n/// # Arguments\n/// * `client` - [Client] with an active connection to gateway.\n/// * `contract` - The [Contract] used as sample to query the available contracts. Typically, it will contain the [Contract]'s symbol, currency, security_type, and exchange.\n/// * `number_of_ticks` - number of ticks.\n/// * `ignore_size` - ignore size flag.\npub fn tick_by_tick_midpoint\u003c'a\u003e(\n    client: \u0026'a mut Client,\n    contract: \u0026Contract,\n    number_of_ticks: i32,\n    ignore_size: bool,\n) -\u003e Result\u003cMidPointIterator\u003c'a\u003e\u003e {\n    validate_tick_by_tick_request(client, contract, number_of_ticks, ignore_size)?;\n\n    let server_version = client.server_version();\n    let request_id = client.next_request_id();\n\n    let message = encoders::tick_by_tick(server_version, request_id, contract, \"MidPoint\", number_of_ticks, ignore_size)?;\n    let responses = client.send_request(request_id, message)?;\n\n    Ok(MidPointIterator {\n        client,\n        request_id,\n        responses,\n    })\n}\n\n// Iterators\n\n/// RealTimeBarIterator supports iteration over [RealTimeBar] ticks.\npub struct RealTimeBarIterator\u003c'a\u003e {\n    client: \u0026'a mut Client,\n    request_id: i32,\n    responses: ResponseIterator,\n}\n\nimpl\u003c'a\u003e RealTimeBarIterator\u003c'a\u003e {\n    fn new(client: \u0026'a mut Client, request_id: i32, responses: ResponseIterator) -\u003e RealTimeBarIterator\u003c'a\u003e {\n        RealTimeBarIterator {\n            client,\n            request_id,\n            responses,\n        }\n    }\n\n    /// Cancels request to stream realtime bars\n    fn cancel_realtime_bars(\u0026mut self) {\n        let message = encoders::cancel_realtime_bars(self.request_id).unwrap();\n\n        self.client.send_message(message).unwrap();\n\n        ()\n    }\n}\n\nimpl\u003c'a\u003e Iterator for RealTimeBarIterator\u003c'a\u003e {\n    type Item = RealTimeBar;\n\n    /// Advances the iterator and returns the next value.\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        if let Some(mut message) = self.responses.next() {\n            match message.message_type() {\n                IncomingMessages::RealTimeBars =\u003e {\n                    let decoded = decoders::decode_realtime_bar(\u0026mut message);\n\n                    if let Ok(bar) = decoded {\n                        return Some(bar);\n                    }\n\n                    error!(\"unexpected message: {:?}\", decoded.err());\n                    None\n                }\n                _ =\u003e {\n                    error!(\"unexpected message: {message:?}\");\n                    None\n                }\n            }\n        } else {\n            None\n        }\n    }\n}\n\nimpl\u003c'a\u003e Drop for RealTimeBarIterator\u003c'a\u003e {\n    fn drop(\u0026mut self) {\n        self.cancel_realtime_bars()\n    }\n}\n\n/// TradeIterator supports iteration over [Trade] ticks.\npub struct TradeIterator\u003c'a\u003e {\n    client: \u0026'a mut Client,\n    request_id: i32,\n    responses: ResponseIterator,\n}\n\nimpl\u003c'a\u003e Drop for TradeIterator\u003c'a\u003e {\n    // Ensures tick by tick request is cancelled\n    fn drop(\u0026mut self) {\n        cancel_tick_by_tick(self.client, self.request_id);\n    }\n}\n\nimpl\u003c'a\u003e Iterator for TradeIterator\u003c'a\u003e {\n    type Item = Trade;\n\n    /// Advances the iterator and returns the next value.\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            match self.responses.next() {\n                Some(mut message) =\u003e match message.message_type() {\n                    IncomingMessages::TickByTick =\u003e match decoders::trade_tick(\u0026mut message) {\n                        Ok(tick) =\u003e return Some(tick),\n                        Err(e) =\u003e error!(\"unexpected message {message:?}: {e:?}\"),\n                    },\n                    _ =\u003e error!(\"unexpected message {message:?}\"),\n                },\n                None =\u003e return None,\n            }\n        }\n    }\n}\n\n/// BidAskIterator supports iteration over [BidAsk] ticks.\npub struct BidAskIterator\u003c'a\u003e {\n    client: \u0026'a mut Client,\n    request_id: i32,\n    responses: ResponseIterator,\n}\n\n/// Cancels the tick by tick request\nfn cancel_tick_by_tick(client: \u0026mut Client, request_id: i32) {\n    if client.server_version() \u003e= server_versions::TICK_BY_TICK {\n        let message = encoders::cancel_tick_by_tick(request_id).unwrap();\n        client.send_message(message).unwrap();\n    }\n}\n\nimpl\u003c'a\u003e Drop for BidAskIterator\u003c'a\u003e {\n    // Ensures tick by tick request is cancelled\n    fn drop(\u0026mut self) {\n        cancel_tick_by_tick(self.client, self.request_id);\n    }\n}\n\nimpl\u003c'a\u003e Iterator for BidAskIterator\u003c'a\u003e {\n    type Item = BidAsk;\n\n    /// Advances the iterator and returns the next value.\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            match self.responses.next() {\n                Some(mut message) =\u003e match message.message_type() {\n                    IncomingMessages::TickByTick =\u003e match decoders::bid_ask_tick(\u0026mut message) {\n                        Ok(tick) =\u003e return Some(tick),\n                        Err(e) =\u003e error!(\"unexpected message {message:?}: {e:?}\"),\n                    },\n                    _ =\u003e error!(\"unexpected message {message:?}\"),\n                },\n                None =\u003e return None,\n            }\n        }\n    }\n}\n\n/// MidPointIterator supports iteration over [MidPoint] ticks.\npub struct MidPointIterator\u003c'a\u003e {\n    client: \u0026'a mut Client,\n    request_id: i32,\n    responses: ResponseIterator,\n}\n\nimpl\u003c'a\u003e Drop for MidPointIterator\u003c'a\u003e {\n    // Ensures tick by tick request is cancelled\n    fn drop(\u0026mut self) {\n        cancel_tick_by_tick(self.client, self.request_id);\n    }\n}\n\nimpl\u003c'a\u003e Iterator for MidPointIterator\u003c'a\u003e {\n    type Item = MidPoint;\n\n    /// Advances the iterator and returns the next value.\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            match self.responses.next() {\n                Some(mut message) =\u003e match message.message_type() {\n                    IncomingMessages::TickByTick =\u003e match decoders::mid_point_tick(\u0026mut message) {\n                        Ok(tick) =\u003e return Some(tick),\n                        Err(e) =\u003e error!(\"unexpected message {message:?}: {e:?}\"),\n                    },\n                    _ =\u003e error!(\"unexpected message {message:?}\"),\n                },\n                None =\u003e return None,\n            }\n        }\n    }\n}\n","traces":[{"line":50,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":203,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":206,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":225,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":228,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":229,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":232,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":233,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":248,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":258,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":270,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":271,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":272,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":273,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":274,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":276,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":277,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":280,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":283,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":284,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":296,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":309,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":321,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":326,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":328,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":342,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":343,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":344,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":345,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":351,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":352,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":360,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":361,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":362,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":365,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":366,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":368,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":370,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":385,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":396,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":397,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":398,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":404,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":19,"coverable":108},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data","scanners.rs"],"content":"// request_scanner_sub","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","market_data.rs"],"content":"use time::OffsetDateTime;\n\nuse crate::ToField;\n\npub mod historical;\npub mod realtime;\n\n#[derive(Clone, Debug)]\npub struct RealTimeBar {\n    pub date: OffsetDateTime,\n    pub open: f64,\n    pub high: f64,\n    pub low: f64,\n    pub close: f64,\n    pub volume: f64,\n    pub wap: f64,\n    pub count: i32,\n}\n\npub enum BarSize {\n    Secs5,\n}\n\npub enum WhatToShow {\n    Trades,\n    MidPoint,\n    Bid,\n    Ask,\n}\n\nimpl ToString for WhatToShow {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            Self::Trades =\u003e \"TRADES\".to_string(),\n            Self::MidPoint =\u003e \"MIDPOINT\".to_string(),\n            Self::Bid =\u003e \"BID\".to_string(),\n            Self::Ask =\u003e \"ASK\".to_string(),\n        }\n    }\n}\n\nimpl ToField for WhatToShow {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\n#[derive(Debug)]\npub struct BidAsk {\n    /// The spread's date and time (either as a yyyymmss hh:mm:ss formatted string or as system time according to the request). Time zone is the TWS time zone chosen on login.\n    pub time: OffsetDateTime,\n    /// tick-by-tick real-time tick bid price\n    pub bid_price: f64,\n    /// tick-by-tick real-time tick ask price\n    pub ask_price: f64,\n    /// tick-by-tick real-time tick bid size\n    pub bid_size: i64,\n    /// tick-by-tick real-time tick ask size\n    pub ask_size: i64,\n    /// tick-by-tick real-time bid/ask tick attribs (bit 0 - bid past low, bit 1 - ask past high)\n    pub bid_ask_attribute: BidAskAttribute,\n}\n\n#[derive(Debug)]\npub struct BidAskAttribute {\n    pub bid_past_low: bool,\n    pub ask_past_high: bool,\n}\n\n/// Bar describes the historical data bar.\npub struct Bar {\n    /// The bar's date and time (either as a yyyymmss hh:mm:ss formatted string or as system time according to the request). Time zone is the TWS time zone chosen on login.\n    pub time: OffsetDateTime,\n    /// The bar's open price.\n    pub open: f64,\n    /// The bar's high price.\n    pub high: f64,\n    /// The bar's low price.\n    pub low: f64,\n    /// The bar's close price.\n    pub close: f64,\n    /// The bar's traded volume if available (only available for TRADES)\n    pub volume: i64,\n    /// The bar's Weighted Average Price (only available for TRADES)\n    pub wap: f64,\n    /// The number of trades during the bar's timespan (only available for TRADES)\n    pub count: i32,\n}\n\n#[derive(Debug)]\npub struct Trade {\n    /// Tick type: \"Last\" or \"AllLast\"\n    pub tick_type: String,\n    /// The trade's date and time (either as a yyyymmss hh:mm:ss formatted string or as system time according to the request). Time zone is the TWS time zone chosen on login.\n    pub time: OffsetDateTime,\n    /// Tick last price\n    pub price: f64,\n    /// Tick last size\n    pub size: i64,\n    /// Tick attribs (bit 0 - past limit, bit 1 - unreported)\n    pub trade_attribute: TradeAttribute,\n    /// Tick exchange\n    pub exchange: String,\n    /// Tick special conditions\n    pub special_conditions: String,\n}\n\n#[derive(Debug)]\npub struct TradeAttribute {\n    pub past_limit: bool,\n    pub unreported: bool,\n}\n\n#[derive(Debug)]\npub struct HistogramData {\n    pub price: f64,\n    pub count: i32,\n}\n\n#[derive(Debug)]\npub struct MidPoint {\n    /// The trade's date and time (either as a yyyymmss hh:mm:ss formatted string or as system time according to the request). Time zone is the TWS time zone chosen on login.\n    pub time: OffsetDateTime,\n    /// mid point\n    pub mid_point: f64,\n}\n","traces":[{"line":32,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":2},"fn_name":null}],"covered":5,"coverable":8},{"path":["/","Users","wboayue","projects","rust-ibapi","src","messages.rs"],"content":"use crate::ToField;\n\n#[derive(Debug, PartialEq)]\npub enum IncomingMessages {\n    NotValid = -1,\n    TickPrice = 1,\n    TickSize = 2,\n    OrderStatus = 3,\n    Error = 4,\n    OpenOrder = 5,\n    AccountValue = 6,\n    PortfolioValue = 7,\n    AccountUpdateTime = 8,\n    NextValidId = 9,\n    ContractData = 10,\n    ExecutionData = 11,\n    MarketDepth = 12,\n    MarketDepthL2 = 13,\n    NewsBulletins = 14,\n    ManagedAccounts = 15,\n    ReceiveFA = 16,\n    HistoricalData = 17,\n    BondContractData = 18,\n    ScannerParameters = 19,\n    ScannerData = 20,\n    TickOptionComputation = 21,\n    TickGeneric = 45,\n    Tickstring = 46,\n    TickEFP = 47, //TICK EFP 47\n    CurrentTime = 49,\n    RealTimeBars = 50,\n    FundamentalData = 51,\n    ContractDataEnd = 52,\n    OpenOrderEnd = 53,\n    AccountDownloadEnd = 54,\n    ExecutionDataEnd = 55,\n    DeltaNeutralValidation = 56,\n    TickSnapshotEnd = 57,\n    MarketDataType = 58,\n    CommissionsReport = 59,\n    Position = 61,\n    PositionEnd = 62,\n    AccountSummary = 63,\n    AccountSummaryEnd = 64,\n    VerifyMessageApi = 65,\n    VerifyCompleted = 66,\n    DisplayGroupList = 67,\n    DisplayGroupUpdated = 68,\n    VerifyAndAuthMessageApi = 69,\n    VerifyAndAuthCompleted = 70,\n    PositionMulti = 71,\n    PositionMultiEnd = 72,\n    AccountUpdateMulti = 73,\n    AccountUpdateMultiEnd = 74,\n    SecurityDefinitionOptionParameter = 75,\n    SecurityDefinitionOptionParameterEnd = 76,\n    SoftDollarTier = 77,\n    FamilyCodes = 78,\n    SymbolSamples = 79,\n    MktDepthExchanges = 80,\n    TickReqParams = 81,\n    SmartComponents = 82,\n    NewsArticle = 83,\n    TickNews = 84,\n    NewsProviders = 85,\n    HistoricalNews = 86,\n    HistoricalNewsEnd = 87,\n    HeadTimestamp = 88,\n    HistogramData = 89,\n    HistoricalDataUpdate = 90,\n    RerouteMktDataReq = 91,\n    RerouteMktDepthReq = 92,\n    MarketRule = 93,\n    PnL = 94,\n    PnLSingle = 95,\n    HistoricalTick = 96,\n    HistoricalTickBidAsk = 97,\n    HistoricalTickLast = 98,\n    TickByTick = 99,\n    OrderBound = 100,\n    CompletedOrder = 101,\n    CompletedOrdersEnd = 102,\n    ReplaceFAEnd = 103,\n    WshMetaData = 104,\n    WshEventData = 105,\n    HistoricalSchedule = 106,\n    UserInfo = 107,\n}\n\nimpl From\u003ci32\u003e for IncomingMessages {\n    fn from(value: i32) -\u003e IncomingMessages {\n        match value {\n            1 =\u003e IncomingMessages::TickPrice,\n            2 =\u003e IncomingMessages::TickSize,\n            3 =\u003e IncomingMessages::OrderStatus,\n            4 =\u003e IncomingMessages::Error,\n            5 =\u003e IncomingMessages::OpenOrder,\n            6 =\u003e IncomingMessages::AccountValue,\n            7 =\u003e IncomingMessages::PortfolioValue,\n            8 =\u003e IncomingMessages::AccountUpdateTime,\n            9 =\u003e IncomingMessages::NextValidId,\n            10 =\u003e IncomingMessages::ContractData,\n            11 =\u003e IncomingMessages::ExecutionData,\n            12 =\u003e IncomingMessages::MarketDepth,\n            13 =\u003e IncomingMessages::MarketDepthL2,\n            14 =\u003e IncomingMessages::NewsBulletins,\n            15 =\u003e IncomingMessages::ManagedAccounts,\n            16 =\u003e IncomingMessages::ReceiveFA,\n            17 =\u003e IncomingMessages::HistoricalData,\n            18 =\u003e IncomingMessages::BondContractData,\n            19 =\u003e IncomingMessages::ScannerParameters,\n            20 =\u003e IncomingMessages::ScannerData,\n            21 =\u003e IncomingMessages::TickOptionComputation,\n            45 =\u003e IncomingMessages::TickGeneric,\n            46 =\u003e IncomingMessages::Tickstring,\n            47 =\u003e IncomingMessages::TickEFP, //TICK EFP 47\n            49 =\u003e IncomingMessages::CurrentTime,\n            50 =\u003e IncomingMessages::RealTimeBars,\n            51 =\u003e IncomingMessages::FundamentalData,\n            52 =\u003e IncomingMessages::ContractDataEnd,\n            53 =\u003e IncomingMessages::OpenOrderEnd,\n            54 =\u003e IncomingMessages::AccountDownloadEnd,\n            55 =\u003e IncomingMessages::ExecutionDataEnd,\n            56 =\u003e IncomingMessages::DeltaNeutralValidation,\n            57 =\u003e IncomingMessages::TickSnapshotEnd,\n            58 =\u003e IncomingMessages::MarketDataType,\n            59 =\u003e IncomingMessages::CommissionsReport,\n            61 =\u003e IncomingMessages::Position,\n            62 =\u003e IncomingMessages::PositionEnd,\n            63 =\u003e IncomingMessages::AccountSummary,\n            64 =\u003e IncomingMessages::AccountSummaryEnd,\n            65 =\u003e IncomingMessages::VerifyMessageApi,\n            66 =\u003e IncomingMessages::VerifyCompleted,\n            67 =\u003e IncomingMessages::DisplayGroupList,\n            68 =\u003e IncomingMessages::DisplayGroupUpdated,\n            69 =\u003e IncomingMessages::VerifyAndAuthMessageApi,\n            70 =\u003e IncomingMessages::VerifyAndAuthCompleted,\n            71 =\u003e IncomingMessages::PositionMulti,\n            72 =\u003e IncomingMessages::PositionMultiEnd,\n            73 =\u003e IncomingMessages::AccountUpdateMulti,\n            74 =\u003e IncomingMessages::AccountUpdateMultiEnd,\n            75 =\u003e IncomingMessages::SecurityDefinitionOptionParameter,\n            76 =\u003e IncomingMessages::SecurityDefinitionOptionParameterEnd,\n            77 =\u003e IncomingMessages::SoftDollarTier,\n            78 =\u003e IncomingMessages::FamilyCodes,\n            79 =\u003e IncomingMessages::SymbolSamples,\n            80 =\u003e IncomingMessages::MktDepthExchanges,\n            81 =\u003e IncomingMessages::TickReqParams,\n            82 =\u003e IncomingMessages::SmartComponents,\n            83 =\u003e IncomingMessages::NewsArticle,\n            84 =\u003e IncomingMessages::TickNews,\n            85 =\u003e IncomingMessages::NewsProviders,\n            86 =\u003e IncomingMessages::HistoricalNews,\n            87 =\u003e IncomingMessages::HistoricalNewsEnd,\n            88 =\u003e IncomingMessages::HeadTimestamp,\n            89 =\u003e IncomingMessages::HistogramData,\n            90 =\u003e IncomingMessages::HistoricalDataUpdate,\n            91 =\u003e IncomingMessages::RerouteMktDataReq,\n            92 =\u003e IncomingMessages::RerouteMktDepthReq,\n            93 =\u003e IncomingMessages::MarketRule,\n            94 =\u003e IncomingMessages::PnL,\n            95 =\u003e IncomingMessages::PnLSingle,\n            96 =\u003e IncomingMessages::HistoricalTick,\n            97 =\u003e IncomingMessages::HistoricalTickBidAsk,\n            98 =\u003e IncomingMessages::HistoricalTickLast,\n            99 =\u003e IncomingMessages::TickByTick,\n            100 =\u003e IncomingMessages::OrderBound,\n            101 =\u003e IncomingMessages::CompletedOrder,\n            102 =\u003e IncomingMessages::CompletedOrdersEnd,\n            103 =\u003e IncomingMessages::ReplaceFAEnd,\n            104 =\u003e IncomingMessages::WshMetaData,\n            105 =\u003e IncomingMessages::WshEventData,\n            106 =\u003e IncomingMessages::HistoricalSchedule,\n            107 =\u003e IncomingMessages::UserInfo,\n            _ =\u003e IncomingMessages::NotValid,\n        }\n    }\n}\n\npub fn order_id_index(kind: IncomingMessages) -\u003e Option\u003cusize\u003e {\n    match kind {\n        IncomingMessages::OpenOrder | IncomingMessages::OrderStatus =\u003e Some(1),\n        IncomingMessages::ExecutionData | IncomingMessages::ExecutionDataEnd =\u003e Some(2),\n        _ =\u003e None,\n    }\n}\n\npub fn request_id_index(kind: IncomingMessages) -\u003e Option\u003cusize\u003e {\n    match kind {\n        IncomingMessages::ContractData\n        | IncomingMessages::TickByTick\n        | IncomingMessages::SymbolSamples\n        | IncomingMessages::OpenOrder\n        | IncomingMessages::ExecutionData =\u003e Some(1),\n        IncomingMessages::ContractDataEnd | IncomingMessages::RealTimeBars | IncomingMessages::Error | IncomingMessages::ExecutionDataEnd =\u003e Some(2),\n        _ =\u003e None,\n    }\n}\n\n#[derive(Debug, Copy, Clone)]\npub enum OutgoingMessages {\n    RequestMarketData = 1,\n    CancelMarketData = 2,\n    PlaceOrder = 3,\n    CancelOrder = 4,\n    RequestOpenOrders = 5,\n    RequestAccountData = 6,\n    RequestExecutions = 7,\n    RequestIds = 8,\n    RequestContractData = 9,\n    RequestMarketDepth = 10,\n    CancelMarketDepth = 11,\n    RequestNewsBulletins = 12,\n    CancelNewsBulletin = 13,\n    ChangeServerLog = 14,\n    RequestAutoOpenOrders = 15,\n    RequestAllOpenOrders = 16,\n    RequestManagedAccounts = 17,\n    RequestFA = 18,\n    ReplaceFA = 19,\n    RequestHistoricalData = 20,\n    ExerciseOptions = 21,\n    RequestScannerSubscription = 22,\n    CancelScannerSubscription = 23,\n    RequestScannerParameters = 24,\n    CancelHistoricalData = 25,\n    RequestCurrentTime = 49,\n    RequestRealTimeBars = 50,\n    CancelRealTimeBars = 51,\n    RequestFundamentalData = 52,\n    CancelFundamentalData = 53,\n    ReqCalcImpliedVolat = 54,\n    ReqCalcOptionPrice = 55,\n    CancelImpliedVolatility = 56,\n    CancelOptionPrice = 57,\n    RequestGlobalCancel = 58,\n    RequestMarketDataType = 59,\n    RequestPositions = 61,\n    RequestAccountSummary = 62,\n    CancelAccountSummary = 63,\n    CancelPositions = 64,\n    VerifyRequest = 65,\n    VerifyMessage = 66,\n    QueryDisplayGroups = 67,\n    SubscribeToGroupEvents = 68,\n    UpdateDisplayGroup = 69,\n    UnsubscribeFromGroupEvents = 70,\n    StartApi = 71,\n    VerifyAndAuthRequest = 72,\n    VerifyAndAuthMessage = 73,\n    RequestPositionsMulti = 74,\n    CancelPositionsMulti = 75,\n    RequestAccountUpdatesMulti = 76,\n    CancelAccountUpdatesMulti = 77,\n    RequestSecurityDefinitionOptionalParameters = 78,\n    RequestSoftDollarTiers = 79,\n    RequestFamilyCodes = 80,\n    RequestMatchingSymbols = 81,\n    RequestMktDepthExchanges = 82,\n    RequestSmartComponents = 83,\n    RequestNewsArticle = 84,\n    RequestNewsProviders = 85,\n    RequestHistoricalNews = 86,\n    RequestHeadTimestamp = 87,\n    RequestHistogramData = 88,\n    CancelHistogramData = 89,\n    CancelHeadTimestamp = 90,\n    RequestMarketRule = 91,\n    ReqPnL = 92,\n    CancelPnL = 93,\n    ReqPnLSingle = 94,\n    CancelPnLSingle = 95,\n    ReqHistoricalTicks = 96,\n    ReqTickByTickData = 97,\n    CancelTickByTickData = 98,\n    ReqCompletedOrders = 99,\n    ReqWshMetaData = 100,\n    CancelWshMetaData = 101,\n    ReqWshEventData = 102,\n    CancelWshEventData = 103,\n    ReqUserInfo = 104,\n}\n\nimpl ToField for OutgoingMessages {\n    fn to_field(\u0026self) -\u003e String {\n        (*self as i32).to_string()\n    }\n}\n","traces":[{"line":91,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":110,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":115,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":128,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":131,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":173,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":28},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":28},"fn_name":null}],"covered":13,"coverable":97},{"path":["/","Users","wboayue","projects","rust-ibapi","src","news.rs"],"content":"use std::fmt::Debug;\n\nuse anyhow::{anyhow, Result};\n\nuse crate::{client::Client, domain::NewsProvider};\n\n// https://interactivebrokers.github.io/tws-api/news.html\n\n/// Historical News Headlines\n\n/// Requesting News Articles\n\n/// Requests news providers which the user has subscribed to.\npub fn news_providers(client: \u0026Client) -\u003e Result\u003cVec\u003cNewsProvider\u003e\u003e {\n    // request = RequestNewsProvidersRequest::new()\n    // packet = request.encode()\n    // client.send_packet(packet)\n    // packet = client.receive_packet(request_id)\n    // ReceiveNewsProvidersResponse::decode(packet)\n    print!(\"client: {client:?}\");\n    Err(anyhow!(\"not implemented!\"))\n}\n\n// :reqNewsArticle below.\n\n// reqHistoricalNews\n\n//reqNewsArticle s\n","traces":[{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":8},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders","decoders.rs"],"content":"use super::*;\n\nstruct OrderDecoder {\n    server_version: i32,\n    message: ResponseMessage,\n    order_id: i32,\n    contract: Contract,\n    order: Order,\n    order_state: OrderState,\n}\n\nimpl OrderDecoder {\n    fn new(server_version: i32, mut message: ResponseMessage) -\u003e Self {\n        message.skip(); // message type\n\n        if server_version \u003c server_versions::ORDER_CONTAINER {\n            message.skip(); // message version\n        }\n\n        Self {\n            server_version,\n            message,\n            order_id: -1,\n            contract: Contract::default(),\n            order: Order::default(),\n            order_state: OrderState::default(),\n        }\n    }\n\n    fn read_order_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order_id = self.message.next_int()?;\n        self.order.order_id = self.order_id;\n\n        Ok(())\n    }\n\n    fn read_contract_fields(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let message = \u0026mut self.message;\n        let contract = \u0026mut self.contract;\n\n        contract.contract_id = message.next_int()?;\n        contract.symbol = message.next_string()?;\n\n        let security_type = message.next_string()?;\n        contract.security_type = SecurityType::from(\u0026security_type);\n\n        contract.last_trade_date_or_contract_month = message.next_string()?;\n        contract.strike = message.next_double()?;\n        contract.right = message.next_string()?;\n        contract.multiplier = message.next_string()?;\n        contract.exchange = message.next_string()?;\n        contract.currency = message.next_string()?;\n        contract.local_symbol = message.next_string()?;\n        contract.trading_class = message.next_string()?;\n\n        Ok(())\n    }\n\n    fn read_action(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let action = self.message.next_string()?;\n        self.order.action = Action::from(\u0026action);\n\n        Ok(())\n    }\n\n    fn read_total_quantity(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.total_quantity = self.message.next_double()?;\n        Ok(())\n    }\n\n    fn read_order_type(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.order_type = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_limit_price(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.limit_price = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_aux_price(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.aux_price = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_tif(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.tif = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_oca_group(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.oca_group = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_account(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.account = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_open_close(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let open_close = self.message.next_string()?;\n        self.order.open_close = OrderOpenClose::from(\u0026open_close);\n        Ok(())\n    }\n\n    fn read_origin(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.origin = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_order_ref(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.order_ref = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_client_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.client_id = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_perm_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.perm_id = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_outside_rth(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.outside_rth = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_hidden(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.hidden = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_discretionary_amt(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.discretionary_amt = self.message.next_double()?;\n        Ok(())\n    }\n\n    fn read_good_after_time(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.good_after_time = self.message.next_string()?;\n        Ok(())\n    }\n\n    // skips deprecated shares_allocation field\n    fn skip_shares_allocation(\u0026mut self) {\n        self.message.skip();\n    }\n\n    fn read_fa_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.fa_group = self.message.next_string()?;\n        self.order.fa_method = self.message.next_string()?;\n        self.order.fa_percentage = self.message.next_string()?;\n        if self.server_version \u003c server_versions::FA_PROFILE_DESUPPORT {\n            self.order.fa_percentage = self.message.next_string()?;\n        }\n        Ok(())\n    }\n\n    fn read_model_code(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::MODELS_SUPPORT {\n            self.order.model_code = self.message.next_string()?;\n        }\n        Ok(())\n    }\n\n    fn read_good_till_date(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.good_till_date = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_rule_80_a(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let rule_80_a = self.message.next_string()?;\n        self.order.rule_80_a = Rule80A::from(\u0026rule_80_a);\n        Ok(())\n    }\n\n    fn read_percent_offset(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.percent_offset = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_settling_firm(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.settling_firm = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_short_sale_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.short_sale_slot = self.message.next_int()?;\n        self.order.designated_location = self.message.next_string()?;\n        self.order.exempt_code = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_auction_strategy(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.auction_strategy = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_box_order_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.starting_price = self.message.next_optional_double()?;\n        self.order.stock_ref_price = self.message.next_optional_double()?;\n        self.order.delta = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_peg_to_stock_or_vol_order_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.stock_range_lower = self.message.next_optional_double()?;\n        self.order.stock_range_upper = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_display_size(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.display_size = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_block_order(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.block_order = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_sweep_to_fill(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.sweep_to_fill = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_all_or_none(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.all_or_none = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_min_qty(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.min_qty = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_oca_type(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.oca_type = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn skip_etrade_only(\u0026mut self) {\n        self.message.skip();\n    }\n\n    fn skip_firm_quote_only(\u0026mut self) {\n        self.message.skip();\n    }\n\n    fn skip_nbbo_price_cap(\u0026mut self) {\n        self.message.skip();\n    }\n\n    fn read_parent_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.parent_id = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_trigger_method(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.trigger_method = self.message.next_int()?;\n        Ok(())\n    }\n\n    fn read_volatility_order_params(\u0026mut self, read_open_order_attributes: bool) -\u003e Result\u003c()\u003e {\n        self.order.volatility = self.message.next_optional_double()?;\n        self.order.volatility_type = self.message.next_optional_int()?;\n        self.order.delta_neutral_order_type = self.message.next_string()?;\n        self.order.delta_neutral_aux_price = self.message.next_optional_double()?;\n\n        if self.order.is_delta_neutral() {\n            self.order.delta_neutral_con_id = self.message.next_int()?;\n            if read_open_order_attributes {\n                self.order.delta_neutral_settling_firm = self.message.next_string()?;\n                self.order.delta_neutral_clearing_account = self.message.next_string()?;\n                self.order.delta_neutral_clearing_intent = self.message.next_string()?;\n                self.order.delta_neutral_open_close = self.message.next_string()?;\n            }\n            self.order.delta_neutral_short_sale = self.message.next_bool()?;\n            self.order.delta_neutral_short_sale_slot = self.message.next_int()?;\n            self.order.delta_neutral_designated_location = self.message.next_string()?;\n        }\n\n        self.order.continuous_update = self.message.next_bool()?;\n        self.order.reference_price_type = self.message.next_optional_int()?;\n\n        Ok(())\n    }\n\n    fn read_trail_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.trail_stop_price = self.message.next_optional_double()?;\n        self.order.trailing_percent = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_basis_points(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.basis_points = self.message.next_optional_double()?;\n        self.order.basis_points_type = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_combo_legs(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.contract.combo_legs_description = self.message.next_string()?;\n\n        let combo_legs_count = self.message.next_int()?;\n        for _ in 0..combo_legs_count {\n            let contract_id = self.message.next_int()?;\n            let ratio = self.message.next_int()?;\n            let action = self.message.next_string()?;\n            let exchange = self.message.next_string()?;\n            let open_close = self.message.next_int()?;\n            let short_sale_slot = self.message.next_int()?;\n            let designated_location = self.message.next_string()?;\n            let exempt_code = self.message.next_int()?;\n\n            self.contract.combo_legs.push(ComboLeg {\n                contract_id,\n                ratio,\n                action,\n                exchange,\n                open_close: ComboLegOpenClose::from(open_close),\n                short_sale_slot,\n                designated_location,\n                exempt_code,\n            });\n        }\n\n        let order_combo_legs_count = self.message.next_int()?;\n        for _ in 0..order_combo_legs_count {\n            let price = self.message.next_optional_double()?;\n\n            self.order.order_combo_legs.push(OrderComboLeg { price });\n        }\n\n        Ok(())\n    }\n\n    fn read_smart_combo_routing_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        // smart combo routing params\n        let smart_combo_routing_params_count = self.message.next_int()?;\n        for _ in 0..smart_combo_routing_params_count {\n            self.order.smart_combo_routing_params.push(TagValue {\n                tag: self.message.next_string()?,\n                value: self.message.next_string()?,\n            });\n        }\n\n        Ok(())\n    }\n\n    fn read_scale_order_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.scale_init_level_size = self.message.next_optional_int()?;\n        self.order.scale_subs_level_size = self.message.next_optional_int()?;\n        self.order.scale_price_increment = self.message.next_optional_double()?;\n\n        if let Some(scale_price_increment) = self.order.scale_price_increment {\n            if scale_price_increment \u003e 0.0 {\n                self.order.scale_price_adjust_value = self.message.next_optional_double()?;\n                self.order.scale_price_adjust_interval = self.message.next_optional_int()?;\n                self.order.scale_profit_offset = self.message.next_optional_double()?;\n                self.order.scale_auto_reset = self.message.next_bool()?;\n                self.order.scale_init_position = self.message.next_optional_int()?;\n                self.order.scale_init_fill_qty = self.message.next_optional_int()?;\n                self.order.scale_random_percent = self.message.next_bool()?;\n            }\n        }\n\n        Ok(())\n    }\n\n    fn read_hedge_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.hedge_type = self.message.next_string()?;\n        if !self.order.hedge_type.is_empty() {\n            self.order.hedge_param = self.message.next_string()?;\n        }\n        Ok(())\n    }\n\n    fn read_opt_out_smart_routing(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.opt_out_smart_routing = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_clearing_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.clearing_account = self.message.next_string()?;\n        self.order.clearing_intent = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_not_held(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.not_held = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_delta_neutral(\u0026mut self) -\u003e Result\u003c()\u003e {\n        let has_delta_neutral_contract = self.message.next_bool()?;\n        if has_delta_neutral_contract {\n            self.contract.delta_neutral_contract = Some(DeltaNeutralContract {\n                contract_id: self.message.next_int()?,\n                delta: self.message.next_double()?,\n                price: self.message.next_double()?,\n            });\n        }\n        Ok(())\n    }\n\n    fn read_algo_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.algo_strategy = self.message.next_string()?;\n        if !self.order.algo_strategy.is_empty() {\n            let algo_params_count = self.message.next_int()?;\n            for _ in 0..algo_params_count {\n                self.order.algo_params.push(TagValue {\n                    tag: self.message.next_string()?,\n                    value: self.message.next_string()?,\n                });\n            }\n        }\n\n        Ok(())\n    }\n\n    fn read_solicited(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.solicited = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_what_if_info_and_commission(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.what_if = self.message.next_bool()?;\n        self.read_order_status()?;\n\n        if self.server_version \u003e= server_versions::WHAT_IF_EXT_FIELDS {\n            self.order_state.initial_margin_before = self.message.next_optional_double()?;\n            self.order_state.maintenance_margin_before = self.message.next_optional_double()?;\n            self.order_state.equity_with_loan_before = self.message.next_optional_double()?;\n            self.order_state.initial_margin_change = self.message.next_optional_double()?;\n            self.order_state.maintenance_margin_change = self.message.next_optional_double()?;\n            self.order_state.equity_with_loan_change = self.message.next_optional_double()?;\n        }\n\n        self.order_state.initial_margin_after = self.message.next_optional_double()?;\n        self.order_state.maintenance_margin_after = self.message.next_optional_double()?;\n        self.order_state.equity_with_loan_after = self.message.next_optional_double()?;\n        self.order_state.commission = self.message.next_optional_double()?;\n        self.order_state.minimum_commission = self.message.next_optional_double()?;\n        self.order_state.maximum_commission = self.message.next_optional_double()?;\n        self.order_state.commission_currency = self.message.next_string()?;\n        self.order_state.warning_text = self.message.next_string()?;\n\n        Ok(())\n    }\n\n    fn read_vol_randomize_flags(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.randomize_size = self.message.next_bool()?;\n        self.order.randomize_price = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_peg_to_bench_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PEGGED_TO_BENCHMARK \u0026\u0026 self.order.order_type == \"PEG BENCH\" {\n            self.order.reference_contract_id = self.message.next_int()?;\n            self.order.is_pegged_change_amount_decrease = self.message.next_bool()?;\n            self.order.pegged_change_amount = self.message.next_optional_double()?;\n            self.order.reference_change_amount = self.message.next_optional_double()?;\n            self.order.reference_exchange = self.message.next_string()?;\n        }\n        Ok(())\n    }\n\n    fn read_conditions(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PEGGED_TO_BENCHMARK {\n            let conditions_count = self.message.next_int()?;\n            for _ in 0..conditions_count {\n                let order_condition = self.message.next_int()?;\n                self.order.conditions.push(OrderCondition::from(order_condition));\n            }\n            if conditions_count \u003e 0 {\n                self.order.conditions_ignore_rth = self.message.next_bool()?;\n                self.order.conditions_cancel_order = self.message.next_bool()?;\n            }\n        }\n        Ok(())\n    }\n\n    fn read_adjusted_order_params(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PEGGED_TO_BENCHMARK {\n            self.order.adjusted_order_type = self.message.next_string()?;\n            self.order.trigger_price = self.message.next_optional_double()?;\n            self.order.trail_stop_price = self.message.next_optional_double()?;\n            self.order.limit_price_offset = self.message.next_optional_double()?;\n            self.order.adjusted_stop_price = self.message.next_optional_double()?;\n            self.order.adjusted_stop_limit_price = self.message.next_optional_double()?;\n            self.order.adjusted_trailing_amount = self.message.next_optional_double()?;\n            self.order.adjustable_trailing_unit = self.message.next_int()?;\n        }\n        Ok(())\n    }\n\n    fn read_soft_dollar_tier(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::SOFT_DOLLAR_TIER {\n            self.order.soft_dollar_tier = SoftDollarTier {\n                name: self.message.next_string()?,\n                value: self.message.next_string()?,\n                display_name: self.message.next_string()?,\n            };\n        }\n        Ok(())\n    }\n\n    fn read_cash_qty(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::CASH_QTY {\n            self.order.cash_qty = self.message.next_optional_double()?;\n        }\n        Ok(())\n    }\n\n    fn read_dont_use_auto_price_for_hedge(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::AUTO_PRICE_FOR_HEDGE {\n            self.order.dont_use_auto_price_for_hedge = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_is_oms_container(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::ORDER_CONTAINER {\n            self.order.is_oms_container = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_discretionary_up_to_limit_price(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::D_PEG_ORDERS {\n            self.order.discretionary_up_to_limit_price = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_use_price_mgmt_algo(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PRICE_MGMT_ALGO {\n            self.order.use_price_mgmt_algo = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_duration(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::DURATION {\n            self.order.duration = self.message.next_optional_int()?;\n        }\n        Ok(())\n    }\n\n    fn read_post_to_ats(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::POST_TO_ATS {\n            self.order.post_to_ats = self.message.next_optional_int()?;\n        }\n        Ok(())\n    }\n\n    fn read_auto_cancel_parent(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::AUTO_CANCEL_PARENT {\n            self.order.auto_cancel_parent = self.message.next_bool()?;\n        }\n        Ok(())\n    }\n\n    fn read_peg_best_peg_mid_order_attributes(\u0026mut self) -\u003e Result\u003c()\u003e {\n        if self.server_version \u003e= server_versions::PEGBEST_PEGMID_OFFSETS {\n            self.order.min_trade_qty = self.message.next_optional_int()?;\n            self.order.min_compete_size = self.message.next_optional_int()?;\n            self.order.compete_against_best_offset = self.message.next_optional_double()?;\n            self.order.mid_offset_at_whole = self.message.next_optional_double()?;\n            self.order.mid_offset_at_half = self.message.next_optional_double()?;\n        }\n        Ok(())\n    }\n\n    fn read_order_status(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order_state.status = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_stop_price_and_limit_price_offset(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.trail_stop_price = self.message.next_optional_double()?;\n        self.order.limit_price_offset = self.message.next_optional_double()?;\n        Ok(())\n    }\n\n    fn read_auto_cancel_date(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.auto_cancel_date = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_filled_quantity(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.filled_quantity = self.message.next_double()?;\n        Ok(())\n    }\n\n    fn read_ref_futures_contract_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.ref_futures_con_id = self.message.next_optional_int()?;\n        Ok(())\n    }\n\n    fn read_shareholder(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.shareholder = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_imbalance_only(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.imbalance_only = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_route_marketable_to_bbo(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.route_marketable_to_bbo = self.message.next_bool()?;\n        Ok(())\n    }\n\n    fn read_parent_perm_id(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order.parent_perm_id = self.message.next_optional_long()?;\n        Ok(())\n    }\n\n    fn read_completed_time(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order_state.completed_time = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn read_completed_status(\u0026mut self) -\u003e Result\u003c()\u003e {\n        self.order_state.completed_status = self.message.next_string()?;\n        Ok(())\n    }\n\n    fn into_order_data(self) -\u003e OrderData {\n        OrderData {\n            order_id: self.order_id,\n            contract: self.contract,\n            order: self.order,\n            order_state: self.order_state,\n        }\n    }\n}\n\npub fn decode_open_order(server_version: i32, message: ResponseMessage) -\u003e Result\u003cOrderData\u003e {\n    let mut decoder = OrderDecoder::new(server_version, message);\n\n    // read order id\n    decoder.read_order_id()?;\n\n    // read contract fields\n    decoder.read_contract_fields()?;\n\n    // read order fields\n    decoder.read_action()?;\n    decoder.read_total_quantity()?;\n    decoder.read_order_type()?;\n    decoder.read_limit_price()?;\n    decoder.read_aux_price()?;\n    decoder.read_tif()?;\n    decoder.read_oca_group()?;\n    decoder.read_account()?;\n    decoder.read_open_close()?;\n    decoder.read_origin()?;\n    decoder.read_order_ref()?;\n    decoder.read_client_id()?;\n    decoder.read_perm_id()?;\n    decoder.read_outside_rth()?;\n    decoder.read_hidden()?;\n    decoder.read_discretionary_amt()?;\n    decoder.read_good_after_time()?;\n    decoder.skip_shares_allocation();\n    decoder.read_fa_params()?;\n    decoder.read_model_code()?;\n    decoder.read_good_till_date()?;\n    decoder.read_rule_80_a()?;\n    decoder.read_percent_offset()?;\n    decoder.read_settling_firm()?;\n    decoder.read_short_sale_params()?;\n    decoder.read_auction_strategy()?;\n    decoder.read_box_order_params()?;\n    decoder.read_peg_to_stock_or_vol_order_params()?;\n    decoder.read_display_size()?;\n    decoder.read_block_order()?;\n    decoder.read_sweep_to_fill()?;\n    decoder.read_all_or_none()?;\n    decoder.read_min_qty()?;\n    decoder.read_oca_type()?;\n    decoder.skip_etrade_only();\n    decoder.skip_firm_quote_only();\n    decoder.skip_nbbo_price_cap();\n    decoder.read_parent_id()?;\n    decoder.read_trigger_method()?;\n    decoder.read_volatility_order_params(true)?;\n    decoder.read_trail_params()?;\n    decoder.read_basis_points()?;\n    decoder.read_combo_legs()?;\n    decoder.read_smart_combo_routing_params()?;\n    decoder.read_scale_order_params()?;\n    decoder.read_hedge_params()?;\n    decoder.read_opt_out_smart_routing()?;\n    decoder.read_clearing_params()?;\n    decoder.read_not_held()?;\n    decoder.read_delta_neutral()?;\n    decoder.read_algo_params()?;\n    decoder.read_solicited()?;\n    decoder.read_what_if_info_and_commission()?;\n    decoder.read_vol_randomize_flags()?;\n    decoder.read_peg_to_bench_params()?;\n    decoder.read_conditions()?;\n    decoder.read_adjusted_order_params()?;\n    decoder.read_soft_dollar_tier()?;\n    decoder.read_cash_qty()?;\n    decoder.read_dont_use_auto_price_for_hedge()?;\n    decoder.read_is_oms_container()?;\n    decoder.read_discretionary_up_to_limit_price()?;\n    decoder.read_use_price_mgmt_algo()?;\n    decoder.read_duration()?;\n    decoder.read_post_to_ats()?;\n    decoder.read_auto_cancel_parent()?;\n    decoder.read_peg_best_peg_mid_order_attributes()?;\n\n    Ok(decoder.into_order_data())\n}\n\npub fn decode_order_status(server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cOrderStatus\u003e {\n    message.skip(); // message type\n\n    if server_version \u003c server_versions::MARKET_CAP_PRICE {\n        message.skip(); // message version\n    };\n\n    let mut order_status = OrderStatus::default();\n\n    order_status.order_id = message.next_int()?;\n    order_status.status = message.next_string()?;\n    order_status.filled = message.next_double()?;\n    order_status.remaining = message.next_double()?;\n    order_status.average_fill_price = message.next_double()?;\n    order_status.perm_id = message.next_int()?;\n    order_status.parent_id = message.next_int()?;\n    order_status.last_fill_price = message.next_double()?;\n    order_status.client_id = message.next_int()?;\n    order_status.why_held = message.next_string()?;\n\n    if server_version \u003e= server_versions::MARKET_CAP_PRICE {\n        order_status.market_cap_price = message.next_double()?;\n    }\n\n    Ok(order_status)\n}\n\npub fn decode_execution_data(server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cExecutionData\u003e {\n    message.skip(); // message type\n\n    if server_version \u003c server_versions::LAST_LIQUIDITY {\n        message.skip(); // message version\n    };\n\n    let mut execution_data = ExecutionData::default();\n    let contract = \u0026mut execution_data.contract;\n    let execution = \u0026mut execution_data.execution;\n\n    execution_data.request_id = message.next_int()?;\n    execution.order_id = message.next_int()?;\n    contract.contract_id = message.next_int()?;\n    contract.symbol = message.next_string()?;\n    let secutity_type = message.next_string()?;\n    contract.security_type = SecurityType::from(\u0026secutity_type);\n    contract.last_trade_date_or_contract_month = message.next_string()?;\n    contract.strike = message.next_double()?;\n    contract.right = message.next_string()?;\n    contract.multiplier = message.next_string()?;\n    contract.exchange = message.next_string()?;\n    contract.currency = message.next_string()?;\n    contract.local_symbol = message.next_string()?;\n    contract.trading_class = message.next_string()?;\n    execution.execution_id = message.next_string()?;\n    execution.time = message.next_string()?;\n    execution.account_number = message.next_string()?;\n    execution.exchange = message.next_string()?;\n    execution.side = message.next_string()?;\n    execution.shares = message.next_double()?;\n    execution.price = message.next_double()?;\n    execution.perm_id = message.next_int()?;\n    execution.client_id = message.next_int()?;\n    execution.liquidation = message.next_int()?;\n    execution.cumulative_quantity = message.next_double()?;\n    execution.average_price = message.next_double()?;\n    execution.order_reference = message.next_string()?;\n    execution.ev_rule = message.next_string()?;\n    execution.ev_multiplier = message.next_optional_double()?;\n\n    if server_version \u003e= server_versions::MODELS_SUPPORT {\n        execution.model_code = message.next_string()?;\n    }\n\n    if server_version \u003e= server_versions::LAST_LIQUIDITY {\n        execution.last_liquidity = Liquidity::from(message.next_int()?);\n    }\n\n    Ok(execution_data)\n}\n\npub fn decode_commission_report(_server_version: i32, message: \u0026mut ResponseMessage) -\u003e Result\u003cCommissionReport\u003e {\n    message.skip(); // message type\n    message.skip(); // message version\n\n    Ok(CommissionReport {\n        execution_id: message.next_string()?,\n        commission: message.next_double()?,\n        currency: message.next_string()?,\n        realized_pnl: message.next_optional_double()?,\n        yields: message.next_optional_double()?,\n        yield_redemption_date: message.next_string()?, // TODO: use date type?\n    })\n}\n\npub fn decode_completed_order(server_version: i32, message: ResponseMessage) -\u003e Result\u003cOrderData\u003e {\n    let mut decoder = OrderDecoder::new(server_version, message);\n\n    // read contract fields\n    decoder.read_contract_fields()?;\n\n    // read order fields\n    decoder.read_action()?;\n    decoder.read_total_quantity()?;\n    decoder.read_order_type()?;\n    decoder.read_limit_price()?;\n    decoder.read_aux_price()?;\n    decoder.read_tif()?;\n    decoder.read_oca_group()?;\n    decoder.read_account()?;\n    decoder.read_open_close()?;\n    decoder.read_origin()?;\n    decoder.read_order_ref()?;\n    decoder.read_perm_id()?;\n    decoder.read_outside_rth()?;\n    decoder.read_hidden()?;\n    decoder.read_discretionary_amt()?;\n    decoder.read_good_after_time()?;\n    decoder.read_fa_params()?;\n    decoder.read_model_code()?;\n    decoder.read_good_till_date()?;\n    decoder.read_rule_80_a()?;\n    decoder.read_percent_offset()?;\n    decoder.read_settling_firm()?;\n    decoder.read_short_sale_params()?;\n    decoder.read_box_order_params()?;\n    decoder.read_peg_to_stock_or_vol_order_params()?;\n    decoder.read_display_size()?;\n    decoder.read_sweep_to_fill()?;\n    decoder.read_all_or_none()?;\n    decoder.read_min_qty()?;\n    decoder.read_oca_type()?;\n    decoder.read_trigger_method()?;\n    decoder.read_volatility_order_params(false)?;\n    decoder.read_trail_params()?;\n    decoder.read_combo_legs()?;\n    decoder.read_smart_combo_routing_params()?;\n    decoder.read_scale_order_params()?;\n    decoder.read_hedge_params()?;\n    decoder.read_clearing_params()?;\n    decoder.read_not_held()?;\n    decoder.read_delta_neutral()?;\n    decoder.read_algo_params()?;\n    decoder.read_solicited()?;\n    decoder.read_order_status()?;\n    decoder.read_vol_randomize_flags()?;\n    decoder.read_peg_to_bench_params()?;\n    decoder.read_conditions()?;\n    decoder.read_stop_price_and_limit_price_offset()?;\n    decoder.read_cash_qty()?;\n    decoder.read_dont_use_auto_price_for_hedge()?;\n    decoder.read_is_oms_container()?;\n    decoder.read_auto_cancel_date()?;\n    decoder.read_filled_quantity()?;\n    decoder.read_ref_futures_contract_id()?;\n    decoder.read_auto_cancel_parent()?;\n    decoder.read_shareholder()?;\n    decoder.read_imbalance_only()?;\n    decoder.read_route_marketable_to_bbo()?;\n    decoder.read_parent_perm_id()?;\n    decoder.read_completed_time()?;\n    decoder.read_completed_status()?;\n    decoder.read_peg_best_peg_mid_order_attributes()?;\n\n    Ok(decoder.into_order_data())\n}\n","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":17,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":88,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":114,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":118,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":128,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":129,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":132,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":154,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":166,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":174,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":182,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":187,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":190,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":193,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":199,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":202,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":203,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":206,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":209,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":210,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":211,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":212,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":215,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":216,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":217,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":220,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":221,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":225,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":227,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":230,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":232,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":235,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":236,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":237,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":240,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":242,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":245,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":246,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":249,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":250,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":253,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":254,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":258,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":262,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":263,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":264,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":267,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":268,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":269,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":270,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":271,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":273,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":274,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":275,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":276,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":277,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":278,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":279,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":282,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":283,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":287,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":293,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":300,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":301,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":305,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":307,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":309,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":312,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":315,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":316,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":321,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":325,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":326,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":330,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":334,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":337,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":342,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":343,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":345,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":350,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":353,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":354,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":355,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":356,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":358,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":359,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":360,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":361,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":362,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":365,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":366,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":370,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":374,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":375,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":376,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":378,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":381,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":382,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":383,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":387,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":388,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":389,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":392,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":393,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":397,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":398,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":401,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":403,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":406,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":411,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":412,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":415,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":416,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":424,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":425,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":426,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":429,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":430,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":431,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":433,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":435,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":436,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":438,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":439,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":443,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":444,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":445,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":446,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":447,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":451,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":454,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":455,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":457,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":460,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":461,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":462,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":463,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":464,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":465,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":466,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":471,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":472,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":473,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":474,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":475,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":476,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":478,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":479,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":480,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":486,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":487,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":489,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":490,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":491,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":492,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":493,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":494,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":495,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":497,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":500,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":504,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":505,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":508,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":511,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":512,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":513,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":515,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":518,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":519,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":520,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":522,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":525,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":526,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":527,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":529,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":532,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":533,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":534,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":536,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":539,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":540,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":541,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":543,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":546,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":547,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":548,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":550,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":553,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":554,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":555,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":557,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":560,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":561,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":562,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":564,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":567,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":568,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":569,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":570,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":571,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":572,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":573,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":575,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":579,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":580,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":583,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":584,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":585,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":586,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":590,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":591,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":594,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":595,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":596,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":599,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":600,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":601,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":605,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":606,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":609,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":610,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":611,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":614,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":615,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":616,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":619,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":620,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":621,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":625,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":626,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":630,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":631,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":634,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":636,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":637,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":638,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":639,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":644,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":645,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":647,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":648,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":651,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":654,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":655,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":656,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":657,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":658,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":659,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":660,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":661,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":662,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":663,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":664,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":665,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":666,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":667,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":668,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":669,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":670,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":671,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":672,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":673,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":674,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":675,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":676,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":677,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":678,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":679,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":680,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":681,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":682,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":683,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":684,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":685,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":686,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":687,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":688,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":689,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":690,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":691,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":692,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":693,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":694,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":695,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":696,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":697,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":698,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":699,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":700,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":701,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":702,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":703,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":704,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":705,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":706,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":707,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":708,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":709,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":710,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":711,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":712,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":713,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":714,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":715,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":716,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":717,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":718,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":719,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":720,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":722,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":725,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":726,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":728,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":729,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":732,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":734,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":735,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":736,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":737,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":738,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":739,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":740,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":741,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":742,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":743,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":745,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":746,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":749,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":752,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":753,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":755,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":756,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":759,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":760,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":761,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":763,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":764,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":765,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":766,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":767,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":768,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":769,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":770,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":771,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":772,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":773,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":774,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":775,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":776,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":777,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":778,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":779,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":780,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":781,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":782,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":783,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":784,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":785,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":786,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":787,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":788,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":789,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":790,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":791,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":793,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":794,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":797,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":798,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":801,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":804,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":805,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":806,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":808,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":809,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":810,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":811,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":812,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":813,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":814,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":818,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":819,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":821,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":822,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":825,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":826,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":827,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":828,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":829,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":830,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":831,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":832,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":833,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":834,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":835,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":836,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":837,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":838,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":839,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":840,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":841,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":842,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":843,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":844,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":845,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":846,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":847,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":848,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":849,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":850,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":851,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":852,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":853,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":854,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":855,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":856,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":857,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":858,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":859,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":860,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":861,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":862,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":863,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":864,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":865,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":866,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":867,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":868,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":869,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":870,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":871,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":872,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":873,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":874,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":875,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":876,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":877,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":878,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":879,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":880,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":881,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":882,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":883,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":884,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":885,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":887,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":532,"coverable":586},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders","encoders.rs"],"content":"use super::*;\n\npub fn encode_place_order(server_version: i32, order_id: i32, contract: \u0026Contract, order: \u0026Order) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n    let message_version = message_version_for(server_version);\n\n    message.push_field(\u0026OutgoingMessages::PlaceOrder);\n\n    if server_version \u003c server_versions::ORDER_CONTAINER {\n        message.push_field(\u0026message_version);\n    }\n\n    message.push_field(\u0026order_id);\n\n    if server_version \u003e= server_versions::PLACE_ORDER_CONID {\n        message.push_field(\u0026contract.contract_id);\n    }\n    message.push_field(\u0026contract.symbol);\n    message.push_field(\u0026contract.security_type);\n    message.push_field(\u0026contract.last_trade_date_or_contract_month);\n    message.push_field(\u0026contract.strike);\n    message.push_field(\u0026contract.right);\n    message.push_field(\u0026contract.multiplier);\n    message.push_field(\u0026contract.exchange);\n    message.push_field(\u0026contract.primary_exchange);\n    message.push_field(\u0026contract.currency);\n    message.push_field(\u0026contract.local_symbol);\n    if server_version \u003e= server_versions::TRADING_CLASS {\n        message.push_field(\u0026contract.trading_class);\n    }\n    if server_version \u003e= server_versions::SEC_ID_TYPE {\n        message.push_field(\u0026contract.security_id_type);\n        message.push_field(\u0026contract.security_id);\n    }\n\n    message.push_field(\u0026order.action);\n\n    if server_version \u003e= server_versions::FRACTIONAL_POSITIONS {\n        message.push_field(\u0026order.total_quantity);\n    } else {\n        message.push_field(\u0026(order.total_quantity as i32));\n    }\n\n    message.push_field(\u0026order.order_type);\n    if server_version \u003c server_versions::ORDER_COMBO_LEGS_PRICE {\n        message.push_field(\u0026f64_max_to_zero(order.limit_price));\n    } else {\n        message.push_field(\u0026order.limit_price);\n    }\n    if server_version \u003c server_versions::TRAILING_PERCENT {\n        message.push_field(\u0026f64_max_to_zero(order.aux_price));\n    } else {\n        message.push_field(\u0026order.aux_price);\n    }\n\n    // extended order fields\n    message.push_field(\u0026order.tif);\n    message.push_field(\u0026order.oca_group);\n    message.push_field(\u0026order.account);\n    message.push_field(\u0026order.open_close);\n    message.push_field(\u0026order.origin);\n    message.push_field(\u0026order.order_ref);\n    message.push_field(\u0026order.transmit);\n    message.push_field(\u0026order.parent_id);\n\n    message.push_field(\u0026order.block_order);\n    message.push_field(\u0026order.sweep_to_fill);\n    message.push_field(\u0026order.display_size);\n    message.push_field(\u0026order.trigger_method);\n    message.push_field(\u0026order.outside_rth);\n\n    message.push_field(\u0026order.hidden);\n\n    // Contract combo legs for BAG requests\n    if contract.is_bag() {\n        message.push_field(\u0026contract.combo_legs.len());\n\n        for combo_leg in \u0026contract.combo_legs {\n            message.push_field(\u0026combo_leg.contract_id);\n            message.push_field(\u0026combo_leg.ratio);\n            message.push_field(\u0026combo_leg.action);\n            message.push_field(\u0026combo_leg.exchange);\n            message.push_field(\u0026combo_leg.open_close);\n\n            if server_version \u003e= server_versions::SSHORT_COMBO_LEGS {\n                message.push_field(\u0026combo_leg.short_sale_slot);\n                message.push_field(\u0026combo_leg.designated_location);\n            }\n            if server_version \u003e= server_versions::SSHORTX_OLD {\n                message.push_field(\u0026combo_leg.exempt_code);\n            }\n        }\n    }\n\n    // Order combo legs for BAG requests\n    if server_version \u003e= server_versions::ORDER_COMBO_LEGS_PRICE \u0026\u0026 contract.is_bag() {\n        message.push_field(\u0026order.order_combo_legs.len());\n\n        for combo_leg in \u0026order.order_combo_legs {\n            message.push_field(\u0026combo_leg.price);\n        }\n    }\n\n    if server_version \u003e= server_versions::SMART_COMBO_ROUTING_PARAMS \u0026\u0026 contract.is_bag() {\n        message.push_field(\u0026order.smart_combo_routing_params.len());\n\n        for tag_value in \u0026order.smart_combo_routing_params {\n            message.push_field(\u0026tag_value.tag);\n            message.push_field(\u0026tag_value.value);\n        }\n    }\n\n    message.push_field(\u0026\"\"); // deprecated sharesAllocation field\n\n    message.push_field(\u0026order.discretionary_amt);\n    message.push_field(\u0026order.good_after_time);\n    message.push_field(\u0026order.good_till_date);\n\n    message.push_field(\u0026order.fa_group);\n    message.push_field(\u0026order.fa_method);\n    message.push_field(\u0026order.fa_percentage);\n    if server_version \u003c server_versions::FA_PROFILE_DESUPPORT {\n        message.push_field(\u0026order.fa_profile);\n    }\n\n    if server_version \u003e= server_versions::MODELS_SUPPORT {\n        message.push_field(\u0026order.model_code);\n    }\n\n    message.push_field(\u0026order.short_sale_slot);\n    message.push_field(\u0026order.designated_location);\n\n    if server_version \u003e= server_versions::SSHORTX_OLD {\n        message.push_field(\u0026order.exempt_code);\n    }\n\n    message.push_field(\u0026order.oca_type);\n    message.push_field(\u0026order.rule_80_a);\n    message.push_field(\u0026order.settling_firm);\n    message.push_field(\u0026order.all_or_none);\n    message.push_field(\u0026order.min_qty);\n    message.push_field(\u0026order.percent_offset);\n    message.push_field(\u0026false);\n    message.push_field(\u0026false);\n    message.push_field(\u0026Option::\u003cf64\u003e::None);\n    message.push_field(\u0026order.auction_strategy);\n    message.push_field(\u0026order.starting_price);\n    message.push_field(\u0026order.stock_ref_price);\n    message.push_field(\u0026order.delta);\n    message.push_field(\u0026order.stock_range_lower);\n    message.push_field(\u0026order.stock_range_upper);\n\n    message.push_field(\u0026order.override_percentage_constraints);\n\n    // Volitility orders\n    message.push_field(\u0026order.volatility);\n    message.push_field(\u0026order.volatility_type);\n    message.push_field(\u0026order.delta_neutral_order_type);\n    message.push_field(\u0026order.delta_neutral_aux_price);\n\n    if server_version \u003e= server_versions::DELTA_NEUTRAL_CONID \u0026\u0026 order.is_delta_neutral() {\n        message.push_field(\u0026order.delta_neutral_con_id);\n        message.push_field(\u0026order.delta_neutral_settling_firm);\n        message.push_field(\u0026order.delta_neutral_clearing_account);\n        message.push_field(\u0026order.delta_neutral_clearing_intent);\n    }\n\n    if server_version \u003e= server_versions::DELTA_NEUTRAL_OPEN_CLOSE \u0026\u0026 order.is_delta_neutral() {\n        message.push_field(\u0026order.delta_neutral_open_close);\n        message.push_field(\u0026order.delta_neutral_short_sale);\n        message.push_field(\u0026order.delta_neutral_short_sale_slot);\n        message.push_field(\u0026order.delta_neutral_designated_location);\n    }\n\n    message.push_field(\u0026order.continuous_update);\n    message.push_field(\u0026order.reference_price_type);\n\n    message.push_field(\u0026order.trail_stop_price);\n    if server_version \u003e= server_versions::TRAILING_PERCENT {\n        message.push_field(\u0026order.trailing_percent);\n    }\n\n    if server_version \u003e= server_versions::SCALE_ORDERS {\n        if server_version \u003e= server_versions::SCALE_ORDERS2 {\n            message.push_field(\u0026order.scale_init_level_size);\n            message.push_field(\u0026order.scale_subs_level_size);\n        } else {\n            message.push_field(\u0026\"\");\n            message.push_field(\u0026order.scale_init_level_size);\n        }\n        message.push_field(\u0026order.scale_price_increment);\n    }\n\n    if server_version \u003e= server_versions::SCALE_ORDERS3 \u0026\u0026 order.is_scale_order() {\n        message.push_field(\u0026order.scale_price_adjust_value);\n        message.push_field(\u0026order.scale_price_adjust_interval);\n        message.push_field(\u0026order.scale_profit_offset);\n        message.push_field(\u0026order.scale_auto_reset);\n        message.push_field(\u0026order.scale_init_position);\n        message.push_field(\u0026order.scale_init_fill_qty);\n        message.push_field(\u0026order.scale_random_percent);\n    }\n\n    if server_version \u003e= server_versions::SCALE_TABLE {\n        message.push_field(\u0026order.scale_table);\n        message.push_field(\u0026order.active_start_time);\n        message.push_field(\u0026order.active_stop_time);\n    }\n\n    if server_version \u003e= server_versions::HEDGE_ORDERS {\n        message.push_field(\u0026order.hedge_type);\n        if !order.hedge_type.is_empty() {\n            message.push_field(\u0026order.hedge_param);\n        }\n    }\n\n    if server_version \u003e= server_versions::OPT_OUT_SMART_ROUTING {\n        message.push_field(\u0026order.opt_out_smart_routing);\n    }\n\n    if server_version \u003e= server_versions::PTA_ORDERS {\n        message.push_field(\u0026order.clearing_account);\n        message.push_field(\u0026order.clearing_intent);\n    }\n\n    if server_version \u003e= server_versions::NOT_HELD {\n        message.push_field(\u0026order.not_held);\n    }\n\n    if server_version \u003e= server_versions::DELTA_NEUTRAL {\n        if let Some(delta_neutral_contract) = \u0026contract.delta_neutral_contract {\n            message.push_field(\u0026true);\n            message.push_field(\u0026delta_neutral_contract.contract_id);\n            message.push_field(\u0026delta_neutral_contract.delta);\n            message.push_field(\u0026delta_neutral_contract.price);\n        } else {\n            message.push_field(\u0026false);\n        }\n    }\n\n    if server_version \u003e= server_versions::ALGO_ORDERS {\n        message.push_field(\u0026order.algo_strategy);\n        if !order.algo_strategy.is_empty() {\n            message.push_field(\u0026order.algo_params.len());\n            for tag_value in \u0026order.algo_params {\n                message.push_field(\u0026tag_value.tag);\n                message.push_field(\u0026tag_value.value);\n            }\n        }\n    }\n\n    if server_version \u003e= server_versions::ALGO_ID {\n        message.push_field(\u0026order.algo_id);\n    }\n\n    if server_version \u003e= server_versions::WHAT_IF_ORDERS {\n        message.push_field(\u0026order.what_if);\n    }\n\n    if server_version \u003e= server_versions::LINKING {\n        message.push_field(\u0026order.order_misc_options);\n    }\n\n    if server_version \u003e= server_versions::ORDER_SOLICITED {\n        message.push_field(\u0026order.solicited);\n    }\n\n    if server_version \u003e= server_versions::RANDOMIZE_SIZE_AND_PRICE {\n        message.push_field(\u0026order.randomize_size);\n        message.push_field(\u0026order.randomize_price);\n    }\n\n    if server_version \u003e= server_versions::PEGGED_TO_BENCHMARK {\n        if order.order_type == \"PEG BENCH\" {\n            message.push_field(\u0026order.reference_contract_id);\n            message.push_field(\u0026order.is_pegged_change_amount_decrease);\n            message.push_field(\u0026order.pegged_change_amount);\n            message.push_field(\u0026order.reference_change_amount);\n            message.push_field(\u0026order.reference_exchange);\n        }\n\n        message.push_field(\u0026order.conditions.len());\n\n        if !order.conditions.is_empty() {\n            for condition in \u0026order.conditions {\n                // verify\n                // https://github.com/InteractiveBrokers/tws-api/blob/817a905d52299028ac5af08581c8ffde7644cea9/source/csharpclient/client/EClient.cs#L1187\n                message.push_field(condition);\n            }\n\n            message.push_field(\u0026order.conditions_ignore_rth);\n            message.push_field(\u0026order.conditions_cancel_order);\n        }\n\n        message.push_field(\u0026order.adjusted_order_type);\n        message.push_field(\u0026order.trigger_price);\n        message.push_field(\u0026order.limit_price_offset);\n        message.push_field(\u0026order.adjusted_stop_price);\n        message.push_field(\u0026order.adjusted_stop_limit_price);\n        message.push_field(\u0026order.adjusted_trailing_amount);\n        message.push_field(\u0026order.adjustable_trailing_unit);\n    }\n\n    if server_version \u003e= server_versions::EXT_OPERATOR {\n        message.push_field(\u0026order.ext_operator);\n    }\n\n    if server_version \u003e= server_versions::SOFT_DOLLAR_TIER {\n        message.push_field(\u0026order.soft_dollar_tier.name);\n        message.push_field(\u0026order.soft_dollar_tier.value);\n    }\n\n    if server_version \u003e= server_versions::CASH_QTY {\n        message.push_field(\u0026order.cash_qty);\n    }\n\n    if server_version \u003e= server_versions::DECISION_MAKER {\n        message.push_field(\u0026order.mifid2_decision_maker);\n        message.push_field(\u0026order.mifid2_decision_algo);\n    }\n\n    if server_version \u003e= server_versions::MIFID_EXECUTION {\n        message.push_field(\u0026order.mifid2_execution_trader);\n        message.push_field(\u0026order.mifid2_execution_algo);\n    }\n\n    if server_version \u003e= server_versions::AUTO_PRICE_FOR_HEDGE {\n        message.push_field(\u0026order.dont_use_auto_price_for_hedge);\n    }\n\n    if server_version \u003e= server_versions::ORDER_CONTAINER {\n        message.push_field(\u0026order.is_oms_container);\n    }\n\n    if server_version \u003e= server_versions::D_PEG_ORDERS {\n        message.push_field(\u0026order.discretionary_up_to_limit_price);\n    }\n\n    if server_version \u003e= server_versions::PRICE_MGMT_ALGO {\n        message.push_field(\u0026order.use_price_mgmt_algo);\n    }\n\n    if server_version \u003e= server_versions::DURATION {\n        message.push_field(\u0026order.duration);\n    }\n\n    if server_version \u003e= server_versions::POST_TO_ATS {\n        message.push_field(\u0026order.post_to_ats);\n    }\n\n    if server_version \u003e= server_versions::AUTO_CANCEL_PARENT {\n        message.push_field(\u0026order.auto_cancel_parent);\n    }\n\n    if server_version \u003e= server_versions::ADVANCED_ORDER_REJECT {\n        message.push_field(\u0026order.advanced_error_override);\n    }\n\n    if server_version \u003e= server_versions::MANUAL_ORDER_TIME {\n        message.push_field(\u0026order.manual_order_time);\n    }\n\n    if server_version \u003e= server_versions::PEGBEST_PEGMID_OFFSETS {\n        if contract.exchange == \"IBKRATS\" {\n            message.push_field(\u0026order.min_trade_qty);\n        }\n        let mut send_mid_offsets = false;\n        if order.order_type == \"PEG BEST\" {\n            message.push_field(\u0026order.min_compete_size);\n            message.push_field(\u0026order.compete_against_best_offset);\n            if order.compete_against_best_offset == COMPETE_AGAINST_BEST_OFFSET_UP_TO_MID {\n                send_mid_offsets = true;\n            }\n        } else if order.order_type == \"PEG MID\" {\n            send_mid_offsets = true;\n        }\n        if send_mid_offsets {\n            message.push_field(\u0026order.mid_offset_at_whole);\n            message.push_field(\u0026order.mid_offset_at_half);\n        }\n    }\n\n    Ok(message)\n}\n\npub fn encode_cancel_order(server_version: i32, order_id: i32, manual_order_cancel_time: \u0026str) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::CancelOrder);\n    message.push_field(\u0026VERSION);\n    message.push_field(\u0026order_id);\n\n    if server_version \u003e= server_versions::MANUAL_ORDER_TIME {\n        message.push_field(\u0026manual_order_cancel_time);\n    }\n\n    Ok(message)\n}\n\npub fn encode_global_cancel() -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestGlobalCancel);\n    message.push_field(\u0026VERSION);\n\n    Ok(message)\n}\n\npub fn encode_next_valid_order_id() -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestIds);\n    message.push_field(\u0026VERSION);\n    message.push_field(\u00260);\n\n    Ok(message)\n}\n\npub fn encode_completed_orders(api_only: bool) -\u003e Result\u003cRequestMessage\u003e {\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::ReqCompletedOrders);\n    message.push_field(\u0026api_only);\n\n    Ok(message)\n}\n\npub fn encode_open_orders() -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestOpenOrders);\n    message.push_field(\u0026VERSION);\n\n    Ok(message)\n}\n\npub fn encode_all_open_orders() -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestAllOpenOrders);\n    message.push_field(\u0026VERSION);\n\n    Ok(message)\n}\n\npub fn encode_auto_open_orders(auto_bind: bool) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 1;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestAutoOpenOrders);\n    message.push_field(\u0026VERSION);\n    message.push_field(\u0026auto_bind);\n\n    Ok(message)\n}\n\npub fn encode_executions(server_version: i32, request_id: i32, filter: \u0026ExecutionFilter) -\u003e Result\u003cRequestMessage\u003e {\n    const VERSION: i32 = 3;\n\n    let mut message = RequestMessage::default();\n\n    message.push_field(\u0026OutgoingMessages::RequestExecutions);\n    message.push_field(\u0026VERSION);\n\n    if server_version \u003e= server_versions::EXECUTION_DATA_CHAIN {\n        message.push_field(\u0026request_id);\n    }\n\n    message.push_field(\u0026filter.client_id);\n    message.push_field(\u0026filter.account_code);\n    message.push_field(\u0026filter.time); // \"yyyyMMdd-HH:mm:ss\" (UTC) or \"yyyyMMdd HH:mm:ss timezone\"\n    message.push_field(\u0026filter.symbol);\n    message.push_field(\u0026filter.security_type);\n    message.push_field(\u0026filter.exchange);\n    message.push_field(\u0026filter.side);\n\n    Ok(message)\n}\n\nfn f64_max_to_zero(num: Option\u003cf64\u003e) -\u003e Option\u003cf64\u003e {\n    if num == Some(f64::MAX) {\n        Some(0.0)\n    } else {\n        num\n    }\n}\n\nfn message_version_for(server_version: i32) -\u003e i32 {\n    if server_version \u003c server_versions::NOT_HELD {\n        27\n    } else {\n        45\n    }\n}\n","traces":[{"line":3,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":4,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":5,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":7,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":9,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":80,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":108,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":113,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":115,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":116,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":117,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":120,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":121,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":123,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":126,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":127,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":131,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":133,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":134,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":138,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":139,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":141,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":145,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":146,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":147,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":148,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":149,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":150,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":151,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":153,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":155,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":156,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":157,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":158,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":161,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":168,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":171,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":179,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":183,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":186,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":191,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":194,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":204,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":205,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":206,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":207,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":210,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":211,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":212,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":213,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":217,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":218,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":221,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":227,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":230,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":232,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":233,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":235,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":237,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":242,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":252,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":253,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":256,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":261,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":264,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":265,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":268,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":269,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":270,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":273,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":274,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":275,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":276,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":277,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":278,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":279,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":282,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":284,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":287,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":288,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":291,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":292,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":295,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":296,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":297,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":300,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":301,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":304,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":305,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":309,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":310,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":317,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":318,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":319,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":324,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":327,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":328,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":335,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":336,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":339,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":343,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":344,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":347,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":348,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":351,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":352,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":355,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":356,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":359,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":360,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":363,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":364,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":365,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":367,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":368,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":369,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":370,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":371,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":372,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":374,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":375,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":378,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":379,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":383,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":389,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":391,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":392,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":393,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":396,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":402,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":405,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":407,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":408,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":413,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":416,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":418,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":419,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":420,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":422,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":425,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":426,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":428,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":429,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":431,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":434,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":439,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":442,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":445,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":451,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":453,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":456,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":459,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":461,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":462,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":463,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":465,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":471,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":473,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":474,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":476,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":477,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":480,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":481,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":482,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":485,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":486,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":491,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":492,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":493,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":495,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":499,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":500,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":3},"fn_name":null}],"covered":245,"coverable":308},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders","order_builder.rs"],"content":"use super::{Action, Order, OrderComboLeg, TagValue};\n\n/// An auction order is entered into the electronic trading system during the pre-market opening period for execution at the\n/// Calculated Opening Price (COP). If your order is not filled on the open, the order is re-submitted as a limit order with\n/// the limit price set to the COP or the best bid/ask after the market opens.\n/// Products: FUT, STK\npub fn at_auction(action: Action, quantity: f64, price: f64) -\u003e Order {\n    Order {\n        action,\n        tif: \"AUC\".to_owned(),\n        order_type: \"MTL\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        ..Order::default()\n    }\n}\n\n/// A Discretionary order is a limit order submitted with a hidden, specified 'discretionary' amount off the limit price which\n/// may be used to increase the price range over which the limit order is eligible to execute. The market sees only the limit price.\n/// Products: STK\npub fn discretionary(action: Action, quantity: f64, price: f64, discretionary_amount: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        discretionary_amt: discretionary_amount,\n        ..Order::default()\n    }\n}\n\n/// A Market order is an order to buy or sell at the market bid or offer price. A market order may increase the likelihood of a fill\n/// and the speed of execution, but unlike the Limit order a Market order provides no price protection and may fill at a price far\n/// lower/higher than the current displayed bid/ask.\n/// Products: BOND, CFD, EFP, CASH, FUND, FUT, FOP, OPT, STK, WAR\npub fn market_order(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MKT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// A Market if Touched (MIT) is an order to buy (or sell) a contract below (or above) the market. Its purpose is to take advantage\n/// of sudden or unexpected changes in share or other prices and provides investors with a trigger price to set an order in motion.\n/// Investors may be waiting for excessive strength (or weakness) to cease, which might be represented by a specific price point.\n/// MIT orders can be used to determine whether or not to enter the market once a specific price level has been achieved. This order\n/// is held in the system until the trigger price is touched, and is then submitted as a market order. An MIT order is similar to a\n/// stop order, except that an MIT sell order is placed above the current market price, and a stop sell order is placed below\n/// Products: BOND, CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn market_if_touched(action: Action, quantity: f64, price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MIT\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(price),\n        ..Order::default()\n    }\n}\n\n/// A Market-on-Close (MOC) order is a market order that is submitted to execute as close to the closing price as possible.\n/// Products: CFD, FUT, STK, WAR\npub fn market_on_close(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MOC\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// A Market-on-Open (MOO) order combines a market order with the OPG time in force to create an order that is automatically\n/// submitted at the market's open and fills at the market price.\n/// Products: CFD, STK, OPT, WAR\npub fn market_on_open(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MKT\".to_owned(),\n        total_quantity: quantity,\n        tif: \"OPG\".to_owned(),\n        ..Order::default()\n    }\n}\n\n/// ISE Midpoint Match (MPM) orders always execute at the midpoint of the NBBO. You can submit market and limit orders direct-routed\n/// to ISE for MPM execution. Market orders execute at the midpoint whenever an eligible contra-order is available. Limit orders\n/// execute only when the midpoint price is better than the limit price. Standard MPM orders are completely anonymous.\n/// Products: STK\npub fn midpoint_match(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MKT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n// A Midprice order is designed to split the difference between the bid and ask prices, and fill at the current midpoint of\n// the NBBO or better. Set an optional price cap to define the highest price (for a buy order) or the lowest price (for a sell\n// order) you are willing to accept. Requires TWS 975+. Smart-routing to US stocks only.\npub fn midprice(action: Action, quantity: f64, price_cap: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MIDPRICE\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price_cap),\n        ..Order::default()\n    }\n}\n\n/// A pegged-to-market order is designed to maintain a purchase price relative to the national best offer (NBO) or a sale price\n/// relative to the national best bid (NBB). Depending on the width of the quote, this order may be passive or aggressive.\n/// The trader creates the order by entering a limit price which defines the worst limit price that they are willing to accept.\n/// Next, the trader enters an offset amount which computes the active limit price as follows:\n///     Sell order price = Bid price + offset amount\n///     Buy order price = Ask price - offset amount\n/// Products: STK\npub fn pegged_to_market(action: Action, quantity: f64, market_offset: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG MKT\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(market_offset),\n        ..Order::default()\n    }\n}\n\n/// A Pegged to Stock order continually adjusts the option order price by the product of a signed user-define delta and the change of\n/// the option's underlying stock price. The delta is entered as an absolute and assumed to be positive for calls and negative for puts.\n/// A buy or sell call order price is determined by adding the delta times a change in an underlying stock price to a specified starting\n/// price for the call. To determine the change in price, the stock reference price is subtracted from the current NBBO midpoint.\n/// The Stock Reference Price can be defined by the user, or defaults to the NBBO midpoint at the time of the order if no reference price\n/// is entered. You may also enter a high/low stock price range which cancels the order when reached. The delta times the change in stock\n/// price will be rounded to the nearest penny in favor of the order.\n/// Products: OPT\npub fn pegged_to_stock(action: Action, quantity: f64, delta: f64, stock_reference_price: f64, starting_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG STK\".to_owned(),\n        total_quantity: quantity,\n        delta: Some(delta),\n        stock_ref_price: Some(stock_reference_price),\n        starting_price: Some(starting_price),\n        ..Order::default()\n    }\n}\n\n/// Relative (a.k.a. Pegged-to-Primary) orders provide a means for traders to seek a more aggressive price than the National Best Bid\n/// and Offer (NBBO). By acting as liquidity providers, and placing more aggressive bids and offers than the current best bids and offers,\n/// traders increase their odds of filling their order. Quotes are automatically adjusted as the markets move, to remain aggressive.\n/// For a buy order, your bid is pegged to the NBB by a more aggressive offset, and if the NBB moves up, your bid will also move up.\n/// If the NBB moves down, there will be no adjustment because your bid will become even more aggressive and execute. For sales, your\n/// offer is pegged to the NBO by a more aggressive offset, and if the NBO moves down, your offer will also move down. If the NBO moves up,\n/// there will be no adjustment because your offer will become more aggressive and execute. In addition to the offset, you can define an\n/// absolute cap, which works like a limit price, and will prevent your order from being executed above or below a specified level.\n/// Stocks, Options and Futures - not available on paper trading\n/// Products: CFD, STK, OPT, FUT\npub fn relative_pegged_to_primary(action: Action, quantity: f64, price_cap: f64, offset_amount: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"REL\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price_cap),\n        aux_price: Some(offset_amount),\n        ..Order::default()\n    }\n}\n\n/// Sweep-to-fill orders are useful when a trader values speed of execution over price. A sweep-to-fill order identifies the best price\n/// and the exact quantity offered/available at that price, and transmits the corresponding portion of your order for immediate execution.\n/// Simultaneously it identifies the next best price and quantity offered/available, and submits the matching quantity of your order for\n/// immediate execution.\n/// Products: CFD, STK, WAR\npub fn sweep_to_fill(action: Action, quantity: f64, price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        sweep_to_fill: true,\n        ..Order::default()\n    }\n}\n\n/// For option orders routed to the Boston Options Exchange (BOX) you may elect to participate in the BOX's price improvement auction in\n/// pennies. All BOX-directed price improvement orders are immediately sent from Interactive Brokers to the BOX order book, and when the\n/// terms allow, IB will evaluate it for inclusion in a price improvement auction based on price and volume priority. In the auction, your\n/// order will have priority over broker-dealer price improvement orders at the same price.\n/// An Auction Limit order at a specified price. Use of a limit order ensures that you will not receive an execution at a price less favorable\n/// than the limit price. Enter limit orders in penny increments with your auction improvement amount computed as the difference between your\n/// limit order price and the nearest listed increment.\n/// Products: OPT\n/// Supported Exchanges: BOX\npub fn auction_limit(action: Action, quantity: f64, price: f64, auction_strategy: i32) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        auction_strategy: Some(auction_strategy),\n        ..Order::default()\n    }\n}\n\n/// For option orders routed to the Boston Options Exchange (BOX) you may elect to participate in the BOX's price improvement auction in pennies.\n/// All BOX-directed price improvement orders are immediately sent from Interactive Brokers to the BOX order book, and when the terms allow,\n/// IB will evaluate it for inclusion in a price improvement auction based on price and volume priority. In the auction, your order will have\n/// priority over broker-dealer price improvement orders at the same price.\n/// An Auction Pegged to Stock order adjusts the order price by the product of a signed delta (which is entered as an absolute and assumed to be\n/// positive for calls, negative for puts) and the change of the option's underlying stock price. A buy or sell call order price is determined\n/// by adding the delta times a change in an underlying stock price change to a specified starting price for the call. To determine the change\n/// in price, a stock reference price (NBBO midpoint at the time of the order is assumed if no reference price is entered) is subtracted from\n/// the current NBBO midpoint. A stock range may also be entered that cancels an order when reached. The delta times the change in stock price\n/// will be rounded to the nearest penny in favor of the order and will be used as your auction improvement amount.\n/// Products: OPT\n/// Supported Exchanges: BOX\npub fn auction_pegged_to_stock(action: Action, quantity: f64, starting_price: f64, delta: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG STK\".to_owned(),\n        total_quantity: quantity,\n        delta: Some(delta),\n        starting_price: Some(starting_price),\n        ..Order::default()\n    }\n}\n\n/// For option orders routed to the Boston Options Exchange (BOX) you may elect to participate in the BOX's price improvement auction in pennies.\n/// All BOX-directed price improvement orders are immediately sent from Interactive Brokers to the BOX order book, and when the terms allow,\n/// IB will evaluate it for inclusion in a price improvement auction based on price and volume priority. In the auction, your order will have\n/// priority over broker-dealer price improvement orders at the same price.\n/// An Auction Relative order that adjusts the order price by the product of a signed delta (which is entered as an absolute and assumed to be\n/// positive for calls, negative for puts) and the change of the option's underlying stock price. A buy or sell call order price is determined\n/// by adding the delta times a change in an underlying stock price change to a specified starting price for the call. To determine the change\n/// in price, a stock reference price (NBBO midpoint at the time of the order is assumed if no reference price is entered) is subtracted from\n/// the current NBBO midpoint. A stock range may also be entered that cancels an order when reached. The delta times the change in stock price\n/// will be rounded to the nearest penny in favor of the order and will be used as your auction improvement amount.\n/// Products: OPT\n/// Supported Exchanges: BOX\npub fn auction_relative(action: Action, quantity: f64, offset: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"REL\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(offset),\n        ..Order::default()\n    }\n}\n\n/// The Block attribute is used for large volume option orders on ISE that consist of at least 50 contracts. To execute large-volume\n/// orders over time without moving the market, use the Accumulate/Distribute algorithm.\n/// Products: OPT\npub fn block(action: Action, quantity: f64, price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(price),\n        block_order: true,\n        ..Order::default()\n    }\n}\n\n/// A Box Top order executes as a market order at the current best price. If the order is only partially filled, the remainder is submitted as\n/// a limit order with the limit price equal to the price at which the filled portion of the order executed.\n/// Products: OPT\n/// Supported Exchanges: BOX\npub fn box_top(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"BOX TOP\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// A Limit order is an order to buy or sell at a specified price or better. The Limit order ensures that if the order fills,\n/// it will not fill at a price less favorable than your limit price, but it does not guarantee a fill.\n/// Products: BOND, CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn limit_order(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        ..Order::default()\n    }\n}\n\n/// Forex orders can be placed in demonination of second currency in pair using cash_qty field\n/// Requires TWS or IBG 963+\n/// https://www.interactivebrokers.com/en/index.php?f=23876#963-02\npub fn limit_order_with_cash_qty(action: Action, limit_price: f64, cash_qty: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        limit_price: Some(limit_price),\n        cash_qty: Some(cash_qty),\n        ..Order::default()\n    }\n}\n\n/// A Limit if Touched is an order to buy (or sell) a contract at a specified price or better, below (or above) the market. This order is\n/// held in the system until the trigger price is touched. An LIT order is similar to a stop limit order, except that an LIT sell order is\n/// placed above the current market price, and a stop limit sell order is placed below.\n/// Products: BOND, CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn limit_if_touched(action: Action, quantity: f64, limit_price: f64, trigger_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LIT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        aux_price: Some(trigger_price),\n        ..Order::default()\n    }\n}\n\n/// A Limit-on-close (LOC) order will be submitted at the close and will execute if the closing price is at or better than the submitted\n/// limit price.\n/// Products: CFD, FUT, STK, WAR\npub fn limit_on_close(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LOC\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        ..Order::default()\n    }\n}\n\n/// A Limit-on-Open (LOO) order combines a limit order with the OPG time in force to create an order that is submitted at the market's open,\n/// and that will only execute at the specified limit price or better. Orders are filled in accordance with specific exchange rules.\n/// Products: CFD, STK, OPT, WAR\npub fn limit_on_open(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        tif: \"OPG\".to_owned(),\n        ..Order::default()\n    }\n}\n\n/// Passive Relative orders provide a means for traders to seek a less aggressive price than the National Best Bid and Offer (NBBO) while\n/// keeping the order pegged to the best bid (for a buy) or ask (for a sell). The order price is automatically adjusted as the markets move\n/// to keep the order less aggressive. For a buy order, your order price is pegged to the NBB by a less aggressive offset, and if the NBB\n/// moves up, your bid will also move up. If the NBB moves down, there will be no adjustment because your bid will become aggressive and execute.\n/// For a sell order, your price is pegged to the NBO by a less aggressive offset, and if the NBO moves down, your offer will also move down.\n/// If the NBO moves up, there will be no adjustment because your offer will become aggressive and execute. In addition to the offset, you can\n/// define an absolute cap, which works like a limit price, and will prevent your order from being executed above or below a specified level.\n/// The Passive Relative order is similar to the Relative/Pegged-to-Primary order, except that the Passive relative subtracts the offset from\n/// the bid and the Relative adds the offset to the bid.\n/// Products: STK, WAR\npub fn passive_relative(action: Action, quantity: f64, offset: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PASSV REL\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(offset),\n        ..Order::default()\n    }\n}\n\n/// A pegged-to-midpoint order provides a means for traders to seek a price at the midpoint of the National Best Bid and Offer (NBBO).\n/// The price automatically adjusts to peg the midpoint as the markets move, to remain aggressive. For a buy order, your bid is pegged to\n/// the NBBO midpoint and the order price adjusts automatically to continue to peg the midpoint if the market moves. The price only adjusts\n/// to be more aggressive. If the market moves in the opposite direction, the order will execute.\n/// Products: STK\npub fn pegged_to_midpoint(action: Action, quantity: f64, offset: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG MID\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(offset),\n        limit_price: Some(limit_price),\n        ..Order::default()\n    }\n}\n\n/// Bracket orders are designed to help limit your loss and lock in a profit by \"bracketing\" an order with two opposite-side orders.\n/// A BUY order is bracketed by a high-side sell limit order and a low-side sell stop order. A SELL order is bracketed by a high-side buy\n/// stop order and a low side buy limit order.\n/// Products: CFD, BAG, FOP, CASH, FUT, OPT, STK, WAR\npub fn bracket_order(\n    parent_order_id: i32,\n    action: Action,\n    quantity: f64,\n    limit_price: f64,\n    take_profit_limit_price: f64,\n    stop_loss_price: f64,\n) -\u003e Vec\u003cOrder\u003e {\n    //This will be our main or \"parent\" order\n    let parent = Order {\n        order_id: parent_order_id,\n        action: action.clone(),\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        transmit: false,\n        ..Order::default()\n    };\n\n    let take_profit = Order {\n        order_id: parent.order_id + 1,\n        action: action.reverse(),\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(take_profit_limit_price),\n        parent_id: parent_order_id,\n        transmit: false,\n        ..Order::default()\n    };\n\n    let stop_loss = Order {\n        order_id: parent.order_id + 2,\n        action: action.reverse(),\n        order_type: \"STP\".to_owned(),\n        //Stop trigger price\n        aux_price: Some(stop_loss_price),\n        total_quantity: quantity,\n        parent_id: parent_order_id,\n        //In this case, the low side order will be the last child being sent. Therefore, it needs to set this attribute to true\n        //to activate all its predecessors\n        transmit: true,\n        ..Order::default()\n    };\n\n    vec![parent, take_profit, stop_loss]\n}\n\n/// Products:CFD, FUT, FOP, OPT, STK, WAR\n/// A Market-to-Limit (MTL) order is submitted as a market order to execute at the current best market price. If the order is only\n/// partially filled, the remainder of the order is canceled and re-submitted as a limit order with the limit price equal to the price\n/// at which the filled portion of the order executed.\npub fn market_to_limit(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MTL\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// This order type is useful for futures traders using Globex. A Market with Protection order is a market order that will be cancelled and\n/// resubmitted as a limit order if the entire order does not immediately execute at the market price. The limit price is set by Globex to be\n/// close to the current market price, slightly higher for a sell order and lower for a buy order.\n/// Products: FUT, FOP\npub fn market_with_protection(action: Action, quantity: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"MKT PRT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    }\n}\n\n/// A Stop order is an instruction to submit a buy or sell market order if and when the user-specified stop trigger price is attained or\n/// penetrated. A Stop order is not guaranteed a specific execution price and may execute significantly away from its stop price. A Sell\n/// Stop order is always placed below the current market price and is typically used to limit a loss or protect a profit on a long stock\n/// position. A Buy Stop order is always placed above the current market price. It is typically used to limit a loss or help protect a\n/// profit on a short sale.\n/// Products: CFD, BAG, CASH, FUT, FOP, OPT, STK, WAR\npub fn stop(action: Action, quantity: f64, stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"STP\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(stop_price),\n        ..Order::default()\n    }\n}\n\n/// A Stop-Limit order is an instruction to submit a buy or sell limit order when the user-specified stop trigger price is attained or\n/// penetrated. The order has two basic components: the stop price and the limit price. When a trade has occurred at or through the stop\n/// price, the order becomes executable and enters the market as a limit order, which is an order to buy or sell at a specified price or better.\n/// Products: CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn stop_limit(action: Action, quantity: f64, limit_price: f64, stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"STP LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        aux_price: Some(stop_price),\n        ..Order::default()\n    }\n}\n\n/// A Stop with Protection order combines the functionality of a stop limit order with a market with protection order. The order is set\n/// to trigger at a specified stop price. When the stop price is penetrated, the order is triggered as a market with protection order,\n/// which means that it will fill within a specified protected price range equal to the trigger price +/- the exchange-defined protection\n/// point range. Any portion of the order that does not fill within this protected range is submitted as a limit order at the exchange-defined\n/// trigger price +/- the protection points.\n/// Products: FUT\npub fn stop_with_protection(action: Action, quantity: f64, stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"STP PRT\".to_owned(),\n        total_quantity: quantity,\n        aux_price: Some(stop_price),\n        ..Order::default()\n    }\n}\n\n/// A sell trailing stop order sets the stop price at a fixed amount below the market price with an attached \"trailing\" amount. As the\n/// market price rises, the stop price rises by the trail amount, but if the stock price falls, the stop loss price doesn't change,\n/// and a market order is submitted when the stop price is hit. This technique is designed to allow an investor to specify a limit on the\n/// maximum possible loss, without setting a limit on the maximum possible gain. \"Buy\" trailing stop orders are the mirror image of sell\n/// trailing stop orders, and are most appropriate for use in falling markets.\n/// Products: CFD, CASH, FOP, FUT, OPT, STK, WAR\npub fn trailing_stop(action: Action, quantity: f64, trailing_percent: f64, trail_stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"TRAIL\".to_owned(),\n        total_quantity: quantity,\n        trailing_percent: Some(trailing_percent),\n        trail_stop_price: Some(trail_stop_price),\n        ..Order::default()\n    }\n}\n\n/// A trailing stop limit order is designed to allow an investor to specify a limit on the maximum possible loss, without setting a limit\n/// on the maximum possible gain. A SELL trailing stop limit moves with the market price, and continually recalculates the stop trigger\n/// price at a fixed amount below the market price, based on the user-defined \"trailing\" amount. The limit order price is also continually\n/// recalculated based on the limit offset. As the market price rises, both the stop price and the limit price rise by the trail amount and\n/// limit offset respectively, but if the stock price falls, the stop price remains unchanged, and when the stop price is hit a limit order\n/// is submitted at the last calculated limit price. A \"Buy\" trailing stop limit order is the mirror image of a sell trailing stop limit,\n/// and is generally used in falling markets.\n/// Products: BOND, CFD, CASH, FUT, FOP, OPT, STK, WAR\npub fn trailing_stop_limit(action: Action, quantity: f64, lmt_price_offset: f64, trailing_amount: f64, trail_stop_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"TRAIL LIMIT\".to_owned(),\n        total_quantity: quantity,\n        trail_stop_price: Some(trail_stop_price),\n        limit_price_offset: Some(lmt_price_offset),\n        aux_price: Some(trailing_amount),\n        ..Order::default()\n    }\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn combo_limit_order(action: Action, quantity: f64, limit_price: f64, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        ..Order::default()\n    };\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\nfn tag_order_non_guaranteed(mut order: Order) -\u003e Order {\n    order.smart_combo_routing_params = vec![];\n    order.smart_combo_routing_params.push(TagValue {\n        tag: \"NonGuaranteed\".to_owned(),\n        value: \"1\".to_owned(),\n    });\n    order\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn combo_market_order(action: Action, quantity: f64, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"MKT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    };\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn limit_order_for_combo_with_leg_prices(action: Action, quantity: f64, leg_prices: Vec\u003cf64\u003e, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        order_combo_legs: vec![],\n        ..Order::default()\n    };\n\n    for price in leg_prices {\n        order.order_combo_legs.push(OrderComboLeg { price: Some(price) });\n    }\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn relative_limit_combo(action: Action, quantity: f64, limit_price: f64, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"REL + LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        ..Order::default()\n    };\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\n/// Create combination orders that include options, stock and futures legs (stock legs can be included if the order is routed\n/// through SmartRouting). Although a combination/spread order is constructed of separate legs, it is executed as a single transaction\n/// if it is routed directly to an exchange. For combination orders that are SmartRouted, each leg may be executed separately to ensure\n/// best execution.\n/// Products: OPT, STK, FUT\npub fn relative_market_combo(action: Action, quantity: f64, non_guaranteed: bool) -\u003e Order {\n    let mut order = Order {\n        action,\n        order_type: \"REL + MKT\".to_owned(),\n        total_quantity: quantity,\n        ..Order::default()\n    };\n\n    if non_guaranteed {\n        order = tag_order_non_guaranteed(order)\n    }\n\n    order\n}\n\n/// One-Cancels All (OCA) order type allows an investor to place multiple and possibly unrelated orders assigned to a group. The aim is\n/// to complete just one of the orders, which in turn will cause TWS to cancel the remaining orders. The investor may submit several\n/// orders aimed at taking advantage of the most desirable price within the group. Completion of one piece of the group order causes\n/// cancellation of the remaining group orders while partial completion causes the group to rebalance. An investor might desire to sell\n/// 1000 shares of only ONE of three positions held above prevailing market prices. The OCA order group allows the investor to enter prices\n/// at specified target levels and if one is completed, the other two will automatically cancel. Alternatively, an investor may wish to take\n/// a LONG position in eMini S\u0026P stock index futures in a falling market or else SELL US treasury futures at a more favorable price.\n/// Grouping the two orders using an OCA order type offers the investor two chance to enter a similar position, while only running the risk\n/// of taking on a single position.\n/// Products: BOND, CASH, FUT, FOP, STK, OPT, WAR\npub fn one_cancels_all(oca_group: \u0026str, mut oca_orders: Vec\u003cOrder\u003e, oca_type: i32) -\u003e Vec\u003cOrder\u003e {\n    for order in \u0026mut oca_orders {\n        order.oca_group = oca_group.to_owned();\n        order.oca_type = oca_type;\n    }\n\n    oca_orders\n}\n\n/// Specific to US options, investors are able to create and enter Volatility-type orders for options and combinations rather than price orders.\n/// Option traders may wish to trade and position for movements in the price of the option determined by its implied volatility. Because\n/// implied volatility is a key determinant of the premium on an option, traders position in specific contract months in an effort to take\n/// advantage of perceived changes in implied volatility arising before, during or after earnings or when company specific or broad market\n/// volatility is predicted to change. In order to create a Volatility order, clients must first create a Volatility Trader page from the\n/// Trading Tools menu and as they enter option contracts, premiums will display in percentage terms rather than premium. The buy/sell process\n/// is the same as for regular orders priced in premium terms except that the client can limit the volatility level they are willing to pay or\n/// receive.\n/// Products: FOP, OPT\npub fn volatility(action: Action, quantity: f64, volatility_percent: f64, volatility_type: i32) -\u003e Order {\n    Order {\n        action,\n        order_type: \"VOL\".to_owned(),\n        total_quantity: quantity,\n        volatility: Some(volatility_percent),   //Expressed in percentage (40%)\n        volatility_type: Some(volatility_type), // 1=daily, 2=annual\n        ..Order::default()\n    }\n}\n\npub fn market_f_hedge(parent_order_id: i32, action: Action) -\u003e Order {\n    //FX Hedge orders can only have a quantity of 0\n    let mut order = market_order(action, 0.0);\n    order.parent_id = parent_order_id;\n    order.hedge_type = \"F\".to_owned();\n\n    order\n}\n\npub fn pegged_to_benchmark(\n    action: Action,\n    quantity: f64,\n    starting_price: f64,\n    pegged_change_amount_decrease: bool,\n    pegged_change_amount: f64,\n    reference_change_amount: f64,\n    reference_contract_id: i32,\n    reference_exchange: \u0026str,\n    stock_reference_price: f64,\n    reference_contract_lower_range: f64,\n    reference_contract_upper_range: f64,\n) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG BENCH\".to_owned(),\n        total_quantity: quantity,\n        starting_price: Some(starting_price),\n        is_pegged_change_amount_decrease: pegged_change_amount_decrease,\n        pegged_change_amount: Some(pegged_change_amount), // by ... (and likewise for price moving in opposite direction)\n        reference_change_amount: Some(reference_change_amount), // whenever there is a price change of ...\n        reference_contract_id,                            // in the reference contract ...\n        reference_exchange: reference_exchange.to_owned(), // being traded at ...\n        stock_ref_price: Some(stock_reference_price),     // starting reference price is ...\n        //Keep order active as long as reference contract trades between ...\n        stock_range_lower: Some(reference_contract_lower_range),\n        stock_range_upper: Some(reference_contract_upper_range),\n        ..Order::default()\n    }\n}\n\n/// An attached order that turns the parent order (a conventional STP order) into a STP order\n/// in the opposite direction when the trigger is hit.\npub fn attach_adjustable_to_stop(parent: \u0026Order, attached_order_stop_price: f64, trigger_price: f64, adjusted_stop_price: f64) -\u003e Order {\n    // Attached order is a conventional STP order\n    let mut order = stop(parent.action.reverse(), parent.total_quantity, attached_order_stop_price);\n\n    order.parent_id = parent.order_id;\n    order.trigger_price = Some(trigger_price); // When trigger price is penetrated\n    order.adjusted_order_type = \"STP\".to_owned(); // The parent order will be turned into a STP order\n    order.adjusted_stop_price = Some(adjusted_stop_price); // With the given STP price\n\n    order\n}\n\n/// An attached order that turns the parent order (a conventional STP order) into a STP LMT order\n/// in the opposite direction when the trigger is hit.\npub fn attach_adjustable_to_stop_limit(\n    parent: \u0026Order,\n    attached_order_stop_price: f64,\n    trigger_price: f64,\n    adjusted_stop_price: f64,\n    adjusted_stop_limit_price: f64,\n) -\u003e Order {\n    // Attached order is a conventional STP order\n    let mut order = stop(parent.action.reverse(), parent.total_quantity, attached_order_stop_price);\n\n    order.parent_id = parent.order_id;\n    order.trigger_price = Some(trigger_price); // When trigger price is penetrated\n    order.adjusted_order_type = \"STP LMT\".to_owned(); // The parent order will be turned into a STP LMT order\n    order.adjusted_stop_price = Some(adjusted_stop_price); // With the given STP price\n    order.adjusted_stop_limit_price = Some(adjusted_stop_limit_price); // And the given limit price\n\n    order\n}\n\n/// An attached order that turns the parent order (a conventional STP order) into a\n/// TRAIL order in the opposite direction when the trigger is hit.\npub fn attach_adjustable_to_trail(\n    parent: \u0026Order,\n    attached_order_stop_price: f64,\n    trigger_price: f64,\n    adjusted_stop_price: f64,\n    adjusted_trail_amount: f64,\n    trail_unit: i32,\n) -\u003e Order {\n    // Attached order is a conventional STP order\n    let mut order = stop(parent.action.reverse(), parent.total_quantity, attached_order_stop_price);\n\n    order.parent_id = parent.order_id;\n    order.trigger_price = Some(trigger_price); // When trigger price is penetrated\n    order.adjusted_order_type = \"TRAIL\".to_owned(); // The parent order will be turned into a TRAIL order\n    order.adjusted_stop_price = Some(adjusted_stop_price); // With a stop price of ...\n    order.adjustable_trailing_unit = trail_unit; // trailing by and amount (0) or a percent (100) ...\n    order.adjusted_trailing_amount = Some(adjusted_trail_amount); // of ...\n\n    order\n}\n\npub fn what_if_limit_order(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    let mut order = limit_order(action, quantity, limit_price);\n    order.what_if = true;\n\n    order\n}\n\n// https://github.com/InteractiveBrokers/tws-api/blob/07e54ceecda2c9cbd6ffb5f524894f0c837a9ecb/source/csharpclient/client/ContractCondition.cs\n// pub fn price_condition(contract_id: i32, exchange: \u0026str, price: f64, is_more: bool, is_conjunction: bool) -\u003e PriceCondition\n// {\n//     //! [price_condition]\n//     //Conditions have to be created via the OrderCondition.Create\n//     PriceCondition priceCondition = (PriceCondition)OrderCondition.Create(OrderConditionType.Price);\n//     //When this contract...\n//     priceCondition.ConId = conId;\n//     //traded on this exchange\n//     priceCondition.Exchange = exchange;\n//     //has a price above/below\n//     priceCondition.IsMore = isMore;\n//     //this quantity\n//     priceCondition.Price = price;\n//     //AND | OR next condition (will be ignored if no more conditions are added)\n//     priceCondition.IsConjunctionConnection = isConjunction;\n//     //! [price_condition]\n//     return priceCondition;\n// }\n\n//     public static ExecutionCondition ExecutionCondition(string symbol, string secType, string exchange, bool isConjunction)\n//     {\n//         //! [execution_condition]\n//         ExecutionCondition execCondition = (ExecutionCondition)OrderCondition.Create(OrderConditionType.Execution);\n//         //When an execution on symbol\n//         execCondition.Symbol = symbol;\n//         //at exchange\n//         execCondition.Exchange = exchange;\n//         //for this secType\n//         execCondition.SecType = secType;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         execCondition.IsConjunctionConnection = isConjunction;\n//         //! [execution_condition]\n//         return execCondition;\n//     }\n\n//     public static MarginCondition MarginCondition(int percent, bool isMore, bool isConjunction)\n//     {\n//         //! [margin_condition]\n//         MarginCondition marginCondition = (MarginCondition)OrderCondition.Create(OrderConditionType.Margin);\n//         //If margin is above/below\n//         marginCondition.IsMore = isMore;\n//         //given percent\n//         marginCondition.Percent = percent;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         marginCondition.IsConjunctionConnection = isConjunction;\n//         //! [margin_condition]\n//         return marginCondition;\n//     }\n\n//     public static PercentChangeCondition PercentageChangeCondition(double pctChange, int conId, string exchange, bool isMore, bool isConjunction)\n//     {\n//         //! [percentage_condition]\n//         PercentChangeCondition pctChangeCondition = (PercentChangeCondition)OrderCondition.Create(OrderConditionType.PercentCange);\n//         //If there is a price percent change measured against last close price above or below...\n//         pctChangeCondition.IsMore = isMore;\n//         //this amount...\n//         pctChangeCondition.ChangePercent = pctChange;\n//         //on this contract\n//         pctChangeCondition.ConId = conId;\n//         //when traded on this exchange...\n//         pctChangeCondition.Exchange = exchange;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         pctChangeCondition.IsConjunctionConnection = isConjunction;\n//         //! [percentage_condition]\n//         return pctChangeCondition;\n//     }\n\n//     public static TimeCondition TimeCondition(string time, bool isMore, bool isConjunction)\n//     {\n//         //! [time_condition]\n//         TimeCondition timeCondition = (TimeCondition)OrderCondition.Create(OrderConditionType.Time);\n//         //Before or after...\n//         timeCondition.IsMore = isMore;\n//         //this time..\n//         timeCondition.Time = time;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         timeCondition.IsConjunctionConnection = isConjunction;\n//         //! [time_condition]\n//         return timeCondition;\n//     }\n\n//     public static VolumeCondition VolumeCondition(int conId, string exchange, bool isMore, int volume, bool isConjunction)\n//     {\n//         //! [volume_condition]\n//         VolumeCondition volCond = (VolumeCondition)OrderCondition.Create(OrderConditionType.Volume);\n//         //Whenever contract...\n//         volCond.ConId = conId;\n//         //When traded at\n//         volCond.Exchange = exchange;\n//         //reaches a volume higher/lower\n//         volCond.IsMore = isMore;\n//         //than this...\n//         volCond.Volume = volume;\n//         //AND | OR next condition (will be ignored if no more conditions are added)\n//         volCond.IsConjunctionConnection = isConjunction;\n//         //! [volume_condition]\n//         return volCond;\n\n//     }\n\npub fn limit_ibkrats(action: Action, quantity: f64, limit_price: f64) -\u003e Order {\n    Order {\n        action,\n        order_type: \"LMT\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        not_held: true,\n        ..Order::default()\n    }\n}\n\npub fn limit_order_with_manual_order_time(action: Action, quantity: f64, limit_price: f64, manual_order_time: \u0026str) -\u003e Order {\n    let mut order = limit_order(action, quantity, limit_price);\n    order.manual_order_time = manual_order_time.to_owned();\n\n    order\n}\n\npub fn peg_best_up_to_mid_order(\n    action: Action,\n    quantity: f64,\n    limit_price: f64,\n    min_trade_qty: i32,\n    min_compete_size: i32,\n    mid_offset_at_whole: f64,\n    mid_offset_at_half: f64,\n) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG BEST\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        not_held: true,\n        min_trade_qty: Some(min_trade_qty),\n        min_compete_size: Some(min_compete_size),\n        compete_against_best_offset: super::COMPETE_AGAINST_BEST_OFFSET_UP_TO_MID,\n        mid_offset_at_whole: Some(mid_offset_at_whole),\n        mid_offset_at_half: Some(mid_offset_at_half),\n        ..Order::default()\n    }\n}\n\npub fn peg_best_order(\n    action: Action,\n    quantity: f64,\n    limit_price: f64,\n    min_trade_qty: i32,\n    min_compete_size: i32,\n    compete_against_best_offset: f64,\n) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG BEST\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        not_held: true,\n        min_trade_qty: Some(min_trade_qty),\n        min_compete_size: Some(min_compete_size),\n        compete_against_best_offset: Some(compete_against_best_offset),\n        ..Order::default()\n    }\n}\n\npub fn peg_mid_order(\n    action: Action,\n    quantity: f64,\n    limit_price: f64,\n    min_trade_qty: i32,\n    mid_offset_at_whole: f64,\n    mid_offset_at_half: f64,\n) -\u003e Order {\n    Order {\n        action,\n        order_type: \"PEG MID\".to_owned(),\n        total_quantity: quantity,\n        limit_price: Some(limit_price),\n        not_held: true,\n        min_trade_qty: Some(min_trade_qty),\n        mid_offset_at_whole: Some(mid_offset_at_whole),\n        mid_offset_at_half: Some(mid_offset_at_half),\n        ..Order::default()\n    }\n}\n","traces":[{"line":7,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":119,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":124,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":137,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":164,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":178,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":218,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":221,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":223,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":224,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":241,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":254,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":269,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":272,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":284,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":294,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":297,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":298,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":299,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":325,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":338,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":340,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":341,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":356,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":359,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":361,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":371,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":374,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":376,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":386,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":397,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":398,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":406,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":407,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":408,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":410,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":417,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":418,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":419,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":421,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":430,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":440,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":450,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":453,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":465,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":470,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":479,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":482,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":485,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":496,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":499,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":512,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":515,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":517,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":518,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":531,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":534,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":536,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":537,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":538,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":548,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":551,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":553,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":557,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":558,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":561,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":564,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":565,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":566,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":567,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":568,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":570,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":578,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":581,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":586,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":587,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":590,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":598,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":601,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":603,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":607,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":608,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":611,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":612,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":615,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":623,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":626,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":628,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":632,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":633,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":636,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":644,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":647,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":652,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":653,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":656,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":669,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":670,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":671,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":672,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":675,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":687,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":690,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":692,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":693,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":698,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":699,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":700,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":701,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":702,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":704,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":707,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":722,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":724,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":726,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":727,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":729,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":730,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":732,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":733,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":740,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":741,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":742,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":744,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":745,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":746,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":747,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":749,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":754,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":761,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":762,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":764,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":765,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":766,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":767,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":768,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":770,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":775,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":783,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":784,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":786,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":787,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":788,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":789,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":790,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":791,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":793,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":796,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":797,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":798,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":800,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":904,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":907,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":909,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":915,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":916,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":917,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":919,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":922,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":933,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":935,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":937,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":938,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":940,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":941,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":946,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":956,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":958,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":960,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":961,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":962,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":967,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":977,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":979,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":981,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":982,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":983,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":16,"coverable":232},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders","tests.rs"],"content":"use super::*;\n\nuse crate::contracts::{contract_samples, Contract, SecurityType};\nuse crate::stubs::MessageBusStub;\n\n#[test]\nfn place_order() {\n    let mut message_bus = Box::new(MessageBusStub{\n        request_messages: vec![],\n        response_messages: vec![\n            \"5|13|76792991|TSLA|STK||0|?||SMART|USD|TSLA|NMS|BUY|100|MKT|0.0|0.0|DAY||DU1236109||0||100|1376327563|0|0|0||1376327563.0/DU1236109/100||||||||||0||-1|0||||||2147483647|0|0|0||3|0|0||0|0||0|None||0||||?|0|0||0|0||||||0|0|0|2147483647|2147483647|||0||IB|0|0||0|0|PreSubmitted|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308||||||0|0|0|None|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|0||||0|1|0|0|0|||0||\".to_owned(),\n            \"3|13|PreSubmitted|0|100|0|1376327563|0|0|100||0||\".to_owned(),\n            \"11|-1|13|76792991|TSLA|STK||0.0|||ISLAND|USD|TSLA|NMS|00025b46.63f8f39c.01.01|20230224  12:04:56|DU1236109|ISLAND|BOT|100|196.52|1376327563|100|0|100|196.52|||||2||\".to_owned(),\n            \"5|13|76792991|TSLA|STK||0|?||SMART|USD|TSLA|NMS|BUY|100|MKT|0.0|0.0|DAY||DU1236109||0||100|1376327563|0|0|0||1376327563.0/DU1236109/100||||||||||0||-1|0||||||2147483647|0|0|0||3|0|0||0|0||0|None||0||||?|0|0||0|0||||||0|0|0|2147483647|2147483647|||0||IB|0|0||0|0|Filled|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308||||||0|0|0|None|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|0||||0|1|0|0|0|||0||\".to_owned(),\n            \"3|13|Filled|100|0|196.52|1376327563|0|196.52|100||0||\".to_owned(),\n            \"5|13|76792991|TSLA|STK||0|?||SMART|USD|TSLA|NMS|BUY|100|MKT|0.0|0.0|DAY||DU1236109||0||100|1376327563|0|0|0||1376327563.0/DU1236109/100||||||||||0||-1|0||||||2147483647|0|0|0||3|0|0||0|0||0|None||0||||?|0|0||0|0||||||0|0|0|2147483647|2147483647|||0||IB|0|0||0|0|Filled|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.0|||USD||0|0|0|None|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|1.7976931348623157E308|0||||0|1|0|0|0|||0||\".to_owned(),\n            \"59|1|00025b46.63f8f39c.01.01|1.0|USD|1.7976931348623157E308|1.7976931348623157E308|||\".to_owned(),\n        ]\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let contract = Contract {\n        symbol: \"TSLA\".to_owned(),\n        security_type: SecurityType::Stock,\n        exchange: \"SMART\".to_owned(),\n        currency: \"USD\".to_owned(),\n        ..Contract::default()\n    };\n\n    let order_id = 13;\n    let order = order_builder::market_order(super::Action::Buy, 100.0);\n\n    let result = super::place_order(\u0026mut client, order_id, \u0026contract, \u0026order);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(\n        request_messages[0].encode().replace('\\0', \"|\"),\n        \"3|13|0|TSLA|STK||0|||SMART||USD|||||BUY|100|MKT|||||||0||1|0|0|0|0|0|0|0||0||||||||0||-1|0|||0|||0|0||0||||||0|||||0|||||||||||0|||0|0|||0||0|0|0|0|||||||0|||||||||0|0|0|0|||0|\"\n    );\n\n    assert!(result.is_ok(), \"failed to place order: {}\", result.err().unwrap());\n\n    let mut notifications = result.unwrap();\n\n    if let Some(OrderNotification::OpenOrder(open_order)) = notifications.next() {\n        assert_eq!(open_order.order_id, 13, \"open_order.order_id\");\n\n        let contract = \u0026open_order.contract;\n        let order = \u0026open_order.order;\n        let order_state = \u0026open_order.order_state;\n\n        assert_eq!(contract.contract_id, 76792991, \"contract.contract_id\");\n        assert_eq!(contract.symbol, \"TSLA\", \"contract.symbol\");\n        assert_eq!(contract.security_type, SecurityType::Stock, \"contract.security_type\");\n        assert_eq!(\n            contract.last_trade_date_or_contract_month, \"\",\n            \"contract.last_trade_date_or_contract_month\"\n        );\n        assert_eq!(contract.strike, 0.0, \"contract.strike\");\n        assert_eq!(contract.right, \"?\", \"contract.right\");\n        assert_eq!(contract.multiplier, \"\", \"contract.multiplier\");\n        assert_eq!(contract.exchange, \"SMART\", \"contract.exchange\");\n        assert_eq!(contract.currency, \"USD\", \"contract.currency\");\n        assert_eq!(contract.local_symbol, \"TSLA\", \"contract.local_symbol\");\n        assert_eq!(contract.trading_class, \"NMS\", \"contract.trading_class\");\n\n        assert_eq!(order.order_id, 13, \"order.order_id\");\n        assert_eq!(order.action, Action::Buy, \"order.action\");\n        assert_eq!(order.total_quantity, 100.0, \"order.total_quantity\");\n        assert_eq!(order.order_type, \"MKT\", \"order.order_type\");\n        assert_eq!(order.limit_price, Some(0.0), \"order.limit_price\");\n        assert_eq!(order.aux_price, Some(0.0), \"order.aux_price\");\n        assert_eq!(order.tif, \"DAY\", \"order.tif\");\n        assert_eq!(order.oca_group, \"\", \"order.oca_group\");\n        assert_eq!(order.account, \"DU1236109\", \"order.account\");\n        assert_eq!(order.open_close, None, \"order.open_close\");\n        assert_eq!(order.origin, 0, \"order.origin\");\n        assert_eq!(order.order_ref, \"\", \"order.order_ref\");\n        assert_eq!(order.client_id, 100, \"order.client_id\");\n        assert_eq!(order.perm_id, 1376327563, \"order.perm_id\");\n        assert_eq!(order.outside_rth, false, \"order.outside_rth\");\n        assert_eq!(order.hidden, false, \"order.hidden\");\n        assert_eq!(order.discretionary_amt, 0.0, \"order.discretionary_amt\");\n        assert_eq!(order.good_after_time, \"\", \"order.good_after_time\");\n        assert_eq!(order.fa_group, \"\", \"order.fa_group\");\n        assert_eq!(order.fa_method, \"\", \"order.fa_method\");\n        assert_eq!(order.fa_percentage, \"\", \"order.fa_percentage\");\n        assert_eq!(order.fa_profile, \"\", \"order.fa_profile\");\n        assert_eq!(order.model_code, \"\", \"order.model_code\");\n        assert_eq!(order.good_till_date, \"\", \"order.good_till_date\");\n        assert_eq!(order.rule_80_a, None, \"order.rule_80_a\");\n        assert_eq!(order.percent_offset, None, \"order.percent_offset\");\n        assert_eq!(order.settling_firm, \"\", \"order.settling_firm\");\n        assert_eq!(order.short_sale_slot, 0, \"order.short_sale_slot\");\n        assert_eq!(order.designated_location, \"\", \"order.designated_location\");\n        assert_eq!(order.exempt_code, -1, \"order.exempt_code\");\n        assert_eq!(order.auction_strategy, Some(0), \"order.auction_strategy\");\n        assert_eq!(order.starting_price, None, \"order.starting_price\");\n        assert_eq!(order.stock_ref_price, None, \"order.stock_ref_price\");\n        assert_eq!(order.delta, None, \"order.delta\");\n        assert_eq!(order.stock_range_lower, None, \"order.stock_range_lower\");\n        assert_eq!(order.stock_range_upper, None, \"order.stock_range_upper\");\n        assert_eq!(order.display_size, None, \"order.display_size\");\n        assert_eq!(order.block_order, false, \"order.block_order\");\n        assert_eq!(order.sweep_to_fill, false, \"order.sweep_to_fill\");\n        assert_eq!(order.all_or_none, false, \"order.all_or_none\");\n        assert_eq!(order.min_qty, None, \"order.min_qty\");\n        assert_eq!(order.oca_type, 3, \"order.oca_type\");\n        assert_eq!(order.parent_id, 0, \"order.parent_id\");\n        assert_eq!(order.trigger_method, 0, \"order.trigger_method\");\n        assert_eq!(order.volatility, None, \"order.volatility\");\n        assert_eq!(order.volatility_type, Some(0), \"order.volatility_type\");\n        assert_eq!(order.delta_neutral_order_type, \"None\", \"order.delta_neutral_order_type\");\n        assert_eq!(order.delta_neutral_aux_price, None, \"order.delta_neutral_aux_price\");\n        assert_eq!(order.delta_neutral_con_id, 0, \"order.delta_neutral_con_id\");\n        assert_eq!(order.delta_neutral_settling_firm, \"\", \"order.delta_neutral_settling_firm\");\n        assert_eq!(order.delta_neutral_clearing_account, \"\", \"order.delta_neutral_clearing_account\");\n        assert_eq!(order.delta_neutral_clearing_intent, \"\", \"order.delta_neutral_clearing_intent\");\n        assert_eq!(order.delta_neutral_open_close, \"?\", \"order.delta_neutral_open_close\");\n        assert_eq!(order.delta_neutral_short_sale, false, \"order.delta_neutral_short_sale\");\n        assert_eq!(order.delta_neutral_short_sale_slot, 0, \"order.delta_neutral_short_sale_slot\");\n        assert_eq!(order.delta_neutral_designated_location, \"\", \"order.delta_neutral_designated_location\");\n        assert_eq!(order.continuous_update, false, \"order.continuous_update\");\n        assert_eq!(order.reference_price_type, Some(0), \"order.reference_price_type\");\n        assert_eq!(order.trail_stop_price, None, \"order.trail_stop_price\");\n        assert_eq!(order.trailing_percent, None, \"order.trailing_percent\");\n        assert_eq!(order.basis_points, None, \"order.basis_points\");\n        assert_eq!(order.basis_points_type, None, \"order.basis_points_type\");\n        assert_eq!(contract.combo_legs_description, \"\", \"contract.combo_legs_description\");\n        assert_eq!(contract.combo_legs.len(), 0, \"contract.combo_legs.len()\");\n        assert_eq!(order.order_combo_legs.len(), 0, \"order.order_combo_legs.len()\");\n        assert_eq!(order.smart_combo_routing_params.len(), 0, \"order.smart_combo_routing_params.len()\");\n        assert_eq!(order.scale_init_level_size, None, \"order.scale_init_level_size\");\n        assert_eq!(order.scale_subs_level_size, None, \"order.scale_subs_level_size\");\n        assert_eq!(order.scale_price_increment, None, \"order.scale_price_increment\");\n        assert_eq!(order.hedge_type, \"\", \"order.hedge_type\");\n        assert_eq!(order.opt_out_smart_routing, false, \"order.opt_out_smart_routing\");\n        assert_eq!(order.clearing_account, \"\", \"order.clearing_account\");\n        assert_eq!(order.clearing_intent, \"IB\", \"order.clearing_intent\");\n        assert_eq!(order.not_held, false, \"order.not_held\");\n        assert_eq!(order.algo_strategy, \"\", \"order.algo_strategy\");\n        assert_eq!(order.algo_params.len(), 0, \"order.algo_params.len()\");\n        assert_eq!(order.solicited, false, \"order.solicited\");\n        assert_eq!(order.what_if, false, \"order.what_if\");\n        assert_eq!(order_state.status, \"PreSubmitted\", \"order_state.status\");\n        assert_eq!(order_state.initial_margin_before, None, \"order_state.initial_margin_before\");\n        assert_eq!(order_state.maintenance_margin_before, None, \"order_state.maintenance_margin_before\");\n        assert_eq!(order_state.equity_with_loan_before, None, \"order_state.equity_with_loan_before\");\n        assert_eq!(order_state.initial_margin_change, None, \"order_state.initial_margin_change\");\n        assert_eq!(order_state.maintenance_margin_change, None, \"order_state.maintenance_margin_change\");\n        assert_eq!(order_state.equity_with_loan_change, None, \"order_state.equity_with_loan_change\");\n        assert_eq!(order_state.initial_margin_after, None, \"order_state.initial_margin_after\");\n        assert_eq!(order_state.maintenance_margin_after, None, \"order_state.maintenance_margin_after\");\n        assert_eq!(order_state.equity_with_loan_after, None, \"order_state.equity_with_loan_after\");\n        assert_eq!(order_state.commission, None, \"order_state.commission\");\n        assert_eq!(order_state.minimum_commission, None, \"order_state.minimum_commission\");\n        assert_eq!(order_state.maximum_commission, None, \"order_state.maximum_commission\");\n        assert_eq!(order_state.commission_currency, \"\", \"order_state.commission_currency\");\n        assert_eq!(order_state.warning_text, \"\", \"order_state.warning_text\");\n        assert_eq!(order.randomize_size, false, \"order.randomize_size\");\n        assert_eq!(order.randomize_price, false, \"order.randomize_price\");\n        assert_eq!(order.conditions.len(), 0, \"order.conditions.len()\");\n        assert_eq!(order.adjusted_order_type, \"None\", \"order.adjusted_order_type\");\n        assert_eq!(order.trigger_price, None, \"order.trigger_price\");\n        assert_eq!(order.trail_stop_price, None, \"order.trail_stop_price\");\n        assert_eq!(order.limit_price_offset, None, \"order.lmt_price_offset\");\n        assert_eq!(order.adjusted_stop_price, None, \"order.adjusted_stop_price\");\n        assert_eq!(order.adjusted_stop_limit_price, None, \"order.adjusted_stop_limit_price\");\n        assert_eq!(order.adjusted_trailing_amount, None, \"order.adjusted_trailing_amount\");\n        assert_eq!(order.adjustable_trailing_unit, 0, \"order.adjustable_trailing_unit\");\n        assert_eq!(order.soft_dollar_tier.name, \"\", \"order.soft_dollar_tier.name\");\n        assert_eq!(order.soft_dollar_tier.value, \"\", \"order.soft_dollar_tier.value\");\n        assert_eq!(order.soft_dollar_tier.display_name, \"\", \"order.soft_dollar_tier.display_name\");\n        assert_eq!(order.cash_qty, Some(0.0), \"order.cash_qty\");\n        assert_eq!(order.dont_use_auto_price_for_hedge, true, \"order.dont_use_auto_price_for_hedge\");\n        assert_eq!(order.is_oms_container, false, \"order.is_oms_container\");\n        assert_eq!(order.discretionary_up_to_limit_price, false, \"order.discretionary_up_to_limit_price\");\n        assert_eq!(order.use_price_mgmt_algo, false, \"order.use_price_mgmt_algo\");\n        assert_eq!(order.duration, None, \"order.duration\");\n        assert_eq!(order.post_to_ats, None, \"order.post_to_ats\");\n        assert_eq!(order.auto_cancel_parent, false, \"order.auto_cancel_parent\");\n        assert_eq!(order.min_trade_qty, None, \"order.min_trade_qty\");\n        assert_eq!(order.min_compete_size, None, \"order.min_compete_size\");\n        assert_eq!(order.compete_against_best_offset, None, \"order.compete_against_best_offset\");\n        assert_eq!(order.mid_offset_at_whole, None, \"order.mid_offset_at_whole\");\n        assert_eq!(order.mid_offset_at_half, None, \"order.mid_offset_at_half\");\n    } else {\n        assert!(false, \"message[0] expected an open order notification\");\n    }\n\n    if let Some(OrderNotification::OrderStatus(order_status)) = notifications.next() {\n        assert_eq!(order_status.order_id, 13, \"order_status.order_id\");\n        assert_eq!(order_status.status, \"PreSubmitted\", \"order_status.status\");\n        assert_eq!(order_status.filled, 0.0, \"order_status.filled\");\n        assert_eq!(order_status.remaining, 100.0, \"order_status.remaining\");\n        assert_eq!(order_status.average_fill_price, 0.0, \"order_status.average_fill_price\");\n        assert_eq!(order_status.perm_id, 1376327563, \"order_status.perm_id\");\n        assert_eq!(order_status.parent_id, 0, \"order_status.parent_id\");\n        assert_eq!(order_status.last_fill_price, 0.0, \"order_status.last_fill_price\");\n        assert_eq!(order_status.client_id, 100, \"order_status.client_id\");\n        assert_eq!(order_status.why_held, \"\", \"order_status.why_held\");\n        assert_eq!(order_status.market_cap_price, 0.0, \"order_status.market_cap_price\");\n    } else {\n        assert!(false, \"message[1] expected order status notification\");\n    }\n\n    if let Some(OrderNotification::ExecutionData(execution_data)) = notifications.next() {\n        let contract = execution_data.contract;\n        let execution = execution_data.execution;\n\n        assert_eq!(execution_data.request_id, -1, \"execution_data.request_id\");\n        assert_eq!(execution.order_id, 13, \"execution.order_id\");\n        assert_eq!(contract.contract_id, 76792991, \"contract.contract_id\");\n        assert_eq!(contract.symbol, \"TSLA\", \"contract.symbol\");\n        assert_eq!(contract.security_type, SecurityType::Stock, \"contract.security_type\");\n        assert_eq!(\n            contract.last_trade_date_or_contract_month, \"\",\n            \"contract.last_trade_date_or_contract_month\"\n        );\n        assert_eq!(contract.strike, 0.0, \"contract.strike\");\n        assert_eq!(contract.right, \"\", \"contract.right\");\n        assert_eq!(contract.multiplier, \"\", \"contract.multiplier\");\n        assert_eq!(contract.exchange, \"ISLAND\", \"contract.exchange\");\n        assert_eq!(contract.currency, \"USD\", \"contract.currency\");\n        assert_eq!(contract.local_symbol, \"TSLA\", \"contract.local_symbol\");\n        assert_eq!(contract.trading_class, \"NMS\", \"contract.trading_class\");\n        assert_eq!(execution.execution_id, \"00025b46.63f8f39c.01.01\", \"execution.execution_id\");\n        assert_eq!(execution.time, \"20230224  12:04:56\", \"execution.time\");\n        assert_eq!(execution.account_number, \"DU1236109\", \"execution.account_number\");\n        assert_eq!(execution.exchange, \"ISLAND\", \"execution.exchange\");\n        assert_eq!(execution.side, \"BOT\", \"execution.side\");\n        assert_eq!(execution.shares, 100.0, \"execution.shares\");\n        assert_eq!(execution.price, 196.52, \"execution.price\");\n        assert_eq!(execution.perm_id, 1376327563, \"execution.perm_id\");\n        assert_eq!(execution.client_id, 100, \"execution.client_id\");\n        assert_eq!(execution.liquidation, 0, \"execution.liquidation\");\n        assert_eq!(execution.cumulative_quantity, 100.0, \"execution.cumulative_quantity\");\n        assert_eq!(execution.average_price, 196.52, \"execution.average_price\");\n        assert_eq!(execution.order_reference, \"\", \"execution.order_reference\");\n        assert_eq!(execution.ev_rule, \"\", \"execution.ev_rule\");\n        assert_eq!(execution.ev_multiplier, None, \"execution.ev_multiplier\");\n        assert_eq!(execution.model_code, \"\", \"execution.model_code\");\n        assert_eq!(execution.last_liquidity, Liquidity::RemovedLiquidity, \"execution.last_liquidity\");\n    } else {\n        assert!(false, \"message[2] expected execution notification\");\n    }\n\n    if let Some(OrderNotification::OpenOrder(open_order)) = notifications.next() {\n        let order_state = \u0026open_order.order_state;\n\n        assert_eq!(open_order.order_id, 13, \"open_order.order_id\");\n        assert_eq!(order_state.status, \"Filled\", \"order_state.status\");\n    } else {\n        assert!(false, \"message[3] expected an open order notification\");\n    }\n\n    if let Some(OrderNotification::OrderStatus(order_status)) = notifications.next() {\n        assert_eq!(order_status.order_id, 13, \"order_status.order_id\");\n        assert_eq!(order_status.status, \"Filled\", \"order_status.status\");\n        assert_eq!(order_status.filled, 100.0, \"order_status.filled\");\n        assert_eq!(order_status.remaining, 0.0, \"order_status.remaining\");\n        assert_eq!(order_status.average_fill_price, 196.52, \"order_status.average_fill_price\");\n        assert_eq!(order_status.last_fill_price, 196.52, \"order_status.last_fill_price\");\n    } else {\n        assert!(false, \"message[4] expected order status notification\");\n    }\n\n    if let Some(OrderNotification::OpenOrder(open_order)) = notifications.next() {\n        let order_state = \u0026open_order.order_state;\n\n        assert_eq!(open_order.order_id, 13, \"open_order.order_id\");\n        assert_eq!(order_state.status, \"Filled\", \"order_state.status\");\n        assert_eq!(order_state.commission, Some(1.0), \"order_state.commission\");\n        assert_eq!(order_state.minimum_commission, None, \"order_state.minimum_commission\");\n        assert_eq!(order_state.maximum_commission, None, \"order_state.maximum_commission\");\n        assert_eq!(order_state.commission_currency, \"USD\", \"order_state.commission_currency\");\n    } else {\n        assert!(false, \"message[5] expected an open order notification\");\n    }\n\n    if let Some(OrderNotification::CommissionReport(report)) = notifications.next() {\n        assert_eq!(report.execution_id, \"00025b46.63f8f39c.01.01\", \"report.execution_id\");\n        assert_eq!(report.commission, 1.0, \"report.commission\");\n        assert_eq!(report.currency, \"USD\", \"report.currency\");\n        assert_eq!(report.realized_pnl, None, \"report.realized_pnl\");\n        assert_eq!(report.yields, None, \"report.yielded\");\n        assert_eq!(report.yield_redemption_date, \"\", \"report.yield_redemption_date\");\n    } else {\n        assert!(false, \"message[6] expected a commission report notification\");\n    }\n}\n\n#[test]\nfn cancel_order() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\n            \"3|41|Cancelled|0|100|0|71270927|0|0|100||0||\".to_owned(),\n            \"4|2|41|202|Order Canceled - reason:||\".to_owned(),\n        ],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let order_id = 41;\n    let results = super::cancel_order(\u0026mut client, order_id, \"\");\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode(), \"4\\01\\041\\0\");\n\n    assert!(results.is_ok(), \"failed to cancel order: {}\", results.err().unwrap());\n\n    let mut results = results.unwrap();\n\n    if let Some(CancelOrderResult::OrderStatus(order_status)) = results.next() {\n        assert_eq!(order_status.order_id, 41, \"order_status.order_id\");\n        assert_eq!(order_status.status, \"Cancelled\", \"order_status.status\");\n        assert_eq!(order_status.filled, 0.0, \"order_status.filled\");\n        assert_eq!(order_status.remaining, 100.0, \"order_status.remaining\");\n        assert_eq!(order_status.average_fill_price, 0.0, \"order_status.average_fill_price\");\n        assert_eq!(order_status.perm_id, 71270927, \"order_status.perm_id\");\n        assert_eq!(order_status.parent_id, 0, \"order_status.parent_id\");\n        assert_eq!(order_status.last_fill_price, 0.0, \"order_status.last_fill_price\");\n        assert_eq!(order_status.client_id, 100, \"order_status.client_id\");\n        assert_eq!(order_status.why_held, \"\", \"order_status.why_held\");\n        assert_eq!(order_status.market_cap_price, 0.0, \"order_status.market_cap_price\");\n    }\n\n    if let Some(CancelOrderResult::Notice(Notice(message))) = results.next() {\n        assert_eq!(message, \"Order Canceled - reason:\", \"order status notice\");\n    }\n}\n\n#[test]\nfn global_cancel() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let results = super::global_cancel(\u0026mut client);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode(), \"58\\01\\0\");\n    assert!(results.is_ok(), \"failed to cancel order: {}\", results.err().unwrap());\n}\n\n#[test]\nfn next_valid_order_id() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let results = super::next_valid_order_id(\u0026mut client);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode(), \"8\\01\\00\\0\");\n\n    assert!(results.is_ok(), \"failed to request next order id: {}\", results.err().unwrap());\n    assert_eq!(43, results.unwrap(), \"next order id\");\n}\n\n#[test]\nfn completed_orders() {\n    let mut message_bus = Box::new(MessageBusStub{\n        request_messages: vec![],\n        response_messages: vec![\n            \"101|265598|AAPL|STK||0|?||SMART|USD|AAPL|NMS|BUY|0|MKT|0.0|0.0|DAY||DU1236109||0||1824933227|0|0|0|||||||||||0||-1||||||2147483647|0|0||3|0||0|None||0|0|0||0|0||||0|0|0|2147483647|2147483647||||IB|0|0||0|Filled|0|0|0|1.7976931348623157E308|1.7976931348623157E308|0|1|0||100|2147483647|0|Not an insider or substantial shareholder|0|0|9223372036854775807|20230306 12:28:30 America/Los_Angeles|Filled Size: 100|\".to_owned(),\n            \"102|\".to_owned(),\n        ],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let api_only = true;\n    let results = super::completed_orders(\u0026mut client, api_only);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode(), \"99\\01\\0\");\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n\n    let mut results = results.unwrap();\n    if let Some(OrderDataResult::OrderData(order_data)) = results.next() {\n        assert_eq!(order_data.order_id, -1, \"open_order.order_id\");\n\n        let contract = \u0026order_data.contract;\n        let order = \u0026order_data.order;\n        let order_state = \u0026order_data.order_state;\n\n        assert_eq!(contract.contract_id, 265598, \"contract.contract_id\");\n        assert_eq!(contract.symbol, \"AAPL\", \"contract.symbol\");\n        assert_eq!(contract.security_type, SecurityType::Stock, \"contract.security_type\");\n        assert_eq!(\n            contract.last_trade_date_or_contract_month, \"\",\n            \"contract.last_trade_date_or_contract_month\"\n        );\n        assert_eq!(contract.strike, 0.0, \"contract.strike\");\n        assert_eq!(contract.right, \"?\", \"contract.right\");\n        assert_eq!(contract.multiplier, \"\", \"contract.multiplier\");\n        assert_eq!(contract.exchange, \"SMART\", \"contract.exchange\");\n        assert_eq!(contract.currency, \"USD\", \"contract.currency\");\n        assert_eq!(contract.local_symbol, \"AAPL\", \"contract.local_symbol\");\n        assert_eq!(contract.trading_class, \"NMS\", \"contract.trading_class\");\n        assert_eq!(order.action, Action::Buy, \"order.action\");\n        assert_eq!(order.total_quantity, 0.0, \"order.total_quantity\");\n        assert_eq!(order.order_type, \"MKT\", \"order.order_type\");\n        assert_eq!(order.limit_price, Some(0.0), \"order.limit_price\");\n        assert_eq!(order.aux_price, Some(0.0), \"order.aux_price\");\n        assert_eq!(order.tif, \"DAY\", \"order.tif\");\n        assert_eq!(order.oca_group, \"\", \"order.oca_group\");\n        assert_eq!(order.account, \"DU1236109\", \"order.account\");\n        assert_eq!(order.open_close, None, \"order.open_close\");\n        assert_eq!(order.origin, 0, \"order.origin\");\n        assert_eq!(order.order_ref, \"\", \"order.order_ref\");\n        assert_eq!(order.perm_id, 1824933227, \"order.perm_id\");\n        assert_eq!(order.outside_rth, false, \"order.outside_rth\");\n        assert_eq!(order.hidden, false, \"order.hidden\");\n        assert_eq!(order.discretionary_amt, 0.0, \"order.discretionary_amt\");\n        assert_eq!(order.good_after_time, \"\", \"order.good_after_time\");\n        assert_eq!(order.fa_group, \"\", \"order.fa_group\");\n        assert_eq!(order.fa_method, \"\", \"order.fa_method\");\n        assert_eq!(order.fa_percentage, \"\", \"order.fa_percentage\");\n        assert_eq!(order.fa_profile, \"\", \"order.fa_profile\");\n        assert_eq!(order.model_code, \"\", \"order.model_code\");\n        assert_eq!(order.good_till_date, \"\", \"order.good_till_date\");\n        assert_eq!(order.rule_80_a, None, \"order.rule_80_a\");\n        assert_eq!(order.percent_offset, None, \"order.percent_offset\");\n        assert_eq!(order.settling_firm, \"\", \"order.settling_firm\");\n        assert_eq!(order.short_sale_slot, 0, \"order.short_sale_slot\");\n        assert_eq!(order.designated_location, \"\", \"order.designated_location\");\n        assert_eq!(order.exempt_code, -1, \"order.exempt_code\");\n        assert_eq!(order.starting_price, None, \"order.starting_price\");\n        assert_eq!(order.stock_ref_price, None, \"order.stock_ref_price\");\n        assert_eq!(order.delta, None, \"order.delta\");\n        assert_eq!(order.stock_range_lower, None, \"order.stock_range_lower\");\n        assert_eq!(order.stock_range_upper, None, \"order.stock_range_upper\");\n        assert_eq!(order.display_size, None, \"order.display_size\");\n        assert_eq!(order.sweep_to_fill, false, \"order.sweep_to_fill\");\n        assert_eq!(order.all_or_none, false, \"order.all_or_none\");\n        assert_eq!(order.min_qty, None, \"order.min_qty\");\n        assert_eq!(order.oca_type, 3, \"order.oca_type\");\n        assert_eq!(order.trigger_method, 0, \"order.trigger_method\");\n        assert_eq!(order.volatility, None, \"order.volatility\");\n        assert_eq!(order.volatility_type, Some(0), \"order.volatility_type\");\n        assert_eq!(order.delta_neutral_order_type, \"None\", \"order.delta_neutral_order_type\");\n        assert_eq!(order.delta_neutral_aux_price, None, \"order.delta_neutral_aux_price\");\n        assert_eq!(order.delta_neutral_con_id, 0, \"order.delta_neutral_con_id\");\n        assert_eq!(order.delta_neutral_short_sale, false, \"order.delta_neutral_short_sale\");\n        assert_eq!(order.delta_neutral_short_sale_slot, 0, \"order.delta_neutral_short_sale_slot\");\n        assert_eq!(order.delta_neutral_designated_location, \"\", \"order.delta_neutral_designated_location\");\n        assert_eq!(order.continuous_update, false, \"order.continuous_update\");\n        assert_eq!(order.reference_price_type, Some(0), \"order.reference_price_type\");\n        assert_eq!(order.trail_stop_price, None, \"order.trail_stop_price\");\n        assert_eq!(order.trailing_percent, None, \"order.trailing_percent\");\n        assert_eq!(contract.combo_legs_description, \"\", \"contract.combo_legs_description\");\n        assert_eq!(contract.combo_legs.len(), 0, \"contract.combo_legs.len()\");\n        assert_eq!(order.order_combo_legs.len(), 0, \"order.order_combo_legs.len()\");\n        assert_eq!(order.smart_combo_routing_params.len(), 0, \"order.smart_combo_routing_params.len()\");\n        assert_eq!(order.scale_init_level_size, None, \"order.scale_init_level_size\");\n        assert_eq!(order.scale_subs_level_size, None, \"order.scale_subs_level_size\");\n        assert_eq!(order.scale_price_increment, None, \"order.scale_price_increment\");\n        assert_eq!(order.hedge_type, \"\", \"order.hedge_type\");\n        assert_eq!(order.clearing_account, \"\", \"order.clearing_account\");\n        assert_eq!(order.clearing_intent, \"IB\", \"order.clearing_intent\");\n        assert_eq!(order.not_held, false, \"order.not_held\");\n        assert_eq!(contract.delta_neutral_contract, None, \"contract.delta_neutral_contract\");\n        assert_eq!(order.algo_strategy, \"\", \"order.algo_strategy\");\n        assert_eq!(order.algo_params.len(), 0, \"order.algo_params.len()\");\n        assert_eq!(order.solicited, false, \"order.solicited\");\n        assert_eq!(order_state.status, \"Filled\", \"order_state.status\");\n        assert_eq!(order.randomize_size, false, \"order.randomize_size\");\n        assert_eq!(order.randomize_price, false, \"order.randomize_price\");\n        assert_eq!(order.conditions.len(), 0, \"order.conditions.len()\");\n        assert_eq!(order.trail_stop_price, None, \"order.trail_stop_price\");\n        assert_eq!(order.limit_price_offset, None, \"order.limit_price_offset\");\n        assert_eq!(order.cash_qty, Some(0.0), \"order.cash_qty\");\n        assert_eq!(order.dont_use_auto_price_for_hedge, true, \"order.dont_use_auto_price_for_hedge\");\n        assert_eq!(order.is_oms_container, false, \"order.is_oms_container\");\n        assert_eq!(order.auto_cancel_date, \"\", \"order.auto_cancel_date\");\n        assert_eq!(order.filled_quantity, 100.0, \"order.filled_quantity\");\n        assert_eq!(order.ref_futures_con_id, None, \"order.ref_futures_con_id\");\n        assert_eq!(order.auto_cancel_parent, false, \"order.auto_cancel_parent\");\n        assert_eq!(order.shareholder, \"Not an insider or substantial shareholder\", \"order.shareholder\");\n        assert_eq!(order.imbalance_only, false, \"order.imbalance_only\");\n        assert_eq!(order.route_marketable_to_bbo, false, \"order.route_marketable_to_bbo\");\n        assert_eq!(order.parent_perm_id, None, \"order.parent_perm_id\");\n        assert_eq!(\n            order_state.completed_time, \"20230306 12:28:30 America/Los_Angeles\",\n            \"order_state.completed_time\"\n        );\n        assert_eq!(order_state.completed_status, \"Filled Size: 100\", \"order_state.completed_status\");\n    } else {\n        assert!(false, \"expected order data\");\n    }\n}\n\n#[test]\nfn open_orders() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let results = super::open_orders(\u0026mut client);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode_simple(), \"5|1|\");\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n}\n\n#[test]\nfn all_open_orders() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let results = super::all_open_orders(\u0026mut client);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode_simple(), \"16|1|\");\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n}\n\n#[test]\nfn auto_open_orders() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let api_only = true;\n    let results = super::auto_open_orders(\u0026mut client, api_only);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(request_messages[0].encode_simple(), \"15|1|1|\");\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n}\n\n#[test]\nfn executions() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![\"9|1|43||\".to_owned()],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let filter = ExecutionFilter {\n        client_id: Some(100),\n        account_code: \"xyz\".to_owned(),\n        time: \"yyyymmdd hh:mm:ss EST\".to_owned(),\n        symbol: \"TSLA\".to_owned(),\n        security_type: \"STK\".to_owned(),\n        exchange: \"ISLAND\".to_owned(),\n        side: \"BUY\".to_owned(),\n    };\n    let results = super::executions(\u0026mut client, filter);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(\n        request_messages[0].encode_simple(),\n        \"7|3|9000|100|xyz|yyyymmdd hh:mm:ss EST|TSLA|STK|ISLAND|BUY|\"\n    );\n\n    assert!(results.is_ok(), \"failed to request completed orders: {}\", results.err().unwrap());\n    // assert_eq!(43, results.unwrap(), \"next order id\");\n}\n\n#[test]\nfn encode_limit_order() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let order_id = 12;\n    let contract = contract_samples::future_with_local_symbol();\n    let order = order_builder::limit_order(super::Action::Buy, 10.0, 500.00);\n\n    let results = super::place_order(\u0026mut client, order_id, \u0026contract, \u0026order);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(\n        request_messages[0].encode_simple(),\n        \"3|12|0||FUT|202303|0|||EUREX||EUR|FGBL MAR 23||||BUY|10|LMT|500||||||0||1|0|0|0|0|0|0|0||0||||||||0||-1|0|||0|||0|0||0||||||0|||||0|||||||||||0|||0|0|||0||0|0|0|0|||||||0|||||||||0|0|0|0|||0|\"\n    );\n\n    assert!(results.is_ok(), \"failed to place order: {}\", results.err().unwrap());\n}\n\n#[test]\nfn encode_combo_market_order() {\n    let mut message_bus = Box::new(MessageBusStub {\n        request_messages: vec![],\n        response_messages: vec![],\n    });\n\n    let mut client = Client::stubbed(message_bus, server_versions::SIZE_RULES);\n\n    let order_id = 12; // get next order id\n    let contract = contract_samples::smart_future_combo_contract();\n    let order = order_builder::combo_market_order(Action::Sell, 150.0, true);\n\n    let results = super::place_order(\u0026mut client, order_id, \u0026contract, \u0026order);\n\n    let request_messages = client.message_bus.request_messages();\n\n    assert_eq!(\n        request_messages[0].encode_simple(),\n        \"3|12|0|WTI|BAG||0|||SMART||USD|||||SELL|150|MKT|||||||0||1|0|0|0|0|0|0|0|2|55928698|1|BUY|IPE|0|0||0|55850663|1|SELL|IPE|0|0||0|0|1|NonGuaranteed|1||0||||||||0||-1|0|||0|||0|0||0||||||0|||||0|||||||||||0|||0|0|||0||0|0|0|0|||||||0|||||||||0|0|0|0|||0|\"\n    );\n\n    assert!(results.is_ok(), \"failed to place order: {}\", results.err().unwrap());\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","orders.rs"],"content":"use std::convert::From;\nuse std::fmt::{self, Debug};\n\nuse anyhow::{anyhow, Result};\nuse log::{error, info};\n\nuse crate::client::transport::{GlobalResponseIterator, ResponseIterator};\nuse crate::client::{Client, RequestMessage, ResponseMessage};\nuse crate::contracts::{ComboLeg, ComboLegOpenClose, Contract, DeltaNeutralContract, SecurityType};\nuse crate::messages::{IncomingMessages, OutgoingMessages};\nuse crate::server_versions;\nuse crate::{encode_option_field, ToField};\n\nmod decoders;\nmod encoders;\n\n/// Make sure to test using only your paper trading account when applicable. A good way of finding out if an order type/exchange combination\n/// is possible is by trying to place such order manually using the TWS.\n/// Before contacting our API support team please refer to the available documentation.\npub mod order_builder;\n\n/// New description\npub use crate::contracts::TagValue;\n\nconst COMPETE_AGAINST_BEST_OFFSET_UP_TO_MID: Option\u003cf64\u003e = Some(f64::INFINITY);\n\n#[derive(Clone, Debug)]\n/// Order describes the order.\npub struct Order {\n    /// The API client's order id.\n    pub order_id: i32,\n    /// The Solicited field should be used for orders initiated or recommended by the broker or adviser that were approved by the client (by phone, email, chat, verbally, etc.) prior to entry. Please note that orders that the adviser or broker placed without specifically discussing with the client are discretionary orders, not solicited.\n    pub solicited: bool,\n    /// The API client id which placed the order.\n    pub client_id: i32,\n    /// The Host order identifier.\n    pub perm_id: i32,\n    /// Identifies the side.\n    /// Generally available values are BUY and SELL.\n    /// Additionally, SSHORT and SLONG are available in some institutional-accounts only.\n    /// For general account types, a SELL order will be able to enter a short position automatically if the order quantity is larger than your current long position.\n    /// SSHORT is only supported for institutional account configured with Long/Short account segments or clearing with a separate account.\n    /// SLONG is available in specially-configured institutional accounts to indicate that long position not yet delivered is being sold.\n    pub action: Action,\n    /// The number of positions being bought/sold.\n    pub total_quantity: f64,\n    /// The order's type.\n    pub order_type: String,\n    /// The LIMIT price.\n    /// Used for limit, stop-limit and relative orders. In all other cases specify zero. For relative orders with no limit price, also specify zero.\n    pub limit_price: Option\u003cf64\u003e,\n    /// Generic field to contain the stop price for STP LMT orders, trailing amount, etc.\n    pub aux_price: Option\u003cf64\u003e,\n    /// The time in force.\n    /// Valid values are:\n    /// DAY - Valid for the day only.\n    /// GTC - Good until canceled. The order will continue to work within the system and in the marketplace until it executes or is canceled. GTC orders will be automatically be cancelled under the following conditions:\n    /// If a corporate action on a security results in a stock split (forward or reverse), exchange for shares, or distribution of shares. If you do not log into your IB account for 90 days.\n    /// At the end of the calendar quarter following the current quarter. For example, an order placed during the third quarter of 2011 will be canceled at the end of the first quarter of 2012. If the last day is a non-trading day, the cancellation will occur at the close of the final trading day of that quarter. For example, if the last day of the quarter is Sunday, the orders will be cancelled on the preceding Friday.\n    /// Orders that are modified will be assigned a new Auto Expire date consistent with the end of the calendar quarter following the current quarter.\n    /// Orders submitted to IB that remain in force for more than one day will not be reduced for dividends. To allow adjustment to your order price on ex-dividend date, consider using a Good-Til-Date/Time (GTD) or Good-after-Time/Date (GAT) order type, or a combination of the two.\n    /// IOC - Immediate or Cancel. Any portion that is not filled as soon as it becomes available in the market is canceled.\n    /// GTD - Good until Date. It will remain working within the system and in the marketplace until it executes or until the close of the market on the date specified\n    /// OPG - Use OPG to send a market-on-open (MOO) or limit-on-open (LOO) order.\n    /// FOK - If the entire Fill-or-Kill order does not execute as soon as it becomes available, the entire order is canceled.\n    /// DTC - Day until Canceled.\n    pub tif: String, // FIXME create enum\n    /// One-Cancels-All group identifier.\n    pub oca_group: String,\n    /// Tells how to handle remaining orders in an OCA group when one order or part of an order executes.\n    /// Valid values are:\n    /// 1 - Cancel all remaining orders with block.\n    /// 2 - Remaining orders are proportionately reduced in size with block.\n    /// 3 - Remaining orders are proportionately reduced in size with no block.\n    /// If you use a value \"with block\" it gives the order overfill protection. This means that only one order in the group will be routed at a time to remove the possibility of an overfill.\n    pub oca_type: i32,\n    /// The order reference.\n    /// Intended for institutional customers only, although all customers may use it to identify the API client that sent the order when multiple API clients are running.\n    pub order_ref: String,\n    /// Specifies whether the order will be transmitted by TWS. If set to false, the order will be created at TWS but will not be sent.\n    pub transmit: bool,\n    /// The order ID of the parent order, used for bracket and auto trailing stop orders.\n    pub parent_id: i32,\n    /// If set to true, specifies that the order is an ISE Block order.\n    pub block_order: bool,\n    /// If set to true, specifies that the order is a Sweep-to-Fill order.\n    pub sweep_to_fill: bool,\n    /// The publicly disclosed order size, used when placing Iceberg orders.\n    pub display_size: Option\u003ci32\u003e,\n    /// Specifies how Simulated Stop, Stop-Limit and Trailing Stop orders are triggered.\n    /// Valid values are:\n    /// 0 - The default value. The \"double bid/ask\" function will be used for orders for OTC stocks and US options. All other orders will used the \"last\" function.\n    /// 1 - use \"double bid/ask\" function, where stop orders are triggered based on two consecutive bid or ask prices.\n    /// 2 - \"last\" function, where stop orders are triggered based on the last price.\n    /// 3 - double last function.\n    /// 4 - bid/ask function.\n    /// 7 - last or bid/ask function.\n    /// 8 - mid-point function.    \n    pub trigger_method: i32,\n    /// If set to true, allows orders to also trigger or fill outside of regular trading hours.\n    pub outside_rth: bool,\n    /// If set to true, the order will not be visible when viewing the market depth. This option only applies to orders routed to the NASDAQ exchange.\n    pub hidden: bool,\n    /// Specifies the date and time after which the order will be active.\n    /// Format: yyyymmdd hh:mm:ss {optional Timezone}.\n    pub good_after_time: String,\n    /// The date and time until the order will be active.\n    /// You must enter GTD as the time in force to use this string. The trade's \"Good Till Date,\" format \"yyyyMMdd HH:mm:ss (optional time zone)\" or UTC \"yyyyMMdd-HH:mm:ss\".\n    pub good_till_date: String,\n    /// Overrides TWS constraints.\n    /// Precautionary constraints are defined on the TWS Presets page, and help ensure tha tyour price and size order values are reasonable. Orders sent from the API are also validated against these safety constraints, and may be rejected if any constraint is violated. To override validation, set this parameters value to True.\n    pub override_percentage_constraints: bool,\n    /// Individual = 'I', Agency = 'A', AgentOtherMember = 'W', IndividualPTIA = 'J', AgencyPTIA = 'U', AgentOtherMemberPTIA = 'M', IndividualPT = 'K', AgencyPT = 'Y', AgentOtherMemberPT = 'N'\n    pub rule_80_a: Option\u003cRule80A\u003e,\n    /// Indicates whether or not all the order has to be filled on a single execution.\n    pub all_or_none: bool,\n    /// Identifies a minimum quantity order type.\n    pub min_qty: Option\u003ci32\u003e,\n    /// The percent offset amount for relative orders.\n    pub percent_offset: Option\u003cf64\u003e,\n    /// Trail stop price for TRAIL LIMIT orders.\n    pub trail_stop_price: Option\u003cf64\u003e,\n    /// Specifies the trailing amount of a trailing stop order as a percentage.\n    /// Observe the following guidelines when using the trailingPercent field:\n    ///\n    /// This field is mutually exclusive with the existing trailing amount. That is, the API client can send one or the other but not both.\n    /// This field is read AFTER the stop price (barrier price) as follows: deltaNeutralAuxPrice stopPrice, trailingPercent, scale order attributes\n    /// The field will also be sent to the API in the openOrder message if the API client version is \u003e= 56. It is sent after the stopPrice field as follows: stopPrice, trailingPct, basisPoint.    \n    pub trailing_percent: Option\u003cf64\u003e,\n    /// The Financial Advisor group the trade will be allocated to. Use an empty string if not applicable.\n    pub fa_group: String,\n    /// The Financial Advisor allocation profile the trade will be allocated to. Use an empty string if not applicable.\n    pub fa_profile: String,\n    /// The Financial Advisor allocation method the trade will be allocated to. Use an empty string if not applicable.\n    pub fa_method: String,\n    /// The Financial Advisor percentage concerning the trade's allocation. Use an empty string if not applicable.\n    pub fa_percentage: String,\n    /// For institutional customers only. Valid values are O (open) and C (close).\n    /// Available for institutional clients to determine if this order is to open or close a position.\n    /// When Action = \"BUY\" and OpenClose = \"O\" this will open a new position.\n    /// When Action = \"BUY\" and OpenClose = \"C\" this will close and existing short position.    \n    pub open_close: Option\u003cOrderOpenClose\u003e,\n    /// The order's origin. Same as TWS \"Origin\" column. Identifies the type of customer from which the order originated.\n    /// Valid values are:\n    /// 0 - Customer\n    /// 1 - Firm.\n    pub origin: i32,\n    /// For institutions only.\n    /// Valid values are:\n    /// 1 - Broker holds shares\n    /// 2 - Shares come from elsewhere.    \n    pub short_sale_slot: i32,\n    /// For institutions only. Indicates the location where the shares to short come from. Used only when short sale slot is set to 2 (which means that the shares to short are held elsewhere and not with IB).\n    pub designated_location: String,\n    /// Only available with IB Execution-Only accounts with applicable securities.\n    /// Mark order as exempt from short sale uptick rule.\n    pub exempt_code: i32,\n    /// The amount off the limit price allowed for discretionary orders.\n    pub discretionary_amt: f64,\n    /// Use to opt out of default SmartRouting for orders routed directly to ASX.\n    /// This attribute defaults to false unless explicitly set to true.\n    /// When set to false, orders routed directly to ASX will NOT use SmartRouting.\n    /// When set to true, orders routed directly to ASX orders WILL use SmartRouting.\n    pub opt_out_smart_routing: bool,\n    /// For BOX orders only.\n    /// Values include:\n    /// 1 - Match\n    /// 2 - Improvement\n    /// 3 - Transparent.\n    pub auction_strategy: Option\u003ci32\u003e, // FIXME enum\n    /// The auction's starting price. For BOX orders only.\n    pub starting_price: Option\u003cf64\u003e,\n    /// The stock's reference price.\n    /// The reference price is used for VOL orders to compute the limit price sent to an exchange (whether or not Continuous Update is selected), and for price range monitoring.    \n    pub stock_ref_price: Option\u003cf64\u003e,\n    /// The stock's Delta. For orders on BOX only.\n    pub delta: Option\u003cf64\u003e,\n    /// The lower value for the acceptable underlying stock price range.\n    /// For price improvement option orders on BOX and VOL orders with dynamic management.    \n    pub stock_range_lower: Option\u003cf64\u003e,\n    /// The upper value for the acceptable underlying stock price range.\n    /// For price improvement option orders on BOX and VOL orders with dynamic management.\n    pub stock_range_upper: Option\u003cf64\u003e,\n    /// The option price in volatility, as calculated by TWS' Option Analytics.\n    /// This value is expressed as a percent and is used to calculate the limit price sent to the exchange.\n    pub volatility: Option\u003cf64\u003e,\n    /// Values include:\n    /// 1 - Daily Volatility\n    /// 2 - Annual Volatility.\n    pub volatility_type: Option\u003ci32\u003e, // FIXM enum\n    /// Specifies whether TWS will automatically update the limit price of the order as the underlying price moves. VOL orders only.\n    pub continuous_update: bool,\n    /// Specifies how you want TWS to calculate the limit price for options, and for stock range price monitoring.\n    /// VOL orders only.\n    /// Valid values include:\n    /// 1 - Average of NBBO\n    /// 2 - NBB or the NBO depending on the action and right.\n    pub reference_price_type: Option\u003ci32\u003e,\n    /// Enter an order type to instruct TWS to submit a delta neutral trade on full or partial execution of the VOL order. VOL orders only. For no hedge delta order to be sent, specify NONE.\n    pub delta_neutral_order_type: String,\n    /// Use this field to enter a value if the value in the deltaNeutralOrderType field is an order type that requires an Aux price, such as a REL order. VOL orders only.\n    pub delta_neutral_aux_price: Option\u003cf64\u003e,\n    /// The unique contract identifier specifying the security in Delta Neutral order.\n    pub delta_neutral_con_id: i32,\n    /// Indicates the firm which will settle the Delta Neutral trade. Institutions only.\n    pub delta_neutral_settling_firm: String,\n    /// Specifies the beneficiary of the Delta Neutral order.\n    pub delta_neutral_clearing_account: String,\n    /// Specifies where the clients want their shares to be cleared at. Must be specified by execution-only clients.\n    /// Valid values are:\n    /// IB, Away, and PTA (post trade allocation).\n    pub delta_neutral_clearing_intent: String,\n    /// Specifies whether the order is an Open or a Close order and is used when the hedge involves a CFD and and the order is clearing away.\n    pub delta_neutral_open_close: String,\n    /// Used when the hedge involves a stock and indicates whether or not it is sold short.\n    pub delta_neutral_short_sale: bool,\n    /// Indicates a short sale Delta Neutral order. Has a value of 1 (the clearing broker holds shares) or 2 (delivered from a third party). If you use 2, then you must specify a deltaNeutralDesignatedLocation.\n    pub delta_neutral_short_sale_slot: i32,\n    /// Identifies third party order origin. Used only when deltaNeutralShortSaleSlot = 2.\n    pub delta_neutral_designated_location: String,\n    /// Specifies Basis Points for EFP order. The values increment in 0.01% = 1 basis point. For EFP orders only.\n    pub basis_points: Option\u003cf64\u003e,\n    /// Specifies the increment of the Basis Points. For EFP orders only.\n    pub basis_points_type: Option\u003ci32\u003e,\n    /// Defines the size of the first, or initial, order component. For Scale orders only.\n    pub scale_init_level_size: Option\u003ci32\u003e,\n    /// Defines the order size of the subsequent scale order components. For Scale orders only. Used in conjunction with scaleInitLevelSize().\n    pub scale_subs_level_size: Option\u003ci32\u003e,\n    /// Defines the price increment between scale components. For Scale orders only. This value is compulsory.\n    pub scale_price_increment: Option\u003cf64\u003e,\n    /// Modifies the value of the Scale order. For extended Scale orders.\n    pub scale_price_adjust_value: Option\u003cf64\u003e,\n    /// Specifies the interval when the price is adjusted. For extended Scale orders.\n    pub scale_price_adjust_interval: Option\u003ci32\u003e,\n    /// Specifies the offset when to adjust profit. For extended scale orders.\n    pub scale_profit_offset: Option\u003cf64\u003e,\n    /// Restarts the Scale series if the order is cancelled. For extended scale orders.\n    pub scale_auto_reset: bool,\n    /// The initial position of the Scale order. For extended scale orders.\n    pub scale_init_position: Option\u003ci32\u003e,\n    /// Specifies the initial quantity to be filled. For extended scale orders.\n    pub scale_init_fill_qty: Option\u003ci32\u003e,\n    /// Defines the random percent by which to adjust the position. For extended scale orders.\n    pub scale_random_percent: bool,\n    /// For hedge orders.\n    /// Possible values include:\n    /// D - Delta\n    /// B - Beta\n    /// F - FX\n    /// P - Pair\n    pub hedge_type: String,\n    /// For hedge orders.\n    /// Beta = x for Beta hedge orders, ratio = y for Pair hedge order\n    pub hedge_param: String,\n    /// The account the trade will be allocated to.    \n    pub account: String,\n    /// Indicates the firm which will settle the trade. Institutions only.\n    pub settling_firm: String,\n    /// Specifies the true beneficiary of the order.\n    /// For IBExecution customers. This value is required for FUT/FOP orders for reporting to the exchange.\n    pub clearing_account: String,\n    /// For execution-only clients to know where do they want their shares to be cleared at.\n    /// Valid values are:\n    /// IB, Away, and PTA (post trade allocation).\n    pub clearing_intent: String,\n    /// The algorithm strategy.\n    /// As of API verion 9.6, the following algorithms are supported:\n    /// ArrivalPx - Arrival Price\n    /// DarkIce - Dark Ice\n    /// PctVol - Percentage of Volume\n    /// Twap - TWAP (Time Weighted Average Price)\n    /// Vwap - VWAP (Volume Weighted Average Price)\n    /// For more information about IB's API algorithms, refer to [https://www.interactivebrokers.com/en/software/api/apiguide/tables/ibalgo_parameters.htm](https://www.interactivebrokers.com/en/software/api/apiguide/tables/ibalgo_parameters.htm)\n    pub algo_strategy: String,\n    /// The list of parameters for the IB algorithm.\n    /// For more information about IB's API algorithms, refer to [https://www.interactivebrokers.com/en/software/api/apiguide/tables/ibalgo_parameters.htm](https://www.interactivebrokers.com/en/software/api/apiguide/tables/ibalgo_parameters.htm)\n    pub algo_params: Vec\u003cTagValue\u003e,\n    /// Allows to retrieve the commissions and margin information.\n    /// When placing an order with this attribute set to true, the order will not be placed as such. Instead it will used to request the commissions and margin information that would result from this order.\n    pub what_if: bool,\n    /// Identifies orders generated by algorithmic trading.\n    pub algo_id: String,\n    /// Orders routed to IBDARK are tagged as post only and are held in IB's order book, where incoming SmartRouted orders from other IB customers are eligible to trade against them.\n    /// For IBDARK orders only.\n    pub not_held: bool,\n    /// Advanced parameters for Smart combo routing.\n    /// These features are for both guaranteed and nonguaranteed combination orders routed to Smart, and are available based on combo type and order type. SmartComboRoutingParams is similar to AlgoParams in that it makes use of tag/value pairs to add parameters to combo orders.\n    /// Make sure that you fully understand how Advanced Combo Routing works in TWS itself first: \u003chttps://guides.interactivebrokers.com/tws/twsguide.htm#usersguidebook/specializedorderentry/advanced_combo_routing.htm\u003e\n    /// The parameters cover the following capabilities:\n    ///\n    /// * Non-Guaranteed - Determine if the combo order is Guaranteed or Non-Guaranteed.\n    ///   \u003cbr/\u003eTag = NonGuaranteed\n    ///   \u003cbr/\u003eValue = 0: The order is guaranteed\n    ///   \u003cbr/\u003eValue = 1: The order is non-guaranteed\n    ///\n    /// * Select Leg to Fill First - User can specify which leg to be executed first.\n    ///   \u003cbr/\u003eTag = LeginPrio\n    ///   \u003cbr/\u003eValue = -1: No priority is assigned to either combo leg\n    ///   \u003cbr/\u003eValue = 0: Priority is assigned to the first leg being added to the comboLeg\n    ///   \u003cbr/\u003eValue = 1: Priority is assigned to the second leg being added to the comboLeg\n    ///   \u003cbr/\u003eNote: The LeginPrio parameter can only be applied to two-legged combo.\n    ///\n    /// * Maximum Leg-In Combo Size - Specify the maximum allowed leg-in size per segment\n    ///   \u003cbr/\u003eTag = MaxSegSize\n    ///   \u003cbr/\u003eValue = Unit of combo size\n    ///\n    /// * Do Not Start Next Leg-In if Previous Leg-In Did Not Finish - Specify whether or not the system should attempt to fill the next segment before the current segment fills.\n    ///   \u003cbr/\u003eTag = DontLeginNext\n    ///   \u003cbr/\u003eValue = 0: Start next leg-in even if previous leg-in did not finish\n    ///   \u003cbr/\u003eValue = 1: Do not start next leg-in if previous leg-in did not finish\n    ///\n    /// * Price Condition - Combo order will be rejected or cancelled if the leg market price is outside of the specified price range [CondPriceMin, CondPriceMax]\n    ///   \u003cbr/\u003eTag = PriceCondConid: The ContractID of the combo leg to specify price condition on\n    ///   \u003cbr/\u003eValue = The ContractID\n    ///   \u003cbr/\u003eTag = CondPriceMin: The lower price range of the price condition\n    ///   \u003cbr/\u003eValue = The lower price\n    ///   \u003cbr/\u003eTag = CondPriceMax: The upper price range of the price condition\n    ///   \u003cbr/\u003eValue = The upper price    \n    pub smart_combo_routing_params: Vec\u003cTagValue\u003e,\n    /// List of Per-leg price following the same sequence combo legs are added. The combo price must be left unspecified when using per-leg prices.\n    pub order_combo_legs: Vec\u003cOrderComboLeg\u003e,\n    /// For internal use only. Use the default value XYZ.\n    pub order_misc_options: Vec\u003cTagValue\u003e,\n    /// Defines the start time of GTC orders.\n    pub active_start_time: String,\n    /// Defines the stop time of GTC orders.\n    pub active_stop_time: String,\n    /// The list of scale orders. Used for scale orders.\n    pub scale_table: String,\n    /// Is used to place an order to a model. For example, \"Technology\" model can be used for tech stocks first created in TWS.\n    pub model_code: String,\n    /// This is a regulartory attribute that applies to all US Commodity (Futures) Exchanges, provided to allow client to comply with CFTC Tag 50 Rules.\n    pub ext_operator: String,\n    /// The native cash quantity.\n    pub cash_qty: Option\u003cf64\u003e,\n    /// Identifies a person as the responsible party for investment decisions within the firm. Orders covered by MiFID 2 (Markets in Financial Instruments Directive 2) must include either Mifid2DecisionMaker or Mifid2DecisionAlgo field (but not both). Requires TWS 969+.\n    pub mifid2_decision_maker: String,\n    /// Identifies the algorithm responsible for investment decisions within the firm. Orders covered under MiFID 2 must include either Mifid2DecisionMaker or Mifid2DecisionAlgo, but cannot have both. Requires TWS 969+.\n    pub mifid2_decision_algo: String,\n    /// For MiFID 2 reporting; identifies a person as the responsible party for the execution of a transaction within the firm. Requires TWS 969+.\n    pub mifid2_execution_trader: String,\n    /// For MiFID 2 reporting; identifies the algorithm responsible for the execution of a transaction within the firm. Requires TWS 969+.\n    pub mifid2_execution_algo: String,\n    /// Don't use auto price for hedge.\n    pub dont_use_auto_price_for_hedge: bool,\n    /// Specifies the date to auto cancel the order.\n    pub auto_cancel_date: String, // TODO date object\n    /// Specifies the initial order quantity to be filled.\n    pub filled_quantity: f64,\n    /// Identifies the reference future conId.\n    pub ref_futures_con_id: Option\u003ci32\u003e,\n    /// Cancels the parent order if child order was cancelled.\n    pub auto_cancel_parent: bool,\n    /// Identifies the Shareholder.\n    pub shareholder: String,\n    /// Used to specify \"imbalance only open orders\" or \"imbalance only closing orders\".\n    pub imbalance_only: bool,\n    /// Routes market order to Best Bid Offer.\n    pub route_marketable_to_bbo: bool,\n    /// Parent order Id.\n    pub parent_perm_id: Option\u003ci64\u003e,\n    /// Accepts a list with parameters obtained from advancedOrderRejectJson.\n    pub advanced_error_override: String,\n    /// Used by brokers and advisors when manually entering, modifying or cancelling orders at the direction of a client. Only used when allocating orders to specific groups or accounts. Excluding \"All\" group.\n    pub manual_order_time: String,\n    /// Defines the minimum trade quantity to fill. For IBKRATS orders.\n    pub min_trade_qty: Option\u003ci32\u003e,\n    /// Defines the minimum size to compete. For IBKRATS orders.\n    pub min_compete_size: Option\u003ci32\u003e,\n    /// Specifies the offset off the midpoint that will be applied to the order. For IBKRATS orders.\n    pub compete_against_best_offset: Option\u003cf64\u003e,\n    /// his offset is applied when the spread is an even number of cents wide. This offset must be in whole-penny increments or zero. For IBKRATS orders.\n    pub mid_offset_at_whole: Option\u003cf64\u003e,\n    /// This offset is applied when the spread is an odd number of cents wide. This offset must be in half-penny increments. For IBKRATS orders.\n    pub mid_offset_at_half: Option\u003cf64\u003e,\n    /// Randomizes the order's size. Only for Volatility and Pegged to Volatility orders.\n    pub randomize_size: bool,\n    /// Randomizes the order's price. Only for Volatility and Pegged to Volatility orders.\n    pub randomize_price: bool,\n    /// Pegged-to-benchmark orders: this attribute will contain the conId of the contract against which the order will be pegged.\n    pub reference_contract_id: i32,\n    /// Pegged-to-benchmark orders: indicates whether the order's pegged price should increase or decreases.\n    pub is_pegged_change_amount_decrease: bool,\n    /// Pegged-to-benchmark orders: amount by which the order's pegged price should move.\n    pub pegged_change_amount: Option\u003cf64\u003e,\n    /// Pegged-to-benchmark orders: the amount the reference contract needs to move to adjust the pegged order.\n    pub reference_change_amount: Option\u003cf64\u003e,\n    /// Pegged-to-benchmark orders: the exchange against which we want to observe the reference contract.\n    pub reference_exchange: String,\n    /// Adjusted Stop orders: the parent order will be adjusted to the given type when the adjusted trigger price is penetrated.\n    pub adjusted_order_type: String,\n    /// Adjusted Stop orders: specifies the trigger price to execute.\n    pub trigger_price: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies the price offset for the stop to move in increments.\n    pub limit_price_offset: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies the stop price of the adjusted (STP) parent.\n    pub adjusted_stop_price: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies the stop limit price of the adjusted (STPL LMT) parent.\n    pub adjusted_stop_limit_price: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies the trailing amount of the adjusted (TRAIL) parent.\n    pub adjusted_trailing_amount: Option\u003cf64\u003e,\n    /// Adjusted Stop orders: specifies where the trailing unit is an amount (set to 0) or a percentage (set to 1)\n    pub adjustable_trailing_unit: i32,\n    /// Conditions determining when the order will be activated or canceled.\n    pub conditions: Vec\u003cOrderCondition\u003e,\n    /// Indicates whether or not conditions will also be valid outside Regular Trading Hours.\n    pub conditions_ignore_rth: bool,\n    /// Conditions can determine if an order should become active or canceled.\n    pub conditions_cancel_order: bool,\n    /// Define the Soft Dollar Tier used for the order. Only provided for registered professional advisors and hedge and mutual funds.\n    pub soft_dollar_tier: SoftDollarTier,\n    /// Set to true to create tickets from API orders when TWS is used as an OMS.\n    pub is_oms_container: bool,\n    /// Set to true to convert order of type 'Primary Peg' to 'D-Peg'.\n    pub discretionary_up_to_limit_price: bool,\n    /// Specifies wether to use Price Management Algo. CTCI users only.\n    pub use_price_mgmt_algo: bool,\n    /// Specifies the duration of the order. Format: yyyymmdd hh:mm:ss TZ. For GTD orders.\n    pub duration: Option\u003ci32\u003e, // TODO date object?\n    /// Value must be positive, and it is number of seconds that SMART order would be parked for at IBKRATS before being routed to exchange.\n    pub post_to_ats: Option\u003ci32\u003e,\n}\n\nimpl Default for Order {\n    fn default() -\u003e Self {\n        Self {\n            order_id: 0,\n            solicited: false,\n            client_id: 0,\n            perm_id: 0,\n            action: Action::Buy,\n            total_quantity: 0.0,\n            order_type: \"\".to_owned(),\n            limit_price: None,\n            aux_price: None,\n            tif: \"\".to_owned(),\n            oca_group: \"\".to_owned(),\n            oca_type: 0,\n            order_ref: \"\".to_owned(),\n            transmit: true,\n            parent_id: 0,\n            block_order: false,\n            sweep_to_fill: false,\n            display_size: Some(0), // TODO - default to None?\n            trigger_method: 0,\n            outside_rth: false,\n            hidden: false,\n            good_after_time: \"\".to_owned(),\n            good_till_date: \"\".to_owned(),\n            override_percentage_constraints: false,\n            rule_80_a: None,\n            all_or_none: false,\n            min_qty: None,\n            percent_offset: None,\n            trail_stop_price: None,\n            trailing_percent: None,\n            fa_group: \"\".to_owned(),\n            fa_profile: \"\".to_owned(),\n            fa_method: \"\".to_owned(),\n            fa_percentage: \"\".to_owned(),\n            open_close: None,\n            origin: 0,\n            short_sale_slot: 0,\n            designated_location: \"\".to_owned(),\n            exempt_code: -1,\n            discretionary_amt: 0.0,\n            opt_out_smart_routing: false,\n            auction_strategy: Some(0), // TODO - use enum\n            starting_price: None,\n            stock_ref_price: None,\n            delta: None,\n            stock_range_lower: None,\n            stock_range_upper: None,\n            volatility: None,\n            volatility_type: None,\n            continuous_update: false,\n            reference_price_type: None,\n            delta_neutral_order_type: \"\".to_owned(),\n            delta_neutral_aux_price: None,\n            delta_neutral_con_id: 0,\n            delta_neutral_settling_firm: \"\".to_owned(),\n            delta_neutral_clearing_account: \"\".to_owned(),\n            delta_neutral_clearing_intent: \"\".to_owned(),\n            delta_neutral_open_close: \"\".to_owned(),\n            delta_neutral_short_sale: false,\n            delta_neutral_short_sale_slot: 0,\n            delta_neutral_designated_location: \"\".to_owned(),\n            basis_points: Some(0.0),\n            basis_points_type: Some(0),\n            scale_init_level_size: None,\n            scale_subs_level_size: None,\n            scale_price_increment: None,\n            scale_price_adjust_value: None,\n            scale_price_adjust_interval: None,\n            scale_profit_offset: None,\n            scale_auto_reset: false,\n            scale_init_position: None,\n            scale_init_fill_qty: None,\n            scale_random_percent: false,\n            hedge_type: \"\".to_owned(),\n            hedge_param: \"\".to_owned(),\n            account: \"\".to_owned(),\n            settling_firm: \"\".to_owned(),\n            clearing_account: \"\".to_owned(),\n            clearing_intent: \"\".to_owned(),\n            algo_strategy: \"\".to_owned(),\n            algo_params: vec![],\n            what_if: false,\n            algo_id: \"\".to_owned(),\n            not_held: false,\n            smart_combo_routing_params: vec![],\n            order_combo_legs: vec![],\n            order_misc_options: vec![],\n            active_start_time: \"\".to_owned(),\n            active_stop_time: \"\".to_owned(),\n            scale_table: \"\".to_owned(),\n            model_code: \"\".to_owned(),\n            ext_operator: \"\".to_owned(),\n            cash_qty: None,\n            mifid2_decision_maker: \"\".to_owned(),\n            mifid2_decision_algo: \"\".to_owned(),\n            mifid2_execution_trader: \"\".to_owned(),\n            mifid2_execution_algo: \"\".to_owned(),\n            dont_use_auto_price_for_hedge: false,\n            auto_cancel_date: \"\".to_owned(),\n            filled_quantity: 0.0,\n            ref_futures_con_id: Some(0),\n            auto_cancel_parent: false,\n            shareholder: \"\".to_owned(),\n            imbalance_only: false,\n            route_marketable_to_bbo: false,\n            parent_perm_id: None,\n            advanced_error_override: \"\".to_owned(),\n            manual_order_time: \"\".to_owned(),\n            min_trade_qty: None,\n            min_compete_size: None,\n            compete_against_best_offset: None,\n            mid_offset_at_whole: None,\n            mid_offset_at_half: None,\n            randomize_size: false,\n            randomize_price: false,\n            reference_contract_id: 0,\n            is_pegged_change_amount_decrease: false,\n            pegged_change_amount: Some(0.0),\n            reference_change_amount: Some(0.0),\n            reference_exchange: \"\".to_owned(),\n            adjusted_order_type: \"\".to_owned(),\n            trigger_price: None,\n            limit_price_offset: None,\n            adjusted_stop_price: None,\n            adjusted_stop_limit_price: None,\n            adjusted_trailing_amount: None,\n            adjustable_trailing_unit: 0,\n            conditions: vec![],\n            conditions_ignore_rth: false,\n            conditions_cancel_order: false,\n            soft_dollar_tier: SoftDollarTier::default(),\n            is_oms_container: false,\n            discretionary_up_to_limit_price: false,\n            use_price_mgmt_algo: false,\n            duration: None,\n            post_to_ats: None,\n        }\n    }\n}\n\nimpl Order {\n    pub fn is_delta_neutral(\u0026self) -\u003e bool {\n        !self.delta_neutral_order_type.is_empty()\n    }\n\n    pub fn is_scale_order(\u0026self) -\u003e bool {\n        match self.scale_price_increment {\n            Some(price_increment) =\u003e price_increment \u003e 0.0,\n            _ =\u003e false,\n        }\n    }\n}\n\n/// Identifies the side.\n/// Generally available values are BUY and SELL.\n/// Additionally, SSHORT and SLONG are available in some institutional-accounts only.\n/// For general account types, a SELL order will be able to enter a short position automatically if the order quantity is larger than your current long position.\n/// SSHORT is only supported for institutional account configured with Long/Short account segments or clearing with a separate account.\n/// SLONG is available in specially-configured institutional accounts to indicate that long position not yet delivered is being sold.\n#[derive(Clone, Debug, Default, PartialEq, Eq)]\npub enum Action {\n    #[default]\n    Buy,\n    Sell,\n    /// SSHORT is only supported for institutional account configured with Long/Short account segments or clearing with a separate account.\n    SellShort,\n    /// SLONG is available in specially-configured institutional accounts to indicate that long position not yet delivered is being sold.\n    SellLong,\n}\n\nimpl ToField for Action {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToString for Action {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            Action::Buy =\u003e String::from(\"BUY\"),\n            Action::Sell =\u003e String::from(\"SELL\"),\n            Action::SellShort =\u003e String::from(\"SSHORT\"),\n            Action::SellLong =\u003e String::from(\"SLONG\"),\n        }\n    }\n}\n\nimpl Action {\n    fn reverse(\u0026self) -\u003e Action {\n        match self {\n            Action::Buy =\u003e Action::Sell,\n            Action::Sell =\u003e Action::Buy,\n            Action::SellShort =\u003e Action::SellLong,\n            Action::SellLong =\u003e Action::SellShort,\n        }\n    }\n\n    pub fn from(name: \u0026str) -\u003e Self {\n        match name {\n            \"BUY\" =\u003e Self::Buy,\n            \"SELL\" =\u003e Self::Sell,\n            \"SSHORT\" =\u003e Self::SellShort,\n            \"SLONG\" =\u003e Self::SellLong,\n            \u0026_ =\u003e todo!(),\n        }\n    }\n}\n\n#[derive(Clone, Debug, PartialEq)]\npub enum Rule80A {\n    Individual,\n    Agency,\n    AgentOtherMember,\n    IndividualPTIA,\n    AgencyPTIA,\n    AgentOtherMemberPTIA,\n    IndividualPT,\n    AgencyPT,\n    AgentOtherMemberPT,\n}\n\nimpl ToField for Rule80A {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003cRule80A\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl ToString for Rule80A {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            Rule80A::Individual =\u003e String::from('I'),\n            Rule80A::Agency =\u003e String::from('A'),\n            Rule80A::AgentOtherMember =\u003e String::from('W'),\n            Rule80A::IndividualPTIA =\u003e String::from('J'),\n            Rule80A::AgencyPTIA =\u003e String::from('U'),\n            Rule80A::AgentOtherMemberPTIA =\u003e String::from('M'),\n            Rule80A::IndividualPT =\u003e String::from('K'),\n            Rule80A::AgencyPT =\u003e String::from('Y'),\n            Rule80A::AgentOtherMemberPT =\u003e String::from('N'),\n        }\n    }\n}\n\nimpl Rule80A {\n    pub fn from(source: \u0026str) -\u003e Option\u003cSelf\u003e {\n        match source {\n            \"I\" =\u003e Some(Rule80A::Individual),\n            \"A\" =\u003e Some(Rule80A::Agency),\n            \"W\" =\u003e Some(Rule80A::AgentOtherMember),\n            \"J\" =\u003e Some(Rule80A::IndividualPTIA),\n            \"U\" =\u003e Some(Rule80A::AgencyPTIA),\n            \"M\" =\u003e Some(Rule80A::AgentOtherMemberPTIA),\n            \"K\" =\u003e Some(Rule80A::IndividualPT),\n            \"Y\" =\u003e Some(Rule80A::AgencyPT),\n            \"N\" =\u003e Some(Rule80A::AgentOtherMemberPT),\n            _ =\u003e None,\n        }\n    }\n}\n\npub enum AuctionStrategy {\n    Match,\n    Improvement,\n    Transparent,\n}\n\n#[derive(Clone, Debug, Default)]\npub struct OrderComboLeg {\n    price: Option\u003cf64\u003e,\n}\n\n#[derive(Copy, Clone, Debug)]\npub enum OrderCondition {\n    Price = 1,\n    Time = 3,\n    Margin = 4,\n    Execution = 5,\n    Volume = 6,\n    PercentChange = 7,\n}\n\nimpl ToField for OrderCondition {\n    fn to_field(\u0026self) -\u003e String {\n        (*self as u8).to_string()\n    }\n}\n\nimpl ToField for Option\u003cOrderCondition\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl From\u003ci32\u003e for OrderCondition {\n    fn from(val: i32) -\u003e Self {\n        match val {\n            1 =\u003e OrderCondition::Price,\n            3 =\u003e OrderCondition::Time,\n            4 =\u003e OrderCondition::Volume,\n            5 =\u003e OrderCondition::Execution,\n            6 =\u003e OrderCondition::Volume,\n            7 =\u003e OrderCondition::PercentChange,\n            _ =\u003e panic!(\"OrderCondition({val}) is unsupported\"),\n        }\n    }\n}\n\n/// Stores Soft Dollar Tier information.\n#[derive(Clone, Debug, Default)]\npub struct SoftDollarTier {\n    pub name: String,\n    pub value: String,\n    pub display_name: String,\n}\n\n#[derive(Clone, Debug, Default)]\npub struct OrderData {\n    /// The order's unique id\n    pub order_id: i32,\n    /// The order's Contract.\n    pub contract: Contract,\n    /// The currently active order\n    pub order: Order,\n    /// The order's OrderState\n    pub order_state: OrderState,\n}\n\n/// Provides an active order's current state.\n#[derive(Clone, Debug, Default)]\npub struct OrderState {\n    /// The order's current status\n    pub status: String,\n    /// The account's current initial margin.\n    pub initial_margin_before: Option\u003cf64\u003e,\n    /// The account's current maintenance margin\n    pub maintenance_margin_before: Option\u003cf64\u003e,\n    /// The account's current equity with loan\n    pub equity_with_loan_before: Option\u003cf64\u003e,\n    /// The change of the account's initial margin.\n    pub initial_margin_change: Option\u003cf64\u003e,\n    /// The change of the account's maintenance margin\n    pub maintenance_margin_change: Option\u003cf64\u003e,\n    /// The change of the account's equity with loan\n    pub equity_with_loan_change: Option\u003cf64\u003e,\n    /// The order's impact on the account's initial margin.\n    pub initial_margin_after: Option\u003cf64\u003e,\n    /// The order's impact on the account's maintenance margin\n    pub maintenance_margin_after: Option\u003cf64\u003e,\n    /// Shows the impact the order would have on the account's equity with loan\n    pub equity_with_loan_after: Option\u003cf64\u003e,\n    /// The order's generated commission.\n    pub commission: Option\u003cf64\u003e,\n    // The execution's minimum commission.\n    pub minimum_commission: Option\u003cf64\u003e,\n    /// The executions maximum commission.\n    pub maximum_commission: Option\u003cf64\u003e,\n    /// The generated commission currency\n    pub commission_currency: String,\n    /// If the order is warranted, a descriptive message will be provided.\n    pub warning_text: String,\n    pub completed_time: String,\n    pub completed_status: String,\n}\n\n/// For institutional customers only. Valid values are O (open) and C (close).\n/// Available for institutional clients to determine if this order is to open or close a position.\n/// When Action = \"BUY\" and OpenClose = \"O\" this will open a new position.\n/// When Action = \"BUY\" and OpenClose = \"C\" this will close and existing short position.\n#[derive(Clone, Debug, PartialEq)]\npub enum OrderOpenClose {\n    Open,\n    Close,\n}\n\nimpl ToField for OrderOpenClose {\n    fn to_field(\u0026self) -\u003e String {\n        self.to_string()\n    }\n}\n\nimpl ToField for Option\u003cOrderOpenClose\u003e {\n    fn to_field(\u0026self) -\u003e String {\n        encode_option_field(self)\n    }\n}\n\nimpl ToString for OrderOpenClose {\n    fn to_string(\u0026self) -\u003e String {\n        match self {\n            OrderOpenClose::Open =\u003e String::from(\"O\"),\n            OrderOpenClose::Close =\u003e String::from(\"C\"),\n        }\n    }\n}\n\nimpl OrderOpenClose {\n    pub fn from(source: \u0026str) -\u003e Option\u003cSelf\u003e {\n        match source {\n            \"O\" =\u003e Some(OrderOpenClose::Open),\n            \"C\" =\u003e Some(OrderOpenClose::Close),\n            _ =\u003e None,\n        }\n    }\n}\n\n/// Represents the commission generated by an execution.\n#[derive(Clone, Debug, Default)]\npub struct CommissionReport {\n    /// the execution's id this commission belongs to.\n    pub execution_id: String,\n    /// the commissions cost.\n    pub commission: f64,\n    /// the reporting currency.\n    pub currency: String,\n    /// the realized profit and loss\n    pub realized_pnl: Option\u003cf64\u003e,\n    /// The income return.\n    pub yields: Option\u003cf64\u003e,\n    /// date expressed in yyyymmdd format.\n    pub yield_redemption_date: String,\n}\n\n#[derive(Clone, Debug, Default, PartialEq)]\npub enum Liquidity {\n    #[default]\n    None = 0,\n    AddedLiquidity = 1,\n    RemovedLiquidity = 2,\n    LiquidityRoutedOut = 3,\n}\n\nimpl From\u003ci32\u003e for Liquidity {\n    fn from(val: i32) -\u003e Self {\n        match val {\n            0 =\u003e Liquidity::None,\n            1 =\u003e Liquidity::AddedLiquidity,\n            2 =\u003e Liquidity::RemovedLiquidity,\n            3 =\u003e Liquidity::LiquidityRoutedOut,\n            _ =\u003e panic!(\"unsupported Liquidity({val})\"),\n        }\n    }\n}\n\n/// Describes an order's execution.\n#[derive(Clone, Debug, Default)]\npub struct Execution {\n    /// The API client's order Id. May not be unique to an account.\n    pub order_id: i32,\n    /// The API client identifier which placed the order which originated this execution.\n    pub client_id: i32,\n    /// The execution's identifier. Each partial fill has a separate ExecId.\n    /// A correction is indicated by an ExecId which differs from a previous ExecId in only the digits after the final period,\n    /// e.g. an ExecId ending in \".02\" would be a correction of a previous execution with an ExecId ending in \".01\"\n    pub execution_id: String,\n    /// The execution's server time.\n    pub time: String,\n    /// The account to which the order was allocated.\n    pub account_number: String,\n    /// The exchange where the execution took place.\n    pub exchange: String,\n    /// Specifies if the transaction was buy or sale\n    /// BOT for bought, SLD for sold\n    pub side: String,\n    /// The number of shares filled.\n    pub shares: f64,\n    /// The order's execution price excluding commissions.\n    pub price: f64,\n    /// The TWS order identifier. The PermId can be 0 for trades originating outside IB.\n    pub perm_id: i32,\n    /// Identifies whether an execution occurred because of an IB-initiated liquidation.\n    pub liquidation: i32,\n    /// Cumulative quantity.\n    // Used in regular trades, combo trades and legs of the combo.\n    pub cumulative_quantity: f64,\n    /// Average price.\n    /// Used in regular trades, combo trades and legs of the combo. Does not include commissions.\n    pub average_price: f64,\n    /// The OrderRef is a user-customizable string that can be set from the API or TWS and will be associated with an order for its lifetime.\n    pub order_reference: String,\n    /// The Economic Value Rule name and the respective optional argument.\n    /// The two values should be separated by a colon. For example, aussieBond:YearsToExpiration=3. When the optional argument is not present, the first value will be followed by a colon.\n    pub ev_rule: String,\n    /// Tells you approximately how much the market value of a contract would change if the price were to change by 1.\n    /// It cannot be used to get market value by multiplying the price by the approximate multiplier.\n    pub ev_multiplier: Option\u003cf64\u003e,\n    /// model code\n    pub model_code: String,\n    // The liquidity type of the execution. Requires TWS 968+ and API v973.05+. Python API specifically requires API v973.06+.\n    pub last_liquidity: Liquidity,\n}\n\n#[derive(Clone, Debug, Default)]\npub struct ExecutionData {\n    pub request_id: i32,\n    pub contract: Contract,\n    pub execution: Execution,\n}\n\n#[derive(Clone, Debug)]\npub enum OrderNotification {\n    OrderStatus(OrderStatus),\n    OpenOrder(OrderData),\n    ExecutionData(ExecutionData),\n    CommissionReport(CommissionReport),\n    Message(String),\n}\n\nimpl From\u003cOrderStatus\u003e for OrderNotification {\n    fn from(val: OrderStatus) -\u003e Self {\n        OrderNotification::OrderStatus(val)\n    }\n}\n\nimpl From\u003cOrderData\u003e for OrderNotification {\n    fn from(val: OrderData) -\u003e Self {\n        OrderNotification::OpenOrder(val)\n    }\n}\n\nimpl From\u003cExecutionData\u003e for OrderNotification {\n    fn from(val: ExecutionData) -\u003e Self {\n        OrderNotification::ExecutionData(val)\n    }\n}\n\nimpl From\u003cCommissionReport\u003e for OrderNotification {\n    fn from(val: CommissionReport) -\u003e Self {\n        OrderNotification::CommissionReport(val)\n    }\n}\n\n/// Contains all relevant information on the current status of the order execution-wise (i.e. amount filled and pending, filling price, etc.).\n#[derive(Clone, Debug, Default)]\npub struct OrderStatus {\n    /// The order's client id.\n    order_id: i32,\n    /// The current status of the order. Possible values:\n    ///     ApiPending - indicates order has not yet been sent to IB server, for instance if there is a delay in receiving the security definition. Uncommonly received.\n    ///     PendingSubmit - indicates that you have transmitted the order, but have not yet received confirmation that it has been accepted by the order destination.\n    ///     PendingCancel - indicates that you have sent a request to cancel the order but have not yet received cancel confirmation from the order destination. At this point, your order is not confirmed canceled. It is not guaranteed that the cancellation will be successful.\n    ///     PreSubmitted - indicates that a simulated order type has been accepted by the IB system and that this order has yet to be elected. The order is held in the IB system until the election criteria are met. At that time the order is transmitted to the order destination as specified .\n    ///     Submitted - indicates that your order has been accepted by the system.\n    ///     ApiCancelled - after an order has been submitted and before it has been acknowledged, an API client client can request its cancelation, producing this state.\n    ///     Cancelled - indicates that the balance of your order has been confirmed canceled by the IB system. This could occur unexpectedly when IB or the destination has rejected your order.\n    ///     Filled - indicates that the order has been completely filled. Market orders executions will not always trigger a Filled status.\n    ///     Inactive - indicates that the order was received by the system but is no longer active because it was rejected or canceled.    \n    status: String,\n    /// Number of filled positions.\n    filled: f64,\n    /// The remnant positions.\n    remaining: f64,\n    /// Average filling price.\n    average_fill_price: f64,\n    /// The order's permId used by the TWS to identify orders.\n    perm_id: i32,\n    /// Parent's id. Used for bracket and auto trailing stop orders.\n    parent_id: i32,\n    /// Price at which the last positions were filled.\n    last_fill_price: f64,\n    /// API client which submitted the order.\n    client_id: i32,\n    /// This field is used to identify an order held when TWS is trying to locate shares for a short sell. The value used to indicate this is 'locate'.\n    why_held: String,\n    /// If an order has been capped, this indicates the current capped price. Requires TWS 967+ and API v973.04+. Python API specifically requires API v973.06+.\n    market_cap_price: f64,\n}\n\n#[derive(Debug)]\npub struct Notice(String);\n\nimpl fmt::Display for Notice {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter) -\u003e fmt::Result {\n        write!(f, \"{}\", self.0)\n    }\n}\n\n/// Submits an [Order].\n///\n/// Submits an [Order] using [Client] for the given [Contract].\n/// Immediately after the order was submitted correctly, the TWS will start sending events concerning the order's activity via IBApi.EWrapper.openOrder and IBApi.EWrapper.orderStatus\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n/// * `order_id` - ID for [Order]. Get next valid ID using [Client::next_order_id].\n/// * `contract` - [Contract] to submit order for.\n/// * `order` - [Order] to sumbit.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::contracts::Contract;\n/// use ibapi::orders::{self, order_builder, OrderNotification};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let mut contract = Contract::stock(\"MSFT\");\n///     let order = order_builder::market_order(orders::Action::Buy, 100.0);\n///     let order_id = client.next_order_id();\n///\n///     let notifications = orders::place_order(\u0026mut client, order_id, \u0026contract, \u0026order)?;\n///\n///     for notification in notifications {\n///         match notification {\n///             OrderNotification::OrderStatus(order_status) =\u003e {\n///                 println!(\"order status: {order_status:?}\")\n///             }\n///             OrderNotification::OpenOrder(open_order) =\u003e println!(\"open order: {open_order:?}\"),\n///             OrderNotification::ExecutionData(execution) =\u003e println!(\"execution: {execution:?}\"),\n///             OrderNotification::CommissionReport(report) =\u003e println!(\"commision report: {report:?}\"),\n///             OrderNotification::Message(message) =\u003e println!(\"message: {message:?}\"),\n///        }\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn place_order(client: \u0026mut Client, order_id: i32, contract: \u0026Contract, order: \u0026Order) -\u003e Result\u003cOrderNotificationIterator\u003e {\n    verify_order(client, order, order_id)?;\n    verify_order_contract(client, contract, order_id)?;\n\n    let message = encoders::encode_place_order(client.server_version(), order_id, contract, order)?;\n\n    let messages = client.send_order(order_id, message)?;\n\n    Ok(OrderNotificationIterator {\n        messages,\n        server_version: client.server_version(),\n    })\n}\n\n// https://interactivebrokers.github.io/tws-api/order_submission.html\n\n/// Supports iteration over [OrderNotification]\npub struct OrderNotificationIterator {\n    server_version: i32,\n    messages: ResponseIterator,\n}\n\nimpl Iterator for OrderNotificationIterator {\n    type Item = OrderNotification;\n\n    /// Returns the next [OrderNotification]. Waits up to x seconds for next [OrderNotification].\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        fn convert\u003cT: Into\u003cOrderNotification\u003e\u003e(result: Result\u003cT\u003e) -\u003e Option\u003cOrderNotification\u003e {\n            match result {\n                Ok(val) =\u003e Some(val.into()),\n                Err(err) =\u003e {\n                    info!(\"error: {err:?}\");\n                    None\n                }\n            }\n        }\n\n        loop {\n            if let Some(mut message) = self.messages.next() {\n                match message.message_type() {\n                    IncomingMessages::OpenOrder =\u003e {\n                        let open_order = decoders::decode_open_order(self.server_version, message);\n                        return convert(open_order);\n                    }\n                    IncomingMessages::OrderStatus =\u003e {\n                        let order_status = decoders::decode_order_status(self.server_version, \u0026mut message);\n                        return convert(order_status);\n                    }\n                    IncomingMessages::ExecutionData =\u003e {\n                        let executation_data = decoders::decode_execution_data(self.server_version, \u0026mut message);\n                        return convert(executation_data);\n                    }\n                    IncomingMessages::CommissionsReport =\u003e {\n                        let commission_report = decoders::decode_commission_report(self.server_version, \u0026mut message);\n                        return convert(commission_report);\n                    }\n                    IncomingMessages::Error =\u003e {\n                        let message = message.peek_string(4);\n                        return Some(OrderNotification::Message(message));\n                    }\n                    message =\u003e {\n                        error!(\"unexpected messsage: {message:?}\");\n                    }\n                }\n            } else {\n                return None;\n            }\n        }\n    }\n}\n\n// Verifies that Order is properly formed.\nfn verify_order(client: \u0026mut Client, order: \u0026Order, _order_id: i32) -\u003e Result\u003c()\u003e {\n    let is_bag_order: bool = false; // StringsAreEqual(Constants.BagSecType, contract.SecType)\n\n    if order.scale_init_level_size.is_some() || order.scale_price_increment.is_some() {\n        client.check_server_version(server_versions::SCALE_ORDERS, \"It does not support Scale orders.\")?\n    }\n\n    if order.what_if {\n        client.check_server_version(server_versions::WHAT_IF_ORDERS, \"It does not support what-if orders.\")?\n    }\n\n    if order.scale_subs_level_size.is_some() {\n        client.check_server_version(\n            server_versions::SCALE_ORDERS2,\n            \"It does not support Subsequent Level Size for Scale orders.\",\n        )?\n    }\n\n    if !order.algo_strategy.is_empty() {\n        client.check_server_version(server_versions::ALGO_ORDERS, \"It does not support algo orders.\")?\n    }\n\n    if order.not_held {\n        client.check_server_version(server_versions::NOT_HELD, \"It does not support not_held parameter.\")?\n    }\n\n    if order.exempt_code != -1 {\n        client.check_server_version(server_versions::SSHORTX, \"It does not support exempt_code parameter.\")?\n    }\n\n    if !order.hedge_type.is_empty() {\n        client.check_server_version(server_versions::HEDGE_ORDERS, \"It does not support hedge orders.\")?\n    }\n\n    if order.opt_out_smart_routing {\n        client.check_server_version(\n            server_versions::OPT_OUT_SMART_ROUTING,\n            \"It does not support opt_out_smart_routing parameter.\",\n        )?\n    }\n\n    if order.delta_neutral_con_id \u003e 0\n        || !order.delta_neutral_settling_firm.is_empty()\n        || !order.delta_neutral_clearing_account.is_empty()\n        || !order.delta_neutral_clearing_intent.is_empty()\n    {\n        client.check_server_version(\n            server_versions::DELTA_NEUTRAL_CONID,\n            \"It does not support delta_neutral parameters: con_id, settling_firm, clearing_account, clearing_intent.\",\n        )?\n    }\n\n    if !order.delta_neutral_open_close.is_empty()\n        || order.delta_neutral_short_sale\n        || order.delta_neutral_short_sale_slot \u003e 0\n        || !order.delta_neutral_designated_location.is_empty()\n    {\n        client.check_server_version(\n            server_versions::DELTA_NEUTRAL_OPEN_CLOSE,\n            \"It does not support delta_neutral parameters: open_close, short_sale, short_saleSlot, designated_location\",\n        )?\n    }\n\n    if (order.scale_price_increment \u003e Some(0.0))\n        \u0026\u0026 (order.scale_price_adjust_value.is_some()\n            || order.scale_price_adjust_interval.is_some()\n            || order.scale_profit_offset.is_some()\n            || order.scale_auto_reset\n            || order.scale_init_position.is_some()\n            || order.scale_init_fill_qty.is_some()\n            || order.scale_random_percent)\n    {\n        client.check_server_version(\n                server_versions::SCALE_ORDERS3,\n                \"It does not support Scale order parameters: PriceAdjustValue, PriceAdjustInterval, ProfitOffset, AutoReset, InitPosition, InitFillQty and RandomPercent\",\n            )?\n    }\n\n    if is_bag_order \u0026\u0026 order.order_combo_legs.iter().any(|combo_leg| combo_leg.price.is_some()) {\n        client.check_server_version(\n            server_versions::ORDER_COMBO_LEGS_PRICE,\n            \"It does not support per-leg prices for order combo legs.\",\n        )?\n    }\n\n    if order.trailing_percent.is_some() {\n        client.check_server_version(server_versions::TRAILING_PERCENT, \"It does not support trailing percent parameter.\")?\n    }\n\n    if !order.algo_id.is_empty() {\n        client.check_server_version(server_versions::ALGO_ID, \"It does not support algo_id parameter\")?\n    }\n\n    if !order.scale_table.is_empty() || !order.active_start_time.is_empty() || !order.active_stop_time.is_empty() {\n        client.check_server_version(\n            server_versions::SCALE_TABLE,\n            \"It does not support scale_table, active_start_time nor active_stop_time parameters.\",\n        )?\n    }\n\n    if !order.ext_operator.is_empty() {\n        client.check_server_version(server_versions::EXT_OPERATOR, \"It does not support ext_operator parameter\")?\n    }\n\n    if order.cash_qty.is_some() {\n        client.check_server_version(server_versions::CASH_QTY, \"It does not support cash_qty parameter\")?\n    }\n\n    if !order.mifid2_execution_trader.is_empty() || !order.mifid2_execution_algo.is_empty() {\n        client.check_server_version(server_versions::DECISION_MAKER, \"It does not support MIFID II execution parameters\")?\n    }\n\n    if order.dont_use_auto_price_for_hedge {\n        client.check_server_version(\n            server_versions::AUTO_PRICE_FOR_HEDGE,\n            \"It does not support don't use auto price for hedge parameter\",\n        )?\n    }\n\n    if order.is_oms_container {\n        client.check_server_version(server_versions::ORDER_CONTAINER, \"It does not support oms container parameter\")?\n    }\n\n    if order.discretionary_up_to_limit_price {\n        client.check_server_version(server_versions::D_PEG_ORDERS, \"It does not support D-Peg orders\")?\n    }\n\n    if order.use_price_mgmt_algo {\n        client.check_server_version(server_versions::PRICE_MGMT_ALGO, \"It does not support Use Price Management Algo requests\")?\n    }\n\n    if order.duration.is_some() {\n        client.check_server_version(server_versions::DURATION, \"It does not support duration attribute\")?\n    }\n\n    if order.post_to_ats.is_some() {\n        client.check_server_version(server_versions::POST_TO_ATS, \"It does not support post_to_ats attribute\")?\n    }\n\n    if order.auto_cancel_parent {\n        client.check_server_version(server_versions::AUTO_CANCEL_PARENT, \"It does not support auto_cancel_parent attribute\")?\n    }\n\n    if !order.advanced_error_override.is_empty() {\n        client.check_server_version(\n            server_versions::ADVANCED_ORDER_REJECT,\n            \"It does not support advanced error override attribute\",\n        )?\n    }\n\n    if !order.manual_order_time.is_empty() {\n        client.check_server_version(server_versions::MANUAL_ORDER_TIME, \"It does not support manual order time attribute\")?\n    }\n\n    if order.min_trade_qty.is_some()\n        || order.min_compete_size.is_some()\n        || order.compete_against_best_offset.is_some()\n        || order.mid_offset_at_whole.is_some()\n        || order.mid_offset_at_half.is_some()\n    {\n        client.check_server_version(\n            server_versions::PEGBEST_PEGMID_OFFSETS,\n            \"It does not support PEG BEST / PEG MID order parameters: minTradeQty, minCompeteSize, competeAgainstBestOffset, midOffsetAtWhole and midOffsetAtHalf\",\n        )?\n    }\n\n    Ok(())\n}\n\n// Verifies that Contract is properly formed.\nfn verify_order_contract(client: \u0026mut Client, contract: \u0026Contract, _order_id: i32) -\u003e Result\u003c()\u003e {\n    if contract\n        .combo_legs\n        .iter()\n        .any(|combo_leg| combo_leg.short_sale_slot != 0 || !combo_leg.designated_location.is_empty())\n    {\n        client.check_server_version(server_versions::SSHORT_COMBO_LEGS, \"It does not support SSHORT flag for combo legs\")?\n    }\n\n    if contract.delta_neutral_contract.is_some() {\n        client.check_server_version(server_versions::DELTA_NEUTRAL, \"It does not support delta-neutral orders\")?\n    }\n\n    if contract.contract_id \u003e 0 {\n        client.check_server_version(server_versions::PLACE_ORDER_CONID, \"It does not support contract_id parameter\")?\n    }\n\n    if !contract.security_id_type.is_empty() || !contract.security_id.is_empty() {\n        client.check_server_version(server_versions::SEC_ID_TYPE, \"It does not support sec_id_type and sec_id parameters\")?\n    }\n\n    if contract.combo_legs.iter().any(|combo_leg| combo_leg.exempt_code != -1) {\n        client.check_server_version(server_versions::SSHORTX, \"It does not support exempt_code parameter\")?\n    }\n\n    if !contract.trading_class.is_empty() {\n        client.check_server_version(\n            server_versions::TRADING_CLASS,\n            \"It does not support trading_class parameters in place_order\",\n        )?\n    }\n\n    Ok(())\n}\n\n/// Cancels an open [Order].\n///\n/// Requests the cancelation of an open [Order].\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n/// * `order_id` - ID of [Order] to cancel.\n/// * `manual_order_cancel_time` - can't find documentation. leave blank.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let order_id = 15;\n///     let results = orders::cancel_order(\u0026mut client, order_id, \"\")?;\n///     for result in results {\n///        println!(\"{result:?}\");\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn cancel_order(client: \u0026mut Client, order_id: i32, manual_order_cancel_time: \u0026str) -\u003e Result\u003cCancelOrderResultIterator\u003e {\n    if !manual_order_cancel_time.is_empty() {\n        client.check_server_version(\n            server_versions::MANUAL_ORDER_TIME,\n            \"It does not support manual order cancel time attribute\",\n        )?\n    }\n\n    let message = encoders::encode_cancel_order(client.server_version(), order_id, manual_order_cancel_time)?;\n\n    let messages = client.send_order(order_id, message)?;\n\n    Ok(CancelOrderResultIterator {\n        messages,\n        server_version: client.server_version(),\n    })\n}\n\n/// Enumerates possible results from cancelling an order.\n#[derive(Debug)]\npub enum CancelOrderResult {\n    OrderStatus(OrderStatus),\n    Notice(Notice),\n}\n\n/// Supports iteration over [CancelOrderResult]\npub struct CancelOrderResultIterator {\n    server_version: i32,\n    messages: ResponseIterator,\n}\n\nimpl Iterator for CancelOrderResultIterator {\n    type Item = CancelOrderResult;\n\n    /// Returns the next [CancelOrderResult]. Waits up to x seconds for next [CancelOrderResult].\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            if let Some(mut message) = self.messages.next() {\n                match message.message_type() {\n                    IncomingMessages::OrderStatus =\u003e match decoders::decode_order_status(self.server_version, \u0026mut message) {\n                        Ok(val) =\u003e return Some(CancelOrderResult::OrderStatus(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding order status: {err}\");\n                        }\n                    },\n                    IncomingMessages::Error =\u003e {\n                        let message = message.peek_string(4);\n                        return Some(CancelOrderResult::Notice(Notice(message)));\n                    }\n                    message =\u003e {\n                        error!(\"unexpected messsage: {message:?}\");\n                    }\n                }\n            } else {\n                return None;\n            }\n        }\n    }\n}\n\n/// Cancels all open [Order]s.\n///\n/// Requests the cancelation of all open [Order]s.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     orders::global_cancel(\u0026mut client)?;\n///\n///     Ok(())\n/// }\n/// ```\npub fn global_cancel(client: \u0026mut Client) -\u003e Result\u003c()\u003e {\n    client.check_server_version(server_versions::REQ_GLOBAL_CANCEL, \"It does not support global cancel requests.\")?;\n\n    let message = encoders::encode_global_cancel()?;\n\n    let request_id = client.next_request_id();\n    client.send_order(request_id, message)?;\n\n    Ok(())\n}\n\n/// Cancels all open [Order]s.\n///\n/// Requests the cancelation of all open [Order]s.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let next_valid_order_id = orders::next_valid_order_id(\u0026mut client)?;\n///     println!(\"next_valid_order_id: {next_valid_order_id}\");\n///\n///     Ok(())\n/// }\n/// ```\npub fn next_valid_order_id(client: \u0026mut Client) -\u003e Result\u003ci32\u003e {\n    let message = encoders::encode_next_valid_order_id()?;\n\n    let mut messages = client.request_next_order_id(message)?;\n\n    if let Some(message) = messages.next() {\n        let order_id_index = 2;\n        let next_order_id = message.peek_int(order_id_index)?;\n\n        client.set_next_order_id(next_order_id);\n\n        Ok(next_order_id)\n    } else {\n        Err(anyhow!(\"no response from server\"))\n    }\n}\n\n/// Requests completed [Order]s.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n/// * `api_only` - request only orders placed by the API.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let results = orders::completed_orders(\u0026mut client, false)?;\n///     for order_data in results {\n///        println!(\"{order_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn completed_orders(client: \u0026mut Client, api_only: bool) -\u003e Result\u003cOrderDataIterator\u003e {\n    client.check_server_version(server_versions::COMPLETED_ORDERS, \"It does not support completed orders requests.\")?;\n\n    let message = encoders::encode_completed_orders(api_only)?;\n\n    let messages = client.request_order_data(message)?;\n\n    Ok(OrderDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n/// Enumerates possible results from querying an [Order].\n#[derive(Debug)]\npub enum OrderDataResult {\n    OrderData(OrderData),\n    OrderStatus(OrderStatus),\n}\n\n/// Supports iteration over [OrderDataResult].\npub struct OrderDataIterator {\n    server_version: i32,\n    messages: GlobalResponseIterator,\n}\n\nimpl Iterator for OrderDataIterator {\n    type Item = OrderDataResult;\n\n    /// Returns the next [OrderDataResult]. Waits up to x seconds for next [OrderDataResult].\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            if let Some(mut message) = self.messages.next() {\n                match message.message_type() {\n                    IncomingMessages::CompletedOrder =\u003e match decoders::decode_completed_order(self.server_version, message) {\n                        Ok(val) =\u003e return Some(OrderDataResult::OrderData(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding completed order: {err}\");\n                        }\n                    },\n                    IncomingMessages::OpenOrder =\u003e match decoders::decode_open_order(self.server_version, message) {\n                        Ok(val) =\u003e return Some(OrderDataResult::OrderData(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding open order: {err}\");\n                        }\n                    },\n                    IncomingMessages::OrderStatus =\u003e match decoders::decode_order_status(self.server_version, \u0026mut message) {\n                        Ok(val) =\u003e return Some(OrderDataResult::OrderStatus(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding order status: {err}\");\n                        }\n                    },\n                    IncomingMessages::OpenOrderEnd | IncomingMessages::CompletedOrdersEnd =\u003e {\n                        return None;\n                    }\n                    message =\u003e {\n                        error!(\"order data iterator unexpected messsage: {message:?}\");\n                    }\n                }\n            } else {\n                return None;\n            }\n        }\n    }\n}\n\n/// Requests all open orders places by this specific API client (identified by the API client id).\n/// For client ID 0, this will bind previous manual TWS orders.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let results = orders::open_orders(\u0026mut client)?;\n///     for order_data in results {\n///        println!(\"{order_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn open_orders(client: \u0026mut Client) -\u003e Result\u003cOrderDataIterator\u003e {\n    let message = encoders::encode_open_orders()?;\n\n    let messages = client.request_order_data(message)?;\n\n    Ok(OrderDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n/// Requests all *current* open orders in associated accounts at the current moment.\n/// Open orders are returned once; this function does not initiate a subscription.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let results = orders::all_open_orders(\u0026mut client)?;\n///     for order_data in results {\n///        println!(\"{order_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn all_open_orders(client: \u0026mut Client) -\u003e Result\u003cOrderDataIterator\u003e {\n    let message = encoders::encode_all_open_orders()?;\n\n    let messages = client.request_order_data(message)?;\n\n    Ok(OrderDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n/// Requests status updates about future orders placed from TWS. Can only be used with client ID 0.\n///\n/// # Arguments\n/// * `client` - [Client] used to communicate with server.\n/// * `auto_bind` - if set to true, the newly created orders will be assigned an API order ID and implicitly associated with this client. If set to false, future orders will not be.\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders;\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///\n///     let results = orders::auto_open_orders(\u0026mut client, false)?;\n///     for order_data in results {\n///        println!(\"{order_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn auto_open_orders(client: \u0026mut Client, auto_bind: bool) -\u003e Result\u003cOrderDataIterator\u003e {\n    let message = encoders::encode_auto_open_orders(auto_bind)?;\n\n    // TODO this should probably not timeout.\n    let messages = client.request_order_data(message)?;\n\n    Ok(OrderDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n#[derive(Debug, Default)]\n/// Filter criteria used to determine which execution reports are returned.\npub struct ExecutionFilter {\n    /// The API client which placed the order.\n    pub client_id: Option\u003ci32\u003e,\n    /// The account to which the order was allocated to\n    pub account_code: String,\n    /// Time from which the executions will be returned yyyymmdd hh:mm:ss\n    /// Only those executions reported after the specified time will be returned.\n    pub time: String,\n    /// The instrument's symbol\n    pub symbol: String,\n    /// The Contract's security's type (i.e. STK, OPT...)\n    pub security_type: String,\n    /// The exchange at which the execution was produced\n    pub exchange: String,\n    /// The Contract's side (BUY or SELL)\n    pub side: String,\n}\n\n/// Requests current day's (since midnight) executions matching the filter.\n///\n/// Only the current day's executions can be retrieved.\n/// Along with the [ExecutionData], the [CommissionReport] will also be returned.\n/// When requesting executions, a filter can be specified to receive only a subset of them\n///\n/// # Arguments\n/// * `filter` - filter criteria used to determine which execution reports are returned\n///\n/// # Examples\n///\n/// ```no_run\n/// use ibapi::client::{Client};\n/// use ibapi::orders::{self, ExecutionFilter};\n///\n/// fn main() -\u003e anyhow::Result\u003c()\u003e {\n///     let mut client = Client::connect(\"localhost:4002\")?;\n///     \n///     let filter = ExecutionFilter{\n///        side: \"BUY\".to_owned(),\n///        ..ExecutionFilter::default()\n///     };\n///\n///     let results = orders::executions(\u0026mut client, filter)?;\n///     for execution_data in results {\n///        println!(\"{execution_data:?}\")\n///     }\n///\n///     Ok(())\n/// }\n/// ```\npub fn executions(client: \u0026mut Client, filter: ExecutionFilter) -\u003e Result\u003cExecutionDataIterator\u003e {\n    let request_id = client.next_request_id();\n    let message = encoders::encode_executions(client.server_version(), request_id, \u0026filter)?;\n\n    let messages = client.send_request(request_id, message)?;\n\n    Ok(ExecutionDataIterator {\n        server_version: client.server_version(),\n        messages,\n    })\n}\n\n/// Enumerates possible results from querying an [Execution].\n#[derive(Debug)]\npub enum ExecutionDataResult {\n    ExecutionData(ExecutionData),\n    CommissionReport(CommissionReport),\n}\n\n/// Supports iteration over [ExecutionDataResult].\npub struct ExecutionDataIterator {\n    server_version: i32,\n    messages: ResponseIterator,\n}\n\nimpl Iterator for ExecutionDataIterator {\n    type Item = ExecutionDataResult;\n\n    /// Returns the next [OrderDataResult]. Waits up to x seconds for next [OrderDataResult].\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        loop {\n            if let Some(mut message) = self.messages.next() {\n                match message.message_type() {\n                    IncomingMessages::ExecutionData =\u003e match decoders::decode_execution_data(self.server_version, \u0026mut message) {\n                        Ok(val) =\u003e return Some(ExecutionDataResult::ExecutionData(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding execution data: {err}\");\n                        }\n                    },\n                    IncomingMessages::CommissionsReport =\u003e match decoders::decode_commission_report(self.server_version, \u0026mut message) {\n                        Ok(val) =\u003e return Some(ExecutionDataResult::CommissionReport(val)),\n                        Err(err) =\u003e {\n                            error!(\"error decoding commission report: {err}\");\n                        }\n                    },\n                    IncomingMessages::ExecutionDataEnd =\u003e {\n                        return None;\n                    }\n                    message =\u003e {\n                        error!(\"order data iterator unexpected messsage: {message:?}\");\n                    }\n                }\n            } else {\n                return None;\n            }\n        }\n    }\n}\n\n#[cfg(test)]\nmod tests;\n","traces":[{"line":425,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":433,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":436,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":437,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":439,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":444,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":448,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":449,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":457,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":458,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":459,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":460,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":464,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":465,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":468,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":478,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":481,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":482,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":483,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":484,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":487,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":488,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":489,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":500,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":501,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":502,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":503,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":504,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":505,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":506,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":507,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":509,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":511,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":512,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":513,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":514,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":515,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":516,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":517,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":518,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":520,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":521,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":522,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":523,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":525,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":527,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":529,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":533,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":534,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":544,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":545,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":546,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":547,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":554,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":557,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":568,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":569,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":572,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":573,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":574,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":575,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":598,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":599,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":604,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":605,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":606,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":607,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":608,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":609,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":615,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":616,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":617,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":618,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":619,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":620,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":624,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":625,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":626,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":627,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":628,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":629,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":649,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":650,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":655,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":656,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":661,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":662,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":663,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":664,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":665,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":666,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":667,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":668,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":669,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":670,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":671,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":677,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":678,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":679,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":680,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":681,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":682,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":683,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":684,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":685,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":686,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":687,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":688,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":715,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":716,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":721,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":722,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":727,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":728,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":729,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":730,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":731,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":732,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":733,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":734,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":735,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":808,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":809,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":814,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":815,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":820,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":821,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":822,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":823,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":829,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":830,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":831,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":832,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":833,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":865,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":866,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":867,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":868,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":869,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":870,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":871,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":941,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":942,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":947,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":948,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":953,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":954,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":959,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":960,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1004,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1005,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1052,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1053,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1055,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1057,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1059,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1060,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1061,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1077,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1078,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1079,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1080,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1081,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1082,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1083,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1089,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":1090,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1092,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1093,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1096,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1097,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1100,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1101,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1104,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1105,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1108,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1111,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1112,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1116,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1123,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1124,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1126,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1127,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1130,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1131,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1134,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1135,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1136,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1141,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1142,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1145,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1146,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1149,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1150,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1153,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1154,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1157,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1158,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1159,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1164,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1165,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1166,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1167,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1169,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1175,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1176,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1177,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1178,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1181,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1186,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1187,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1190,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1191,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1193,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1195,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1201,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1202,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1203,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1208,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1209,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1212,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1213,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1216,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":1217,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1218,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1223,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1224,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1227,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1228,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1231,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1232,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1235,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1236,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1237,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1242,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1243,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1246,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1247,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1250,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1251,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1254,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1255,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1258,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1262,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1263,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1266,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1267,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1268,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1273,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1274,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1277,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1278,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1279,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1280,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1281,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1283,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1284,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1289,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1293,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1294,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1295,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1297,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":1299,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1302,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1303,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1306,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1307,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1310,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":1311,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1314,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":1315,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1318,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1319,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1320,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1325,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":1355,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1356,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1357,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1358,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1363,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1365,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1367,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1368,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1369,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1390,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1392,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":1393,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1394,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1395,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1396,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1397,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1401,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1402,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1404,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1405,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1409,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1437,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1439,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1441,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1442,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1444,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1469,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1470,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1472,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1474,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1475,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1476,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1478,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1480,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1482,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1510,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1512,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1514,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1516,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1517,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1518,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1539,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1541,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1542,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1543,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1544,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1545,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1546,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1549,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1550,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1551,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1552,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1555,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1556,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1557,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1558,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1562,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1564,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1565,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1569,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1598,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1599,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1601,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1603,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1604,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1605,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1632,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1633,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1635,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1637,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1638,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1639,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1666,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1667,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1670,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1672,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1673,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1674,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1729,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1730,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1731,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1733,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":1735,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1736,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1737,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":1758,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1760,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1761,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1762,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1763,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1764,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1765,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1768,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1769,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1770,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1771,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1775,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1777,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1778,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":1782,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":260,"coverable":383},{"path":["/","Users","wboayue","projects","rust-ibapi","src","server_versions.rs"],"content":"//! The known server versions.\n\n//shouldn't these all be deprecated?\n//  public const int HISTORICAL_DATA = 24;\n//  public const int CURRENT_TIME = 33;\npub const REAL_TIME_BARS: i32 = 34;\npub const SCALE_ORDERS: i32 = 35;\n//  public const int SNAPSHOT_MKT_DATA = 35;\npub const SSHORT_COMBO_LEGS: i32 = 35;\npub const WHAT_IF_ORDERS: i32 = 36;\npub const CONTRACT_CONID: i32 = 37;\n\npub const PTA_ORDERS: i32 = 39;\npub const FUNDAMENTAL_DATA: i32 = 40;\npub const DELTA_NEUTRAL: i32 = 40;\npub const CONTRACT_DATA_CHAIN: i32 = 40;\npub const SCALE_ORDERS2: i32 = 40;\npub const ALGO_ORDERS: i32 = 41;\npub const EXECUTION_DATA_CHAIN: i32 = 42;\npub const NOT_HELD: i32 = 44;\npub const SEC_ID_TYPE: i32 = 45;\npub const PLACE_ORDER_CONID: i32 = 46;\npub const REQ_MKT_DATA_CONID: i32 = 47;\npub const REQ_CALC_IMPLIED_VOLAT: i32 = 49;\npub const REQ_CALC_OPTION_PRICE: i32 = 50;\npub const SSHORTX_OLD: i32 = 51;\npub const SSHORTX: i32 = 52;\npub const REQ_GLOBAL_CANCEL: i32 = 53;\npub const HEDGE_ORDERS: i32 = 54;\npub const REQ_MARKET_DATA_TYPE: i32 = 55;\npub const OPT_OUT_SMART_ROUTING: i32 = 56;\npub const SMART_COMBO_ROUTING_PARAMS: i32 = 57;\npub const DELTA_NEUTRAL_CONID: i32 = 58;\npub const SCALE_ORDERS3: i32 = 60;\npub const ORDER_COMBO_LEGS_PRICE: i32 = 61;\npub const TRAILING_PERCENT: i32 = 62;\npub const DELTA_NEUTRAL_OPEN_CLOSE: i32 = 66;\npub const POSITIONS: i32 = 67;\npub const ACCOUNT_SUMMARY: i32 = 67;\npub const TRADING_CLASS: i32 = 68;\npub const SCALE_TABLE: i32 = 69;\npub const LINKING: i32 = 70;\npub const ALGO_ID: i32 = 71;\npub const OPTIONAL_CAPABILITIES: i32 = 72;\npub const ORDER_SOLICITED: i32 = 73;\npub const LINKING_AUTH: i32 = 74;\npub const PRIMARYEXCH: i32 = 75;\npub const RANDOMIZE_SIZE_AND_PRICE: i32 = 76;\npub const FRACTIONAL_POSITIONS: i32 = 101;\npub const PEGGED_TO_BENCHMARK: i32 = 102;\npub const MODELS_SUPPORT: i32 = 103;\npub const SEC_DEF_OPT_PARAMS_REQ: i32 = 104;\npub const EXT_OPERATOR: i32 = 105;\npub const SOFT_DOLLAR_TIER: i32 = 106;\npub const REQ_FAMILY_CODES: i32 = 107;\npub const REQ_MATCHING_SYMBOLS: i32 = 108;\npub const PAST_LIMIT: i32 = 109;\npub const MD_SIZE_MULTIPLIER: i32 = 110;\npub const CASH_QTY: i32 = 111;\npub const REQ_MKT_DEPTH_EXCHANGES: i32 = 112;\npub const TICK_NEWS: i32 = 113;\npub const REQ_SMART_COMPONENTS: i32 = 114;\npub const REQ_NEWS_PROVIDERS: i32 = 115;\npub const REQ_NEWS_ARTICLE: i32 = 116;\npub const REQ_HISTORICAL_NEWS: i32 = 117;\npub const REQ_HEAD_TIMESTAMP: i32 = 118;\npub const REQ_HISTOGRAM: i32 = 119;\npub const SERVICE_DATA_TYPE: i32 = 120;\npub const AGG_GROUP: i32 = 121;\npub const UNDERLYING_INFO: i32 = 122;\npub const CANCEL_HEADTIMESTAMP: i32 = 123;\npub const SYNT_REALTIME_BARS: i32 = 124;\npub const CFD_REROUTE: i32 = 125;\npub const MARKET_RULES: i32 = 126;\npub const PNL: i32 = 127;\npub const NEWS_QUERY_ORIGINS: i32 = 128;\npub const UNREALIZED_PNL: i32 = 129;\npub const HISTORICAL_TICKS: i32 = 130;\npub const MARKET_CAP_PRICE: i32 = 131;\npub const PRE_OPEN_BID_ASK: i32 = 132;\npub const REAL_EXPIRATION_DATE: i32 = 134;\npub const REALIZED_PNL: i32 = 135;\npub const LAST_LIQUIDITY: i32 = 136;\npub const TICK_BY_TICK: i32 = 137;\npub const DECISION_MAKER: i32 = 138;\npub const MIFID_EXECUTION: i32 = 139;\npub const TICK_BY_TICK_IGNORE_SIZE: i32 = 140;\npub const AUTO_PRICE_FOR_HEDGE: i32 = 141;\npub const WHAT_IF_EXT_FIELDS: i32 = 142;\npub const SCANNER_GENERIC_OPTS: i32 = 143;\npub const API_BIND_ORDER: i32 = 144;\npub const ORDER_CONTAINER: i32 = 145;\npub const SMART_DEPTH: i32 = 146;\npub const REMOVE_NULL_ALL_CASTING: i32 = 147;\npub const D_PEG_ORDERS: i32 = 148;\npub const MKT_DEPTH_PRIM_EXCHANGE: i32 = 149;\npub const COMPLETED_ORDERS: i32 = 150;\npub const PRICE_MGMT_ALGO: i32 = 151;\npub const STOCK_TYPE: i32 = 152;\npub const ENCODE_MSG_ASCII7: i32 = 153;\npub const SEND_ALL_FAMILY_CODES: i32 = 154;\npub const NO_DEFAULT_OPEN_CLOSE: i32 = 155;\npub const PRICE_BASED_VOLATILITY: i32 = 156;\npub const REPLACE_FA_END: i32 = 157;\npub const DURATION: i32 = 158;\npub const MARKET_DATA_IN_SHARES: i32 = 159;\npub const POST_TO_ATS: i32 = 160;\npub const WSHE_CALENDAR: i32 = 161;\npub const AUTO_CANCEL_PARENT: i32 = 162;\npub const FRACTIONAL_SIZE_SUPPORT: i32 = 163;\npub const SIZE_RULES: i32 = 164;\npub const HISTORICAL_SCHEDULE: i32 = 165;\npub const ADVANCED_ORDER_REJECT: i32 = 166;\npub const USER_INFO: i32 = 167;\npub const CRYPTO_AGGREGATED_TRADES: i32 = 168;\npub const MANUAL_ORDER_TIME: i32 = 169;\npub const PEGBEST_PEGMID_OFFSETS: i32 = 170;\npub const WSH_EVENT_DATA_FILTERS: i32 = 171;\npub const IPO_PRICES: i32 = 172;\npub const WSH_EVENT_DATA_FILTERS_DATE: i32 = 173;\npub const INSTRUMENT_TIMEZONE: i32 = 174;\npub const HMDS_MARKET_DATA_IN_SHARES: i32 = 175;\npub const BOND_ISSUERID: i32 = 176;\npub const FA_PROFILE_DESUPPORT: i32 = 177;\n","traces":[],"covered":0,"coverable":0},{"path":["/","Users","wboayue","projects","rust-ibapi","src","stubs.rs"],"content":"use std::sync::Arc;\nuse std::time::Duration;\n\nuse crossbeam::channel;\n\nuse crate::client::transport::{GlobalResponseIterator, MessageBus, ResponseIterator};\nuse crate::client::{RequestMessage, ResponseMessage};\n\npub struct MessageBusStub {\n    pub request_messages: Vec\u003cRequestMessage\u003e,\n    pub response_messages: Vec\u003cString\u003e,\n    // pub next_request_id: i32,\n    // pub server_version: i32,\n    // pub order_id: i32,\n}\n\nimpl MessageBus for MessageBusStub {\n    fn request_messages(\u0026self) -\u003e Vec\u003cRequestMessage\u003e {\n        self.request_messages.clone()\n    }\n\n    fn read_message(\u0026mut self) -\u003e anyhow::Result\u003cResponseMessage\u003e {\n        Ok(ResponseMessage::default())\n    }\n\n    fn write_message(\u0026mut self, message: \u0026RequestMessage) -\u003e anyhow::Result\u003c()\u003e {\n        self.request_messages.push(message.clone());\n        Ok(())\n    }\n\n    fn send_generic_message(\u0026mut self, request_id: i32, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n        let (s1, r1) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(ResponseIterator::new(receiver, s1, None, None, Duration::from_secs(5)))\n    }\n\n    fn send_order_message(\u0026mut self, request_id: i32, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n        let (s1, r1) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(ResponseIterator::new(receiver, s1, None, None, Duration::from_secs(5)))\n    }\n\n    fn request_next_order_id(\u0026mut self, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cGlobalResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(GlobalResponseIterator::new(Arc::new(receiver)))\n    }\n\n    fn request_open_orders(\u0026mut self, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cGlobalResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(GlobalResponseIterator::new(Arc::new(receiver)))\n    }\n\n    fn request_market_rule(\u0026mut self, message: \u0026RequestMessage) -\u003e anyhow::Result\u003cGlobalResponseIterator\u003e {\n        self.request_messages.push(message.clone());\n\n        let (sender, receiver) = channel::unbounded();\n\n        for message in \u0026self.response_messages {\n            sender.send(ResponseMessage::from(\u0026message.replace(\"|\", \"\\0\"))).unwrap();\n        }\n\n        Ok(GlobalResponseIterator::new(Arc::new(receiver)))\n    }\n\n    fn write(\u0026mut self, packet: \u0026str) -\u003e anyhow::Result\u003c()\u003e {\n        Ok(())\n    }\n\n    fn process_messages(\u0026mut self, server_version: i32) -\u003e anyhow::Result\u003c()\u003e {\n        Ok(())\n    }\n}\n\nfn encode_message(message: \u0026RequestMessage) -\u003e String {\n    message.encode().replace(\"\\0\", \"|\")\n}\n","traces":[{"line":18,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":13},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":22},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":32},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":19},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":86,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":31,"coverable":45}]};
    </script>
    <script crossorigin>/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
'use strict';(function(d,r){"object"===typeof exports&&"undefined"!==typeof module?r(exports):"function"===typeof define&&define.amd?define(["exports"],r):(d=d||self,r(d.React={}))})(this,function(d){function r(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function w(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function da(){}function L(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function ea(a,b,c){var g,e={},fa=null,d=null;if(null!=b)for(g in void 0!==b.ref&&(d=b.ref),void 0!==b.key&&(fa=""+b.key),b)ha.call(b,g)&&!ia.hasOwnProperty(g)&&(e[g]=b[g]);var h=arguments.length-2;if(1===h)e.children=c;else if(1<h){for(var k=Array(h),f=0;f<h;f++)k[f]=arguments[f+2];e.children=k}if(a&&a.defaultProps)for(g in h=a.defaultProps,
h)void 0===e[g]&&(e[g]=h[g]);return{$$typeof:x,type:a,key:fa,ref:d,props:e,_owner:M.current}}function va(a,b){return{$$typeof:x,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function N(a){return"object"===typeof a&&null!==a&&a.$$typeof===x}function wa(a){var b={"=":"=0",":":"=2"};return"$"+(""+a).replace(/[=:]/g,function(a){return b[a]})}function ja(a,b,c,g){if(C.length){var e=C.pop();e.result=a;e.keyPrefix=b;e.func=c;e.context=g;e.count=0;return e}return{result:a,keyPrefix:b,func:c,
context:g,count:0}}function ka(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>C.length&&C.push(a)}function O(a,b,c,g){var e=typeof a;if("undefined"===e||"boolean"===e)a=null;var d=!1;if(null===a)d=!0;else switch(e){case "string":case "number":d=!0;break;case "object":switch(a.$$typeof){case x:case xa:d=!0}}if(d)return c(g,a,""===b?"."+P(a,0):b),1;d=0;b=""===b?".":b+":";if(Array.isArray(a))for(var f=0;f<a.length;f++){e=a[f];var h=b+P(e,f);d+=O(e,h,c,g)}else if(null===a||
"object"!==typeof a?h=null:(h=la&&a[la]||a["@@iterator"],h="function"===typeof h?h:null),"function"===typeof h)for(a=h.call(a),f=0;!(e=a.next()).done;)e=e.value,h=b+P(e,f++),d+=O(e,h,c,g);else if("object"===e)throw c=""+a,Error(r(31,"[object Object]"===c?"object with keys {"+Object.keys(a).join(", ")+"}":c,""));return d}function Q(a,b,c){return null==a?0:O(a,"",b,c)}function P(a,b){return"object"===typeof a&&null!==a&&null!=a.key?wa(a.key):b.toString(36)}function ya(a,b,c){a.func.call(a.context,b,
a.count++)}function za(a,b,c){var g=a.result,e=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?R(a,g,c,function(a){return a}):null!=a&&(N(a)&&(a=va(a,e+(!a.key||b&&b.key===a.key?"":(""+a.key).replace(ma,"$&/")+"/")+c)),g.push(a))}function R(a,b,c,g,e){var d="";null!=c&&(d=(""+c).replace(ma,"$&/")+"/");b=ja(b,d,g,e);Q(a,za,b);ka(b)}function t(){var a=na.current;if(null===a)throw Error(r(321));return a}function S(a,b){var c=a.length;a.push(b);a:for(;;){var g=c-1>>>1,e=a[g];if(void 0!==
e&&0<D(e,b))a[g]=b,a[c]=e,c=g;else break a}}function n(a){a=a[0];return void 0===a?null:a}function E(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var g=0,e=a.length;g<e;){var d=2*(g+1)-1,f=a[d],h=d+1,k=a[h];if(void 0!==f&&0>D(f,c))void 0!==k&&0>D(k,f)?(a[g]=k,a[h]=c,g=h):(a[g]=f,a[d]=c,g=d);else if(void 0!==k&&0>D(k,c))a[g]=k,a[h]=c,g=h;else break a}}return b}return null}function D(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}function F(a){for(var b=n(u);null!==
b;){if(null===b.callback)E(u);else if(b.startTime<=a)E(u),b.sortIndex=b.expirationTime,S(p,b);else break;b=n(u)}}function T(a){y=!1;F(a);if(!v)if(null!==n(p))v=!0,z(U);else{var b=n(u);null!==b&&G(T,b.startTime-a)}}function U(a,b){v=!1;y&&(y=!1,V());H=!0;var c=m;try{F(b);for(l=n(p);null!==l&&(!(l.expirationTime>b)||a&&!W());){var g=l.callback;if(null!==g){l.callback=null;m=l.priorityLevel;var e=g(l.expirationTime<=b);b=q();"function"===typeof e?l.callback=e:l===n(p)&&E(p);F(b)}else E(p);l=n(p)}if(null!==
l)var d=!0;else{var f=n(u);null!==f&&G(T,f.startTime-b);d=!1}return d}finally{l=null,m=c,H=!1}}function oa(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3}}var f="function"===typeof Symbol&&Symbol.for,x=f?Symbol.for("react.element"):60103,xa=f?Symbol.for("react.portal"):60106,Aa=f?Symbol.for("react.fragment"):60107,Ba=f?Symbol.for("react.strict_mode"):60108,Ca=f?Symbol.for("react.profiler"):60114,Da=f?Symbol.for("react.provider"):60109,
Ea=f?Symbol.for("react.context"):60110,Fa=f?Symbol.for("react.forward_ref"):60112,Ga=f?Symbol.for("react.suspense"):60113,Ha=f?Symbol.for("react.memo"):60115,Ia=f?Symbol.for("react.lazy"):60116,la="function"===typeof Symbol&&Symbol.iterator,pa=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,Ka=Object.prototype.propertyIsEnumerable,I=function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;var b={};for(a=0;10>a;a++)b["_"+
String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var c={};"abcdefghijklmnopqrst".split("").forEach(function(a){c[a]=a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},c)).join("")?!1:!0}catch(g){return!1}}()?Object.assign:function(a,b){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");var c=Object(a);for(var g,e=1;e<arguments.length;e++){var d=Object(arguments[e]);
for(var f in d)Ja.call(d,f)&&(c[f]=d[f]);if(pa){g=pa(d);for(var h=0;h<g.length;h++)Ka.call(d,g[h])&&(c[g[h]]=d[g[h]])}}return c},ca={isMounted:function(a){return!1},enqueueForceUpdate:function(a,b,c){},enqueueReplaceState:function(a,b,c,d){},enqueueSetState:function(a,b,c,d){}},ba={};w.prototype.isReactComponent={};w.prototype.setState=function(a,b){if("object"!==typeof a&&"function"!==typeof a&&null!=a)throw Error(r(85));this.updater.enqueueSetState(this,a,b,"setState")};w.prototype.forceUpdate=
function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};da.prototype=w.prototype;f=L.prototype=new da;f.constructor=L;I(f,w.prototype);f.isPureReactComponent=!0;var M={current:null},ha=Object.prototype.hasOwnProperty,ia={key:!0,ref:!0,__self:!0,__source:!0},ma=/\/+/g,C=[],na={current:null},X;if("undefined"===typeof window||"function"!==typeof MessageChannel){var A=null,qa=null,ra=function(){if(null!==A)try{var a=q();A(!0,a);A=null}catch(b){throw setTimeout(ra,0),b;}},La=Date.now();var q=
function(){return Date.now()-La};var z=function(a){null!==A?setTimeout(z,0,a):(A=a,setTimeout(ra,0))};var G=function(a,b){qa=setTimeout(a,b)};var V=function(){clearTimeout(qa)};var W=function(){return!1};f=X=function(){}}else{var Y=window.performance,sa=window.Date,Ma=window.setTimeout,Na=window.clearTimeout;"undefined"!==typeof console&&(f=window.cancelAnimationFrame,"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),
"function"!==typeof f&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));if("object"===typeof Y&&"function"===typeof Y.now)q=function(){return Y.now()};else{var Oa=sa.now();q=function(){return sa.now()-Oa}}var J=!1,K=null,Z=-1,ta=5,ua=0;W=function(){return q()>=ua};f=function(){};X=function(a){0>a||125<a?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):
ta=0<a?Math.floor(1E3/a):5};var B=new MessageChannel,aa=B.port2;B.port1.onmessage=function(){if(null!==K){var a=q();ua=a+ta;try{K(!0,a)?aa.postMessage(null):(J=!1,K=null)}catch(b){throw aa.postMessage(null),b;}}else J=!1};z=function(a){K=a;J||(J=!0,aa.postMessage(null))};G=function(a,b){Z=Ma(function(){a(q())},b)};V=function(){Na(Z);Z=-1}}var p=[],u=[],Pa=1,l=null,m=3,H=!1,v=!1,y=!1,Qa=0;B={ReactCurrentDispatcher:na,ReactCurrentOwner:M,IsSomeRendererActing:{current:!1},assign:I};I(B,{Scheduler:{__proto__:null,
unstable_ImmediatePriority:1,unstable_UserBlockingPriority:2,unstable_NormalPriority:3,unstable_IdlePriority:5,unstable_LowPriority:4,unstable_runWithPriority:function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=m;m=a;try{return b()}finally{m=c}},unstable_next:function(a){switch(m){case 1:case 2:case 3:var b=3;break;default:b=m}var c=m;m=b;try{return a()}finally{m=c}},unstable_scheduleCallback:function(a,b,c){var d=q();if("object"===typeof c&&null!==c){var e=c.delay;
e="number"===typeof e&&0<e?d+e:d;c="number"===typeof c.timeout?c.timeout:oa(a)}else c=oa(a),e=d;c=e+c;a={id:Pa++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,S(u,a),null===n(p)&&a===n(u)&&(y?V():y=!0,G(T,e-d))):(a.sortIndex=c,S(p,a),v||H||(v=!0,z(U)));return a},unstable_cancelCallback:function(a){a.callback=null},unstable_wrapCallback:function(a){var b=m;return function(){var c=m;m=b;try{return a.apply(this,arguments)}finally{m=c}}},unstable_getCurrentPriorityLevel:function(){return m},
unstable_shouldYield:function(){var a=q();F(a);var b=n(p);return b!==l&&null!==l&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<l.expirationTime||W()},unstable_requestPaint:f,unstable_continueExecution:function(){v||H||(v=!0,z(U))},unstable_pauseExecution:function(){},unstable_getFirstCallbackNode:function(){return n(p)},get unstable_now(){return q},get unstable_forceFrameRate(){return X},unstable_Profiling:null},SchedulerTracing:{__proto__:null,__interactionsRef:null,__subscriberRef:null,
unstable_clear:function(a){return a()},unstable_getCurrent:function(){return null},unstable_getThreadID:function(){return++Qa},unstable_trace:function(a,b,c){return c()},unstable_wrap:function(a){return a},unstable_subscribe:function(a){},unstable_unsubscribe:function(a){}}});d.Children={map:function(a,b,c){if(null==a)return a;var d=[];R(a,d,null,b,c);return d},forEach:function(a,b,c){if(null==a)return a;b=ja(null,null,b,c);Q(a,ya,b);ka(b)},count:function(a){return Q(a,function(){return null},null)},
toArray:function(a){var b=[];R(a,b,null,function(a){return a});return b},only:function(a){if(!N(a))throw Error(r(143));return a}};d.Component=w;d.Fragment=Aa;d.Profiler=Ca;d.PureComponent=L;d.StrictMode=Ba;d.Suspense=Ga;d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B;d.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(r(267,a));var d=I({},a.props),e=a.key,f=a.ref,m=a._owner;if(null!=b){void 0!==b.ref&&(f=b.ref,m=M.current);void 0!==b.key&&(e=""+b.key);if(a.type&&a.type.defaultProps)var h=
a.type.defaultProps;for(k in b)ha.call(b,k)&&!ia.hasOwnProperty(k)&&(d[k]=void 0===b[k]&&void 0!==h?h[k]:b[k])}var k=arguments.length-2;if(1===k)d.children=c;else if(1<k){h=Array(k);for(var l=0;l<k;l++)h[l]=arguments[l+2];d.children=h}return{$$typeof:x,type:a.type,key:e,ref:f,props:d,_owner:m}};d.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:Ea,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:Da,_context:a};return a.Consumer=
a};d.createElement=ea;d.createFactory=function(a){var b=ea.bind(null,a);b.type=a;return b};d.createRef=function(){return{current:null}};d.forwardRef=function(a){return{$$typeof:Fa,render:a}};d.isValidElement=N;d.lazy=function(a){return{$$typeof:Ia,_ctor:a,_status:-1,_result:null}};d.memo=function(a,b){return{$$typeof:Ha,type:a,compare:void 0===b?null:b}};d.useCallback=function(a,b){return t().useCallback(a,b)};d.useContext=function(a,b){return t().useContext(a,b)};d.useDebugValue=function(a,b){};
d.useEffect=function(a,b){return t().useEffect(a,b)};d.useImperativeHandle=function(a,b,c){return t().useImperativeHandle(a,b,c)};d.useLayoutEffect=function(a,b){return t().useLayoutEffect(a,b)};d.useMemo=function(a,b){return t().useMemo(a,b)};d.useReducer=function(a,b,c){return t().useReducer(a,b,c)};d.useRef=function(a){return t().useRef(a)};d.useState=function(a){return t().useState(a)};d.version="16.13.1"});
</script>
    <script crossorigin>/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
/*
 Modernizr 3.0.0pre (Custom Build) | MIT
*/
'use strict';(function(I,ea){"object"===typeof exports&&"undefined"!==typeof module?ea(exports,require("react")):"function"===typeof define&&define.amd?define(["exports","react"],ea):(I=I||self,ea(I.ReactDOM={},I.React))})(this,function(I,ea){function k(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function ji(a,b,c,d,e,f,g,h,m){yb=!1;gc=null;ki.apply(li,arguments)}function mi(a,b,c,d,e,f,g,h,m){ji.apply(this,arguments);if(yb){if(yb){var n=gc;yb=!1;gc=null}else throw Error(k(198));hc||(hc=!0,pd=n)}}function lf(a,b,c){var d=a.type||"unknown-event";a.currentTarget=mf(c);mi(d,b,void 0,a);a.currentTarget=null}function nf(){if(ic)for(var a in cb){var b=cb[a],c=ic.indexOf(a);if(!(-1<c))throw Error(k(96,a));if(!jc[c]){if(!b.extractEvents)throw Error(k(97,a));jc[c]=b;c=b.eventTypes;for(var d in c){var e=
void 0;var f=c[d],g=b,h=d;if(qd.hasOwnProperty(h))throw Error(k(99,h));qd[h]=f;var m=f.phasedRegistrationNames;if(m){for(e in m)m.hasOwnProperty(e)&&of(m[e],g,h);e=!0}else f.registrationName?(of(f.registrationName,g,h),e=!0):e=!1;if(!e)throw Error(k(98,d,a));}}}}function of(a,b,c){if(db[a])throw Error(k(100,a));db[a]=b;rd[a]=b.eventTypes[c].dependencies}function pf(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(!cb.hasOwnProperty(c)||cb[c]!==d){if(cb[c])throw Error(k(102,c));cb[c]=
d;b=!0}}b&&nf()}function qf(a){if(a=rf(a)){if("function"!==typeof sd)throw Error(k(280));var b=a.stateNode;b&&(b=td(b),sd(a.stateNode,a.type,b))}}function sf(a){eb?fb?fb.push(a):fb=[a]:eb=a}function tf(){if(eb){var a=eb,b=fb;fb=eb=null;qf(a);if(b)for(a=0;a<b.length;a++)qf(b[a])}}function ud(){if(null!==eb||null!==fb)vd(),tf()}function uf(a,b,c){if(wd)return a(b,c);wd=!0;try{return vf(a,b,c)}finally{wd=!1,ud()}}function ni(a){if(wf.call(xf,a))return!0;if(wf.call(yf,a))return!1;if(oi.test(a))return xf[a]=
!0;yf[a]=!0;return!1}function pi(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case "function":case "symbol":return!0;case "boolean":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return"data-"!==a&&"aria-"!==a;default:return!1}}function qi(a,b,c,d){if(null===b||"undefined"===typeof b||pi(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function L(a,
b,c,d,e,f){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f}function xd(a,b,c,d){var e=E.hasOwnProperty(b)?E[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||"o"!==b[0]&&"O"!==b[0]||"n"!==b[1]&&"N"!==b[1]?!1:!0;f||(qi(b,c,e,d)&&(c=null),d||null===e?ni(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,""+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:"":c:(b=e.attributeName,
d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?"":""+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}function zb(a){if(null===a||"object"!==typeof a)return null;a=zf&&a[zf]||a["@@iterator"];return"function"===typeof a?a:null}function ri(a){if(-1===a._status){a._status=0;var b=a._ctor;b=b();a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}}function na(a){if(null==a)return null;
if("function"===typeof a)return a.displayName||a.name||null;if("string"===typeof a)return a;switch(a){case Ma:return"Fragment";case gb:return"Portal";case kc:return"Profiler";case Af:return"StrictMode";case lc:return"Suspense";case yd:return"SuspenseList"}if("object"===typeof a)switch(a.$$typeof){case Bf:return"Context.Consumer";case Cf:return"Context.Provider";case zd:var b=a.render;b=b.displayName||b.name||"";return a.displayName||(""!==b?"ForwardRef("+b+")":"ForwardRef");case Ad:return na(a.type);
case Df:return na(a.render);case Ef:if(a=1===a._status?a._result:null)return na(a)}return null}function Bd(a){var b="";do{a:switch(a.tag){case 3:case 4:case 6:case 7:case 10:case 9:var c="";break a;default:var d=a._debugOwner,e=a._debugSource,f=na(a.type);c=null;d&&(c=na(d.type));d=f;f="";e?f=" (at "+e.fileName.replace(si,"")+":"+e.lineNumber+")":c&&(f=" (created by "+c+")");c="\n    in "+(d||"Unknown")+f}b+=c;a=a.return}while(a);return b}function va(a){switch(typeof a){case "boolean":case "number":case "object":case "string":case "undefined":return a;
default:return""}}function Ff(a){var b=a.type;return(a=a.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===b||"radio"===b)}function ti(a){var b=Ff(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=""+a[b];if(!a.hasOwnProperty(b)&&"undefined"!==typeof c&&"function"===typeof c.get&&"function"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=""+a;f.call(this,a)}});Object.defineProperty(a,
b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=""+a},stopTracking:function(){a._valueTracker=null;delete a[b]}}}}function mc(a){a._valueTracker||(a._valueTracker=ti(a))}function Gf(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d="";a&&(d=Ff(a)?a.checked?"true":"false":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Cd(a,b){var c=b.checked;return M({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=
c?c:a._wrapperState.initialChecked})}function Hf(a,b){var c=null==b.defaultValue?"":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=va(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:"checkbox"===b.type||"radio"===b.type?null!=b.checked:null!=b.value}}function If(a,b){b=b.checked;null!=b&&xd(a,"checked",b,!1)}function Dd(a,b){If(a,b);var c=va(b.value),d=b.type;if(null!=c)if("number"===d){if(0===c&&""===a.value||a.value!=c)a.value=""+c}else a.value!==
""+c&&(a.value=""+c);else if("submit"===d||"reset"===d){a.removeAttribute("value");return}b.hasOwnProperty("value")?Ed(a,b.type,c):b.hasOwnProperty("defaultValue")&&Ed(a,b.type,va(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}function Jf(a,b,c){if(b.hasOwnProperty("value")||b.hasOwnProperty("defaultValue")){var d=b.type;if(!("submit"!==d&&"reset"!==d||void 0!==b.value&&null!==b.value))return;b=""+a._wrapperState.initialValue;c||b===a.value||(a.value=
b);a.defaultValue=b}c=a.name;""!==c&&(a.name="");a.defaultChecked=!!a._wrapperState.initialChecked;""!==c&&(a.name=c)}function Ed(a,b,c){if("number"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+c&&(a.defaultValue=""+c)}function ui(a){var b="";ea.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function Fd(a,b){a=M({children:void 0},b);if(b=ui(b.children))a.children=b;return a}function hb(a,b,c,d){a=a.options;if(b){b={};
for(var e=0;e<c.length;e++)b["$"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty("$"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=""+va(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}function Gd(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(k(91));return M({},b,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}
function Kf(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(k(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(k(93));c=c[0]}b=c}null==b&&(b="");c=b}a._wrapperState={initialValue:va(c)}}function Lf(a,b){var c=va(b.value),d=va(b.defaultValue);null!=c&&(c=""+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=""+d)}function Mf(a,b){b=a.textContent;b===a._wrapperState.initialValue&&""!==
b&&null!==b&&(a.value=b)}function Nf(a){switch(a){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hd(a,b){return null==a||"http://www.w3.org/1999/xhtml"===a?Nf(b):"http://www.w3.org/2000/svg"===a&&"foreignObject"===b?"http://www.w3.org/1999/xhtml":a}function nc(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c["Webkit"+a]="webkit"+b;c["Moz"+a]="moz"+b;return c}function oc(a){if(Id[a])return Id[a];
if(!ib[a])return a;var b=ib[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Of)return Id[a]=b[c];return a}function Jd(a){var b=Pf.get(a);void 0===b&&(b=new Map,Pf.set(a,b));return b}function Na(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.effectTag&1026)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Qf(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Rf(a){if(Na(a)!==
a)throw Error(k(188));}function vi(a){var b=a.alternate;if(!b){b=Na(a);if(null===b)throw Error(k(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Rf(e),a;if(f===d)return Rf(e),b;f=f.sibling}throw Error(k(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=
f.child;h;){if(h===c){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(k(189));}}if(c.alternate!==d)throw Error(k(190));}if(3!==c.tag)throw Error(k(188));return c.stateNode.current===c?a:b}function Sf(a){a=vi(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}function jb(a,b){if(null==
b)throw Error(k(30));if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}function Kd(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}function pc(a){null!==a&&(Ab=jb(Ab,a));a=Ab;Ab=null;if(a){Kd(a,wi);if(Ab)throw Error(k(95));if(hc)throw a=pd,hc=!1,pd=null,a;}}function Ld(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:
a}function Tf(a){if(!wa)return!1;a="on"+a;var b=a in document;b||(b=document.createElement("div"),b.setAttribute(a,"return;"),b="function"===typeof b[a]);return b}function Uf(a){a.topLevelType=null;a.nativeEvent=null;a.targetInst=null;a.ancestors.length=0;10>qc.length&&qc.push(a)}function Vf(a,b,c,d){if(qc.length){var e=qc.pop();e.topLevelType=a;e.eventSystemFlags=d;e.nativeEvent=b;e.targetInst=c;return e}return{topLevelType:a,eventSystemFlags:d,nativeEvent:b,targetInst:c,ancestors:[]}}function Wf(a){var b=
a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d=c;if(3===d.tag)d=d.stateNode.containerInfo;else{for(;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo}if(!d)break;b=c.tag;5!==b&&6!==b||a.ancestors.push(c);c=Bb(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=Ld(a.nativeEvent);d=a.topLevelType;var f=a.nativeEvent,g=a.eventSystemFlags;0===c&&(g|=64);for(var h=null,m=0;m<jc.length;m++){var n=jc[m];n&&(n=n.extractEvents(d,b,f,e,g))&&(h=jb(h,n))}pc(h)}}function Md(a,
b,c){if(!c.has(a)){switch(a){case "scroll":Cb(b,"scroll",!0);break;case "focus":case "blur":Cb(b,"focus",!0);Cb(b,"blur",!0);c.set("blur",null);c.set("focus",null);break;case "cancel":case "close":Tf(a)&&Cb(b,a,!0);break;case "invalid":case "submit":case "reset":break;default:-1===Db.indexOf(a)&&w(a,b)}c.set(a,null)}}function xi(a,b){var c=Jd(b);Nd.forEach(function(a){Md(a,b,c)});yi.forEach(function(a){Md(a,b,c)})}function Od(a,b,c,d,e){return{blockedOn:a,topLevelType:b,eventSystemFlags:c|32,nativeEvent:e,
container:d}}function Xf(a,b){switch(a){case "focus":case "blur":xa=null;break;case "dragenter":case "dragleave":ya=null;break;case "mouseover":case "mouseout":za=null;break;case "pointerover":case "pointerout":Eb.delete(b.pointerId);break;case "gotpointercapture":case "lostpointercapture":Fb.delete(b.pointerId)}}function Gb(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a=Od(b,c,d,e,f),null!==b&&(b=Hb(b),null!==b&&Yf(b)),a;a.eventSystemFlags|=d;return a}function zi(a,b,c,d,e){switch(b){case "focus":return xa=
Gb(xa,a,b,c,d,e),!0;case "dragenter":return ya=Gb(ya,a,b,c,d,e),!0;case "mouseover":return za=Gb(za,a,b,c,d,e),!0;case "pointerover":var f=e.pointerId;Eb.set(f,Gb(Eb.get(f)||null,a,b,c,d,e));return!0;case "gotpointercapture":return f=e.pointerId,Fb.set(f,Gb(Fb.get(f)||null,a,b,c,d,e)),!0}return!1}function Ai(a){var b=Bb(a.target);if(null!==b){var c=Na(b);if(null!==c)if(b=c.tag,13===b){if(b=Qf(c),null!==b){a.blockedOn=b;Pd(a.priority,function(){Bi(c)});return}}else if(3===b&&c.stateNode.hydrate){a.blockedOn=
3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}function rc(a){if(null!==a.blockedOn)return!1;var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);if(null!==b){var c=Hb(b);null!==c&&Yf(c);a.blockedOn=b;return!1}return!0}function Zf(a,b,c){rc(a)&&c.delete(b)}function Ci(){for(Rd=!1;0<fa.length;){var a=fa[0];if(null!==a.blockedOn){a=Hb(a.blockedOn);null!==a&&Di(a);break}var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);null!==b?a.blockedOn=b:fa.shift()}null!==
xa&&rc(xa)&&(xa=null);null!==ya&&rc(ya)&&(ya=null);null!==za&&rc(za)&&(za=null);Eb.forEach(Zf);Fb.forEach(Zf)}function Ib(a,b){a.blockedOn===b&&(a.blockedOn=null,Rd||(Rd=!0,$f(ag,Ci)))}function bg(a){if(0<fa.length){Ib(fa[0],a);for(var b=1;b<fa.length;b++){var c=fa[b];c.blockedOn===a&&(c.blockedOn=null)}}null!==xa&&Ib(xa,a);null!==ya&&Ib(ya,a);null!==za&&Ib(za,a);b=function(b){return Ib(b,a)};Eb.forEach(b);Fb.forEach(b);for(b=0;b<Jb.length;b++)c=Jb[b],c.blockedOn===a&&(c.blockedOn=null);for(;0<Jb.length&&
(b=Jb[0],null===b.blockedOn);)Ai(b),null===b.blockedOn&&Jb.shift()}function Sd(a,b){for(var c=0;c<a.length;c+=2){var d=a[c],e=a[c+1],f="on"+(e[0].toUpperCase()+e.slice(1));f={phasedRegistrationNames:{bubbled:f,captured:f+"Capture"},dependencies:[d],eventPriority:b};Td.set(d,b);cg.set(d,f);dg[e]=f}}function w(a,b){Cb(b,a,!1)}function Cb(a,b,c){var d=Td.get(b);switch(void 0===d?2:d){case 0:d=Ei.bind(null,b,1,a);break;case 1:d=Fi.bind(null,b,1,a);break;default:d=sc.bind(null,b,1,a)}c?a.addEventListener(b,
d,!0):a.addEventListener(b,d,!1)}function Ei(a,b,c,d){Oa||vd();var e=sc,f=Oa;Oa=!0;try{eg(e,a,b,c,d)}finally{(Oa=f)||ud()}}function Fi(a,b,c,d){Gi(Hi,sc.bind(null,a,b,c,d))}function sc(a,b,c,d){if(tc)if(0<fa.length&&-1<Nd.indexOf(a))a=Od(null,a,b,c,d),fa.push(a);else{var e=Qd(a,b,c,d);if(null===e)Xf(a,d);else if(-1<Nd.indexOf(a))a=Od(e,a,b,c,d),fa.push(a);else if(!zi(e,a,b,c,d)){Xf(a,d);a=Vf(a,d,null,b);try{uf(Wf,a)}finally{Uf(a)}}}}function Qd(a,b,c,d){c=Ld(d);c=Bb(c);if(null!==c){var e=Na(c);if(null===
e)c=null;else{var f=e.tag;if(13===f){c=Qf(e);if(null!==c)return c;c=null}else if(3===f){if(e.stateNode.hydrate)return 3===e.tag?e.stateNode.containerInfo:null;c=null}else e!==c&&(c=null)}}a=Vf(a,d,c,b);try{uf(Wf,a)}finally{Uf(a)}return null}function fg(a,b,c){return null==b||"boolean"===typeof b||""===b?"":c||"number"!==typeof b||0===b||Kb.hasOwnProperty(a)&&Kb[a]?(""+b).trim():b+"px"}function gg(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf("--"),e=fg(c,b[c],d);"float"===
c&&(c="cssFloat");d?a.setProperty(c,e):a[c]=e}}function Ud(a,b){if(b){if(Ii[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(k(137,a,""));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(k(60));if(!("object"===typeof b.dangerouslySetInnerHTML&&"__html"in b.dangerouslySetInnerHTML))throw Error(k(61));}if(null!=b.style&&"object"!==typeof b.style)throw Error(k(62,""));}}function Vd(a,b){if(-1===a.indexOf("-"))return"string"===typeof b.is;switch(a){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":return!1;
default:return!0}}function oa(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=Jd(a);b=rd[b];for(var d=0;d<b.length;d++)Md(b[d],a,c)}function uc(){}function Wd(a){a=a||("undefined"!==typeof document?document:void 0);if("undefined"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function hg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function ig(a,b){var c=hg(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,
offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=hg(c)}}function jg(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?jg(a,b.parentNode):"contains"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}function kg(){for(var a=window,b=Wd();b instanceof a.HTMLIFrameElement;){try{var c="string"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Wd(a.document)}return b}
function Xd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&("input"===b&&("text"===a.type||"search"===a.type||"tel"===a.type||"url"===a.type||"password"===a.type)||"textarea"===b||"true"===a.contentEditable)}function lg(a,b){switch(a){case "button":case "input":case "select":case "textarea":return!!b.autoFocus}return!1}function Yd(a,b){return"textarea"===a||"option"===a||"noscript"===a||"string"===typeof b.children||"number"===typeof b.children||"object"===typeof b.dangerouslySetInnerHTML&&
null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}function kb(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}function mg(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(c===ng||c===Zd||c===$d){if(0===b)return a;b--}else c===og&&b++}a=a.previousSibling}return null}function Bb(a){var b=a[Aa];if(b)return b;for(var c=a.parentNode;c;){if(b=c[Lb]||c[Aa]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=mg(a);null!==
a;){if(c=a[Aa])return c;a=mg(a)}return b}a=c;c=a.parentNode}return null}function Hb(a){a=a[Aa]||a[Lb];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function Pa(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(k(33));}function ae(a){return a[vc]||null}function pa(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}function pg(a,b){var c=a.stateNode;if(!c)return null;var d=td(c);if(!d)return null;c=d[b];a:switch(b){case "onClick":case "onClickCapture":case "onDoubleClick":case "onDoubleClickCapture":case "onMouseDown":case "onMouseDownCapture":case "onMouseMove":case "onMouseMoveCapture":case "onMouseUp":case "onMouseUpCapture":case "onMouseEnter":(d=
!d.disabled)||(a=a.type,d=!("button"===a||"input"===a||"select"===a||"textarea"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&"function"!==typeof c)throw Error(k(231,b,typeof c));return c}function qg(a,b,c){if(b=pg(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a)}function Ji(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=pa(b);for(b=c.length;0<b--;)qg(c[b],
"captured",a);for(b=0;b<c.length;b++)qg(c[b],"bubbled",a)}}function be(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=pg(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a))}function Ki(a){a&&a.dispatchConfig.registrationName&&be(a._targetInst,null,a)}function lb(a){Kd(a,Ji)}function rg(){if(wc)return wc;var a,b=ce,c=b.length,d,e="value"in Ba?Ba.value:Ba.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=
c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return wc=e.slice(a,1<d?1-d:void 0)}function xc(){return!0}function yc(){return!1}function R(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):"target"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?xc:yc;this.isPropagationStopped=yc;return this}function Li(a,b,c,d){if(this.eventPool.length){var e=
this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}function Mi(a){if(!(a instanceof this))throw Error(k(279));a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function sg(a){a.eventPool=[];a.getPooled=Li;a.release=Mi}function tg(a,b){switch(a){case "keyup":return-1!==Ni.indexOf(b.keyCode);case "keydown":return 229!==b.keyCode;case "keypress":case "mousedown":case "blur":return!0;default:return!1}}function ug(a){a=a.detail;return"object"===typeof a&&"data"in
a?a.data:null}function Oi(a,b){switch(a){case "compositionend":return ug(b);case "keypress":if(32!==b.which)return null;vg=!0;return wg;case "textInput":return a=b.data,a===wg&&vg?null:a;default:return null}}function Pi(a,b){if(mb)return"compositionend"===a||!de&&tg(a,b)?(a=rg(),wc=ce=Ba=null,mb=!1,a):null;switch(a){case "paste":return null;case "keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;
case "compositionend":return xg&&"ko"!==b.locale?null:b.data;default:return null}}function yg(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return"input"===b?!!Qi[a.type]:"textarea"===b?!0:!1}function zg(a,b,c){a=R.getPooled(Ag.change,a,b,c);a.type="change";sf(c);lb(a);return a}function Ri(a){pc(a)}function zc(a){var b=Pa(a);if(Gf(b))return a}function Si(a,b){if("change"===a)return b}function Bg(){Mb&&(Mb.detachEvent("onpropertychange",Cg),Nb=Mb=null)}function Cg(a){if("value"===a.propertyName&&
zc(Nb))if(a=zg(Nb,a,Ld(a)),Oa)pc(a);else{Oa=!0;try{ee(Ri,a)}finally{Oa=!1,ud()}}}function Ti(a,b,c){"focus"===a?(Bg(),Mb=b,Nb=c,Mb.attachEvent("onpropertychange",Cg)):"blur"===a&&Bg()}function Ui(a,b){if("selectionchange"===a||"keyup"===a||"keydown"===a)return zc(Nb)}function Vi(a,b){if("click"===a)return zc(b)}function Wi(a,b){if("input"===a||"change"===a)return zc(b)}function Xi(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Yi[a])?!!b[a]:!1}function fe(a){return Xi}
function Zi(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}function Ob(a,b){if(Qa(a,b))return!0;if("object"!==typeof a||null===a||"object"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!$i.call(b,c[d])||!Qa(a[c[d]],b[c[d]]))return!1;return!0}function Dg(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if(ge||null==nb||nb!==Wd(c))return null;c=nb;"selectionStart"in c&&Xd(c)?c={start:c.selectionStart,
end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return Pb&&Ob(Pb,c)?null:(Pb=c,a=R.getPooled(Eg.select,he,a,b),a.type="select",a.target=nb,lb(a),a)}function Ac(a){var b=a.keyCode;"charCode"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function q(a,b){0>ob||(a.current=ie[ob],ie[ob]=null,ob--)}function y(a,b,c){ob++;
ie[ob]=a.current;a.current=b}function pb(a,b){var c=a.type.contextTypes;if(!c)return Ca;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function N(a){a=a.childContextTypes;return null!==a&&void 0!==a}function Fg(a,b,c){if(B.current!==Ca)throw Error(k(168));y(B,b);y(G,c)}
function Gg(a,b,c){var d=a.stateNode;a=b.childContextTypes;if("function"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw Error(k(108,na(b)||"Unknown",e));return M({},c,{},d)}function Bc(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Ca;Ra=B.current;y(B,a);y(G,G.current);return!0}function Hg(a,b,c){var d=a.stateNode;if(!d)throw Error(k(169));c?(a=Gg(a,b,Ra),d.__reactInternalMemoizedMergedChildContext=a,q(G),q(B),y(B,a)):q(G);y(G,c)}function Cc(){switch(aj()){case Dc:return 99;
case Ig:return 98;case Jg:return 97;case Kg:return 96;case Lg:return 95;default:throw Error(k(332));}}function Mg(a){switch(a){case 99:return Dc;case 98:return Ig;case 97:return Jg;case 96:return Kg;case 95:return Lg;default:throw Error(k(332));}}function Da(a,b){a=Mg(a);return bj(a,b)}function Ng(a,b,c){a=Mg(a);return je(a,b,c)}function Og(a){null===qa?(qa=[a],Ec=je(Dc,Pg)):qa.push(a);return Qg}function ha(){if(null!==Ec){var a=Ec;Ec=null;Rg(a)}Pg()}function Pg(){if(!ke&&null!==qa){ke=!0;var a=0;
try{var b=qa;Da(99,function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});qa=null}catch(c){throw null!==qa&&(qa=qa.slice(a+1)),je(Dc,ha),c;}finally{ke=!1}}}function Fc(a,b,c){c/=10;return 1073741821-(((1073741821-a+b/10)/c|0)+1)*c}function aa(a,b){if(a&&a.defaultProps){b=M({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}function le(){Gc=qb=Hc=null}function me(a){var b=Ic.current;q(Ic);a.type._context._currentValue=b}function Sg(a,b){for(;null!==a;){var c=
a.alternate;if(a.childExpirationTime<b)a.childExpirationTime=b,null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);else if(null!==c&&c.childExpirationTime<b)c.childExpirationTime=b;else break;a=a.return}}function rb(a,b){Hc=a;Gc=qb=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(a.expirationTime>=b&&(ia=!0),a.firstContext=null)}function W(a,b){if(Gc!==a&&!1!==b&&0!==b){if("number"!==typeof b||1073741823===b)Gc=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===qb){if(null===
Hc)throw Error(k(308));qb=b;Hc.dependencies={expirationTime:0,firstContext:b,responders:null}}else qb=qb.next=b}return a._currentValue}function ne(a){a.updateQueue={baseState:a.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function oe(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,baseQueue:a.baseQueue,shared:a.shared,effects:a.effects})}function Ea(a,b){a={expirationTime:a,suspenseConfig:b,tag:Tg,payload:null,callback:null,next:null};return a.next=
a}function Fa(a,b){a=a.updateQueue;if(null!==a){a=a.shared;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}}function Ug(a,b){var c=a.alternate;null!==c&&oe(c,a);a=a.updateQueue;c=a.baseQueue;null===c?(a.baseQueue=b.next=b,b.next=b):(b.next=c.next,c.next=b)}function Qb(a,b,c,d){var e=a.updateQueue;Ga=!1;var f=e.baseQueue,g=e.shared.pending;if(null!==g){if(null!==f){var h=f.next;f.next=g.next;g.next=h}f=g;e.shared.pending=null;h=a.alternate;null!==h&&(h=h.updateQueue,null!==h&&
(h.baseQueue=g))}if(null!==f){h=f.next;var m=e.baseState,n=0,k=null,ba=null,l=null;if(null!==h){var p=h;do{g=p.expirationTime;if(g<d){var t={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===l?(ba=l=t,k=m):l=l.next=t;g>n&&(n=g)}else{null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null});Vg(g,p.suspenseConfig);a:{var q=a,r=p;g=b;t=c;switch(r.tag){case 1:q=
r.payload;if("function"===typeof q){m=q.call(t,m,g);break a}m=q;break a;case 3:q.effectTag=q.effectTag&-4097|64;case Tg:q=r.payload;g="function"===typeof q?q.call(t,m,g):q;if(null===g||void 0===g)break a;m=M({},m,g);break a;case Jc:Ga=!0}}null!==p.callback&&(a.effectTag|=32,g=e.effects,null===g?e.effects=[p]:g.push(p))}p=p.next;if(null===p||p===h)if(g=e.shared.pending,null===g)break;else p=f.next=g.next,g.next=h,e.baseQueue=f=g,e.shared.pending=null}while(1)}null===l?k=m:l.next=ba;e.baseState=k;e.baseQueue=
l;Kc(n);a.expirationTime=n;a.memoizedState=m}}function Wg(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=e;e=c;if("function"!==typeof d)throw Error(k(191,d));d.call(e)}}}function Lc(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:M({},b,c);a.memoizedState=c;0===a.expirationTime&&(a.updateQueue.baseState=c)}function Xg(a,b,c,d,e,f,g){a=a.stateNode;return"function"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,
f,g):b.prototype&&b.prototype.isPureReactComponent?!Ob(c,d)||!Ob(e,f):!0}function Yg(a,b,c){var d=!1,e=Ca;var f=b.contextType;"object"===typeof f&&null!==f?f=W(f):(e=N(b)?Ra:B.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?pb(a,e):Ca);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Mc;a.stateNode=b;b._reactInternalFiber=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}function Zg(a,
b,c,d){a=b.state;"function"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);"function"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Mc.enqueueReplaceState(b,b.state,null)}function pe(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=$g;ne(a);var f=b.contextType;"object"===typeof f&&null!==f?e.context=W(f):(f=N(b)?Ra:B.current,e.context=pb(a,f));Qb(a,c,e,d);e.state=a.memoizedState;f=b.getDerivedStateFromProps;
"function"===typeof f&&(Lc(a,b,f,c),e.state=a.memoizedState);"function"===typeof b.getDerivedStateFromProps||"function"===typeof e.getSnapshotBeforeUpdate||"function"!==typeof e.UNSAFE_componentWillMount&&"function"!==typeof e.componentWillMount||(b=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Mc.enqueueReplaceState(e,e.state,null),Qb(a,c,e,d),e.state=a.memoizedState);"function"===
typeof e.componentDidMount&&(a.effectTag|=4)}function Rb(a,b,c){a=c.ref;if(null!==a&&"function"!==typeof a&&"object"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(k(309));var d=c.stateNode}if(!d)throw Error(k(147,a));var e=""+a;if(null!==b&&null!==b.ref&&"function"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===$g&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if("string"!==typeof a)throw Error(k(284));if(!c._owner)throw Error(k(290,
a));}return a}function Nc(a,b){if("textarea"!==a.type)throw Error(k(31,"[object Object]"===Object.prototype.toString.call(b)?"object with keys {"+Object.keys(b).join(", ")+"}":b,""));}function ah(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,
b),b=b.sibling;return a}function e(a,b){a=Sa(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=qe(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function m(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props),d.ref=Rb(a,b,c),d.return=a,d;d=Oc(c.type,
c.key,c.props,null,a.mode,d);d.ref=Rb(a,b,c);d.return=a;return d}function n(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=re(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function l(a,b,c,d,f){if(null===b||7!==b.tag)return b=Ha(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function ba(a,b,c){if("string"===typeof b||"number"===typeof b)return b=qe(""+b,a.mode,c),b.return=a,b;if("object"===
typeof b&&null!==b){switch(b.$$typeof){case Pc:return c=Oc(b.type,b.key,b.props,null,a.mode,c),c.ref=Rb(a,null,b),c.return=a,c;case gb:return b=re(b,a.mode,c),b.return=a,b}if(Qc(b)||zb(b))return b=Ha(b,a.mode,c,null),b.return=a,b;Nc(a,b)}return null}function p(a,b,c,d){var e=null!==b?b.key:null;if("string"===typeof c||"number"===typeof c)return null!==e?null:h(a,b,""+c,d);if("object"===typeof c&&null!==c){switch(c.$$typeof){case Pc:return c.key===e?c.type===Ma?l(a,b,c.props.children,d,e):m(a,b,c,
d):null;case gb:return c.key===e?n(a,b,c,d):null}if(Qc(c)||zb(c))return null!==e?null:l(a,b,c,d,null);Nc(a,c)}return null}function t(a,b,c,d,e){if("string"===typeof d||"number"===typeof d)return a=a.get(c)||null,h(b,a,""+d,e);if("object"===typeof d&&null!==d){switch(d.$$typeof){case Pc:return a=a.get(null===d.key?c:d.key)||null,d.type===Ma?l(b,a,d.props.children,e,d.key):m(b,a,d,e);case gb:return a=a.get(null===d.key?c:d.key)||null,n(b,a,d,e)}if(Qc(d)||zb(d))return a=a.get(c)||null,l(b,a,d,e,null);
Nc(b,d)}return null}function q(e,g,h,m){for(var n=null,k=null,l=g,r=g=0,C=null;null!==l&&r<h.length;r++){l.index>r?(C=l,l=null):C=l.sibling;var O=p(e,l,h[r],m);if(null===O){null===l&&(l=C);break}a&&l&&null===O.alternate&&b(e,l);g=f(O,g,r);null===k?n=O:k.sibling=O;k=O;l=C}if(r===h.length)return c(e,l),n;if(null===l){for(;r<h.length;r++)l=ba(e,h[r],m),null!==l&&(g=f(l,g,r),null===k?n=l:k.sibling=l,k=l);return n}for(l=d(e,l);r<h.length;r++)C=t(l,e,r,h[r],m),null!==C&&(a&&null!==C.alternate&&l.delete(null===
C.key?r:C.key),g=f(C,g,r),null===k?n=C:k.sibling=C,k=C);a&&l.forEach(function(a){return b(e,a)});return n}function w(e,g,h,n){var m=zb(h);if("function"!==typeof m)throw Error(k(150));h=m.call(h);if(null==h)throw Error(k(151));for(var l=m=null,r=g,C=g=0,O=null,v=h.next();null!==r&&!v.done;C++,v=h.next()){r.index>C?(O=r,r=null):O=r.sibling;var q=p(e,r,v.value,n);if(null===q){null===r&&(r=O);break}a&&r&&null===q.alternate&&b(e,r);g=f(q,g,C);null===l?m=q:l.sibling=q;l=q;r=O}if(v.done)return c(e,r),m;
if(null===r){for(;!v.done;C++,v=h.next())v=ba(e,v.value,n),null!==v&&(g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);return m}for(r=d(e,r);!v.done;C++,v=h.next())v=t(r,e,C,v.value,n),null!==v&&(a&&null!==v.alternate&&r.delete(null===v.key?C:v.key),g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);a&&r.forEach(function(a){return b(e,a)});return m}return function(a,d,f,h){var m="object"===typeof f&&null!==f&&f.type===Ma&&null===f.key;m&&(f=f.props.children);var n="object"===typeof f&&null!==f;if(n)switch(f.$$typeof){case Pc:a:{n=
f.key;for(m=d;null!==m;){if(m.key===n){switch(m.tag){case 7:if(f.type===Ma){c(a,m.sibling);d=e(m,f.props.children);d.return=a;a=d;break a}break;default:if(m.elementType===f.type){c(a,m.sibling);d=e(m,f.props);d.ref=Rb(a,m,f);d.return=a;a=d;break a}}c(a,m);break}else b(a,m);m=m.sibling}f.type===Ma?(d=Ha(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Oc(f.type,f.key,f.props,null,a.mode,h),h.ref=Rb(a,d,f),h.return=a,a=h)}return g(a);case gb:a:{for(m=f.key;null!==d;){if(d.key===m)if(4===d.tag&&d.stateNode.containerInfo===
f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=re(f,a.mode,h);d.return=a;a=d}return g(a)}if("string"===typeof f||"number"===typeof f)return f=""+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):(c(a,d),d=qe(f,a.mode,h),d.return=a,a=d),g(a);if(Qc(f))return q(a,d,f,h);if(zb(f))return w(a,d,f,h);n&&Nc(a,f);if("undefined"===typeof f&&!m)switch(a.tag){case 1:case 0:throw a=
a.type,Error(k(152,a.displayName||a.name||"Component"));}return c(a,d)}}function Ta(a){if(a===Sb)throw Error(k(174));return a}function se(a,b){y(Tb,b);y(Ub,a);y(ja,Sb);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Hd(null,"");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=Hd(b,a)}q(ja);y(ja,b)}function tb(a){q(ja);q(Ub);q(Tb)}function bh(a){Ta(Tb.current);var b=Ta(ja.current);var c=Hd(b,a.type);b!==c&&(y(Ub,a),y(ja,c))}function te(a){Ub.current===
a&&(q(ja),q(Ub))}function Rc(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||c.data===$d||c.data===Zd))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.effectTag&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}function ue(a,b){return{responder:a,props:b}}
function S(){throw Error(k(321));}function ve(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!Qa(a[c],b[c]))return!1;return!0}function we(a,b,c,d,e,f){Ia=f;z=b;b.memoizedState=null;b.updateQueue=null;b.expirationTime=0;Sc.current=null===a||null===a.memoizedState?dj:ej;a=c(d,e);if(b.expirationTime===Ia){f=0;do{b.expirationTime=0;if(!(25>f))throw Error(k(301));f+=1;J=K=null;b.updateQueue=null;Sc.current=fj;a=c(d,e)}while(b.expirationTime===Ia)}Sc.current=Tc;b=null!==K&&null!==K.next;
Ia=0;J=K=z=null;Uc=!1;if(b)throw Error(k(300));return a}function ub(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===J?z.memoizedState=J=a:J=J.next=a;return J}function vb(){if(null===K){var a=z.alternate;a=null!==a?a.memoizedState:null}else a=K.next;var b=null===J?z.memoizedState:J.next;if(null!==b)J=b,K=a;else{if(null===a)throw Error(k(310));K=a;a={memoizedState:K.memoizedState,baseState:K.baseState,baseQueue:K.baseQueue,queue:K.queue,next:null};null===J?z.memoizedState=
J=a:J=J.next=a}return J}function Ua(a,b){return"function"===typeof b?b(a):b}function Vc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=K,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){e=e.next;d=d.baseState;var h=g=f=null,m=e;do{var n=m.expirationTime;if(n<Ia){var l={expirationTime:m.expirationTime,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,
next:null};null===h?(g=h=l,f=d):h=h.next=l;n>z.expirationTime&&(z.expirationTime=n,Kc(n))}else null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,next:null}),Vg(n,m.suspenseConfig),d=m.eagerReducer===a?m.eagerState:a(d,m.action);m=m.next}while(null!==m&&m!==e);null===h?f=d:h.next=g;Qa(d,b.memoizedState)||(ia=!0);b.memoizedState=d;b.baseState=f;b.baseQueue=h;c.lastRenderedState=d}return[b.memoizedState,
c.dispatch]}function Wc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);Qa(f,b.memoizedState)||(ia=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function xe(a){var b=ub();"function"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={pending:null,dispatch:null,lastRenderedReducer:Ua,
lastRenderedState:a};a=a.dispatch=ch.bind(null,z,a);return[b.memoizedState,a]}function ye(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=z.updateQueue;null===b?(b={lastEffect:null},z.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function dh(a){return vb().memoizedState}function ze(a,b,c,d){var e=ub();z.effectTag|=a;e.memoizedState=ye(1|b,c,void 0,void 0===d?null:d)}function Ae(a,b,c,d){var e=vb();
d=void 0===d?null:d;var f=void 0;if(null!==K){var g=K.memoizedState;f=g.destroy;if(null!==d&&ve(d,g.deps)){ye(b,c,f,d);return}}z.effectTag|=a;e.memoizedState=ye(1|b,c,f,d)}function eh(a,b){return ze(516,4,a,b)}function Xc(a,b){return Ae(516,4,a,b)}function fh(a,b){return Ae(4,2,a,b)}function gh(a,b){if("function"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function hh(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;
return Ae(4,2,gh.bind(null,b,a),c)}function Be(a,b){}function ih(a,b){ub().memoizedState=[a,void 0===b?null:b];return a}function Yc(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];c.memoizedState=[a,b];return a}function jh(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function Ce(a,b,c){var d=Cc();Da(98>d?98:d,function(){a(!0)});Da(97<d?97:d,function(){var d=
X.suspense;X.suspense=void 0===b?null:b;try{a(!1),c()}finally{X.suspense=d}})}function ch(a,b,c){var d=ka(),e=Vb.suspense;d=Va(d,a,e);e={expirationTime:d,suspenseConfig:e,action:c,eagerReducer:null,eagerState:null,next:null};var f=b.pending;null===f?e.next=e:(e.next=f.next,f.next=e);b.pending=e;f=a.alternate;if(a===z||null!==f&&f===z)Uc=!0,e.expirationTime=Ia,z.expirationTime=Ia;else{if(0===a.expirationTime&&(null===f||0===f.expirationTime)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,
h=f(g,c);e.eagerReducer=f;e.eagerState=h;if(Qa(h,g))return}catch(m){}finally{}Ja(a,d)}}function kh(a,b){var c=la(5,null,null,0);c.elementType="DELETED";c.type="DELETED";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function lh(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=""===a.pendingProps||3!==b.nodeType?
null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1}}function De(a){if(Wa){var b=Ka;if(b){var c=b;if(!lh(a,b)){b=kb(c.nextSibling);if(!b||!lh(a,b)){a.effectTag=a.effectTag&-1025|2;Wa=!1;ra=a;return}kh(ra,c)}ra=a;Ka=kb(b.firstChild)}else a.effectTag=a.effectTag&-1025|2,Wa=!1,ra=a}}function mh(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;ra=a}function Zc(a){if(a!==ra)return!1;if(!Wa)return mh(a),Wa=!0,!1;var b=a.type;if(5!==a.tag||"head"!==b&&"body"!==
b&&!Yd(b,a.memoizedProps))for(b=Ka;b;)kh(a,b),b=kb(b.nextSibling);mh(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(k(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(c===og){if(0===b){Ka=kb(a.nextSibling);break a}b--}else c!==ng&&c!==Zd&&c!==$d||b++}a=a.nextSibling}Ka=null}}else Ka=ra?kb(a.stateNode.nextSibling):null;return!0}function Ee(){Ka=ra=null;Wa=!1}function T(a,b,c,d){b.child=null===a?Fe(b,null,c,d):wb(b,a.child,c,d)}function nh(a,
b,c,d,e){c=c.render;var f=b.ref;rb(b,e);d=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,d,e);return b.child}function oh(a,b,c,d,e,f){if(null===a){var g=c.type;if("function"===typeof g&&!Ge(g)&&void 0===g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,ph(a,b,g,d,e,f);a=Oc(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<
f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:Ob,c(e,d)&&a.ref===b.ref))return sa(a,b,f);b.effectTag|=1;a=Sa(g,d);a.ref=b.ref;a.return=b;return b.child=a}function ph(a,b,c,d,e,f){return null!==a&&Ob(a.memoizedProps,d)&&a.ref===b.ref&&(ia=!1,e<f)?(b.expirationTime=a.expirationTime,sa(a,b,f)):He(a,b,c,d,f)}function qh(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function He(a,b,c,d,e){var f=N(c)?Ra:B.current;f=pb(b,f);rb(b,e);c=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=
a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,c,e);return b.child}function rh(a,b,c,d,e){if(N(c)){var f=!0;Bc(b)}else f=!1;rb(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Yg(b,c,d),pe(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var m=g.context,n=c.contextType;"object"===typeof n&&null!==n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n));var l=c.getDerivedStateFromProps,k="function"===
typeof l||"function"===typeof g.getSnapshotBeforeUpdate;k||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n);Ga=!1;var p=b.memoizedState;g.state=p;Qb(b,d,g,e);m=b.memoizedState;h!==d||p!==m||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),m=b.memoizedState),(h=Ga||Xg(b,c,h,d,p,m,n))?(k||"function"!==typeof g.UNSAFE_componentWillMount&&"function"!==typeof g.componentWillMount||("function"===typeof g.componentWillMount&&
g.componentWillMount(),"function"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),"function"===typeof g.componentDidMount&&(b.effectTag|=4)):("function"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=m),g.props=d,g.state=m,g.context=n,d=h):("function"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,oe(a,b),h=b.memoizedProps,g.props=b.type===b.elementType?h:aa(b.type,h),m=g.context,n=c.contextType,"object"===typeof n&&null!==
n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n)),l=c.getDerivedStateFromProps,(k="function"===typeof l||"function"===typeof g.getSnapshotBeforeUpdate)||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n),Ga=!1,m=b.memoizedState,g.state=m,Qb(b,d,g,e),p=b.memoizedState,h!==d||m!==p||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),p=b.memoizedState),(l=Ga||Xg(b,c,h,d,m,p,n))?(k||"function"!==typeof g.UNSAFE_componentWillUpdate&&
"function"!==typeof g.componentWillUpdate||("function"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,p,n),"function"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,p,n)),"function"===typeof g.componentDidUpdate&&(b.effectTag|=4),"function"===typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===
a.memoizedState||(b.effectTag|=256),b.memoizedProps=d,b.memoizedState=p),g.props=d,g.state=p,g.context=n,d=l):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=256),d=!1);return Ie(a,b,c,d,f,e)}function Ie(a,b,c,d,e,f){qh(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&Hg(b,c,!1),sa(a,b,f);d=b.stateNode;gj.current=b;var h=g&&"function"!==typeof c.getDerivedStateFromError?
null:d.render();b.effectTag|=1;null!==a&&g?(b.child=wb(b,a.child,null,f),b.child=wb(b,null,h,f)):T(a,b,h,f);b.memoizedState=d.state;e&&Hg(b,c,!0);return b.child}function sh(a){var b=a.stateNode;b.pendingContext?Fg(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Fg(a,b.context,!1);se(a,b.containerInfo)}function th(a,b,c){var d=b.mode,e=b.pendingProps,f=D.current,g=!1,h;(h=0!==(b.effectTag&64))||(h=0!==(f&2)&&(null===a||null!==a.memoizedState));h?(g=!0,b.effectTag&=-65):null!==a&&null===
a.memoizedState||void 0===e.fallback||!0===e.unstable_avoidThisFallback||(f|=1);y(D,f&1);if(null===a){void 0!==e.fallback&&De(b);if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;b.memoizedState=Je;b.child=e;return c}d=e.children;b.memoizedState=null;return b.child=Fe(b,null,d,c)}if(null!==a.memoizedState){a=a.child;d=a.sibling;if(g){e=e.fallback;
c=Sa(a,a.pendingProps);c.return=b;if(0===(b.mode&2)&&(g=null!==b.memoizedState?b.child.child:b.child,g!==a.child))for(c.child=g;null!==g;)g.return=c,g=g.sibling;d=Sa(d,e);d.return=b;c.sibling=d;c.childExpirationTime=0;b.memoizedState=Je;b.child=c;return d}c=wb(b,a.child,e.children,c);b.memoizedState=null;return b.child=c}a=a.child;if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;e.child=a;null!==a&&(a.return=e);if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==
a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;c.effectTag|=2;e.childExpirationTime=0;b.memoizedState=Je;b.child=e;return c}b.memoizedState=null;return b.child=wb(b,a,e.children,c)}function uh(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);Sg(a.return,b)}function Ke(a,b,c,d,e,f){var g=a.memoizedState;null===g?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailExpiration:0,tailMode:e,
lastEffect:f}:(g.isBackwards=b,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=c,g.tailExpiration=0,g.tailMode=e,g.lastEffect=f)}function vh(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;T(a,b,d.children,c);d=D.current;if(0!==(d&2))d=d&1|2,b.effectTag|=64;else{if(null!==a&&0!==(a.effectTag&64))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&uh(a,c);else if(19===a.tag)uh(a,c);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===
a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}y(D,d);if(0===(b.mode&2))b.memoizedState=null;else switch(e){case "forwards":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Rc(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);Ke(b,!1,e,c,f,b.lastEffect);break;case "backwards":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Rc(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}Ke(b,
!0,c,null,f,b.lastEffect);break;case "together":Ke(b,!1,null,null,void 0,b.lastEffect);break;default:b.memoizedState=null}return b.child}function sa(a,b,c){null!==a&&(b.dependencies=a.dependencies);var d=b.expirationTime;0!==d&&Kc(d);if(b.childExpirationTime<c)return null;if(null!==a&&b.child!==a.child)throw Error(k(153));if(null!==b.child){a=b.child;c=Sa(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Sa(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}
function $c(a,b){switch(a.tailMode){case "hidden":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case "collapsed":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}function hj(a,b,c){var d=b.pendingProps;switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return N(b.type)&&(q(G),q(B)),
null;case 3:return tb(),q(G),q(B),c=b.stateNode,c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),null!==a&&null!==a.child||!Zc(b)||(b.effectTag|=4),wh(b),null;case 5:te(b);c=Ta(Tb.current);var e=b.type;if(null!==a&&null!=b.stateNode)ij(a,b,e,d,c),a.ref!==b.ref&&(b.effectTag|=128);else{if(!d){if(null===b.stateNode)throw Error(k(166));return null}a=Ta(ja.current);if(Zc(b)){d=b.stateNode;e=b.type;var f=b.memoizedProps;d[Aa]=b;d[vc]=f;switch(e){case "iframe":case "object":case "embed":w("load",
d);break;case "video":case "audio":for(a=0;a<Db.length;a++)w(Db[a],d);break;case "source":w("error",d);break;case "img":case "image":case "link":w("error",d);w("load",d);break;case "form":w("reset",d);w("submit",d);break;case "details":w("toggle",d);break;case "input":Hf(d,f);w("invalid",d);oa(c,"onChange");break;case "select":d._wrapperState={wasMultiple:!!f.multiple};w("invalid",d);oa(c,"onChange");break;case "textarea":Kf(d,f),w("invalid",d),oa(c,"onChange")}Ud(e,f);a=null;for(var g in f)if(f.hasOwnProperty(g)){var h=
f[g];"children"===g?"string"===typeof h?d.textContent!==h&&(a=["children",h]):"number"===typeof h&&d.textContent!==""+h&&(a=["children",""+h]):db.hasOwnProperty(g)&&null!=h&&oa(c,g)}switch(e){case "input":mc(d);Jf(d,f,!0);break;case "textarea":mc(d);Mf(d);break;case "select":case "option":break;default:"function"===typeof f.onClick&&(d.onclick=uc)}c=a;b.updateQueue=c;null!==c&&(b.effectTag|=4)}else{g=9===c.nodeType?c:c.ownerDocument;"http://www.w3.org/1999/xhtml"===a&&(a=Nf(e));"http://www.w3.org/1999/xhtml"===
a?"script"===e?(a=g.createElement("div"),a.innerHTML="<script>\x3c/script>",a=a.removeChild(a.firstChild)):"string"===typeof d.is?a=g.createElement(e,{is:d.is}):(a=g.createElement(e),"select"===e&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,e);a[Aa]=b;a[vc]=d;jj(a,b,!1,!1);b.stateNode=a;g=Vd(e,d);switch(e){case "iframe":case "object":case "embed":w("load",a);h=d;break;case "video":case "audio":for(h=0;h<Db.length;h++)w(Db[h],a);h=d;break;case "source":w("error",a);
h=d;break;case "img":case "image":case "link":w("error",a);w("load",a);h=d;break;case "form":w("reset",a);w("submit",a);h=d;break;case "details":w("toggle",a);h=d;break;case "input":Hf(a,d);h=Cd(a,d);w("invalid",a);oa(c,"onChange");break;case "option":h=Fd(a,d);break;case "select":a._wrapperState={wasMultiple:!!d.multiple};h=M({},d,{value:void 0});w("invalid",a);oa(c,"onChange");break;case "textarea":Kf(a,d);h=Gd(a,d);w("invalid",a);oa(c,"onChange");break;default:h=d}Ud(e,h);var m=h;for(f in m)if(m.hasOwnProperty(f)){var n=
m[f];"style"===f?gg(a,n):"dangerouslySetInnerHTML"===f?(n=n?n.__html:void 0,null!=n&&xh(a,n)):"children"===f?"string"===typeof n?("textarea"!==e||""!==n)&&Wb(a,n):"number"===typeof n&&Wb(a,""+n):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(db.hasOwnProperty(f)?null!=n&&oa(c,f):null!=n&&xd(a,f,n,g))}switch(e){case "input":mc(a);Jf(a,d,!1);break;case "textarea":mc(a);Mf(a);break;case "option":null!=d.value&&a.setAttribute("value",""+va(d.value));break;case "select":a.multiple=
!!d.multiple;c=d.value;null!=c?hb(a,!!d.multiple,c,!1):null!=d.defaultValue&&hb(a,!!d.multiple,d.defaultValue,!0);break;default:"function"===typeof h.onClick&&(a.onclick=uc)}lg(e,d)&&(b.effectTag|=4)}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)kj(a,b,a.memoizedProps,d);else{if("string"!==typeof d&&null===b.stateNode)throw Error(k(166));c=Ta(Tb.current);Ta(ja.current);Zc(b)?(c=b.stateNode,d=b.memoizedProps,c[Aa]=b,c.nodeValue!==d&&(b.effectTag|=4)):(c=(9===c.nodeType?
c:c.ownerDocument).createTextNode(d),c[Aa]=b,b.stateNode=c)}return null;case 13:q(D);d=b.memoizedState;if(0!==(b.effectTag&64))return b.expirationTime=c,b;c=null!==d;d=!1;null===a?void 0!==b.memoizedProps.fallback&&Zc(b):(e=a.memoizedState,d=null!==e,c||null===e||(e=a.child.sibling,null!==e&&(f=b.firstEffect,null!==f?(b.firstEffect=e,e.nextEffect=f):(b.firstEffect=b.lastEffect=e,e.nextEffect=null),e.effectTag=8)));if(c&&!d&&0!==(b.mode&2))if(null===a&&!0!==b.memoizedProps.unstable_avoidThisFallback||
0!==(D.current&1))F===Xa&&(F=ad);else{if(F===Xa||F===ad)F=bd;0!==Xb&&null!==U&&(Ya(U,P),yh(U,Xb))}if(c||d)b.effectTag|=4;return null;case 4:return tb(),wh(b),null;case 10:return me(b),null;case 17:return N(b.type)&&(q(G),q(B)),null;case 19:q(D);d=b.memoizedState;if(null===d)return null;e=0!==(b.effectTag&64);f=d.rendering;if(null===f)if(e)$c(d,!1);else{if(F!==Xa||null!==a&&0!==(a.effectTag&64))for(f=b.child;null!==f;){a=Rc(f);if(null!==a){b.effectTag|=64;$c(d,!1);e=a.updateQueue;null!==e&&(b.updateQueue=
e,b.effectTag|=4);null===d.lastEffect&&(b.firstEffect=null);b.lastEffect=d.lastEffect;for(d=b.child;null!==d;)e=d,f=c,e.effectTag&=2,e.nextEffect=null,e.firstEffect=null,e.lastEffect=null,a=e.alternate,null===a?(e.childExpirationTime=0,e.expirationTime=f,e.child=null,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null):(e.childExpirationTime=a.childExpirationTime,e.expirationTime=a.expirationTime,e.child=a.child,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,
e.updateQueue=a.updateQueue,f=a.dependencies,e.dependencies=null===f?null:{expirationTime:f.expirationTime,firstContext:f.firstContext,responders:f.responders}),d=d.sibling;y(D,D.current&1|2);return b.child}f=f.sibling}}else{if(!e)if(a=Rc(f),null!==a){if(b.effectTag|=64,e=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.effectTag|=4),$c(d,!0),null===d.tail&&"hidden"===d.tailMode&&!f.alternate)return b=b.lastEffect=d.lastEffect,null!==b&&(b.nextEffect=null),null}else 2*Y()-d.renderingStartTime>d.tailExpiration&&
1<c&&(b.effectTag|=64,e=!0,$c(d,!1),b.expirationTime=b.childExpirationTime=c-1);d.isBackwards?(f.sibling=b.child,b.child=f):(c=d.last,null!==c?c.sibling=f:b.child=f,d.last=f)}return null!==d.tail?(0===d.tailExpiration&&(d.tailExpiration=Y()+500),c=d.tail,d.rendering=c,d.tail=c.sibling,d.lastEffect=b.lastEffect,d.renderingStartTime=Y(),c.sibling=null,b=D.current,y(D,e?b&1|2:b&1),c):null}throw Error(k(156,b.tag));}function lj(a,b){switch(a.tag){case 1:return N(a.type)&&(q(G),q(B)),b=a.effectTag,b&4096?
(a.effectTag=b&-4097|64,a):null;case 3:tb();q(G);q(B);b=a.effectTag;if(0!==(b&64))throw Error(k(285));a.effectTag=b&-4097|64;return a;case 5:return te(a),null;case 13:return q(D),b=a.effectTag,b&4096?(a.effectTag=b&-4097|64,a):null;case 19:return q(D),null;case 4:return tb(),null;case 10:return me(a),null;default:return null}}function Le(a,b){return{value:a,source:b,stack:Bd(b)}}function Me(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=Bd(c));null!==c&&na(c.type);b=b.value;null!==a&&1===a.tag&&
na(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e;})}}function mj(a,b){try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(c){Za(a,c)}}function zh(a){var b=a.ref;if(null!==b)if("function"===typeof b)try{b(null)}catch(c){Za(a,c)}else b.current=null}function nj(a,b){switch(b.tag){case 0:case 11:case 15:case 22:return;case 1:if(b.effectTag&256&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;b=a.getSnapshotBeforeUpdate(b.elementType===
b.type?c:aa(b.type,c),d);a.__reactInternalSnapshotBeforeUpdate=b}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(k(163));}function Ah(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.destroy;c.destroy=void 0;void 0!==d&&d()}c=c.next}while(c!==b)}}function Bh(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function oj(a,b,c,d){switch(c.tag){case 0:case 11:case 15:case 22:Bh(3,
c);return;case 1:a=c.stateNode;c.effectTag&4&&(null===b?a.componentDidMount():(d=c.elementType===c.type?b.memoizedProps:aa(c.type,b.memoizedProps),a.componentDidUpdate(d,b.memoizedState,a.__reactInternalSnapshotBeforeUpdate)));b=c.updateQueue;null!==b&&Wg(c,b,a);return;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}Wg(c,b,a)}return;case 5:a=c.stateNode;null===b&&c.effectTag&4&&lg(c.type,c.memoizedProps)&&
a.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===c.memoizedState&&(c=c.alternate,null!==c&&(c=c.memoizedState,null!==c&&(c=c.dehydrated,null!==c&&bg(c))));return;case 19:case 17:case 20:case 21:return}throw Error(k(163));}function Ch(a,b,c){"function"===typeof Ne&&Ne(b);switch(b.tag){case 0:case 11:case 14:case 15:case 22:a=b.updateQueue;if(null!==a&&(a=a.lastEffect,null!==a)){var d=a.next;Da(97<c?97:c,function(){var a=d;do{var c=a.destroy;if(void 0!==c){var g=b;try{c()}catch(h){Za(g,
h)}}a=a.next}while(a!==d)})}break;case 1:zh(b);c=b.stateNode;"function"===typeof c.componentWillUnmount&&mj(b,c);break;case 5:zh(b);break;case 4:Dh(a,b,c)}}function Eh(a){var b=a.alternate;a.return=null;a.child=null;a.memoizedState=null;a.updateQueue=null;a.dependencies=null;a.alternate=null;a.firstEffect=null;a.lastEffect=null;a.pendingProps=null;a.memoizedProps=null;a.stateNode=null;null!==b&&Eh(b)}function Fh(a){return 5===a.tag||3===a.tag||4===a.tag}function Gh(a){a:{for(var b=a.return;null!==
b;){if(Fh(b)){var c=b;break a}b=b.return}throw Error(k(160));}b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw Error(k(161));}c.effectTag&16&&(Wb(b,""),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||Fh(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.effectTag&2)continue b;if(null===c.child||4===c.tag)continue b;
else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}d?Oe(a,c,b):Pe(a,c,b)}function Oe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=uc));else if(4!==d&&(a=a.child,null!==a))for(Oe(a,b,c),a=a.sibling;null!==a;)Oe(a,b,c),a=a.sibling}
function Pe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Pe(a,b,c),a=a.sibling;null!==a;)Pe(a,b,c),a=a.sibling}function Dh(a,b,c){for(var d=b,e=!1,f,g;;){if(!e){e=d.return;a:for(;;){if(null===e)throw Error(k(160));f=e.stateNode;switch(e.tag){case 5:g=!1;break a;case 3:f=f.containerInfo;g=!0;break a;case 4:f=f.containerInfo;g=!0;break a}e=e.return}e=!0}if(5===d.tag||6===d.tag){a:for(var h=
a,m=d,n=c,l=m;;)if(Ch(h,l,n),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===m)break a;for(;null===l.sibling;){if(null===l.return||l.return===m)break a;l=l.return}l.sibling.return=l.return;l=l.sibling}g?(h=f,m=d.stateNode,8===h.nodeType?h.parentNode.removeChild(m):h.removeChild(m)):f.removeChild(d.stateNode)}else if(4===d.tag){if(null!==d.child){f=d.stateNode.containerInfo;g=!0;d.child.return=d;d=d.child;continue}}else if(Ch(a,d,c),null!==d.child){d.child.return=d;d=d.child;continue}if(d===
b)break;for(;null===d.sibling;){if(null===d.return||d.return===b)return;d=d.return;4===d.tag&&(e=!1)}d.sibling.return=d.return;d=d.sibling}}function Qe(a,b){switch(b.tag){case 0:case 11:case 14:case 15:case 22:Ah(3,b);return;case 1:return;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[vc]=d;"input"===a&&"radio"===d.type&&null!=d.name&&If(c,d);Vd(a,e);b=Vd(a,d);for(e=0;e<f.length;e+=2){var g=f[e],
h=f[e+1];"style"===g?gg(c,h):"dangerouslySetInnerHTML"===g?xh(c,h):"children"===g?Wb(c,h):xd(c,g,h,b)}switch(a){case "input":Dd(c,d);break;case "textarea":Lf(c,d);break;case "select":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?hb(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?hb(c,!!d.multiple,d.defaultValue,!0):hb(c,!!d.multiple,d.multiple?[]:"",!1))}}}return;case 6:if(null===b.stateNode)throw Error(k(162));b.stateNode.nodeValue=b.memoizedProps;
return;case 3:b=b.stateNode;b.hydrate&&(b.hydrate=!1,bg(b.containerInfo));return;case 12:return;case 13:c=b;null===b.memoizedState?d=!1:(d=!0,c=b.child,Re=Y());if(null!==c)a:for(a=c;;){if(5===a.tag)f=a.stateNode,d?(f=f.style,"function"===typeof f.setProperty?f.setProperty("display","none","important"):f.display="none"):(f=a.stateNode,e=a.memoizedProps.style,e=void 0!==e&&null!==e&&e.hasOwnProperty("display")?e.display:null,f.style.display=fg("display",e));else if(6===a.tag)a.stateNode.nodeValue=d?
"":a.memoizedProps;else if(13===a.tag&&null!==a.memoizedState&&null===a.memoizedState.dehydrated){f=a.child.sibling;f.return=a;a=f;continue}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===c)break;for(;null===a.sibling;){if(null===a.return||a.return===c)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}Hh(b);return;case 19:Hh(b);return;case 17:return}throw Error(k(163));}function Hh(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=
new pj);b.forEach(function(b){var d=qj.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}function Ih(a,b,c){c=Ea(c,null);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){cd||(cd=!0,Se=d);Me(a,b)};return c}function Jh(a,b,c){c=Ea(c,null);c.tag=3;var d=a.type.getDerivedStateFromError;if("function"===typeof d){var e=b.value;c.payload=function(){Me(a,b);return d(e)}}var f=a.stateNode;null!==f&&"function"===typeof f.componentDidCatch&&(c.callback=function(){"function"!==typeof d&&
(null===La?La=new Set([this]):La.add(this),Me(a,b));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:""})});return c}function ka(){return(p&(ca|ma))!==H?1073741821-(Y()/10|0):0!==dd?dd:dd=1073741821-(Y()/10|0)}function Va(a,b,c){b=b.mode;if(0===(b&2))return 1073741823;var d=Cc();if(0===(b&4))return 99===d?1073741823:1073741822;if((p&ca)!==H)return P;if(null!==c)a=Fc(a,c.timeoutMs|0||5E3,250);else switch(d){case 99:a=1073741823;break;case 98:a=Fc(a,150,100);break;case 97:case 96:a=
Fc(a,5E3,250);break;case 95:a=2;break;default:throw Error(k(326));}null!==U&&a===P&&--a;return a}function ed(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===d.tag){e=d.stateNode;break}d=d.return}null!==e&&
(U===e&&(Kc(b),F===bd&&Ya(e,P)),yh(e,b));return e}function fd(a){var b=a.lastExpiredTime;if(0!==b)return b;b=a.firstPendingTime;if(!Kh(a,b))return b;var c=a.lastPingedTime;a=a.nextKnownPendingLevel;a=c>a?c:a;return 2>=a&&b!==a?0:a}function V(a){if(0!==a.lastExpiredTime)a.callbackExpirationTime=1073741823,a.callbackPriority=99,a.callbackNode=Og(Te.bind(null,a));else{var b=fd(a),c=a.callbackNode;if(0===b)null!==c&&(a.callbackNode=null,a.callbackExpirationTime=0,a.callbackPriority=90);else{var d=ka();
1073741823===b?d=99:1===b||2===b?d=95:(d=10*(1073741821-b)-10*(1073741821-d),d=0>=d?99:250>=d?98:5250>=d?97:95);if(null!==c){var e=a.callbackPriority;if(a.callbackExpirationTime===b&&e>=d)return;c!==Qg&&Rg(c)}a.callbackExpirationTime=b;a.callbackPriority=d;b=1073741823===b?Og(Te.bind(null,a)):Ng(d,Lh.bind(null,a),{timeout:10*(1073741821-b)-Y()});a.callbackNode=b}}}function Lh(a,b){dd=0;if(b)return b=ka(),Ue(a,b),V(a),null;var c=fd(a);if(0!==c){b=a.callbackNode;if((p&(ca|ma))!==H)throw Error(k(327));
xb();a===U&&c===P||$a(a,c);if(null!==t){var d=p;p|=ca;var e=Mh();do try{rj();break}catch(h){Nh(a,h)}while(1);le();p=d;gd.current=e;if(F===hd)throw b=id,$a(a,c),Ya(a,c),V(a),b;if(null===t)switch(e=a.finishedWork=a.current.alternate,a.finishedExpirationTime=c,d=F,U=null,d){case Xa:case hd:throw Error(k(345));case Oh:Ue(a,2<c?2:c);break;case ad:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(1073741823===ta&&(e=Re+Ph-Y(),10<e)){if(jd){var f=a.lastPingedTime;if(0===f||f>=c){a.lastPingedTime=
c;$a(a,c);break}}f=fd(a);if(0!==f&&f!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}a.timeoutHandle=We(ab.bind(null,a),e);break}ab(a);break;case bd:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(jd&&(e=a.lastPingedTime,0===e||e>=c)){a.lastPingedTime=c;$a(a,c);break}e=fd(a);if(0!==e&&e!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}1073741823!==Yb?d=10*(1073741821-Yb)-Y():1073741823===ta?d=0:(d=10*(1073741821-ta)-5E3,e=Y(),c=10*(1073741821-c)-e,d=e-d,0>d&&(d=0),d=
(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*sj(d/1960))-d,c<d&&(d=c));if(10<d){a.timeoutHandle=We(ab.bind(null,a),d);break}ab(a);break;case Xe:if(1073741823!==ta&&null!==kd){f=ta;var g=kd;d=g.busyMinDurationMs|0;0>=d?d=0:(e=g.busyDelayMs|0,f=Y()-(10*(1073741821-f)-(g.timeoutMs|0||5E3)),d=f<=e?0:e+d-f);if(10<d){Ya(a,c);a.timeoutHandle=We(ab.bind(null,a),d);break}}ab(a);break;default:throw Error(k(329));}V(a);if(a.callbackNode===b)return Lh.bind(null,a)}}return null}function Te(a){var b=
a.lastExpiredTime;b=0!==b?b:1073741823;if((p&(ca|ma))!==H)throw Error(k(327));xb();a===U&&b===P||$a(a,b);if(null!==t){var c=p;p|=ca;var d=Mh();do try{tj();break}catch(e){Nh(a,e)}while(1);le();p=c;gd.current=d;if(F===hd)throw c=id,$a(a,b),Ya(a,b),V(a),c;if(null!==t)throw Error(k(261));a.finishedWork=a.current.alternate;a.finishedExpirationTime=b;U=null;ab(a);V(a)}return null}function uj(){if(null!==bb){var a=bb;bb=null;a.forEach(function(a,c){Ue(c,a);V(c)});ha()}}function Qh(a,b){var c=p;p|=1;try{return a(b)}finally{p=
c,p===H&&ha()}}function Rh(a,b){var c=p;p&=-2;p|=Ye;try{return a(b)}finally{p=c,p===H&&ha()}}function $a(a,b){a.finishedWork=null;a.finishedExpirationTime=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,vj(c));if(null!==t)for(c=t.return;null!==c;){var d=c;switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&(q(G),q(B));break;case 3:tb();q(G);q(B);break;case 5:te(d);break;case 4:tb();break;case 13:q(D);break;case 19:q(D);break;case 10:me(d)}c=c.return}U=a;t=Sa(a.current,null);
P=b;F=Xa;id=null;Yb=ta=1073741823;kd=null;Xb=0;jd=!1}function Nh(a,b){do{try{le();Sc.current=Tc;if(Uc)for(var c=z.memoizedState;null!==c;){var d=c.queue;null!==d&&(d.pending=null);c=c.next}Ia=0;J=K=z=null;Uc=!1;if(null===t||null===t.return)return F=hd,id=b,t=null;a:{var e=a,f=t.return,g=t,h=b;b=P;g.effectTag|=2048;g.firstEffect=g.lastEffect=null;if(null!==h&&"object"===typeof h&&"function"===typeof h.then){var m=h;if(0===(g.mode&2)){var n=g.alternate;n?(g.updateQueue=n.updateQueue,g.memoizedState=
n.memoizedState,g.expirationTime=n.expirationTime):(g.updateQueue=null,g.memoizedState=null)}var l=0!==(D.current&1),k=f;do{var p;if(p=13===k.tag){var q=k.memoizedState;if(null!==q)p=null!==q.dehydrated?!0:!1;else{var w=k.memoizedProps;p=void 0===w.fallback?!1:!0!==w.unstable_avoidThisFallback?!0:l?!1:!0}}if(p){var y=k.updateQueue;if(null===y){var r=new Set;r.add(m);k.updateQueue=r}else y.add(m);if(0===(k.mode&2)){k.effectTag|=64;g.effectTag&=-2981;if(1===g.tag)if(null===g.alternate)g.tag=17;else{var O=
Ea(1073741823,null);O.tag=Jc;Fa(g,O)}g.expirationTime=1073741823;break a}h=void 0;g=b;var v=e.pingCache;null===v?(v=e.pingCache=new wj,h=new Set,v.set(m,h)):(h=v.get(m),void 0===h&&(h=new Set,v.set(m,h)));if(!h.has(g)){h.add(g);var x=xj.bind(null,e,m,g);m.then(x,x)}k.effectTag|=4096;k.expirationTime=b;break a}k=k.return}while(null!==k);h=Error((na(g.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+
Bd(g))}F!==Xe&&(F=Oh);h=Le(h,g);k=f;do{switch(k.tag){case 3:m=h;k.effectTag|=4096;k.expirationTime=b;var A=Ih(k,m,b);Ug(k,A);break a;case 1:m=h;var u=k.type,B=k.stateNode;if(0===(k.effectTag&64)&&("function"===typeof u.getDerivedStateFromError||null!==B&&"function"===typeof B.componentDidCatch&&(null===La||!La.has(B)))){k.effectTag|=4096;k.expirationTime=b;var H=Jh(k,m,b);Ug(k,H);break a}}k=k.return}while(null!==k)}t=Sh(t)}catch(cj){b=cj;continue}break}while(1)}function Mh(a){a=gd.current;gd.current=
Tc;return null===a?Tc:a}function Vg(a,b){a<ta&&2<a&&(ta=a);null!==b&&a<Yb&&2<a&&(Yb=a,kd=b)}function Kc(a){a>Xb&&(Xb=a)}function tj(){for(;null!==t;)t=Th(t)}function rj(){for(;null!==t&&!yj();)t=Th(t)}function Th(a){var b=zj(a.alternate,a,P);a.memoizedProps=a.pendingProps;null===b&&(b=Sh(a));Uh.current=null;return b}function Sh(a){t=a;do{var b=t.alternate;a=t.return;if(0===(t.effectTag&2048)){b=hj(b,t,P);if(1===P||1!==t.childExpirationTime){for(var c=0,d=t.child;null!==d;){var e=d.expirationTime,
f=d.childExpirationTime;e>c&&(c=e);f>c&&(c=f);d=d.sibling}t.childExpirationTime=c}if(null!==b)return b;null!==a&&0===(a.effectTag&2048)&&(null===a.firstEffect&&(a.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==a.lastEffect&&(a.lastEffect.nextEffect=t.firstEffect),a.lastEffect=t.lastEffect),1<t.effectTag&&(null!==a.lastEffect?a.lastEffect.nextEffect=t:a.firstEffect=t,a.lastEffect=t))}else{b=lj(t);if(null!==b)return b.effectTag&=2047,b;null!==a&&(a.firstEffect=a.lastEffect=null,a.effectTag|=
2048)}b=t.sibling;if(null!==b)return b;t=a}while(null!==t);F===Xa&&(F=Xe);return null}function Ve(a){var b=a.expirationTime;a=a.childExpirationTime;return b>a?b:a}function ab(a){var b=Cc();Da(99,Aj.bind(null,a,b));return null}function Aj(a,b){do xb();while(null!==Zb);if((p&(ca|ma))!==H)throw Error(k(327));var c=a.finishedWork,d=a.finishedExpirationTime;if(null===c)return null;a.finishedWork=null;a.finishedExpirationTime=0;if(c===a.current)throw Error(k(177));a.callbackNode=null;a.callbackExpirationTime=
0;a.callbackPriority=90;a.nextKnownPendingLevel=0;var e=Ve(c);a.firstPendingTime=e;d<=a.lastSuspendedTime?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:d<=a.firstSuspendedTime&&(a.firstSuspendedTime=d-1);d<=a.lastPingedTime&&(a.lastPingedTime=0);d<=a.lastExpiredTime&&(a.lastExpiredTime=0);a===U&&(t=U=null,P=0);1<c.effectTag?null!==c.lastEffect?(c.lastEffect.nextEffect=c,e=c.firstEffect):e=c:e=c.firstEffect;if(null!==e){var f=p;p|=ma;Uh.current=null;Ze=tc;var g=kg();if(Xd(g)){if("selectionStart"in
g)var h={start:g.selectionStart,end:g.selectionEnd};else a:{h=(h=g.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&0!==m.rangeCount){h=m.anchorNode;var n=m.anchorOffset,q=m.focusNode;m=m.focusOffset;try{h.nodeType,q.nodeType}catch(sb){h=null;break a}var ba=0,w=-1,y=-1,B=0,D=0,r=g,z=null;b:for(;;){for(var v;;){r!==h||0!==n&&3!==r.nodeType||(w=ba+n);r!==q||0!==m&&3!==r.nodeType||(y=ba+m);3===r.nodeType&&(ba+=r.nodeValue.length);if(null===(v=r.firstChild))break;z=r;
r=v}for(;;){if(r===g)break b;z===h&&++B===n&&(w=ba);z===q&&++D===m&&(y=ba);if(null!==(v=r.nextSibling))break;r=z;z=r.parentNode}r=v}h=-1===w||-1===y?null:{start:w,end:y}}else h=null}h=h||{start:0,end:0}}else h=null;$e={activeElementDetached:null,focusedElem:g,selectionRange:h};tc=!1;l=e;do try{Bj()}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=e;do try{for(g=a,h=b;null!==l;){var x=l.effectTag;x&16&&Wb(l.stateNode,"");if(x&128){var A=l.alternate;if(null!==A){var u=
A.ref;null!==u&&("function"===typeof u?u(null):u.current=null)}}switch(x&1038){case 2:Gh(l);l.effectTag&=-3;break;case 6:Gh(l);l.effectTag&=-3;Qe(l.alternate,l);break;case 1024:l.effectTag&=-1025;break;case 1028:l.effectTag&=-1025;Qe(l.alternate,l);break;case 4:Qe(l.alternate,l);break;case 8:n=l,Dh(g,n,h),Eh(n)}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);u=$e;A=kg();x=u.focusedElem;h=u.selectionRange;if(A!==x&&x&&x.ownerDocument&&jg(x.ownerDocument.documentElement,
x)){null!==h&&Xd(x)&&(A=h.start,u=h.end,void 0===u&&(u=A),"selectionStart"in x?(x.selectionStart=A,x.selectionEnd=Math.min(u,x.value.length)):(u=(A=x.ownerDocument||document)&&A.defaultView||window,u.getSelection&&(u=u.getSelection(),n=x.textContent.length,g=Math.min(h.start,n),h=void 0===h.end?g:Math.min(h.end,n),!u.extend&&g>h&&(n=h,h=g,g=n),n=ig(x,g),q=ig(x,h),n&&q&&(1!==u.rangeCount||u.anchorNode!==n.node||u.anchorOffset!==n.offset||u.focusNode!==q.node||u.focusOffset!==q.offset)&&(A=A.createRange(),
A.setStart(n.node,n.offset),u.removeAllRanges(),g>h?(u.addRange(A),u.extend(q.node,q.offset)):(A.setEnd(q.node,q.offset),u.addRange(A))))));A=[];for(u=x;u=u.parentNode;)1===u.nodeType&&A.push({element:u,left:u.scrollLeft,top:u.scrollTop});"function"===typeof x.focus&&x.focus();for(x=0;x<A.length;x++)u=A[x],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}tc=!!Ze;$e=Ze=null;a.current=c;l=e;do try{for(x=a;null!==l;){var F=l.effectTag;F&36&&oj(x,l.alternate,l);if(F&128){A=void 0;var E=l.ref;if(null!==
E){var G=l.stateNode;switch(l.tag){case 5:A=G;break;default:A=G}"function"===typeof E?E(A):E.current=A}}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=null;Cj();p=f}else a.current=c;if(ld)ld=!1,Zb=a,$b=b;else for(l=e;null!==l;)b=l.nextEffect,l.nextEffect=null,l=b;b=a.firstPendingTime;0===b&&(La=null);1073741823===b?a===af?ac++:(ac=0,af=a):ac=0;"function"===typeof bf&&bf(c.stateNode,d);V(a);if(cd)throw cd=!1,a=Se,Se=null,a;if((p&Ye)!==H)return null;
ha();return null}function Bj(){for(;null!==l;){var a=l.effectTag;0!==(a&256)&&nj(l.alternate,l);0===(a&512)||ld||(ld=!0,Ng(97,function(){xb();return null}));l=l.nextEffect}}function xb(){if(90!==$b){var a=97<$b?97:$b;$b=90;return Da(a,Dj)}}function Dj(){if(null===Zb)return!1;var a=Zb;Zb=null;if((p&(ca|ma))!==H)throw Error(k(331));var b=p;p|=ma;for(a=a.current.firstEffect;null!==a;){try{var c=a;if(0!==(c.effectTag&512))switch(c.tag){case 0:case 11:case 15:case 22:Ah(5,c),Bh(5,c)}}catch(d){if(null===
a)throw Error(k(330));Za(a,d)}c=a.nextEffect;a.nextEffect=null;a=c}p=b;ha();return!0}function Vh(a,b,c){b=Le(c,b);b=Ih(a,b,1073741823);Fa(a,b);a=ed(a,1073741823);null!==a&&V(a)}function Za(a,b){if(3===a.tag)Vh(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){Vh(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if("function"===typeof c.type.getDerivedStateFromError||"function"===typeof d.componentDidCatch&&(null===La||!La.has(d))){a=Le(b,a);a=Jh(c,a,1073741823);Fa(c,a);c=ed(c,1073741823);null!==
c&&V(c);break}}c=c.return}}function xj(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);U===a&&P===c?F===bd||F===ad&&1073741823===ta&&Y()-Re<Ph?$a(a,P):jd=!0:Kh(a,c)&&(b=a.lastPingedTime,0!==b&&b<c||(a.lastPingedTime=c,V(a)))}function qj(a,b){var c=a.stateNode;null!==c&&c.delete(b);b=0;0===b&&(b=ka(),b=Va(b,a,null));a=ed(a,b);null!==a&&V(a)}function Ej(a){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=
b.inject(a);bf=function(a,e){try{b.onCommitFiberRoot(c,a,void 0,64===(a.current.effectTag&64))}catch(f){}};Ne=function(a){try{b.onCommitFiberUnmount(c,a)}catch(e){}}}catch(d){}return!0}function Fj(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=
null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function Ge(a){a=a.prototype;return!(!a||!a.isReactComponent)}function Gj(a){if("function"===typeof a)return Ge(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===zd)return 11;if(a===Ad)return 14}return 2}function Sa(a,b){var c=a.alternate;null===c?(c=la(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=
null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{expirationTime:b.expirationTime,firstContext:b.firstContext,responders:b.responders};c.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}function Oc(a,b,c,d,e,f){var g=2;d=a;if("function"===typeof a)Ge(a)&&(g=1);else if("string"===typeof a)g=
5;else a:switch(a){case Ma:return Ha(c.children,e,f,b);case Hj:g=8;e|=7;break;case Af:g=8;e|=1;break;case kc:return a=la(12,c,b,e|8),a.elementType=kc,a.type=kc,a.expirationTime=f,a;case lc:return a=la(13,c,b,e),a.type=lc,a.elementType=lc,a.expirationTime=f,a;case yd:return a=la(19,c,b,e),a.elementType=yd,a.expirationTime=f,a;default:if("object"===typeof a&&null!==a)switch(a.$$typeof){case Cf:g=10;break a;case Bf:g=9;break a;case zd:g=11;break a;case Ad:g=14;break a;case Ef:g=16;d=null;break a;case Df:g=
22;break a}throw Error(k(130,null==a?a:typeof a,""));}b=la(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function Ha(a,b,c,d){a=la(7,a,d,b);a.expirationTime=c;return a}function qe(a,b,c){a=la(6,a,null,b);a.expirationTime=c;return a}function re(a,b,c){b=la(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}function Ij(a,b,c){this.tag=b;this.current=null;this.containerInfo=
a;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=null;this.callbackPriority=90;this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Kh(a,b){var c=a.firstSuspendedTime;a=a.lastSuspendedTime;return 0!==c&&c>=b&&a<=b}function Ya(a,b){var c=a.firstSuspendedTime,d=a.lastSuspendedTime;
c<b&&(a.firstSuspendedTime=b);if(d>b||0===c)a.lastSuspendedTime=b;b<=a.lastPingedTime&&(a.lastPingedTime=0);b<=a.lastExpiredTime&&(a.lastExpiredTime=0)}function yh(a,b){b>a.firstPendingTime&&(a.firstPendingTime=b);var c=a.firstSuspendedTime;0!==c&&(b>=c?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:b>=a.lastSuspendedTime&&(a.lastSuspendedTime=b+1),b>a.nextKnownPendingLevel&&(a.nextKnownPendingLevel=b))}function Ue(a,b){var c=a.lastExpiredTime;if(0===c||c>b)a.lastExpiredTime=b}
function md(a,b,c,d){var e=b.current,f=ka(),g=Vb.suspense;f=Va(f,e,g);a:if(c){c=c._reactInternalFiber;b:{if(Na(c)!==c||1!==c.tag)throw Error(k(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(N(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw Error(k(171));}if(1===c.tag){var m=c.type;if(N(m)){c=Gg(c,m,h);break a}}c=h}else c=Ca;null===b.context?b.context=c:b.pendingContext=c;b=Ea(f,g);b.payload={element:a};d=void 0===
d?null:d;null!==d&&(b.callback=d);Fa(e,b);Ja(e,f);return f}function cf(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Wh(a,b){a=a.memoizedState;null!==a&&null!==a.dehydrated&&a.retryTime<b&&(a.retryTime=b)}function df(a,b){Wh(a,b);(a=a.alternate)&&Wh(a,b)}function ef(a,b,c){c=null!=c&&!0===c.hydrate;var d=new Ij(a,b,c),e=la(3,null,null,2===b?7:1===b?3:0);d.current=e;e.stateNode=d;ne(e);a[Lb]=d.current;c&&0!==b&&
xi(a,9===a.nodeType?a:a.ownerDocument);this._internalRoot=d}function bc(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||" react-mount-point-unstable "!==a.nodeValue))}function Jj(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute("data-reactroot")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new ef(a,0,b?{hydrate:!0}:void 0)}function nd(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f._internalRoot;
if("function"===typeof e){var h=e;e=function(){var a=cf(g);h.call(a)}}md(b,g,a,e)}else{f=c._reactRootContainer=Jj(c,d);g=f._internalRoot;if("function"===typeof e){var m=e;e=function(){var a=cf(g);m.call(a)}}Rh(function(){md(b,g,a,e)})}return cf(g)}function Kj(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:gb,key:null==d?null:""+d,children:a,containerInfo:b,implementation:c}}function Xh(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;
if(!bc(b))throw Error(k(200));return Kj(a,b,null,c)}if(!ea)throw Error(k(227));var ki=function(a,b,c,d,e,f,g,h,m){var n=Array.prototype.slice.call(arguments,3);try{b.apply(c,n)}catch(C){this.onError(C)}},yb=!1,gc=null,hc=!1,pd=null,li={onError:function(a){yb=!0;gc=a}},td=null,rf=null,mf=null,ic=null,cb={},jc=[],qd={},db={},rd={},wa=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),M=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.assign,
sd=null,eb=null,fb=null,ee=function(a,b){return a(b)},eg=function(a,b,c,d,e){return a(b,c,d,e)},vd=function(){},vf=ee,Oa=!1,wd=!1,Z=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Scheduler,Lj=Z.unstable_cancelCallback,ff=Z.unstable_now,$f=Z.unstable_scheduleCallback,Mj=Z.unstable_shouldYield,Yh=Z.unstable_requestPaint,Pd=Z.unstable_runWithPriority,Nj=Z.unstable_getCurrentPriorityLevel,Oj=Z.unstable_ImmediatePriority,Zh=Z.unstable_UserBlockingPriority,ag=Z.unstable_NormalPriority,Pj=Z.unstable_LowPriority,
Qj=Z.unstable_IdlePriority,oi=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wf=Object.prototype.hasOwnProperty,yf={},xf={},E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=
new L(a,0,!1,a,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var b=a[0];E[b]=new L(b,1,!1,a[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new L(a,2,!1,a.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new L(a,2,!1,a,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=
new L(a,3,!1,a.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(a){E[a]=new L(a,3,!0,a,null,!1)});["capture","download"].forEach(function(a){E[a]=new L(a,4,!1,a,null,!1)});["cols","rows","size","span"].forEach(function(a){E[a]=new L(a,6,!1,a,null,!1)});["rowSpan","start"].forEach(function(a){E[a]=new L(a,5,!1,a.toLowerCase(),null,!1)});var gf=/[\-:]([a-z])/g,hf=function(a){return a[1].toUpperCase()};"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var b=
a.replace(gf,hf);E[b]=new L(b,1,!1,a,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!1)});E.xlinkHref=new L("xlinkHref",1,
!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!0)});var da=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;da.hasOwnProperty("ReactCurrentDispatcher")||(da.ReactCurrentDispatcher={current:null});da.hasOwnProperty("ReactCurrentBatchConfig")||(da.ReactCurrentBatchConfig={suspense:null});var si=/^(.*)[\\\/]/,Q="function"===typeof Symbol&&Symbol.for,Pc=Q?Symbol.for("react.element"):60103,gb=Q?Symbol.for("react.portal"):
60106,Ma=Q?Symbol.for("react.fragment"):60107,Af=Q?Symbol.for("react.strict_mode"):60108,kc=Q?Symbol.for("react.profiler"):60114,Cf=Q?Symbol.for("react.provider"):60109,Bf=Q?Symbol.for("react.context"):60110,Hj=Q?Symbol.for("react.concurrent_mode"):60111,zd=Q?Symbol.for("react.forward_ref"):60112,lc=Q?Symbol.for("react.suspense"):60113,yd=Q?Symbol.for("react.suspense_list"):60120,Ad=Q?Symbol.for("react.memo"):60115,Ef=Q?Symbol.for("react.lazy"):60116,Df=Q?Symbol.for("react.block"):60121,zf="function"===
typeof Symbol&&Symbol.iterator,od,xh=function(a){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if("http://www.w3.org/2000/svg"!==a.namespaceURI||"innerHTML"in a)a.innerHTML=b;else{od=od||document.createElement("div");od.innerHTML="<svg>"+b.valueOf().toString()+"</svg>";for(b=od.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}}),Wb=function(a,
b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b},ib={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Id={},Of={};wa&&(Of=document.createElement("div").style,"AnimationEvent"in window||(delete ib.animationend.animation,delete ib.animationiteration.animation,delete ib.animationstart.animation),"TransitionEvent"in
window||delete ib.transitionend.transition);var $h=oc("animationend"),ai=oc("animationiteration"),bi=oc("animationstart"),ci=oc("transitionend"),Db="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pf=new ("function"===typeof WeakMap?WeakMap:Map),Ab=null,wi=function(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;
if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)lf(a,b[d],c[d]);else b&&lf(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}},qc=[],Rd=!1,fa=[],xa=null,ya=null,za=null,Eb=new Map,Fb=new Map,Jb=[],Nd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),
yi="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" "),dg={},cg=new Map,Td=new Map,Rj=["abort","abort",$h,"animationEnd",ai,"animationIteration",bi,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata",
"loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",ci,"transitionEnd","waiting","waiting"];Sd("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),
0);Sd("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Sd(Rj,2);(function(a,b){for(var c=0;c<a.length;c++)Td.set(a[c],b)})("change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),0);var Hi=Zh,Gi=Pd,tc=!0,Kb={animationIterationCount:!0,
borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,
strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sj=["Webkit","ms","Moz","O"];Object.keys(Kb).forEach(function(a){Sj.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);Kb[b]=Kb[a]})});var Ii=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),ng="$",og="/$",$d="$?",Zd="$!",Ze=null,$e=null,We="function"===typeof setTimeout?setTimeout:void 0,vj="function"===
typeof clearTimeout?clearTimeout:void 0,jf=Math.random().toString(36).slice(2),Aa="__reactInternalInstance$"+jf,vc="__reactEventHandlers$"+jf,Lb="__reactContainere$"+jf,Ba=null,ce=null,wc=null;M(R.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():"unknown"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=xc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():"unknown"!==
typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=xc)},persist:function(){this.isPersistent=xc},isPersistent:yc,destructor:function(){var a=this.constructor.Interface,b;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=yc;this._dispatchInstances=this._dispatchListeners=null}});R.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||
Date.now()},defaultPrevented:null,isTrusted:null};R.extend=function(a){function b(){return c.apply(this,arguments)}var c=this,d=function(){};d.prototype=c.prototype;d=new d;M(d,b.prototype);b.prototype=d;b.prototype.constructor=b;b.Interface=M({},c.Interface,a);b.extend=c.extend;sg(b);return b};sg(R);var Tj=R.extend({data:null}),Uj=R.extend({data:null}),Ni=[9,13,27,32],de=wa&&"CompositionEvent"in window,cc=null;wa&&"documentMode"in document&&(cc=document.documentMode);var Vj=wa&&"TextEvent"in window&&
!cc,xg=wa&&(!de||cc&&8<cc&&11>=cc),wg=String.fromCharCode(32),ua={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},
dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},vg=!1,mb=!1,Wj={eventTypes:ua,extractEvents:function(a,b,c,d,e){var f;if(de)b:{switch(a){case "compositionstart":var g=ua.compositionStart;break b;case "compositionend":g=ua.compositionEnd;break b;case "compositionupdate":g=
ua.compositionUpdate;break b}g=void 0}else mb?tg(a,c)&&(g=ua.compositionEnd):"keydown"===a&&229===c.keyCode&&(g=ua.compositionStart);g?(xg&&"ko"!==c.locale&&(mb||g!==ua.compositionStart?g===ua.compositionEnd&&mb&&(f=rg()):(Ba=d,ce="value"in Ba?Ba.value:Ba.textContent,mb=!0)),e=Tj.getPooled(g,b,c,d),f?e.data=f:(f=ug(c),null!==f&&(e.data=f)),lb(e),f=e):f=null;(a=Vj?Oi(a,c):Pi(a,c))?(b=Uj.getPooled(ua.beforeInput,b,c,d),b.data=a,lb(b)):b=null;return null===f?b:null===b?f:[f,b]}},Qi={color:!0,date:!0,
datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Ag={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}},Mb=null,Nb=null,kf=!1;wa&&(kf=Tf("input")&&(!document.documentMode||9<document.documentMode));var Xj={eventTypes:Ag,_isInputEventSupported:kf,extractEvents:function(a,b,c,d,e){e=b?Pa(b):window;var f=
e.nodeName&&e.nodeName.toLowerCase();if("select"===f||"input"===f&&"file"===e.type)var g=Si;else if(yg(e))if(kf)g=Wi;else{g=Ui;var h=Ti}else(f=e.nodeName)&&"input"===f.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)&&(g=Vi);if(g&&(g=g(a,b)))return zg(g,c,d);h&&h(a,e,b);"blur"===a&&(a=e._wrapperState)&&a.controlled&&"number"===e.type&&Ed(e,"number",e.value)}},dc=R.extend({view:null,detail:null}),Yi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},di=0,ei=0,fi=!1,gi=!1,ec=dc.extend({screenX:null,
screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:fe,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if("movementX"in a)return a.movementX;var b=di;di=a.screenX;return fi?"mousemove"===a.type?a.screenX-b:0:(fi=!0,0)},movementY:function(a){if("movementY"in a)return a.movementY;var b=ei;ei=a.screenY;return gi?"mousemove"===
a.type?a.screenY-b:0:(gi=!0,0)}}),hi=ec.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),fc={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout",
"pointerover"]}},Yj={eventTypes:fc,extractEvents:function(a,b,c,d,e){var f="mouseover"===a||"pointerover"===a,g="mouseout"===a||"pointerout"===a;if(f&&0===(e&32)&&(c.relatedTarget||c.fromElement)||!g&&!f)return null;f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window;if(g){if(g=b,b=(b=c.relatedTarget||c.toElement)?Bb(b):null,null!==b){var h=Na(b);if(b!==h||5!==b.tag&&6!==b.tag)b=null}}else g=null;if(g===b)return null;if("mouseout"===a||"mouseover"===a){var m=ec;var n=fc.mouseLeave;
var l=fc.mouseEnter;var k="mouse"}else if("pointerout"===a||"pointerover"===a)m=hi,n=fc.pointerLeave,l=fc.pointerEnter,k="pointer";a=null==g?f:Pa(g);f=null==b?f:Pa(b);n=m.getPooled(n,g,c,d);n.type=k+"leave";n.target=a;n.relatedTarget=f;c=m.getPooled(l,b,c,d);c.type=k+"enter";c.target=f;c.relatedTarget=a;d=g;k=b;if(d&&k)a:{m=d;l=k;g=0;for(a=m;a;a=pa(a))g++;a=0;for(b=l;b;b=pa(b))a++;for(;0<g-a;)m=pa(m),g--;for(;0<a-g;)l=pa(l),a--;for(;g--;){if(m===l||m===l.alternate)break a;m=pa(m);l=pa(l)}m=null}else m=
null;l=m;for(m=[];d&&d!==l;){g=d.alternate;if(null!==g&&g===l)break;m.push(d);d=pa(d)}for(d=[];k&&k!==l;){g=k.alternate;if(null!==g&&g===l)break;d.push(k);k=pa(k)}for(k=0;k<m.length;k++)be(m[k],"bubbled",n);for(k=d.length;0<k--;)be(d[k],"captured",c);return 0===(e&64)?[n]:[n,c]}},Qa="function"===typeof Object.is?Object.is:Zi,$i=Object.prototype.hasOwnProperty,Zj=wa&&"documentMode"in document&&11>=document.documentMode,Eg={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},
dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},nb=null,he=null,Pb=null,ge=!1,ak={eventTypes:Eg,extractEvents:function(a,b,c,d,e,f){e=f||(d.window===d?d.document:9===d.nodeType?d:d.ownerDocument);if(!(f=!e)){a:{e=Jd(e);f=rd.onSelect;for(var g=0;g<f.length;g++)if(!e.has(f[g])){e=!1;break a}e=!0}f=!e}if(f)return null;e=b?Pa(b):window;switch(a){case "focus":if(yg(e)||"true"===e.contentEditable)nb=e,he=b,Pb=null;break;case "blur":Pb=he=nb=null;
break;case "mousedown":ge=!0;break;case "contextmenu":case "mouseup":case "dragend":return ge=!1,Dg(c,d);case "selectionchange":if(Zj)break;case "keydown":case "keyup":return Dg(c,d)}return null}},bk=R.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ck=R.extend({clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),dk=dc.extend({relatedTarget:null}),ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",
Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",
224:"Meta"},gk=dc.extend({key:function(a){if(a.key){var b=ek[a.key]||a.key;if("Unidentified"!==b)return b}return"keypress"===a.type?(a=Ac(a),13===a?"Enter":String.fromCharCode(a)):"keydown"===a.type||"keyup"===a.type?fk[a.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:fe,charCode:function(a){return"keypress"===a.type?Ac(a):0},keyCode:function(a){return"keydown"===a.type||"keyup"===a.type?a.keyCode:0},which:function(a){return"keypress"===
a.type?Ac(a):"keydown"===a.type||"keyup"===a.type?a.keyCode:0}}),hk=ec.extend({dataTransfer:null}),ik=dc.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:fe}),jk=R.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),kk=ec.extend({deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?
-a.wheelDelta:0},deltaZ:null,deltaMode:null}),lk={eventTypes:dg,extractEvents:function(a,b,c,d,e){e=cg.get(a);if(!e)return null;switch(a){case "keypress":if(0===Ac(c))return null;case "keydown":case "keyup":a=gk;break;case "blur":case "focus":a=dk;break;case "click":if(2===c.button)return null;case "auxclick":case "dblclick":case "mousedown":case "mousemove":case "mouseup":case "mouseout":case "mouseover":case "contextmenu":a=ec;break;case "drag":case "dragend":case "dragenter":case "dragexit":case "dragleave":case "dragover":case "dragstart":case "drop":a=
hk;break;case "touchcancel":case "touchend":case "touchmove":case "touchstart":a=ik;break;case $h:case ai:case bi:a=bk;break;case ci:a=jk;break;case "scroll":a=dc;break;case "wheel":a=kk;break;case "copy":case "cut":case "paste":a=ck;break;case "gotpointercapture":case "lostpointercapture":case "pointercancel":case "pointerdown":case "pointermove":case "pointerout":case "pointerover":case "pointerup":a=hi;break;default:a=R}b=a.getPooled(e,b,c,d);lb(b);return b}};(function(a){if(ic)throw Error(k(101));
ic=Array.prototype.slice.call(a);nf()})("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));(function(a,b,c){td=a;rf=b;mf=c})(ae,Hb,Pa);pf({SimpleEventPlugin:lk,EnterLeaveEventPlugin:Yj,ChangeEventPlugin:Xj,SelectEventPlugin:ak,BeforeInputEventPlugin:Wj});var ie=[],ob=-1,Ca={},B={current:Ca},G={current:!1},Ra=Ca,bj=Pd,je=$f,Rg=Lj,aj=Nj,Dc=Oj,Ig=Zh,Jg=ag,Kg=Pj,Lg=Qj,Qg={},yj=Mj,Cj=void 0!==Yh?Yh:function(){},qa=null,
Ec=null,ke=!1,ii=ff(),Y=1E4>ii?ff:function(){return ff()-ii},Ic={current:null},Hc=null,qb=null,Gc=null,Tg=0,Jc=2,Ga=!1,Vb=da.ReactCurrentBatchConfig,$g=(new ea.Component).refs,Mc={isMounted:function(a){return(a=a._reactInternalFiber)?Na(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;d=Va(d,a,e);e=Ea(d,e);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;
d=Va(d,a,e);e=Ea(d,e);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=ka(),d=Vb.suspense;c=Va(c,a,d);d=Ea(c,d);d.tag=Jc;void 0!==b&&null!==b&&(d.callback=b);Fa(a,d);Ja(a,c)}},Qc=Array.isArray,wb=ah(!0),Fe=ah(!1),Sb={},ja={current:Sb},Ub={current:Sb},Tb={current:Sb},D={current:0},Sc=da.ReactCurrentDispatcher,X=da.ReactCurrentBatchConfig,Ia=0,z=null,K=null,J=null,Uc=!1,Tc={readContext:W,useCallback:S,useContext:S,
useEffect:S,useImperativeHandle:S,useLayoutEffect:S,useMemo:S,useReducer:S,useRef:S,useState:S,useDebugValue:S,useResponder:S,useDeferredValue:S,useTransition:S},dj={readContext:W,useCallback:ih,useContext:W,useEffect:eh,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ze(4,2,gh.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ze(4,2,a,b)},useMemo:function(a,b){var c=ub();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=
ub();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={pending:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=ch.bind(null,z,a);return[d.memoizedState,a]},useRef:function(a){var b=ub();a={current:a};return b.memoizedState=a},useState:xe,useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=xe(a),d=c[0],e=c[1];eh(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=
xe(!1),c=b[0];b=b[1];return[ih(Ce.bind(null,b,a),[b,a]),c]}},ej={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Vc,useRef:dh,useState:function(a){return Vc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Vc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Vc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,
b,a),[b,a]),c]}},fj={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Wc,useRef:dh,useState:function(a){return Wc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Wc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Wc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,b,a),[b,a]),c]}},ra=null,Ka=null,Wa=
!1,gj=da.ReactCurrentOwner,ia=!1,Je={dehydrated:null,retryTime:0};var jj=function(a,b,c,d){for(c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};var wh=function(a){};var ij=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;Ta(ja.current);a=null;switch(c){case "input":f=
Cd(g,f);d=Cd(g,d);a=[];break;case "option":f=Fd(g,f);d=Fd(g,d);a=[];break;case "select":f=M({},f,{value:void 0});d=M({},d,{value:void 0});a=[];break;case "textarea":f=Gd(g,f);d=Gd(g,d);a=[];break;default:"function"!==typeof f.onClick&&"function"===typeof d.onClick&&(g.onclick=uc)}Ud(c,d);var h,m;c=null;for(h in f)if(!d.hasOwnProperty(h)&&f.hasOwnProperty(h)&&null!=f[h])if("style"===h)for(m in g=f[h],g)g.hasOwnProperty(m)&&(c||(c={}),c[m]="");else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==
h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(db.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in d){var k=d[h];g=null!=f?f[h]:void 0;if(d.hasOwnProperty(h)&&k!==g&&(null!=k||null!=g))if("style"===h)if(g){for(m in g)!g.hasOwnProperty(m)||k&&k.hasOwnProperty(m)||(c||(c={}),c[m]="");for(m in k)k.hasOwnProperty(m)&&g[m]!==k[m]&&(c||(c={}),c[m]=k[m])}else c||(a||(a=[]),a.push(h,c)),c=k;else"dangerouslySetInnerHTML"===h?(k=k?k.__html:void 0,g=g?g.__html:void 0,null!=k&&g!==k&&(a=a||
[]).push(h,k)):"children"===h?g===k||"string"!==typeof k&&"number"!==typeof k||(a=a||[]).push(h,""+k):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(db.hasOwnProperty(h)?(null!=k&&oa(e,h),a||g===k||(a=[])):(a=a||[]).push(h,k))}c&&(a=a||[]).push("style",c);e=a;if(b.updateQueue=e)b.effectTag|=4}};var kj=function(a,b,c,d){c!==d&&(b.effectTag|=4)};var pj="function"===typeof WeakSet?WeakSet:Set,wj="function"===typeof WeakMap?WeakMap:Map,sj=Math.ceil,gd=da.ReactCurrentDispatcher,
Uh=da.ReactCurrentOwner,H=0,Ye=8,ca=16,ma=32,Xa=0,hd=1,Oh=2,ad=3,bd=4,Xe=5,p=H,U=null,t=null,P=0,F=Xa,id=null,ta=1073741823,Yb=1073741823,kd=null,Xb=0,jd=!1,Re=0,Ph=500,l=null,cd=!1,Se=null,La=null,ld=!1,Zb=null,$b=90,bb=null,ac=0,af=null,dd=0,Ja=function(a,b){if(50<ac)throw ac=0,af=null,Error(k(185));a=ed(a,b);if(null!==a){var c=Cc();1073741823===b?(p&Ye)!==H&&(p&(ca|ma))===H?Te(a):(V(a),p===H&&ha()):V(a);(p&4)===H||98!==c&&99!==c||(null===bb?bb=new Map([[a,b]]):(c=bb.get(a),(void 0===c||c>b)&&bb.set(a,
b)))}};var zj=function(a,b,c){var d=b.expirationTime;if(null!==a){var e=b.pendingProps;if(a.memoizedProps!==e||G.current)ia=!0;else{if(d<c){ia=!1;switch(b.tag){case 3:sh(b);Ee();break;case 5:bh(b);if(b.mode&4&&1!==c&&e.hidden)return b.expirationTime=b.childExpirationTime=1,null;break;case 1:N(b.type)&&Bc(b);break;case 4:se(b,b.stateNode.containerInfo);break;case 10:d=b.memoizedProps.value;e=b.type._context;y(Ic,e._currentValue);e._currentValue=d;break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;
if(0!==d&&d>=c)return th(a,b,c);y(D,D.current&1);b=sa(a,b,c);return null!==b?b.sibling:null}y(D,D.current&1);break;case 19:d=b.childExpirationTime>=c;if(0!==(a.effectTag&64)){if(d)return vh(a,b,c);b.effectTag|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null);y(D,D.current);if(!d)return null}return sa(a,b,c)}ia=!1}}else ia=!1;b.expirationTime=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=pb(b,B.current);rb(b,c);e=we(null,
b,d,a,e,c);b.effectTag|=1;if("object"===typeof e&&null!==e&&"function"===typeof e.render&&void 0===e.$$typeof){b.tag=1;b.memoizedState=null;b.updateQueue=null;if(N(d)){var f=!0;Bc(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;ne(b);var g=d.getDerivedStateFromProps;"function"===typeof g&&Lc(b,d,g,a);e.updater=Mc;b.stateNode=e;e._reactInternalFiber=b;pe(b,d,a,c);b=Ie(null,b,d,!0,f,c)}else b.tag=0,T(null,b,e,c),b=b.child;return b;case 16:a:{e=b.elementType;null!==a&&(a.alternate=
null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;ri(e);if(1!==e._status)throw e._result;e=e._result;b.type=e;f=b.tag=Gj(e);a=aa(e,a);switch(f){case 0:b=He(null,b,e,a,c);break a;case 1:b=rh(null,b,e,a,c);break a;case 11:b=nh(null,b,e,a,c);break a;case 14:b=oh(null,b,e,aa(e.type,a),d,c);break a}throw Error(k(306,e,""));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),He(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),rh(a,b,d,e,c);
case 3:sh(b);d=b.updateQueue;if(null===a||null===d)throw Error(k(282));d=b.pendingProps;e=b.memoizedState;e=null!==e?e.element:null;oe(a,b);Qb(b,d,null,c);d=b.memoizedState.element;if(d===e)Ee(),b=sa(a,b,c);else{if(e=b.stateNode.hydrate)Ka=kb(b.stateNode.containerInfo.firstChild),ra=b,e=Wa=!0;if(e)for(c=Fe(b,null,d,c),b.child=c;c;)c.effectTag=c.effectTag&-3|1024,c=c.sibling;else T(a,b,d,c),Ee();b=b.child}return b;case 5:return bh(b),null===a&&De(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:
null,g=e.children,Yd(d,e)?g=null:null!==f&&Yd(d,f)&&(b.effectTag|=16),qh(a,b),b.mode&4&&1!==c&&e.hidden?(b.expirationTime=b.childExpirationTime=1,b=null):(T(a,b,g,c),b=b.child),b;case 6:return null===a&&De(b),null;case 13:return th(a,b,c);case 4:return se(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=wb(b,null,d,c):T(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),nh(a,b,d,e,c);case 7:return T(a,b,b.pendingProps,c),b.child;case 8:return T(a,
b,b.pendingProps.children,c),b.child;case 12:return T(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;var h=b.type._context;y(Ic,h._currentValue);h._currentValue=f;if(null!==g)if(h=g.value,f=Qa(h,f)?0:("function"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0,0===f){if(g.children===e.children&&!G.current){b=sa(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var m=h.dependencies;if(null!==
m){g=h.child;for(var l=m.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=Ea(c,null),l.tag=Jc,Fa(h,l));h.expirationTime<c&&(h.expirationTime=c);l=h.alternate;null!==l&&l.expirationTime<c&&(l.expirationTime=c);Sg(h.return,c);m.expirationTime<c&&(m.expirationTime=c);break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=
g}T(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,rb(b,c),e=W(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,T(a,b,d,c),b.child;case 14:return e=b.type,f=aa(e,b.pendingProps),f=aa(e.type,f),oh(a,b,e,f,d,c);case 15:return ph(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,N(d)?(a=!0,Bc(b)):a=!1,rb(b,c),Yg(b,d,e),pe(b,d,e,c),Ie(null,
b,d,!0,a,c);case 19:return vh(a,b,c)}throw Error(k(156,b.tag));};var bf=null,Ne=null,la=function(a,b,c,d){return new Fj(a,b,c,d)};ef.prototype.render=function(a){md(a,this._internalRoot,null,null)};ef.prototype.unmount=function(){var a=this._internalRoot,b=a.containerInfo;md(null,a,null,function(){b[Lb]=null})};var Di=function(a){if(13===a.tag){var b=Fc(ka(),150,100);Ja(a,b);df(a,b)}};var Yf=function(a){13===a.tag&&(Ja(a,3),df(a,3))};var Bi=function(a){if(13===a.tag){var b=ka();b=Va(b,a,null);Ja(a,
b);df(a,b)}};sd=function(a,b,c){switch(b){case "input":Dd(a,c);b=c.name;if("radio"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll("input[name="+JSON.stringify(""+b)+'][type="radio"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=ae(d);if(!e)throw Error(k(90));Gf(d);Dd(d,e)}}}break;case "textarea":Lf(a,c);break;case "select":b=c.value,null!=b&&hb(a,!!c.multiple,b,!1)}};(function(a,b,c,d){ee=a;eg=b;vd=c;vf=d})(Qh,function(a,b,c,d,e){var f=p;p|=4;
try{return Da(98,a.bind(null,b,c,d,e))}finally{p=f,p===H&&ha()}},function(){(p&(1|ca|ma))===H&&(uj(),xb())},function(a,b){var c=p;p|=2;try{return a(b)}finally{p=c,p===H&&ha()}});var mk={Events:[Hb,Pa,ae,pf,qd,lb,function(a){Kd(a,Ki)},sf,tf,sc,pc,xb,{current:!1}]};(function(a){var b=a.findFiberByHostInstance;return Ej(M({},a,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:da.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Sf(a);
return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:Bb,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"});I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mk;I.createPortal=Xh;I.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;if(void 0===
b){if("function"===typeof a.render)throw Error(k(188));throw Error(k(268,Object.keys(a)));}a=Sf(b);a=null===a?null:a.stateNode;return a};I.flushSync=function(a,b){if((p&(ca|ma))!==H)throw Error(k(187));var c=p;p|=1;try{return Da(99,a.bind(null,b))}finally{p=c,ha()}};I.hydrate=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!0,c)};I.render=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!1,c)};I.unmountComponentAtNode=function(a){if(!bc(a))throw Error(k(40));return a._reactRootContainer?
(Rh(function(){nd(null,null,a,!1,function(){a._reactRootContainer=null;a[Lb]=null})}),!0):!1};I.unstable_batchedUpdates=Qh;I.unstable_createPortal=function(a,b){return Xh(a,b,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};I.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!bc(c))throw Error(k(200));if(null==a||void 0===a._reactInternalFiber)throw Error(k(38));return nd(a,b,c,!1,d)};I.version="16.13.1"});
</script>
    <script>const e = React.createElement;

function pathToString(path) {
  if (path[0] === '/') {
    return '/' + path.slice(1).join('/');
  } else {
    return path.join('/');
  }
}

function findCommonPath(files) {
  if (!files || !files.length) {
    return [];
  }

  function isPrefix(arr, prefix) {
    if (arr.length < prefix.length) {
      return false;
    }
    for (let i = prefix.length - 1; i >= 0; --i) {
      if (arr[i] !== prefix[i]) {
        return false;
      }
    }
    return true;
  }

  let commonPath = files[0].path.slice(0, -1);
  while (commonPath.length) {
    if (files.every(file => isPrefix(file.path, commonPath))) {
      break;
    }
    commonPath.pop();
  }
  return commonPath;
}

function findFolders(files) {
  if (!files || !files.length) {
    return [];
  }

  let folders = files.filter(file => file.path.length > 1).map(file => file.path[0]);
  folders = [...new Set(folders)]; // unique
  folders.sort();

  folders = folders.map(folder => {
    let filesInFolder = files
      .filter(file => file.path[0] === folder)
      .map(file => ({
        ...file,
        path: file.path.slice(1),
        parent: [...file.parent, file.path[0]],
      }));

    const children = findFolders(filesInFolder); // recursion

    return {
      is_folder: true,
      path: [folder],
      parent: files[0].parent,
      children,
      covered: children.reduce((sum, file) => sum + file.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.coverable, 0),
      prevRun: {
        covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
        coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
      }
    };
  });

  return [
    ...folders,
    ...files.filter(file => file.path.length === 1),
  ];
}

class App extends React.Component {
  constructor(...args) {
    super(...args);

    this.state = {
      current: [],
    };
  }

  componentDidMount() {
    this.updateStateFromLocation();
    window.addEventListener("hashchange", () => this.updateStateFromLocation(), false);
  }

  updateStateFromLocation() {
    if (window.location.hash.length > 1) {
      const current = window.location.hash.substr(1).split('/');
      this.setState({current});
    } else {
      this.setState({current: []});
    }
  }

  getCurrentPath() {
    let file = this.props.root;
    let path = [file];
    for (let p of this.state.current) {
      file = file.children.find(file => file.path[0] === p);
      if (!file) {
        return path;
      }
      path.push(file);
    }
    return path;
  }

  render() {
    const path = this.getCurrentPath();
    const file = path[path.length - 1];

    let w = null;
    if (file.is_folder) {
      w = e(FilesList, {
        folder: file,
        onSelectFile: this.selectFile.bind(this),
        onBack: path.length > 1 ? this.back.bind(this) : null,
      });
    } else {
      w = e(DisplayFile, {
        file,
        onBack: this.back.bind(this),
      });
    }

    return e('div', {className: 'app'}, w);
  }

  selectFile(file) {
    this.setState(({current}) => {
      return {current: [...current, file.path[0]]};
    }, () => this.updateHash());
  }

  back(file) {
    this.setState(({current}) => {
      return {current: current.slice(0, current.length - 1)};
    }, () => this.updateHash());
  }

  updateHash() {
    if (!this.state.current || !this.state.current.length) {
      window.location = '#';
    } else {
      window.location = '#' + this.state.current.join('/');
    }
  }
}

function FilesList({folder, onSelectFile, onBack}) {
  let files = folder.children;
  return e('div', {className: 'display-folder'},
    e(FileHeader, {file: folder, onBack}),
    e('table', {className: 'files-list'},
      e('thead', {className: 'files-list__head'},
        e('tr', null,
          e('th', null, "Path"),
          e('th', null, "Coverage")
        )
      ),
      e('tbody', {className: 'files-list__body'},
        files.map(file => e(File, {file, onClick: onSelectFile}))
      )
    )
  );
}

function File({file, onClick}) {
  const coverage = file.coverable ? file.covered / file.coverable * 100 : -1;
  const coverageDelta = file.prevRun &&
    (file.covered / file.coverable * 100 - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('tr', {
      className: 'files-list__file'
        + (coverage >= 0 && coverage < 50 ? ' files-list__file_low': '')
        + (coverage >= 50 && coverage < 80 ? ' files-list__file_medium': '')
        + (coverage >= 80 ? ' files-list__file_high': '')
        + (file.is_folder ? ' files-list__file_folder': ''),
      onClick: () => onClick(file),
    },
    e('td', null, e('a', null, pathToString(file.path))),
    e('td', null,
      file.covered + ' / ' + file.coverable +
      (coverage >= 0 ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function DisplayFile({file, onBack}) {
  return e('div', {className: 'display-file'},
    e(FileHeader, {file, onBack}),
    e(FileContent, {file})
  );
}

function FileHeader({file, onBack}) {
  const coverage = file.covered / file.coverable * 100;
  const coverageDelta = file.prevRun && (coverage - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('div', {className: 'file-header'},
    onBack ? e('a', {className: 'file-header__back', onClick: onBack}, 'Back') : null,
    e('div', {className: 'file-header__name'}, pathToString([...file.parent, ...file.path])),
    e('div', {className: 'file-header__stat'},
      'Covered: ' + file.covered + ' of ' + file.coverable +
      (file.coverable ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function FileContent({file}) {
  return e('div', {className: 'file-content'},
    file.content.split(/\r?\n/).map((line, index) => {
      const trace = file.traces.find(trace => trace.line === index + 1);
      const covered = trace && trace.stats.Line;
      const uncovered = trace && !trace.stats.Line;
      return e('pre', {
          className: 'code-line'
            + (covered ? ' code-line_covered' : '')
            + (uncovered ? ' code-line_uncovered' : ''),
          title: trace ? JSON.stringify(trace.stats, null, 2) : null,
        }, line);
    })
  );
}

(function(){
  const commonPath = findCommonPath(data.files);
  const prevFilesMap = new Map();

  previousData && previousData.files.forEach((file) => {
    const path = file.path.slice(commonPath.length).join('/');
    prevFilesMap.set(path, file);
  });

  const files = data.files.map((file) => {
    const path = file.path.slice(commonPath.length);
    const { covered = 0, coverable = 0 } = prevFilesMap.get(path.join('/')) || {};
    return {
      ...file,
      path,
      parent: commonPath,
      prevRun: { covered, coverable },
    };
  });

  const children = findFolders(files);

  const root = {
    is_folder: true,
    children,
    path: commonPath,
    parent: [],
    covered: children.reduce((sum, file) => sum + file.covered, 0),
    coverable: children.reduce((sum, file) => sum + file.coverable, 0),
    prevRun: {
      covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
    }
  };

  ReactDOM.render(e(App, {root, prevFilesMap}), document.getElementById('root'));
}());
</script>
</body>
</html>